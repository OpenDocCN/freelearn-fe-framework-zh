<html><head></head><body>
<div id="_idContainer093">
<h1 class="chapter-number" id="_idParaDest-142"><a id="_idTextAnchor233"/><span class="koboSpan" id="kobo.1.1">8</span></h1>
<h1 id="_idParaDest-143"><a id="_idTextAnchor234"/><span class="koboSpan" id="kobo.2.1">Building an Interactive Quiz App</span></h1>
<p><span class="koboSpan" id="kobo.3.1">We’ll be stepping up the complexity in this chapter by creating a quiz app that has an admin panel and a real-time connection among multiple clients through the use of WebSockets. </span><span class="koboSpan" id="kobo.3.2">WebSockets differ from our usual endpoints by keeping the connection open, allowing for continuous updates to be sent from a central socket server to one or more clients. </span><span class="koboSpan" id="kobo.3.3">Using these features, we’ll build a small-scale </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">Kahoot clone.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">For the admin panel, we’ll use </span><a id="_idIndexMarker413"/><span class="koboSpan" id="kobo.6.1">Nuxt (</span><a href="https://nuxt.com/"><span class="koboSpan" id="kobo.7.1">https://nuxt.com/</span></a><span class="koboSpan" id="kobo.8.1">). </span><span class="koboSpan" id="kobo.8.2">Nuxt is a framework that was built as an extension of the Vue philosophy but extended with server capabilities. </span><span class="koboSpan" id="kobo.8.3">Save for the Electron app in </span><a href="B19563_07.xhtml#_idTextAnchor204"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.9.1">Chapter 7</span></em></span></a><span class="koboSpan" id="kobo.10.1">, all of our code can run in the browser of the client. </span><span class="koboSpan" id="kobo.10.2">Nuxt allows Vue code to be executed on a server. </span><span class="koboSpan" id="kobo.10.3">On top of that, it has a lot of </span><a id="_idIndexMarker414"/><span class="koboSpan" id="kobo.11.1">extra capabilities that drastically improve the </span><strong class="bold"><span class="koboSpan" id="kobo.12.1">developer experience</span></strong><span class="koboSpan" id="kobo.13.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.14.1">DX</span></strong><span class="koboSpan" id="kobo.15.1">). </span><span class="koboSpan" id="kobo.15.2">We’ll encounter these capabilities as we progress through </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">this chapter.</span></span></p>
<p><span class="koboSpan" id="kobo.17.1">In this chapter, we’ll cover the </span><span class="No-Break"><span class="koboSpan" id="kobo.18.1">following topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.19.1">Familiarizing yourself with Nuxt and </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">server-side rendering</span></span></li>
<li><span class="koboSpan" id="kobo.21.1">Understanding the difference between the REST API </span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">and WebSockets</span></span></li>
<li><span class="koboSpan" id="kobo.23.1">Client experience and server roles in complex </span><span class="No-Break"><span class="koboSpan" id="kobo.24.1">application architecture</span></span></li>
<li><span class="koboSpan" id="kobo.25.1">Structuring </span><span class="No-Break"><span class="koboSpan" id="kobo.26.1">application logic</span></span></li>
<li><span class="koboSpan" id="kobo.27.1">Using Node.js scripts in </span><span class="No-Break"><span class="koboSpan" id="kobo.28.1">development environments</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.29.1">We’re going to build three different applications that need to communicate with each other to form an </span><span class="No-Break"><span class="koboSpan" id="kobo.30.1">interactive quiz</span><a id="_idTextAnchor235"/><span class="koboSpan" id="kobo.31.1">.</span></span></p>
<h1 id="_idParaDest-144"><a id="_idTextAnchor236"/><span class="koboSpan" id="kobo.32.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.33.1">At the heart of our </span><a id="_idIndexMarker415"/><span class="koboSpan" id="kobo.34.1">setup lies the </span><strong class="bold"><span class="koboSpan" id="kobo.35.1">Server Quiz App</span></strong><span class="koboSpan" id="kobo.36.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.37.1">SQA</span></strong><span class="koboSpan" id="kobo.38.1">), which is scaffolded around </span><a id="_idIndexMarker416"/><span class="koboSpan" id="kobo.39.1">Nuxt (</span><a href="https://nuxt.com/"><span class="koboSpan" id="kobo.40.1">https://nuxt.com/</span></a><span class="koboSpan" id="kobo.41.1">), Pinia for state </span><a id="_idIndexMarker417"/><span class="koboSpan" id="kobo.42.1">management (</span><a href="https://pinia.vuejs.org/"><span class="koboSpan" id="kobo.43.1">https://pinia.vuejs.org/</span></a><span class="koboSpan" id="kobo.44.1">), Supabase</span><a id="_idIndexMarker418"/><span class="koboSpan" id="kobo.45.1"> for managing quiz data (</span><a href="https://supabase.com/"><span class="koboSpan" id="kobo.46.1">https://supabase.com/</span></a><span class="koboSpan" id="kobo.47.1">), and Vuetify (</span><a href="https://vuetifyjs.com/"><span class="koboSpan" id="kobo.48.1">https://vuetifyjs.com/</span></a><span class="koboSpan" id="kobo.49.1">) for rendering a </span><a id="_idIndexMarker419"/><span class="No-Break"><span class="koboSpan" id="kobo.50.1">management interface.</span></span></p>
<p><span class="koboSpan" id="kobo.51.1">We’ll build a </span><a id="_idIndexMarker420"/><span class="koboSpan" id="kobo.52.1">standalone </span><strong class="bold"><span class="koboSpan" id="kobo.53.1">Socket Quiz Server</span></strong><span class="koboSpan" id="kobo.54.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.55.1">SQS</span></strong><span class="koboSpan" id="kobo.56.1">) that </span><a id="_idIndexMarker421"/><span class="koboSpan" id="kobo.57.1">uses Express (</span><a href="https://expressjs.com/"><span class="koboSpan" id="kobo.58.1">https://expressjs.com/</span></a><span class="koboSpan" id="kobo.59.1">) to process incoming requests and sets up a </span><strong class="source-inline"><span class="koboSpan" id="kobo.60.1">socket.io</span></strong><span class="koboSpan" id="kobo.61.1"> server (</span><a href="https://socket.io/"><span class="koboSpan" id="kobo.62.1">https://socket.io/</span></a><span class="koboSpan" id="kobo.63.1">) to maintain a real-time connection </span><span class="No-Break"><span class="koboSpan" id="kobo.64.1">between clients.</span></span></p>
<p><span class="koboSpan" id="kobo.65.1">Lastly, our </span><strong class="bold"><span class="koboSpan" id="kobo.66.1">Client Quiz App</span></strong><span class="koboSpan" id="kobo.67.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.68.1">CQA</span></strong><span class="koboSpan" id="kobo.69.1">) will use</span><a id="_idIndexMarker422"/><span class="koboSpan" id="kobo.70.1"> Vuetify to render the quiz </span><span class="No-Break"><span class="koboSpan" id="kobo.71.1">elements (</span></span><a href="https://vuetifyjs.com/"><span class="No-Break"><span class="koboSpan" id="kobo.72.1">https://vuetifyjs.com/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.73.1">)</span></span><span class="No-Break"><span class="koboSpan" id="kobo.74.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.75.1">You can find the code complete code for this chapter </span><span class="No-Break"><span class="koboSpan" id="kobo.76.1">here: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/tree/main/08.quiz"><span class="No-Break"><span class="koboSpan" id="kobo.77.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/tree/main/08.quiz</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.78.1">.</span></span></p>
<h1 id="_idParaDest-145"><a id="_idTextAnchor237"/><span class="koboSpan" id="kobo.79.1">Entities in the quiz app setup</span></h1>
<p><span class="koboSpan" id="kobo.80.1">To give you an </span><a id="_idIndexMarker423"/><span class="koboSpan" id="kobo.81.1">idea of how our elements will work together, let’s quickly take a look at the </span><span class="No-Break"><span class="koboSpan" id="kobo.82.1">following figure:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer083">
<span class="koboSpan" id="kobo.83.1"><img alt="Figure 8.1 – Overview of the entities in the quiz app setup" src="image/B19563_08_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.84.1">Figure 8.1 – Overview of the entities in the quiz app setup</span></p>
<p><span class="koboSpan" id="kobo.85.1">The big </span><a id="_idIndexMarker424"/><span class="koboSpan" id="kobo.86.1">change concerning our previous projects is that our</span><a id="_idIndexMarker425"/><span class="koboSpan" id="kobo.87.1"> client (CQA) is not directly communicating with the Supabase database anymore. </span><span class="koboSpan" id="kobo.87.2">Instead, it connects via the SQS, where</span><a id="_idIndexMarker426"/><span class="koboSpan" id="kobo.88.1"> it retrieves questions and scores and sends its answers back to the SQS. </span><span class="koboSpan" id="kobo.88.2">The SQS, in turn, communicates with the </span><a id="_idIndexMarker427"/><span class="koboSpan" id="kobo.89.1">SQA to retrieve relevant quiz information and centralizes the session of a current active quiz between its </span><span class="No-Break"><span class="koboSpan" id="kobo.90.1">clients (CQAs).</span></span></p>
<p><span class="koboSpan" id="kobo.91.1">The SQA is used to manage the contents of quizzes and interact with </span><span class="No-Break"><span class="koboSpan" id="kobo.92.1">the database.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.93.1">A word beforehand</span></p>
<p class="callout"><span class="koboSpan" id="kobo.94.1">Since the setup is fairly complex, this chapter will not focus on, and instead leave out, security measures. </span><span class="koboSpan" id="kobo.94.2">It is good to realize the limitations of the project and don’t treat this as production-ready code. </span><span class="koboSpan" id="kobo.94.3">Where possible, we’ll mention implications or possible </span><span class="No-Break"><span class="koboSpan" id="kobo.95.1">solutions briefly.</span></span></p>
<p><span class="koboSpan" id="kobo.96.1">Let’s dive in by setting up </span><a id="_idTextAnchor238"/><span class="No-Break"><span class="koboSpan" id="kobo.97.1">the database.</span></span></p>
<h1 id="_idParaDest-146"><a id="_idTextAnchor239"/><span class="koboSpan" id="kobo.98.1">Setting up the database</span></h1>
<p><span class="koboSpan" id="kobo.99.1">As with previous chapters, we’ll start this </span><a id="_idIndexMarker428"/><span class="koboSpan" id="kobo.100.1">chapter by setting up our database. </span><span class="koboSpan" id="kobo.100.2">We’ll create another project called </span><strong class="source-inline"><span class="koboSpan" id="kobo.101.1">quiz</span></strong><span class="koboSpan" id="kobo.102.1">, set a strong database password, and select a geographically </span><span class="No-Break"><span class="koboSpan" id="kobo.103.1">close region.</span></span></p>
<p><span class="koboSpan" id="kobo.104.1">Remember to note the </span><strong class="bold"><span class="koboSpan" id="kobo.105.1">Project URL</span></strong><span class="koboSpan" id="kobo.106.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.107.1">API </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.108.1">Key</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.109.1"> values!</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.110.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.111.1">The intent of this chapter is not to focus on database management and the following settings should not be considered a best practice for a </span><span class="No-Break"><span class="koboSpan" id="kobo.112.1">production app!</span></span></p>
<p><span class="koboSpan" id="kobo.113.1">Follow these steps to set up </span><span class="No-Break"><span class="koboSpan" id="kobo.114.1">the database:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.115.1">Go to </span><strong class="bold"><span class="koboSpan" id="kobo.116.1">Table Editor</span></strong><span class="koboSpan" id="kobo.117.1"> and choose </span><strong class="bold"><span class="koboSpan" id="kobo.118.1">Create a new table</span></strong><span class="koboSpan" id="kobo.119.1">. </span><span class="koboSpan" id="kobo.119.2">Here, do </span><span class="No-Break"><span class="koboSpan" id="kobo.120.1">the following:</span></span><ol><li class="upper-roman"><span class="koboSpan" id="kobo.121.1">For the name, </span><span class="No-Break"><span class="koboSpan" id="kobo.122.1">insert </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.123.1">quiz</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.124.1">.</span></span></li><li class="upper-roman"><span class="koboSpan" id="kobo.125.1">Uncheck </span><strong class="bold"><span class="koboSpan" id="kobo.126.1">Enable Row Level Security (RLS)</span></strong><span class="koboSpan" id="kobo.127.1"> and confirm the dialog after reading </span><span class="No-Break"><span class="koboSpan" id="kobo.128.1">its warning.</span></span></li><li class="upper-roman"><span class="koboSpan" id="kobo.129.1">In the </span><strong class="bold"><span class="koboSpan" id="kobo.130.1">Columns</span></strong><span class="koboSpan" id="kobo.131.1"> section, change the type of the </span><strong class="bold"><span class="koboSpan" id="kobo.132.1">id</span></strong><span class="koboSpan" id="kobo.133.1"> field </span><span class="No-Break"><span class="koboSpan" id="kobo.134.1">to </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.135.1">uuid</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.136.1">.</span></span></li><li class="upper-roman"><span class="koboSpan" id="kobo.137.1">That’s enough for this table, so </span><span class="No-Break"><span class="koboSpan" id="kobo.138.1">click </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.139.1">Save</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.140.1">.</span></span></li></ol><p class="list-inset"><span class="koboSpan" id="kobo.141.1">We will only use this table as a grouping mechanism for questions, so we’re keeping it as simple </span><span class="No-Break"><span class="koboSpan" id="kobo.142.1">as possible.</span></span></p></li>
<li><span class="koboSpan" id="kobo.143.1">Now, return to </span><strong class="bold"><span class="koboSpan" id="kobo.144.1">Table Editor</span></strong><span class="koboSpan" id="kobo.145.1"> and click </span><strong class="bold"><span class="koboSpan" id="kobo.146.1">Create a new table</span></strong><span class="koboSpan" id="kobo.147.1">. </span><span class="koboSpan" id="kobo.147.2">Apply the </span><span class="No-Break"><span class="koboSpan" id="kobo.148.1">following settings:</span></span><ol><li class="upper-roman"><span class="koboSpan" id="kobo.149.1">For the name, </span><span class="No-Break"><span class="koboSpan" id="kobo.150.1">insert </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.151.1">questions</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.152.1">.</span></span></li><li class="upper-roman"><span class="koboSpan" id="kobo.153.1">Again, uncheck </span><strong class="bold"><span class="koboSpan" id="kobo.154.1">Enable Row Level Security (RLS)</span></strong><span class="koboSpan" id="kobo.155.1"> and confirm the dialog after reading </span><span class="No-Break"><span class="koboSpan" id="kobo.156.1">its warning.</span></span></li><li class="upper-roman"><span class="koboSpan" id="kobo.157.1">In the </span><strong class="bold"><span class="koboSpan" id="kobo.158.1">Columns</span></strong><span class="koboSpan" id="kobo.159.1"> section, change the type of the </span><strong class="bold"><span class="koboSpan" id="kobo.160.1">id</span></strong><span class="koboSpan" id="kobo.161.1"> field </span><span class="No-Break"><span class="koboSpan" id="kobo.162.1">to </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.163.1">uuid</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.164.1">.</span></span></li><li class="upper-roman"><span class="koboSpan" id="kobo.165.1">Create a new column called </span><strong class="bold"><span class="koboSpan" id="kobo.166.1">quiz_id</span></strong><span class="koboSpan" id="kobo.167.1"> and click the </span><strong class="bold"><span class="koboSpan" id="kobo.168.1">Edit foreign key </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.169.1">relation</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.170.1"> button:</span></span><ol><li class="lower-roman"><span class="koboSpan" id="kobo.171.1">In the side panel, select the </span><strong class="source-inline"><span class="koboSpan" id="kobo.172.1">quiz</span></strong><span class="koboSpan" id="kobo.173.1"> table and check that the </span><strong class="bold"><span class="koboSpan" id="kobo.174.1">id</span></strong><span class="koboSpan" id="kobo.175.1"> column is </span><span class="No-Break"><span class="koboSpan" id="kobo.176.1">automatically entered.</span></span></li><li class="lower-roman"><span class="koboSpan" id="kobo.177.1">Click </span><strong class="bold"><span class="koboSpan" id="kobo.178.1">Save</span></strong><span class="koboSpan" id="kobo.179.1"> to close the foreign </span><span class="No-Break"><span class="koboSpan" id="kobo.180.1">key property.</span></span></li></ol></li><li class="upper-roman"><span class="koboSpan" id="kobo.181.1">Create a column called </span><strong class="bold"><span class="koboSpan" id="kobo.182.1">question</span></strong><span class="koboSpan" id="kobo.183.1"> and set its type </span><span class="No-Break"><span class="koboSpan" id="kobo.184.1">to </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.185.1">text</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.186.1">.</span></span></li><li class="upper-roman"><span class="koboSpan" id="kobo.187.1">Create four columns called </span><strong class="bold"><span class="koboSpan" id="kobo.188.1">answer_1</span></strong><span class="koboSpan" id="kobo.189.1"> through </span><strong class="bold"><span class="koboSpan" id="kobo.190.1">answer_4</span></strong><span class="koboSpan" id="kobo.191.1"> with their type set </span><span class="No-Break"><span class="koboSpan" id="kobo.192.1">to </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.193.1">text</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.194.1">.</span></span></li><li class="upper-roman"><span class="koboSpan" id="kobo.195.1">Create a column called </span><strong class="bold"><span class="koboSpan" id="kobo.196.1">correct</span></strong><span class="koboSpan" id="kobo.197.1"> with its type set </span><span class="No-Break"><span class="koboSpan" id="kobo.198.1">to </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.199.1">int2</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.200.1">.</span></span></li></ol></li>
<li><span class="koboSpan" id="kobo.201.1">Click </span><strong class="bold"><span class="koboSpan" id="kobo.202.1">Save</span></strong><span class="koboSpan" id="kobo.203.1"> to create</span><a id="_idIndexMarker429"/> <span class="No-Break"><span class="koboSpan" id="kobo.204.1">the table.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.205.1">We’re not going to import any preset data since we’ll use our SQA to handle insertions for us! </span><span class="koboSpan" id="kobo.205.2">Let’s get started by building our first application in </span><span class="No-Break"><span class="koboSpan" id="kobo.206.1">this project.</span></span></p>
<h1 id="_idParaDest-147"><a id="_idTextAnchor240"/><span class="koboSpan" id="kobo.207.1">The SQA</span></h1>
<p><span class="koboSpan" id="kobo.208.1">To</span><a id="_idIndexMarker430"/><span class="koboSpan" id="kobo.209.1"> organize</span><a id="_idIndexMarker431"/><span class="koboSpan" id="kobo.210.1"> all our applications, we’ll create subfolders for every project in our chapters’ root folder. </span><span class="koboSpan" id="kobo.210.2">Since this app will run on Nuxt, we can use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.211.1">Nuxi</span></strong><span class="koboSpan" id="kobo.212.1"> CLI to install our project for us. </span><span class="koboSpan" id="kobo.212.2">From the root of our project, we’ll run the following command in the </span><span class="No-Break"><span class="koboSpan" id="kobo.213.1">command line:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.214.1">
npx nuxi@latest init server</span></pre> <p><span class="koboSpan" id="kobo.215.1">We’ll simply pick </span><strong class="source-inline"><span class="koboSpan" id="kobo.216.1">npm</span></strong><span class="koboSpan" id="kobo.217.1"> as our package manager. </span><span class="koboSpan" id="kobo.217.2">Once the installation is done, navigate to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.218.1">server</span></strong><span class="koboSpan" id="kobo.219.1"> folder and run </span><strong class="source-inline"><span class="koboSpan" id="kobo.220.1">npm run dev</span></strong><span class="koboSpan" id="kobo.221.1"> to start the application. </span><span class="koboSpan" id="kobo.221.2">By default, it will run on port </span><strong class="source-inline"><span class="koboSpan" id="kobo.222.1">3000</span></strong><span class="koboSpan" id="kobo.223.1">. </span><span class="koboSpan" id="kobo.223.2">Upon opening the URL in your browser, you should see something </span><span class="No-Break"><span class="koboSpan" id="kobo.224.1">like this:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer084">
<span class="koboSpan" id="kobo.225.1"><img alt="Figure 8.2 – The welcome screen of a fresh Nuxt installation" src="image/B19563_08_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.226.1">Figure 8.2 – The welcome screen of a fresh Nuxt installation</span></p>
<p><span class="koboSpan" id="kobo.227.1">While</span><a id="_idIndexMarker432"/><span class="koboSpan" id="kobo.228.1"> this may not look like much, please inspect the source of this page. </span><span class="koboSpan" id="kobo.228.2">Instead</span><a id="_idIndexMarker433"/><span class="koboSpan" id="kobo.229.1"> of rendering a virtual DOM to a </span><strong class="source-inline"><span class="koboSpan" id="kobo.230.1">&lt;div id="app" /&gt;</span></strong><span class="koboSpan" id="kobo.231.1"> element, Nuxt runs as a Node.js process, which (among other things) means that it supports server-side rendering of Vue components! </span><span class="koboSpan" id="kobo.231.2">This can be very beneficial since you don’t have to rely on JavaScript being executed in the browser, which positively impacts search engine optimization, crawling support, rendering performance, and browser memory usage. </span><span class="koboSpan" id="kobo.231.3">For more information, please visit the Nuxt official </span><span class="No-Break"><span class="koboSpan" id="kobo.232.1">docs (</span></span><a href="https://vuejs.org/guide/scaling-up/ssr.html#server-side-rendering-ssr"><span class="No-Break"><span class="koboSpan" id="kobo.233.1">https://vuejs.org/guide/scaling-up/ssr.html#server-side-rendering-ssr</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.234.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.235.1">With our foundation in place, let’s add some extra capabilities using the N</span><a id="_idTextAnchor241"/><span class="koboSpan" id="kobo.236.1">uxt </span><span class="No-Break"><span class="koboSpan" id="kobo.237.1">module system.</span></span></p>
<h2 id="_idParaDest-148"><a id="_idTextAnchor242"/><span class="koboSpan" id="kobo.238.1">Modules and auto-imports</span></h2>
<p><span class="koboSpan" id="kobo.239.1">We’ll start by adding </span><a id="_idIndexMarker434"/><span class="koboSpan" id="kobo.240.1">Vuetify to our project. </span><span class="koboSpan" id="kobo.240.2">Nuxt has a solid community </span><a id="_idIndexMarker435"/><span class="koboSpan" id="kobo.241.1">that contributes to</span><a id="_idIndexMarker436"/><span class="koboSpan" id="kobo.242.1"> certain modules for everyone to use. </span><span class="koboSpan" id="kobo.242.2">In our case, we’ll use the </span><em class="italic"><span class="koboSpan" id="kobo.243.1">Nuxt Vuetify Module</span></em><span class="koboSpan" id="kobo.244.1"> (</span><a href="https://nuxt.com/modules/nuxt-vuetify"><span class="koboSpan" id="kobo.245.1">https://nuxt.com/modules/nuxt-vuetify</span></a><span class="koboSpan" id="kobo.246.1">). </span><span class="koboSpan" id="kobo.246.2">In our </span><strong class="source-inline"><span class="koboSpan" id="kobo.247.1">server</span></strong><span class="koboSpan" id="kobo.248.1"> folder, run the </span><span class="No-Break"><span class="koboSpan" id="kobo.249.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.250.1">
npm install --save-dev @invictus.codes/nuxt-vuetify</span></pre> <p><span class="koboSpan" id="kobo.251.1">Nuxt modules can be registered and configured via the </span><strong class="source-inline"><span class="koboSpan" id="kobo.252.1">nuxt.config.ts</span></strong><span class="koboSpan" id="kobo.253.1"> file by changing its contents, </span><span class="No-Break"><span class="koboSpan" id="kobo.254.1">as follows:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.255.1">
// https://nuxt.com/docs/api/configuration/nuxt-configexport default defineNuxtConfig({
  devtools: { enabled: true },
  modules: [
    '@invictus.codes/nuxt-vuetify'
  ],
  vuetify: {
    moduleOptions: {
      treeshaking: true,
      useIconCDN: true,
      styles: true,
      autoImport: true,
      useVuetifyLabs: true,
    }
  }
})</span></pre>
<p><span class="koboSpan" id="kobo.256.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.257.1">modules</span></strong><span class="koboSpan" id="kobo.258.1"> property, we register the module we want to use, and, optionally, on the (in this case) </span><strong class="source-inline"><span class="koboSpan" id="kobo.259.1">vuetify</span></strong><span class="koboSpan" id="kobo.260.1"> property, we configure how the module </span><span class="No-Break"><span class="koboSpan" id="kobo.261.1">should behave.</span></span></p>
<p><span class="koboSpan" id="kobo.262.1">That’s all </span><a id="_idIndexMarker437"/><span class="koboSpan" id="kobo.263.1">we need! </span><span class="koboSpan" id="kobo.263.2">We can now use the Vuetify</span><a id="_idIndexMarker438"/><span class="koboSpan" id="kobo.264.1"> templates in our application. </span><span class="koboSpan" id="kobo.264.2">Nuxt supports a concept called auto-importing, which means that for commonly used scripts, we don’t need to explicitly write the import statement in our script block. </span><span class="koboSpan" id="kobo.264.3">Nuxt can figure out the required file at runtime! </span><span class="koboSpan" id="kobo.264.4">As you will see when we start to write our code, this will make our files v</span><a id="_idTextAnchor243"/><span class="koboSpan" id="kobo.265.1">ery clean </span><span class="No-Break"><span class="koboSpan" id="kobo.266.1">and readable.</span></span></p>
<h2 id="_idParaDest-149"><a id="_idTextAnchor244"/><span class="koboSpan" id="kobo.267.1">File-based routing</span></h2>
<p><span class="koboSpan" id="kobo.268.1">Similar to the automated</span><a id="_idIndexMarker439"/><span class="koboSpan" id="kobo.269.1"> imports, Nuxt uses our familiar </span><strong class="source-inline"><span class="koboSpan" id="kobo.270.1">vue-router</span></strong><span class="koboSpan" id="kobo.271.1"> by default, and it’s configured to create routes for you, based on a certain file </span><span class="No-Break"><span class="koboSpan" id="kobo.272.1">structure (</span></span><a href="https://nuxt.com/docs/getting-started/routing#routing"><span class="No-Break"><span class="koboSpan" id="kobo.273.1">https://nuxt.com/docs/getting-started/routing#routing</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.274.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.275.1">We’ll start with a default layout by creating a </span><strong class="source-inline"><span class="koboSpan" id="kobo.276.1">default.vue</span></strong><span class="koboSpan" id="kobo.277.1"> file in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.278.1">layouts</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.279.1">folder: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.1-default.vue"><span class="No-Break"><span class="koboSpan" id="kobo.280.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.1-default.vue</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.281.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.282.1">As you can see, we’re depending on Vuetify components to create a simple layout for us. </span><span class="koboSpan" id="kobo.282.2">You can already identify a couple of routes. </span><span class="koboSpan" id="kobo.282.3">We’ll create them in the next section. </span><span class="koboSpan" id="kobo.282.4">For now, we can use the default layout in our app by updating the </span><strong class="source-inline"><span class="koboSpan" id="kobo.283.1">app.vue</span></strong><span class="koboSpan" id="kobo.284.1"> file in the SQA root folder with the </span><span class="No-Break"><span class="koboSpan" id="kobo.285.1">following contents:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.286.1">
&lt;template&gt;  &lt;NuxtLayout&gt;
    &lt;NuxtWelcome /&gt;
  &lt;/NuxtLayout&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.287.1">As you can see in the menu, we need a couple of routes: a home route, a route to manage quizzes, and a route where we can share </span><span class="No-Break"><span class="koboSpan" id="kobo.288.1">a quiz.</span></span></p>
<p><span class="koboSpan" id="kobo.289.1">We’ll </span><a id="_idIndexMarker440"/><span class="koboSpan" id="kobo.290.1">start with the home route by creating a </span><strong class="source-inline"><span class="koboSpan" id="kobo.291.1">pages</span></strong><span class="koboSpan" id="kobo.292.1"> folder in the root of the SQA folder and adding an </span><strong class="source-inline"><span class="koboSpan" id="kobo.293.1">index.vue</span></strong><span class="koboSpan" id="kobo.294.1"> file with the </span><span class="No-Break"><span class="koboSpan" id="kobo.295.1">following contents:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.296.1">
&lt;template&gt;  &lt;v-card class="mx-auto" width="600"&gt;
    &lt;template v-slot:title&gt;Welcome to the Admin Panel&lt;/template&gt;
    &lt;v-card-text&gt;
      &lt;p&gt;
        Via this interface, you can create and edit quizzes. </span><span class="koboSpan" id="kobo.296.2">This panel is not perfect, but it works. </span><span class="koboSpan" id="kobo.296.3">As an extra challenge consider implementing the following features:
      &lt;/p&gt;
      &lt;ul class="ma-4"&gt;
        &lt;li&gt;
          Adding meta data to a quiz, such as a title and make it more identifiable in Admin Panel;
        &lt;/li&gt;
        &lt;li&gt;Managing the order of Questions in a Quiz;&lt;/li&gt;
        &lt;li&gt;Securing the Admin Panel via the Supabase OTP authentication;&lt;/li&gt;
        &lt;li&gt;Adding validation on the Question dialog inputs&lt;/li&gt;
      &lt;/ul&gt;
      &lt;p&gt;Good luck!&lt;/p&gt;
    &lt;/v-card-text&gt;
  &lt;/v-card&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.297.1">Now, if we flip</span><a id="_idIndexMarker441"/><span class="koboSpan" id="kobo.298.1"> back to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.299.1">app.vue</span></strong><span class="koboSpan" id="kobo.300.1"> file and replace the </span><strong class="source-inline"><span class="koboSpan" id="kobo.301.1">&lt;NuxtWelcome /&gt;</span></strong><span class="koboSpan" id="kobo.302.1"> component with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.303.1">&lt;NuxtPage /&gt;</span></strong><span class="koboSpan" id="kobo.304.1"> component (notice that we don’t need to import these components in our script block to use them?) while the development server is active, our home route now opens the contents of </span><strong class="source-inline"><span class="koboSpan" id="kobo.305.1">./pages/index.vue</span></strong><span class="koboSpan" id="kobo.306.1"> in </span><span class="No-Break"><span class="koboSpan" id="kobo.307.1">our app!</span></span></p>
<p><span class="koboSpan" id="kobo.308.1">So, what’s </span><a id="_idIndexMarker442"/><span class="koboSpan" id="kobo.309.1">happening here? </span><span class="koboSpan" id="kobo.309.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.310.1">NuxtPage</span></strong><span class="koboSpan" id="kobo.311.1"> component has some logic built in that can read the </span><strong class="source-inline"><span class="koboSpan" id="kobo.312.1">pages</span></strong><span class="koboSpan" id="kobo.313.1"> folder and dynamically create routes on the vue router instance that’s initialized as a default part of </span><span class="No-Break"><span class="koboSpan" id="kobo.314.1">Nuxt. </span><span class="koboSpan" id="kobo.314.2">Neat!</span></span></p>
<p><span class="koboSpan" id="kobo.315.1">Now, if we want to route to a certain path, we can simply create a new folder in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.316.1">./pages</span></strong><span class="koboSpan" id="kobo.317.1"> folder with a name that matches the route. </span><span class="koboSpan" id="kobo.317.2">In our case, we’ll create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.318.1">quiz</span></strong><span class="koboSpan" id="kobo.319.1"> subfolder and add another </span><strong class="source-inline"><span class="koboSpan" id="kobo.320.1">index.vue</span></strong><span class="koboSpan" id="kobo.321.1"> file in </span><span class="No-Break"><span class="koboSpan" id="kobo.322.1">that folder.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.323.1">Note</span></p>
<p class="callout"><span class="koboSpan" id="kobo.324.1">Technically, you could also opt to create a file called </span><strong class="source-inline"><span class="koboSpan" id="kobo.325.1">quiz.vue</span></strong><span class="koboSpan" id="kobo.326.1"> in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.327.1">./pages</span></strong><span class="koboSpan" id="kobo.328.1"> folder. </span><span class="koboSpan" id="kobo.328.2">However, since we will add multiple routes that are part of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.329.1">quiz</span></strong><span class="koboSpan" id="kobo.330.1"> domain, it’s a better practice to group them in their </span><span class="No-Break"><span class="koboSpan" id="kobo.331.1">dedicated folder.</span></span></p>
<p><span class="koboSpan" id="kobo.332.1">We’ll begin with a basic file as part </span><span class="No-Break"><span class="koboSpan" id="kobo.333.1">of </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.334.1">./pages/quiz/index.vue</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.335.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.336.1">
&lt;template&gt;  &lt;div class="my-8"&gt;
    &lt;h1 class="text-h3 mb-8"&gt;Choose quiz to edit&lt;/h1&gt;
    &lt;v-card class="mx-auto" max-width="600"&gt;
      &lt;v-divider /&gt;
      &lt;v-card-actions&gt;
        &lt;v-btn primary class="my-4 mx-4"&gt;✨ Create new Quiz&lt;/v-btn&gt;
      &lt;/v-card-actions&gt;
    &lt;/v-card&gt;
  &lt;/div&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.337.1">Now, when </span><a id="_idIndexMarker443"/><span class="koboSpan" id="kobo.338.1">navigating to </span><strong class="source-inline"><span class="koboSpan" id="kobo.339.1">http://localhost:3000/quiz</span></strong><span class="koboSpan" id="kobo.340.1"> in your browser (or using the </span><strong class="bold"><span class="koboSpan" id="kobo.341.1">Manage Quizzes</span></strong><span class="koboSpan" id="kobo.342.1"> button in the navigation drawer), you should see the </span><span class="No-Break"><span class="koboSpan" id="kobo.343.1">following page:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer085">
<span class="koboSpan" id="kobo.344.1"><img alt="Figure 8.3 – File-based routing in action" src="image/B19563_08_03.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.345.1">Figure 8.3 – File-based routing in action</span></p>
<p><span class="koboSpan" id="kobo.346.1">Our static page doesn’t help us that much, so we’ll focus on establishing the connection and data from our da</span><a id="_idTextAnchor245"/><span class="koboSpan" id="kobo.347.1">tabase in the </span><span class="No-Break"><span class="koboSpan" id="kobo.348.1">next section.</span></span></p>
<h2 id="_idParaDest-150"><a id="_idTextAnchor246"/><span class="koboSpan" id="kobo.349.1">Reintroducing two familiar friends</span></h2>
<p><span class="koboSpan" id="kobo.350.1">As we </span><a id="_idIndexMarker444"/><span class="koboSpan" id="kobo.351.1">did in </span><em class="italic"><span class="koboSpan" id="kobo.352.1">Chapters 6</span></em><span class="koboSpan" id="kobo.353.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.354.1">7</span></em><span class="koboSpan" id="kobo.355.1">, we’ll depend on the Supabase JS client and Pinia. </span><span class="koboSpan" id="kobo.355.2">Let’s see how </span><span class="No-Break"><span class="koboSpan" id="kobo.356.1">that works.</span></span></p>
<p><span class="koboSpan" id="kobo.357.1">First, we’ll install the Supabase JS Client (</span><a href="https://www.npmjs.com/package/@supabase/supabase-js"><span class="koboSpan" id="kobo.358.1">https://www.npmjs.com/package/@supabase/supabase-js</span></a><span class="koboSpan" id="kobo.359.1">) with the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.360.1">npm</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.361.1"> command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.362.1">
npm install @supabase/supabase-js</span></pre> <p><span class="koboSpan" id="kobo.363.1">We’ll also create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.364.1">./composables</span></strong><span class="koboSpan" id="kobo.365.1"> folder with a </span><strong class="source-inline"><span class="koboSpan" id="kobo.366.1">supabase.ts</span></strong><span class="koboSpan" id="kobo.367.1"> file that has the </span><span class="No-Break"><span class="koboSpan" id="kobo.368.1">following contents:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.369.1">
import { createClient } from '@supabase/supabase-js'const supabaseUrl = import.meta.env.VITE_SUPABASE_URL
const supabaseAnonKey = import.meta.env.VITE_SUPABASE_ANON_KEY
export const useSupabaseClient = createClient(supabaseUrl as string, supabaseAnonKey as string, { auth: { persistSession: false } });</span></pre>
<p><span class="koboSpan" id="kobo.370.1">Nuxt is set up to scan the </span><strong class="source-inline"><span class="koboSpan" id="kobo.371.1">./composables</span></strong><span class="koboSpan" id="kobo.372.1"> folder and extract the exports so that it supports auto imports for composables as well! </span><span class="koboSpan" id="kobo.372.2">There’s one caveat: it only scans one level and excludes </span><span class="No-Break"><span class="koboSpan" id="kobo.373.1">nested folders.</span></span></p>
<p><span class="koboSpan" id="kobo.374.1">As you can see, we need to set up a </span><strong class="source-inline"><span class="koboSpan" id="kobo.375.1">.env</span></strong><span class="koboSpan" id="kobo.376.1"> file in the root of our SQA folder with the URL and API key that we received when we created our database. </span><span class="koboSpan" id="kobo.376.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.377.1">.env</span></strong><span class="koboSpan" id="kobo.378.1"> file has the same setup as in </span><em class="italic"><span class="koboSpan" id="kobo.379.1">Chapters 6</span></em> <span class="No-Break"><span class="koboSpan" id="kobo.380.1">and </span></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.381.1">7</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.382.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.383.1">
VITE_SUPABASE_URL=YOUR_SUPABASE_URLVITE_SUPABASE_ANON_KEY=YOUR_SUPABASE_ANON_KEY</span></pre>
<p><span class="koboSpan" id="kobo.384.1">With our client in place, we can add Pinia – this time, as a Nuxt module. </span><span class="koboSpan" id="kobo.384.2">Run the following command in the terminal to install </span><span class="No-Break"><span class="koboSpan" id="kobo.385.1">the packages:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.386.1">
npm install pinia @pinia/nuxt</span></pre> <p><span class="koboSpan" id="kobo.387.1">If you run into an </span><strong class="source-inline"><span class="koboSpan" id="kobo.388.1">ERESOLVE</span></strong><span class="koboSpan" id="kobo.389.1"> error during installation, please look at the tip provided in the installation </span><span class="No-Break"><span class="koboSpan" id="kobo.390.1">guide (</span></span><a href="https://pinia.vuejs.org/ssr/nuxt.html#Installation"><span class="No-Break"><span class="koboSpan" id="kobo.391.1">https://pinia.vuejs.org/ssr/nuxt.html#Installation</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.392.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.393.1">We’ll add the module to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.394.1">modules</span></strong><span class="koboSpan" id="kobo.395.1"> array on the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.396.1">nuxt.config.ts</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.397.1"> property:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.398.1">
  modules: [    '@invictus.codes/nuxt-vuetify',
</span><strong class="bold"><span class="koboSpan" id="kobo.399.1">    '@pinia/nuxt'</span></strong><span class="koboSpan" id="kobo.400.1">
  ],</span></pre>
<p><span class="koboSpan" id="kobo.401.1">For an even better coding experience, we can define the auto imports for Pinia functions as well by adding the following property to the </span><span class="No-Break"><span class="koboSpan" id="kobo.402.1">Nuxt config:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.403.1">
  pinia: {    autoImports: [
      'defineStore',
      ['defineStore', 'definePiniaStore'],
    ],
  },</span></pre>
<p><span class="koboSpan" id="kobo.404.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.405.1">nuxt.config.ts</span></strong><span class="koboSpan" id="kobo.406.1"> file will look like this: </span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.2-nuxt.config.ts"><span class="koboSpan" id="kobo.407.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.2-nuxt.config.ts</span></a><span class="koboSpan" id="kobo.408.1">. </span><span class="koboSpan" id="kobo.408.2">With Supabase and Pinia now in place, we can create our </span><span class="No-Break"><span class="koboSpan" id="kobo.409.1">quiz store!</span></span></p>
<p><span class="koboSpan" id="kobo.410.1">For our stores, we’ll create the </span><strong class="source-inline"><span class="koboSpan" id="kobo.411.1">./stores</span></strong><span class="koboSpan" id="kobo.412.1"> folder with a </span><strong class="source-inline"><span class="koboSpan" id="kobo.413.1">quiz.ts</span></strong><span class="koboSpan" id="kobo.414.1"> file that has the following </span><span class="No-Break"><span class="koboSpan" id="kobo.415.1">contents: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.3-quiz.ts"><span class="No-Break"><span class="koboSpan" id="kobo.416.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.3-quiz.ts</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.417.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.418.1">If you</span><a id="_idIndexMarker445"/><span class="koboSpan" id="kobo.419.1"> compare this store to, for instance, the </span><em class="italic"><span class="koboSpan" id="kobo.420.1">User Store</span></em><span class="koboSpan" id="kobo.421.1"> from </span><a href="B19563_06.xhtml#_idTextAnchor162"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.422.1">Chapter 6</span></em></span></a><span class="koboSpan" id="kobo.423.1">, you’ll notice that a lot of imports are missing. </span><span class="koboSpan" id="kobo.423.2">That’s because they’re being handled by Nuxt! </span><span class="koboSpan" id="kobo.423.3">Let’s quickly summarize the functionalities of the </span><em class="italic"><span class="koboSpan" id="kobo.424.1">Quiz Store</span></em><span class="koboSpan" id="kobo.425.1"> since we’re not going to go </span><span class="No-Break"><span class="koboSpan" id="kobo.426.1">in depth.</span></span></p>
<p><span class="koboSpan" id="kobo.427.1">Our store exposes a list of all quizzes (</span><em class="italic"><span class="koboSpan" id="kobo.428.1">line 7</span></em><span class="koboSpan" id="kobo.429.1">) and the method for retrieving that data from Supabase (</span><em class="italic"><span class="koboSpan" id="kobo.430.1">lines 11–30</span></em><span class="koboSpan" id="kobo.431.1">). </span><span class="koboSpan" id="kobo.431.2">Our store also exposes the properties of a single quiz (</span><em class="italic"><span class="koboSpan" id="kobo.432.1">line 8</span></em><span class="koboSpan" id="kobo.433.1">) and the accompanying method of retrieving quiz data from the database (</span><em class="italic"><span class="koboSpan" id="kobo.434.1">lines 62–82</span></em><span class="koboSpan" id="kobo.435.1">). </span><span class="koboSpan" id="kobo.435.2">For both the quiz and answers to the quiz, we expose methods to upsert data and remove data. </span><span class="koboSpan" id="kobo.435.3">That’s the basic management we need to </span><span class="No-Break"><span class="koboSpan" id="kobo.436.1">continue with.</span></span></p>
<p><span class="koboSpan" id="kobo.437.1">We’ll </span><a id="_idIndexMarker446"/><span class="koboSpan" id="kobo.438.1">revisit our </span><strong class="source-inline"><span class="koboSpan" id="kobo.439.1">./pages/quiz/index.vue</span></strong><span class="koboSpan" id="kobo.440.1"> file to add management at the quiz </span><span class="No-Break"><span class="koboSpan" id="kobo.441.1">level: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.4-index.vue"><span class="No-Break"><span class="koboSpan" id="kobo.442.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.4-index.vue</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.443.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.444.1">When you run the development server, you should be able to add a couple of new quizzes and have them show up in this overview, as shown in the </span><span class="No-Break"><span class="koboSpan" id="kobo.445.1">following screenshot:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer086">
<span class="koboSpan" id="kobo.446.1"><img alt="Figure 8.4 – Our application connected to the database via a Pin﻿ia store" src="image/B19563_08_04.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.447.1">Figure 8.4 – Our application connected to the database via a Pinia store</span></p>
<p><span class="koboSpan" id="kobo.448.1">We can now build a similar overview of quizzes for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.449.1">/share</span></strong><span class="koboSpan" id="kobo.450.1"> route with ease by creating a </span><strong class="source-inline"><span class="koboSpan" id="kobo.451.1">./share</span></strong><span class="koboSpan" id="kobo.452.1"> subfolder in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.453.1">./pages</span></strong><span class="koboSpan" id="kobo.454.1"> folder, creating an </span><strong class="source-inline"><span class="koboSpan" id="kobo.455.1">index.vue</span></strong><span class="koboSpan" id="kobo.456.1"> file, and pasting the following contents in that </span><span class="No-Break"><span class="koboSpan" id="kobo.457.1">file: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.5-index.vue"><span class="No-Break"><span class="koboSpan" id="kobo.458.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.5-index.vue</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.459.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.460.1">We’re getting there! </span><span class="koboSpan" id="kobo.460.2">If you noticed the </span><strong class="source-inline"><span class="koboSpan" id="kobo.461.1">&lt;nuxt-link /&gt;</span></strong><span class="koboSpan" id="kobo.462.1"> component in both pages we created, you may have noticed its similarities to </span><strong class="source-inline"><span class="koboSpan" id="kobo.463.1">&lt;router-link /&gt;</span></strong><span class="koboSpan" id="kobo.464.1">. </span><span class="koboSpan" id="kobo.464.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.465.1">&lt;nuxt-link /&gt;</span></strong><span class="koboSpan" id="kobo.466.1"> component is a wrapper for it but also helps Nuxt in determining a map of all possible routes. </span><span class="koboSpan" id="kobo.466.2">Together with file-based routing, these occurrences and configuration of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.467.1">&lt;nuxt-link /&gt;</span></strong><span class="koboSpan" id="kobo.468.1">  components help in determining the configuration of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.469.1">vue-router</span></strong><span class="koboSpan" id="kobo.470.1"> implementation. </span><span class="koboSpan" id="kobo.470.2">You may have also noticed </span><a id="_idIndexMarker447"/><span class="koboSpan" id="kobo.471.1">that both components link to a dynamic route as a child of </span><strong class="source-inline"><span class="koboSpan" id="kobo.472.1">/quiz</span></strong><span class="koboSpan" id="kobo.473.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.474.1">/share</span></strong><span class="koboSpan" id="kobo.475.1">, </span><a id="_idTextAnchor247"/><span class="koboSpan" id="kobo.476.1">respectively. </span><span class="koboSpan" id="kobo.476.2">Let’s </span><span class="No-Break"><span class="koboSpan" id="kobo.477.1">fix those!</span></span></p>
<h2 id="_idParaDest-151"><a id="_idTextAnchor248"/><span class="koboSpan" id="kobo.478.1">Dynamic file-based routes</span></h2>
<p><span class="koboSpan" id="kobo.479.1">We’ll start with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.480.1">./share</span></strong><span class="koboSpan" id="kobo.481.1"> route. </span><span class="koboSpan" id="kobo.481.2">As </span><a id="_idIndexMarker448"/><span class="koboSpan" id="kobo.482.1">you can see by the markup of the link component, we’re targeting a route with </span><span class="No-Break"><span class="koboSpan" id="kobo.483.1">a parameter:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.484.1">
&lt;nuxt-link :to="`/share/${quiz.id}`"&gt;  &lt;v-btn flat&gt;{{ quiz.id }}&lt;/v-btn&gt;
&lt;/nuxt-link&gt;</span></pre>
<p><span class="koboSpan" id="kobo.485.1">Normally, we’d configure our Vue router configuration with something like the following </span><span class="No-Break"><span class="koboSpan" id="kobo.486.1">example entry:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.487.1">
  routes: [    {
      path: '/share/</span><strong class="bold"><span class="koboSpan" id="kobo.488.1">:id</span></strong><span class="koboSpan" id="kobo.489.1">',
      name: share,
      component: () =&gt; import('../pages/ShareDetail.vue')
    },
  ]</span></pre>
<p><span class="koboSpan" id="kobo.490.1">Using Nuxt, passing a parameter is as simple as marking it in the filename. </span><span class="koboSpan" id="kobo.490.2">Next to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.491.1">index.vue</span></strong><span class="koboSpan" id="kobo.492.1"> file, we’ll create a file called </span><strong class="source-inline"><span class="koboSpan" id="kobo.493.1">[quiz_id].vue</span></strong><span class="koboSpan" id="kobo.494.1">. </span><span class="koboSpan" id="kobo.494.2">This is the equivalent result of defining the parameter in a route file. </span><span class="koboSpan" id="kobo.494.3">It tells Nuxt to instruct the router to create a route with a parameter of </span><strong class="source-inline"><span class="koboSpan" id="kobo.495.1">quiz_id</span></strong><span class="koboSpan" id="kobo.496.1">. </span><span class="koboSpan" id="kobo.496.2">In the file, we can read the parameter by utilizing the </span><strong class="source-inline"><span class="koboSpan" id="kobo.497.1">useRoute</span></strong><span class="koboSpan" id="kobo.498.1"> composable and accessing the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.499.1">params.quiz_id</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.500.1"> property!</span></span></p>
<p><span class="koboSpan" id="kobo.501.1">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.502.1">[quiz_id].vue</span></strong><span class="koboSpan" id="kobo.503.1"> file, we’ll add the following </span><span class="No-Break"><span class="koboSpan" id="kobo.504.1">contents: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.6-%5Bquiz_id%5D.vue"><span class="No-Break"><span class="koboSpan" id="kobo.505.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.6-%5Bquiz_id%5D.vue</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.506.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.507.1">The page itself is nothing fancy: it just generates an anchor link element that points to a URL that we will need to build an app for in the final section of </span><span class="No-Break"><span class="koboSpan" id="kobo.508.1">this chapter!</span></span></p>
<p><span class="koboSpan" id="kobo.509.1">To complete the management interface, we’ll create a page for editing questions in a certain quiz. </span><span class="koboSpan" id="kobo.509.2">First, as a requirement, we’ll create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.510.1">./components</span></strong><span class="koboSpan" id="kobo.511.1"> folder with a </span><strong class="source-inline"><span class="koboSpan" id="kobo.512.1">FormQuestion.vue</span></strong><span class="koboSpan" id="kobo.513.1"> file that has the following </span><span class="No-Break"><span class="koboSpan" id="kobo.514.1">contents: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.7-FormQuestion.vue"><span class="No-Break"><span class="koboSpan" id="kobo.515.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.7-FormQuestion.vue</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.516.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.517.1">In the file, we’re </span><a id="_idIndexMarker449"/><span class="koboSpan" id="kobo.518.1">directly mapping a form to the columns in our database. </span><span class="koboSpan" id="kobo.518.2">It’s pretty straightforward to set up, although I’d like to point out the repeating setup for the answers (</span><em class="italic"><span class="koboSpan" id="kobo.519.1">lines 33–48</span></em><span class="koboSpan" id="kobo.520.1">) where we use a </span><strong class="source-inline"><span class="koboSpan" id="kobo.521.1">v-for</span></strong><span class="koboSpan" id="kobo.522.1"> directive to generate the four answer fields and map each field’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.523.1">v-model</span></strong><span class="koboSpan" id="kobo.524.1"> using dynamic object keys (</span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.525.1">line 36</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.526.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.527.1">Now, we’ll create a dynamic route as a descendant of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.528.1">quiz</span></strong><span class="koboSpan" id="kobo.529.1"> route by creating a </span><strong class="source-inline"><span class="koboSpan" id="kobo.530.1">[quiz_id].vue</span></strong><span class="koboSpan" id="kobo.531.1"> file in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.532.1">./pages/quiz</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.533.1">folder: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.8-%5Bquiz_id%5D.vue"><span class="No-Break"><span class="koboSpan" id="kobo.534.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.8-%5Bquiz_id%5D.vue</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.535.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.536.1">With these pages finished, you should be able to create one or two small quizzes with multiple-choice questions. </span><span class="koboSpan" id="kobo.536.2">Before we continue, we need to have at least one, but preferably more</span><a id="_idIndexMarker450"/><span class="koboSpan" id="kobo.537.1"> quizzes in the database, with a couple of </span><span class="No-Break"><span class="koboSpan" id="kobo.538.1">multiple-choice questions.</span></span></p>
<p><span class="koboSpan" id="kobo.539.1">Why don’t you try and creat</span><a id="_idTextAnchor249"/><span class="koboSpan" id="kobo.540.1">e a quiz about the </span><span class="No-Break"><span class="koboSpan" id="kobo.541.1">Vue ecosystem?</span></span></p>
<h1 id="_idParaDest-152"><a id="_idTextAnchor250"/><span class="koboSpan" id="kobo.542.1">Setting up the SQS</span></h1>
<p><span class="koboSpan" id="kobo.543.1">Our next order of </span><a id="_idIndexMarker451"/><span class="koboSpan" id="kobo.544.1">business is setting up the server that handles </span><a id="_idIndexMarker452"/><span class="koboSpan" id="kobo.545.1">the requests from one or more clients. </span><span class="koboSpan" id="kobo.545.2">This will be a small standalone application and it will get its data from our Nuxt</span><a id="_idIndexMarker453"/><span class="koboSpan" id="kobo.546.1"> server since that already has a connection with the database instance. </span><span class="koboSpan" id="kobo.546.2">Creating an endpoint in Nuxt is something we haven’t built yet because our Nuxt application is only cap</span><a id="_idTextAnchor251"/><span class="koboSpan" id="kobo.547.1">able of presenting a </span><span class="No-Break"><span class="koboSpan" id="kobo.548.1">management app!</span></span></p>
<h2 id="_idParaDest-153"><a id="_idTextAnchor252"/><span class="koboSpan" id="kobo.549.1">Nuxt API routes</span></h2>
<p><span class="koboSpan" id="kobo.550.1">As I mentioned previously, the </span><a id="_idIndexMarker454"/><span class="koboSpan" id="kobo.551.1">Nuxt app runs as a Node process. </span><span class="koboSpan" id="kobo.551.2">When we request pages, it acts as a web server that interprets the Vue components and routes to return an HTML response. </span><span class="koboSpan" id="kobo.551.3">In addition to that, it can also act as a server at the same time! </span><span class="koboSpan" id="kobo.551.4">Nuxt uses the Nitro server engine (</span><a href="https://nuxt.com/docs/guide/directory-structure/server"><span class="koboSpan" id="kobo.552.1">https://nuxt.com/docs/guide/directory-structure/server</span></a><span class="koboSpan" id="kobo.553.1">) to process requests on scripts in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.554.1">./server</span></strong><span class="koboSpan" id="kobo.555.1"> folder. </span><span class="koboSpan" id="kobo.555.2">It also supports file-based routing and parameters, similar to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.556.1">./</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.557.1">pages</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.558.1"> folder.</span></span></p>
<p><span class="koboSpan" id="kobo.559.1">To server our quizzes as part of a RESTful API, we’ll create the </span><strong class="source-inline"><span class="koboSpan" id="kobo.560.1">./server/api/quiz</span></strong><span class="koboSpan" id="kobo.561.1"> structure in our Nuxt project. </span><span class="koboSpan" id="kobo.561.2">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.562.1">quiz</span></strong><span class="koboSpan" id="kobo.563.1"> folder, we’ll create an </span><strong class="source-inline"><span class="koboSpan" id="kobo.564.1">index.ts</span></strong><span class="koboSpan" id="kobo.565.1"> file. </span><span class="koboSpan" id="kobo.565.2">This will be available on </span><strong class="source-inline"><span class="koboSpan" id="kobo.566.1">/api/quiz</span></strong><span class="koboSpan" id="kobo.567.1"> requests to the </span><span class="No-Break"><span class="koboSpan" id="kobo.568.1">Nuxt URL:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.569.1">
import type { QuizHead } from '../../types/quiz';import { useSupabaseClient } from '../../composables/supabase';
export default defineEventHandler(async (): Promise&lt;QuizHead[] | null&gt; =&gt; {
  console.log("📦 Requesting quizzes from endpoint")
  const { data, error, status } = await useSupabaseClient
    .from(`quiz`)
    .select(`id, created_at`);
  if (error &amp;&amp; status !== 406) console.error(error);
  return data
})</span></pre>
<p><span class="koboSpan" id="kobo.570.1">Nothing special is</span><a id="_idIndexMarker455"/><span class="koboSpan" id="kobo.571.1"> going on here. </span><span class="koboSpan" id="kobo.571.2">We’ve added </span><strong class="source-inline"><span class="koboSpan" id="kobo.572.1">console.log</span></strong><span class="koboSpan" id="kobo.573.1"> with a 📦 emoji, which will help us analyze the application flow once it’s been created. </span><span class="koboSpan" id="kobo.573.2">If your development server is running (a restart might be required when adding new files), you should be able to request the quiz information via this </span><span class="No-Break"><span class="koboSpan" id="kobo.574.1">URL: </span></span><a href="http://localhost:3000/api/quiz"><span class="No-Break"><span class="koboSpan" id="kobo.575.1">http://localhost:3000/api/quiz</span></span></a><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.576.1">.</span></strong></span></p>
<p><span class="koboSpan" id="kobo.577.1">If we’ve set up our endpoint correctly, we should see something like this in the browser. </span><span class="koboSpan" id="kobo.577.2">This is the contents of our quiz table in </span><span class="No-Break"><span class="koboSpan" id="kobo.578.1">JSON format:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer087">
<span class="koboSpan" id="kobo.579.1"><img alt="Figure 8.5 – Example of the quiz API server from Nuxt" src="image/B19563_08_05.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.580.1">Figure 8.5 – Example of the quiz API server from Nuxt</span></p>
<p><span class="koboSpan" id="kobo.581.1">We’ll add another entry point using the parameterized file notation. </span><span class="koboSpan" id="kobo.581.2">We’ll create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.582.1">[id].ts</span></strong><span class="koboSpan" id="kobo.583.1"> file next to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.584.1">index.ts</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.585.1">file: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.9-%5Bid%5D.ts"><span class="No-Break"><span class="koboSpan" id="kobo.586.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.9-%5Bid%5D.ts</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.587.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.588.1">We’re using </span><a id="_idIndexMarker456"/><span class="koboSpan" id="kobo.589.1">this endpoint to quickly retrieve all questions and answers and the correct answer to be used in our setup. </span><span class="koboSpan" id="kobo.589.2">Now that we’re able to retrieve quizzes and their details, we can finally build </span><a id="_idTextAnchor253"/><span class="koboSpan" id="kobo.590.1">the next part of our setup: </span><span class="No-Break"><span class="koboSpan" id="kobo.591.1">the SQS.</span></span></p>
<h2 id="_idParaDest-154"><a id="_idTextAnchor254"/><span class="koboSpan" id="kobo.592.1">Setting up a basic Node project</span></h2>
<p><span class="koboSpan" id="kobo.593.1">In this section, we</span><a id="_idIndexMarker457"/><span class="koboSpan" id="kobo.594.1"> won’t be using any Vue-related software. </span><span class="koboSpan" id="kobo.594.2">This part will depend mainly on Express (</span><a href="https://expressjs.com/"><span class="koboSpan" id="kobo.595.1">https://expressjs.com/</span></a><span class="koboSpan" id="kobo.596.1">) and Socket.io (</span><a href="https://socket.io/"><span class="koboSpan" id="kobo.597.1">https://socket.io/</span></a><span class="koboSpan" id="kobo.598.1">). </span><span class="koboSpan" id="kobo.598.2">This means we can’t rely on helpful CLI tools to create our project for us. </span><span class="koboSpan" id="kobo.598.3">Luckily, it’s not hard. </span><span class="koboSpan" id="kobo.598.4">Navigating back to the root of our project, we’ll create a new folder called </span><strong class="source-inline"><span class="koboSpan" id="kobo.599.1">./sockets</span></strong><span class="koboSpan" id="kobo.600.1">. </span><span class="koboSpan" id="kobo.600.2">Via the CLI, we’ll run the </span><strong class="source-inline"><span class="koboSpan" id="kobo.601.1">npm init</span></strong><span class="koboSpan" id="kobo.602.1"> command to define our project, where we’ll simply accept all the defaults. </span><span class="koboSpan" id="kobo.602.2">Once done, we’ll install Express and Socket.io and some TypeScript tooling packages via </span><span class="No-Break"><span class="koboSpan" id="kobo.603.1">the CLI:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.604.1">
npm install express socket.io ts-node @types/node</span></pre> <p><span class="koboSpan" id="kobo.605.1">We’ll also create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.606.1">tsconfig.json</span></strong><span class="koboSpan" id="kobo.607.1"> file in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.608.1">./sockets</span></strong><span class="koboSpan" id="kobo.609.1"> folder that contains the </span><span class="No-Break"><span class="koboSpan" id="kobo.610.1">following configuration:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.611.1">
{  "compilerOptions": {
    "target": "ES2022",
    "module": "commonjs",
    "lib": ["dom"],
    "allowJs": true,
    "outDir": "build",
    "rootDir": "./",
    "strict": true,
    "noImplicitAny": true,
    "esModuleInterop": true,
    "resolveJsonModule": true
  }
}</span></pre>
<p><span class="koboSpan" id="kobo.612.1">For the game mechanics, I’ve provided a </span><strong class="source-inline"><span class="koboSpan" id="kobo.613.1">Quiz</span></strong><span class="koboSpan" id="kobo.614.1"> class that we can implement without going into any details. </span><span class="koboSpan" id="kobo.614.2">Create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.615.1">quiz.ts</span></strong><span class="koboSpan" id="kobo.616.1"> file with the following </span><span class="No-Break"><span class="koboSpan" id="kobo.617.1">contents: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.10-quiz.ts"><span class="No-Break"><span class="koboSpan" id="kobo.618.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.10-quiz.ts</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.619.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.620.1">Next, we can work </span><a id="_idIndexMarker458"/><span class="koboSpan" id="kobo.621.1">on the socket connection. </span><span class="koboSpan" id="kobo.621.2">We’ll create an </span><strong class="source-inline"><span class="koboSpan" id="kobo.622.1">index.ts</span></strong><span class="koboSpan" id="kobo.623.1"> file in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.624.1">./sockets</span></strong><span class="koboSpan" id="kobo.625.1"> folder with the </span><span class="No-Break"><span class="koboSpan" id="kobo.626.1">following contents:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.627.1">
const express = require("express");const { createServer } = require("node:http");
const { Server } = require("socket.io");
</span><strong class="bold"><span class="koboSpan" id="kobo.628.1">import QuizGame from "./quiz";</span></strong><span class="koboSpan" id="kobo.629.1">
const app = express();
const server = createServer(app);
// This needs to match the client url of the running app instance
</span><strong class="bold"><span class="koboSpan" id="kobo.630.1">const clientAppUrl = "http://localhost:5173";</span></strong><span class="koboSpan" id="kobo.631.1">
let serverOptions = {};
if (process.env.NODE_ENV !== "production") {
  serverOptions = {
    ...serverOptions,
      cors: {
</span><strong class="bold"><span class="koboSpan" id="kobo.632.1">        origin: clientAppUrl, // cors is enabled for socketed connections on localhost:5173</span></strong><span class="koboSpan" id="kobo.633.1">
      },
    }
}
</span><strong class="bold"><span class="koboSpan" id="kobo.634.1">const io = new Server(server, serverOptions);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.635.1">const game = new QuizGame();</span></strong><span class="koboSpan" id="kobo.636.1">
// ******************************
// Listen on the port for events
// ******************************
server.listen(4000, () =&gt; {
  console.log("🔌 Server is running on port 4000");
});</span></pre>
<p><span class="koboSpan" id="kobo.637.1">This code</span><a id="_idIndexMarker459"/><span class="koboSpan" id="kobo.638.1"> scaffolds a blank server. </span><span class="koboSpan" id="kobo.638.2">As you can see, we’ve imported the </span><strong class="source-inline"><span class="koboSpan" id="kobo.639.1">Quiz</span></strong><span class="koboSpan" id="kobo.640.1"> class and used it to instantiate a game on the server. </span><strong class="source-inline"><span class="koboSpan" id="kobo.641.1">clientAppUrl</span></strong><span class="koboSpan" id="kobo.642.1"> is important: when using sockets, the </span><strong class="bold"><span class="koboSpan" id="kobo.643.1">Cross-Origin Resource Sharing</span></strong><span class="koboSpan" id="kobo.644.1"> (</span><strong class="bold"><span class="koboSpan" id="kobo.645.1">CORS</span></strong><span class="koboSpan" id="kobo.646.1">; </span><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS"><span class="koboSpan" id="kobo.647.1">https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS</span></a><span class="koboSpan" id="kobo.648.1">) policy will block incoming traffic coming from localhost, unless its origins are provided to </span><span class="No-Break"><span class="koboSpan" id="kobo.649.1">the server.</span></span></p>
<p><span class="koboSpan" id="kobo.650.1">We do have another problem now, though: the </span><strong class="source-inline"><span class="koboSpan" id="kobo.651.1">Quiz</span></strong><span class="koboSpan" id="kobo.652.1"> class expects data that comes from our Nuxt server, remember? </span><span class="koboSpan" id="kobo.652.2">We need to have the Nuxt server running in tandem with the SQS. </span><span class="koboSpan" id="kobo.652.3">We can do this manually, in separate terminal windows, but we can also script the boot process for more convenience. </span><span class="koboSpan" id="kobo.652.4">After all, once our work on the SQS is done, we need to be able </span><a id="_idTextAnchor255"/><span class="koboSpan" id="kobo.653.1">to run another app to act as </span><span class="No-Break"><span class="koboSpan" id="kobo.654.1">a client!</span></span></p>
<h2 id="_idParaDest-155"><a id="_idTextAnchor256"/><span class="koboSpan" id="kobo.655.1">Executing scripts in parallel</span></h2>
<p><span class="koboSpan" id="kobo.656.1">In this section, we’ll </span><a id="_idIndexMarker460"/><span class="koboSpan" id="kobo.657.1">focus on the root folder of our project, from where we’ll trigger the scripts in sub-folders. </span><span class="koboSpan" id="kobo.657.2">We’ll navigate to the root with the terminal and set up another Node project using </span><strong class="source-inline"><span class="koboSpan" id="kobo.658.1">npm init</span></strong><span class="koboSpan" id="kobo.659.1">, accepting the defaults. </span><span class="koboSpan" id="kobo.659.2">Once we’re done, we’ll install some </span><span class="No-Break"><span class="koboSpan" id="kobo.660.1">helper packages:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.661.1">
npm install nodemon npm-run-all ts-node @types/node open chalk</span></pre> <p><span class="koboSpan" id="kobo.662.1">We’ll also create a file called </span><strong class="source-inline"><span class="koboSpan" id="kobo.663.1">open.mjs</span></strong><span class="koboSpan" id="kobo.664.1"> with the </span><span class="No-Break"><span class="koboSpan" id="kobo.665.1">following contents:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.666.1">
import chalk from 'chalk';import open from 'open';
const urls = [{
    name: '📦 Quiz Admin Panel',
    url: 'http://localhost:3000',
}]
urls.forEach(url =&gt; {
    setTimeout(async (): void =&gt; {
        console.log(`✨ Opening ${chalk.black.bgCyan(url.name)} at ${chalk.magenta(url.url)}`);
        await open(url.url);
    }, url.wait || 0);
});</span></pre>
<p><span class="koboSpan" id="kobo.667.1">In this file, we’re </span><a id="_idIndexMarker461"/><span class="koboSpan" id="kobo.668.1">using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.669.1">open</span></strong><span class="koboSpan" id="kobo.670.1"> package to automatically open a browser window. </span><span class="koboSpan" id="kobo.670.2">To make the status more recognizable in the console, we use </span><strong class="source-inline"><span class="koboSpan" id="kobo.671.1">chalk</span></strong><span class="koboSpan" id="kobo.672.1"> to add color to certain parts of the logs. </span><span class="koboSpan" id="kobo.672.2">Now, when we open </span><strong class="source-inline"><span class="koboSpan" id="kobo.673.1">package.json</span></strong><span class="koboSpan" id="kobo.674.1">, we can change the </span><strong class="source-inline"><span class="koboSpan" id="kobo.675.1">scripts</span></strong><span class="koboSpan" id="kobo.676.1"> property so that it matches the </span><span class="No-Break"><span class="koboSpan" id="kobo.677.1">following sample:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.678.1">
  "scripts": {    "dev": "npm-run-all --parallel dev:*",
    "dev:sockets": "nodemon ./sockets/index.ts",
    "dev:server": "cd server &amp;&amp; npm run dev",
    "dev:open": "node ./open.mjs"
  },</span></pre>
<p><span class="koboSpan" id="kobo.679.1">So, what’s happening here? </span><span class="koboSpan" id="kobo.679.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.680.1">npm-run-all</span></strong><span class="koboSpan" id="kobo.681.1"> command triggers multiple commands in parallel mode – in our case, all scripts that are prefixed </span><span class="No-Break"><span class="koboSpan" id="kobo.682.1">with </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.683.1">dev</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.684.1">:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.685.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.686.1">dev:sockets</span></strong><span class="koboSpan" id="kobo.687.1"> script uses </span><strong class="source-inline"><span class="koboSpan" id="kobo.688.1">nodemon</span></strong><span class="koboSpan" id="kobo.689.1"> to run and watch for file changes in our socket </span><span class="No-Break"><span class="koboSpan" id="kobo.690.1">project folder</span></span></li>
<li><span class="koboSpan" id="kobo.691.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.692.1">dev:server</span></strong><span class="koboSpan" id="kobo.693.1"> script opens the Nuxt server from </span><span class="No-Break"><span class="koboSpan" id="kobo.694.1">its folder</span></span></li>
<li><span class="koboSpan" id="kobo.695.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.696.1">dev:open</span></strong><span class="koboSpan" id="kobo.697.1"> script executes the </span><strong class="source-inline"><span class="koboSpan" id="kobo.698.1">open.mjs</span></strong><span class="koboSpan" id="kobo.699.1"> script, which, in turn, opens a browser window on the predefined URL for </span><span class="No-Break"><span class="koboSpan" id="kobo.700.1">the SQA</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.701.1">If you don’t want the SQA to open every time you start the script, you could remove the </span><strong class="source-inline"><span class="koboSpan" id="kobo.702.1">dev:open</span></strong><span class="koboSpan" id="kobo.703.1"> script or remove the entry from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.704.1">urls</span></strong><span class="koboSpan" id="kobo.705.1"> constant in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.706.1">open.mjs</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.707.1"> file.</span></span></p>
<p><span class="koboSpan" id="kobo.708.1">At least we can now control the execution of multiple scripts with a single command. </span><span class="koboSpan" id="kobo.708.2">If we run </span><strong class="source-inline"><span class="koboSpan" id="kobo.709.1">npm run dev</span></strong><span class="koboSpan" id="kobo.710.1"> from the root of the project, it will automatically start the Nuxt server as well as </span><span class="No-Break"><span class="koboSpan" id="kobo.711.1">the SQS!</span></span></p>
<p><span class="koboSpan" id="kobo.712.1">Let’s take a </span><a id="_idIndexMarker462"/><span class="koboSpan" id="kobo.713.1">step back and explain why a regular endpoint is not sufficient, as well as why we’re building a complete socket server as a lay</span><a id="_idTextAnchor257"/><span class="koboSpan" id="kobo.714.1">er between the server and </span><span class="No-Break"><span class="koboSpan" id="kobo.715.1">the client(s).</span></span></p>
<h2 id="_idParaDest-156"><a id="_idTextAnchor258"/><span class="koboSpan" id="kobo.716.1">Why sockets?</span></h2>
<p><span class="koboSpan" id="kobo.717.1">We’re </span><a id="_idIndexMarker463"/><span class="koboSpan" id="kobo.718.1">using a socket server to act as the host of our quiz app. </span><span class="koboSpan" id="kobo.718.2">Sockets have the </span><a id="_idIndexMarker464"/><span class="koboSpan" id="kobo.719.1">advantage over RESTful connections in that data transmission is bidirectional by default and a socket connection is stateful and persistent. </span><span class="koboSpan" id="kobo.719.2">This makes sockets ideal for applications that depend on instant updates, such as chat applications or, as in our case, online games (especially those that support collaboration </span><span class="No-Break"><span class="koboSpan" id="kobo.720.1">or competition).</span></span></p>
<p><span class="koboSpan" id="kobo.721.1">We’re starting a socket server where clients can connect to. </span><span class="koboSpan" id="kobo.721.2">A handshake takes place between the server and client on connecting, which establishes the agreements and protocol between the two. </span><span class="koboSpan" id="kobo.721.3">This handshake allows the server to identify the client, which is useful when we’re dealing with multiple clients but want to </span><span class="No-Break"><span class="koboSpan" id="kobo.722.1">target individuals.</span></span></p>
<p><span class="koboSpan" id="kobo.723.1">Once the connection has been established, both the client and server can send events with context. </span><span class="koboSpan" id="kobo.723.2">The server can broadcast to all clients or an individual. </span><span class="koboSpan" id="kobo.723.3">The clients only send events to the server. </span><span class="koboSpan" id="kobo.723.4">Depending on the event and the context, we can process </span><span class="No-Break"><span class="koboSpan" id="kobo.724.1">the event.</span></span></p>
<p><span class="koboSpan" id="kobo.725.1">Using Sockets.io, we can broadcast events using </span><strong class="source-inline"><span class="koboSpan" id="kobo.726.1">io.emit('event', context)</span></strong><span class="koboSpan" id="kobo.727.1"> and listen to events </span><span class="No-Break"><span class="koboSpan" id="kobo.728.1">using </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.729.1">io.on('event')</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.730.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.731.1">In our application, we’re going to see both methods in action on both the server and the client: the server handles the information being sent to clients and receives answers given by a client – we’ll even use it to control the navigational state of the client app! </span><span class="koboSpan" id="kobo.731.2">From the client’s side, we’ll listen to the sent events and use the sock</span><a id="_idTextAnchor259"/><span class="koboSpan" id="kobo.732.1">ets to send answers to our </span><span class="No-Break"><span class="koboSpan" id="kobo.733.1">quiz’s answers.</span></span></p>
<h2 id="_idParaDest-157"><a id="_idTextAnchor260"/><span class="koboSpan" id="kobo.734.1">Completing the SQS</span></h2>
<p><span class="koboSpan" id="kobo.735.1">We can finalize the </span><a id="_idIndexMarker465"/><span class="koboSpan" id="kobo.736.1">SQS by replacing the contents of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.737.1">./index.ts</span></strong><span class="koboSpan" id="kobo.738.1"> file in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.739.1">./sockets</span></strong><span class="koboSpan" id="kobo.740.1"> folder with the </span><span class="No-Break"><span class="koboSpan" id="kobo.741.1">following: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.11-index.ts"><span class="No-Break"><span class="koboSpan" id="kobo.742.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.11-index.ts</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.743.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.744.1">We’ve added the mechanics for communication now. </span><span class="koboSpan" id="kobo.744.2">The socket server gets initialized on </span><em class="italic"><span class="koboSpan" id="kobo.745.1">lines 27–76</span></em><span class="koboSpan" id="kobo.746.1">. </span><span class="koboSpan" id="kobo.746.2">In the socket connection event, we have defined all the events the server needs to </span><span class="No-Break"><span class="koboSpan" id="kobo.747.1">listen to:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.748.1">When a player has joined (</span><em class="italic"><span class="koboSpan" id="kobo.749.1">line 17</span></em><span class="koboSpan" id="kobo.750.1">), the server signals other players with the current status (</span><em class="italic"><span class="koboSpan" id="kobo.751.1">lines 32, </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.752.1">130 –133</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.753.1">)</span></span></li>
<li><span class="koboSpan" id="kobo.754.1">When a player is ready to start playing (</span><em class="italic"><span class="koboSpan" id="kobo.755.1">lines 37–41</span></em><span class="koboSpan" id="kobo.756.1">), a player is added to the current game (</span><em class="italic"><span class="koboSpan" id="kobo.757.1">line 38</span></em><span class="koboSpan" id="kobo.758.1">), and the other players </span><span class="No-Break"><span class="koboSpan" id="kobo.759.1">are notified</span></span></li>
<li><span class="koboSpan" id="kobo.760.1">If a player answers a question during a game (</span><em class="italic"><span class="koboSpan" id="kobo.761.1">lines 43–50</span></em><span class="koboSpan" id="kobo.762.1">), the answer is processed and, if needed, the player’s score </span><span class="No-Break"><span class="koboSpan" id="kobo.763.1">is updated</span></span></li>
<li><span class="koboSpan" id="kobo.764.1">When a player selects a quiz (</span><em class="italic"><span class="koboSpan" id="kobo.765.1">lines 55–60</span></em><span class="koboSpan" id="kobo.766.1">), the server queries the Nuxt server for the questions and updates it to the current game (</span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.767.1">line 59</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.768.1">)</span></span></li>
<li><span class="koboSpan" id="kobo.769.1">When the quiz is started (</span><em class="italic"><span class="koboSpan" id="kobo.770.1">lines 62–66</span></em><span class="koboSpan" id="kobo.771.1">), the current question is set to the first of the collection and the question is sent to the player (</span><em class="italic"><span class="koboSpan" id="kobo.772.1">lines 65,  </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.773.1">82–88</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.774.1">)</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.775.1">We have some options to send players to </span><span class="No-Break"><span class="koboSpan" id="kobo.776.1">certain views:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.777.1">There’s a method to send a question to the players (</span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.778.1">lines 82–88</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.779.1">)</span></span></li>
<li><span class="koboSpan" id="kobo.780.1">In between every third question, we can show the current score (</span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.781.1">lines 114–118</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.782.1">)</span></span></li>
<li><span class="koboSpan" id="kobo.783.1">Once the quiz has ended, we direct players to the final score (</span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.784.1">lines 120–125</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.785.1">)</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.786.1">As part of the game mechanics, answering the questions is time-based. </span><span class="koboSpan" id="kobo.786.2">The timer runs internally as part of the game, but we emit events once a timer has started (</span><em class="italic"><span class="koboSpan" id="kobo.787.1">lines 138–145</span></em><span class="koboSpan" id="kobo.788.1">) or when it has ended (</span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.789.1">lines 147–150</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.790.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.791.1">With all of this, we </span><a id="_idIndexMarker466"/><span class="koboSpan" id="kobo.792.1">have the basic needs for an interactive quiz. </span><span class="koboSpan" id="kobo.792.2">It’s not very robust, mind you, but it functions well enough to get our </span><span class="No-Break"><span class="koboSpan" id="kobo.793.1">point across.</span></span></p>
<p><span class="koboSpan" id="kobo.794.1">In the final section, we’re going to create an app to co</span><a id="_idTextAnchor261"/><span class="koboSpan" id="kobo.795.1">mplete this whole quiz </span><span class="No-Break"><span class="koboSpan" id="kobo.796.1">application platform!</span></span></p>
<h1 id="_idParaDest-158"><a id="_idTextAnchor262"/><span class="koboSpan" id="kobo.797.1">Creating the CQA</span></h1>
<p><span class="koboSpan" id="kobo.798.1">To wrap it all up, we’re </span><a id="_idIndexMarker467"/><span class="koboSpan" id="kobo.799.1">going to</span><a id="_idIndexMarker468"/><span class="koboSpan" id="kobo.800.1"> create the client app as a Vuetify project in our projects’ root folder. </span><span class="koboSpan" id="kobo.800.2">Let’s navigate to the root folder by using the terminal and typing </span><strong class="source-inline"><span class="koboSpan" id="kobo.801.1">npm create vuetify</span></strong><span class="koboSpan" id="kobo.802.1"> to begin the installation. </span><span class="koboSpan" id="kobo.802.2">We’ll use the </span><span class="No-Break"><span class="koboSpan" id="kobo.803.1">following settings:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.804.1">app</span></strong><span class="koboSpan" id="kobo.805.1"> as the </span><span class="No-Break"><span class="koboSpan" id="kobo.806.1">project’s name</span></span></li>
<li><span class="koboSpan" id="kobo.807.1">For the preset, we’ll choose the default of </span><strong class="source-inline"><span class="koboSpan" id="kobo.808.1">Base (</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.809.1">Vuetify, VueRouter)</span></strong></span></li>
<li><span class="koboSpan" id="kobo.810.1">We’ll </span><span class="No-Break"><span class="koboSpan" id="kobo.811.1">select TypeScript</span></span></li>
<li><span class="koboSpan" id="kobo.812.1">To install dependencies, we’ll </span><span class="No-Break"><span class="koboSpan" id="kobo.813.1">select </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.814.1">npm</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.815.1">Once the installation completes, we can open the folder in our IDE to </span><span class="No-Break"><span class="koboSpan" id="kobo.816.1">start editing.</span></span></p>
<p><span class="koboSpan" id="kobo.817.1">First, we’ll make some changes to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.818.1">vite.config.ts</span></strong><span class="koboSpan" id="kobo.819.1"> file, which helps our app to work in our multi-app environment. </span><span class="koboSpan" id="kobo.819.2">We’ll add a new property called </span><strong class="source-inline"><span class="koboSpan" id="kobo.820.1">clearScreen</span></strong><span class="koboSpan" id="kobo.821.1"> with a value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.822.1">false</span></strong><span class="koboSpan" id="kobo.823.1">. </span><span class="koboSpan" id="kobo.823.2">This will prevent the process from clearing the logs (which will also contain our servers’ logs). </span><span class="koboSpan" id="kobo.823.3">We can simply add it at the bottom of </span><span class="No-Break"><span class="koboSpan" id="kobo.824.1">the file.</span></span></p>
<p><span class="koboSpan" id="kobo.825.1">Next, we’ll locate the </span><strong class="source-inline"><span class="koboSpan" id="kobo.826.1">server</span></strong><span class="koboSpan" id="kobo.827.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.828.1">port</span></strong><span class="koboSpan" id="kobo.829.1"> properties and change </span><strong class="source-inline"><span class="koboSpan" id="kobo.830.1">port</span></strong><span class="koboSpan" id="kobo.831.1"> to the new value – that is, </span><strong class="source-inline"><span class="koboSpan" id="kobo.832.1">5173</span></strong><span class="koboSpan" id="kobo.833.1"> (this corresponds to the CORS setting of our socket server). </span><span class="koboSpan" id="kobo.833.2">This prevents the Vuetify application from trying to occupy the same port as our Nuxt application! </span><span class="koboSpan" id="kobo.833.3">The</span><a id="_idIndexMarker469"/><span class="koboSpan" id="kobo.834.1"> bottom of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.835.1">vite.config.ts</span></strong><span class="koboSpan" id="kobo.836.1"> file </span><a id="_idIndexMarker470"/><span class="koboSpan" id="kobo.837.1">should resemble the </span><span class="No-Break"><span class="koboSpan" id="kobo.838.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.839.1">
// ...abbreviatedexport default defineConfig({
  plugins: [
    // ...abbreviated
  define: { 'process.env': {} },
  resolve: {
    // ...abbreviated
  },
  server: {
    port: </span><strong class="bold"><span class="koboSpan" id="kobo.840.1">5173</span></strong><span class="koboSpan" id="kobo.841.1">,
  },
  </span><strong class="bold"><span class="koboSpan" id="kobo.842.1">clearScreen: false,</span></strong><span class="koboSpan" id="kobo.843.1">
})</span></pre>
<p><span class="koboSpan" id="kobo.844.1">Before we continue</span><a id="_idIndexMarker471"/><span class="koboSpan" id="kobo.845.1"> working on the app, we will add our client app</span><a id="_idIndexMarker472"/><span class="koboSpan" id="kobo.846.1"> to our main development script. </span><span class="koboSpan" id="kobo.846.2">Let’s open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.847.1">package.json</span></strong><span class="koboSpan" id="kobo.848.1"> file from our project’s root and add a script to run our Vuetify </span><span class="No-Break"><span class="koboSpan" id="kobo.849.1">development script:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.850.1">
  "scripts": {    "dev": "npm-run-all --parallel dev:*",
    </span><strong class="bold"><span class="koboSpan" id="kobo.851.1">"dev:client": "cd app &amp;&amp; npm run dev",</span></strong><span class="koboSpan" id="kobo.852.1">
    "dev:sockets": "nodemon ./sockets/index.ts",
    "dev:server": "cd server &amp;&amp; npm run dev",
    "dev:open": "node ./open.mjs"
  },</span></pre>
<p><span class="koboSpan" id="kobo.853.1">Regarding the </span><strong class="source-inline"><span class="koboSpan" id="kobo.854.1">open.mjs</span></strong><span class="koboSpan" id="kobo.855.1"> file, we will add a URL that will automatically open the browser as well. </span><span class="koboSpan" id="kobo.855.2">We’ll </span><a id="_idIndexMarker473"/><span class="koboSpan" id="kobo.856.1">give it a timeout of </span><strong class="source-inline"><span class="koboSpan" id="kobo.857.1">5000</span></strong><span class="koboSpan" id="kobo.858.1"> milliseconds because it needs to wait for Nuxt and the socket server to have </span><span class="No-Break"><span class="koboSpan" id="kobo.859.1">been initialized:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.860.1">
const urls = [  {
    name: "📦 Quiz Admin Panel",
    url: "http://localhost:3000",
  },
</span><strong class="bold"><span class="koboSpan" id="kobo.861.1">  {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.862.1">    name: "</span></strong><span class="koboSpan" id="kobo.863.1">📱</span><strong class="bold"><span class="koboSpan" id="kobo.864.1"> Quiz App",</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.865.1">    url: "http://localhost:5173",</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.866.1">    wait: 5000,</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.867.1">  },</span></strong><span class="koboSpan" id="kobo.868.1">
];</span></pre>
<p><span class="koboSpan" id="kobo.869.1">Now, we can boot</span><a id="_idIndexMarker474"/><span class="koboSpan" id="kobo.870.1"> the app from the projects’ root by using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.871.1">npm run dev:client</span></strong><span class="koboSpan" id="kobo.872.1"> command. </span><span class="koboSpan" id="kobo.872.2">We can also start up all of our scripts at once using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.873.1">npm run dev</span></strong><span class="koboSpan" id="kobo.874.1"> command from the root of the project. </span><span class="koboSpan" id="kobo.874.2">This is very handy when </span><a id="_idIndexMarker475"/><span class="koboSpan" id="kobo.875.1">working on features of the app since the app by itself i</span><a id="_idTextAnchor263"/><span class="koboSpan" id="kobo.876.1">s very reliant on the other </span><span class="No-Break"><span class="koboSpan" id="kobo.877.1">entities running.</span></span></p>
<h2 id="_idParaDest-159"><a id="_idTextAnchor264"/><span class="koboSpan" id="kobo.878.1">Setting up the app</span></h2>
<p><span class="koboSpan" id="kobo.879.1">We’ll begin by</span><a id="_idIndexMarker476"/><span class="koboSpan" id="kobo.880.1"> setting up the routes and views for our app. </span><span class="koboSpan" id="kobo.880.2">We’ll move back to our app folder to make some changes to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.881.1">./src/router/index.ts</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.882.1">file: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.12-index.ts"><span class="No-Break"><span class="koboSpan" id="kobo.883.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.12-index.ts</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.884.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.885.1">Now, for all those routes, we’ll add a separate view Vue component in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.886.1">./src/views</span></strong><span class="koboSpan" id="kobo.887.1"> folder. </span><span class="koboSpan" id="kobo.887.2">We’ll use the following template as a basis (replace the title in the template with a</span><a id="_idIndexMarker477"/><span class="koboSpan" id="kobo.888.1"> corresponding one for </span><span class="No-Break"><span class="koboSpan" id="kobo.889.1">that view):</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.890.1">
&lt;template&gt;  &lt;div class="my-8"&gt;
    &lt;h1 class="text-h3 mb-8"&gt;</span><strong class="bold"><span class="koboSpan" id="kobo.891.1">Home</span></strong><span class="koboSpan" id="kobo.892.1">&lt;/h1&gt;
  &lt;/div&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.893.1">In the end, you’ll end up with the </span><span class="No-Break"><span class="koboSpan" id="kobo.894.1">following views:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer088">
<span class="koboSpan" id="kobo.895.1"><img alt="Figure 8.6 – Newly created views to match our routes" src="image/B19563_08_06.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.896.1">Figure 8.6 – Newly created views to match our routes</span></p>
<p><span class="koboSpan" id="kobo.897.1">We’ll also </span><a id="_idIndexMarker478"/><span class="koboSpan" id="kobo.898.1">simplify the layout by replacing the contents of </span><strong class="source-inline"><span class="koboSpan" id="kobo.899.1">./src/layouts/default.vue</span></strong><span class="koboSpan" id="kobo.900.1"> with </span><span class="No-Break"><span class="koboSpan" id="kobo.901.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.902.1">
&lt;template&gt;  &lt;v-layout&gt;
    &lt;v-app-bar class="bg-primary pa-4"
      &gt;&lt;h1 class="text-h5"&gt;Quiz time!&lt;/h1&gt;
    &lt;/v-app-bar&gt;
    &lt;v-main&gt;
      &lt;RouterView /&gt;
    &lt;/v-main&gt;
  &lt;/v-layout&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.903.1">We can </span><a id="_idIndexMarker479"/><span class="koboSpan" id="kobo.904.1">delete the </span><strong class="source-inline"><span class="koboSpan" id="kobo.905.1">AppBar.vue</span></strong><span class="koboSpan" id="kobo.906.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.907.1">View.vue</span></strong><span class="koboSpan" id="kobo.908.1"> files from the folder </span><span class="No-Break"><span class="koboSpan" id="kobo.909.1">as well.</span></span></p>
<p><span class="koboSpan" id="kobo.910.1">In the next </span><a id="_idTextAnchor265"/><span class="koboSpan" id="kobo.911.1">step, we’ll work on adding a connection to </span><span class="No-Break"><span class="koboSpan" id="kobo.912.1">our server.</span></span></p>
<h2 id="_idParaDest-160"><a id="_idTextAnchor266"/><span class="koboSpan" id="kobo.913.1">Adding the socket client</span></h2>
<p><span class="koboSpan" id="kobo.914.1">At this </span><a id="_idIndexMarker480"/><span class="koboSpan" id="kobo.915.1">point, it’s time to add the socket client to our app project. </span><span class="koboSpan" id="kobo.915.2">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.916.1">./app</span></strong><span class="koboSpan" id="kobo.917.1"> root folder, install the package by typing the </span><span class="No-Break"><span class="koboSpan" id="kobo.918.1">following command:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.919.1">
npm install socket.io-client</span></pre> <p><span class="koboSpan" id="kobo.920.1">To use Socket.io in our app, we’ll create a file called </span><strong class="source-inline"><span class="koboSpan" id="kobo.921.1">sockets.ts</span></strong><span class="koboSpan" id="kobo.922.1"> in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.923.1">./src</span></strong><span class="koboSpan" id="kobo.924.1"> folder with the following </span><span class="No-Break"><span class="koboSpan" id="kobo.925.1">contents: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.13-sockets.ts"><span class="No-Break"><span class="koboSpan" id="kobo.926.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.13-sockets.ts</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.927.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.928.1">This file will handle the connection from the socket server and export the connection as a constant (</span><em class="italic"><span class="koboSpan" id="kobo.929.1">line 6</span></em><span class="koboSpan" id="kobo.930.1">). </span><span class="koboSpan" id="kobo.930.2">In this file, we’ll also store and expose the data we’re</span><a id="_idIndexMarker481"/><span class="koboSpan" id="kobo.931.1"> receiving in a single object (</span><em class="italic"><span class="koboSpan" id="kobo.932.1">lines 18–29</span></em><span class="koboSpan" id="kobo.933.1">). </span><span class="koboSpan" id="kobo.933.2">Since the object has multiple levels, we’ll use </span><strong class="source-inline"><span class="koboSpan" id="kobo.934.1">reactive</span></strong><span class="koboSpan" id="kobo.935.1"> over </span><strong class="source-inline"><span class="koboSpan" id="kobo.936.1">ref</span></strong><span class="koboSpan" id="kobo.937.1"> because of its deep reactive model (</span><a href="https://vuejs.org/api/reactivity-core.html#reactive"><span class="koboSpan" id="kobo.938.1">https://vuejs.org/api/reactivity-core.html#reactive</span></a><span class="koboSpan" id="kobo.939.1">). </span><span class="koboSpan" id="kobo.939.2">This </span><strong class="source-inline"><span class="koboSpan" id="kobo.940.1">state</span></strong><span class="koboSpan" id="kobo.941.1"> will propagate any </span><a id="_idTextAnchor267"/><span class="koboSpan" id="kobo.942.1">changes it receives wherever it’s being used in </span><span class="No-Break"><span class="koboSpan" id="kobo.943.1">our app.</span></span></p>
<h2 id="_idParaDest-161"><a id="_idTextAnchor268"/><span class="koboSpan" id="kobo.944.1">Listening to socket events</span></h2>
<p><span class="koboSpan" id="kobo.945.1">Now, let’s </span><a id="_idIndexMarker482"/><span class="koboSpan" id="kobo.946.1">create a feature where we can start to open a quiz. </span><span class="koboSpan" id="kobo.946.2">We expect users to enter the app via a link that contains the ID of a quiz. </span><span class="koboSpan" id="kobo.946.3">For that, we’ll update the </span><strong class="source-inline"><span class="koboSpan" id="kobo.947.1">./src/views/Start.vue</span></strong><span class="koboSpan" id="kobo.948.1"> file and completely replace its contents with </span><span class="No-Break"><span class="koboSpan" id="kobo.949.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.950.1">
&lt;script setup lang="ts"&gt;import { onMounted } from 'vue';
import { useRoute, useRouter } from 'vue-router';
import { socket } from "@/socket";
const route = useRoute();
const router = useRouter();
const init = (id: string): void =&gt; {
  </span><strong class="bold"><span class="koboSpan" id="kobo.951.1">socket.emit('quiz:select', id);</span></strong><span class="koboSpan" id="kobo.952.1">
}
onMounted(() =&gt; {
  const id : string | string[] = route.params.id;
  if (id) {
    init(id.toString());
    router.push('/lobby');
  }
});
&lt;/script&gt;</span></pre>
<p><span class="koboSpan" id="kobo.953.1">As you can see, we </span><a id="_idIndexMarker483"/><span class="koboSpan" id="kobo.954.1">don’t even need any template here! </span><span class="koboSpan" id="kobo.954.2">The component grabs the </span><strong class="source-inline"><span class="koboSpan" id="kobo.955.1">id</span></strong><span class="koboSpan" id="kobo.956.1"> value from the router parameters. </span><span class="koboSpan" id="kobo.956.2">The code uses the socket to emit the </span><strong class="source-inline"><span class="koboSpan" id="kobo.957.1">quiz:sel</span><a id="_idTextAnchor269"/><span class="koboSpan" id="kobo.958.1">ect</span></strong><span class="koboSpan" id="kobo.959.1"> event and then redirects the user to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.960.1">/</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.961.1">lobby</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.962.1"> route.</span></span></p>
<h2 id="_idParaDest-162"><a id="_idTextAnchor270"/><span class="koboSpan" id="kobo.963.1">Automated route changes</span></h2>
<p><span class="koboSpan" id="kobo.964.1">Before we </span><a id="_idIndexMarker484"/><span class="koboSpan" id="kobo.965.1">continue to the lobby, we’ll modify the </span><strong class="source-inline"><span class="koboSpan" id="kobo.966.1">./src/App.vue</span></strong><span class="koboSpan" id="kobo.967.1"> file too so that it listens to specific state changes in the quiz and redirects to </span><span class="No-Break"><span class="koboSpan" id="kobo.968.1">certain routes:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.969.1">
&lt;template&gt;  &lt;router-view /&gt;
&lt;/template&gt;
&lt;script setup lang="ts"&gt;
import { computed, watch } from 'vue'
import { RouterView, useRouter } from 'vue-router'
import { state } from '@/socket'
const router = useRouter()
</span><strong class="bold"><span class="koboSpan" id="kobo.970.1">const quizStatus = computed((): string | null =&gt; state.quizStatus)</span></strong><span class="koboSpan" id="kobo.971.1">
// when quizStatus changes, check if it's "ready" and if so, redirect to /quiz
</span><strong class="bold"><span class="koboSpan" id="kobo.972.1">watch(quizStatus, (newStatus) =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.973.1">  if (newStatus === 'question') {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.974.1">    router.push('/question')</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.975.1">  }</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.976.1">  if (newStatus === 'answer') {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.977.1">    router.push('/answer')</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.978.1">  }</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.979.1">  if (newStatus === 'end') {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.980.1">    router.push('/final')</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.981.1">  }</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.982.1">  if (newStatus === 'scoreboard') {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.983.1">    router.push('/scoreboard')</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.984.1">  }</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.985.1">})</span></strong><span class="koboSpan" id="kobo.986.1">
&lt;/script&gt;</span></pre>
<p><span class="koboSpan" id="kobo.987.1">Here, we’re</span><a id="_idIndexMarker485"/><span class="koboSpan" id="kobo.988.1"> importing </span><strong class="source-inline"><span class="koboSpan" id="kobo.989.1">quizStatus</span></strong><span class="koboSpan" id="kobo.990.1"> and watching for changes. </span><span class="koboSpan" id="kobo.990.2">Once an updated value matches one of our routes, we’ll programmatically update the rou</span><a id="_idTextAnchor271"/><span class="koboSpan" id="kobo.991.1">ter with the corresponding view. </span><span class="koboSpan" id="kobo.991.2">Now, let’s enter </span><span class="No-Break"><span class="koboSpan" id="kobo.992.1">the lobby!</span></span></p>
<h2 id="_idParaDest-163"><a id="_idTextAnchor272"/><span class="koboSpan" id="kobo.993.1">Player management in the lobby</span></h2>
<p><span class="koboSpan" id="kobo.994.1">In the lobby, we </span><a id="_idIndexMarker486"/><span class="koboSpan" id="kobo.995.1">want to be able to add ourselves as a player, but we also want to see an overview of all currently connected players. </span><span class="koboSpan" id="kobo.995.2">To add a player, we’ll create a new component in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.996.1">./src/components</span></strong><span class="koboSpan" id="kobo.997.1"> folder called </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.998.1">PlayerAdd.vue</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.999.1">: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.14-PlayerAdd.vue"><span class="No-Break"><span class="koboSpan" id="kobo.1000.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.14-PlayerAdd.vue</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.1001.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1002.1">In this case, we</span><a id="_idIndexMarker487"/><span class="koboSpan" id="kobo.1003.1"> will use the socket connection to emit events (</span><em class="italic"><span class="koboSpan" id="kobo.1004.1">lines 9–11, 25 –27</span></em><span class="koboSpan" id="kobo.1005.1">) but we also read from the state to, for instance, only allow a player to </span><span class="No-Break"><span class="koboSpan" id="kobo.1006.1">connect once.</span></span></p>
<p><span class="koboSpan" id="kobo.1007.1">Our next component in the folder, called </span><strong class="source-inline"><span class="koboSpan" id="kobo.1008.1">PlayersOverview.vue</span></strong><span class="koboSpan" id="kobo.1009.1">, will complement the </span><span class="No-Break"><span class="koboSpan" id="kobo.1010.1">lobby: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.15-PlayersOverview.vue"><span class="No-Break"><span class="koboSpan" id="kobo.1011.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.15-PlayersOverview.vue</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.1012.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1013.1">This component only reads from the state and presents the overview in a nicely formatted way, with means for a user to identify themselves in the </span><span class="No-Break"><span class="koboSpan" id="kobo.1014.1">lobby view.</span></span></p>
<p><span class="koboSpan" id="kobo.1015.1">We can now add these two components to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1016.1">./src/views/Lobby.vue</span></strong><span class="koboSpan" id="kobo.1017.1"> file to complete </span><span class="No-Break"><span class="koboSpan" id="kobo.1018.1">this feature:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1019.1">
&lt;script setup lang="ts"&gt;import PlayerAdd from '@/components/PlayerAdd.vue'
import PlayersOverview from '@/components/PlayersOverview.vue'
&lt;/script&gt;
&lt;template&gt;
  &lt;div class="my-8"&gt;
    &lt;h1 class="text-h3 mb-8"&gt;Welcome to the lobby&lt;/h1&gt;
    &lt;player-add /&gt;
    &lt;players-overview class="my-8" /&gt;
  &lt;/div&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.1020.1">This is our</span><a id="_idIndexMarker488"/><span class="koboSpan" id="kobo.1021.1"> first opportunity to see our sockets in action! </span><span class="koboSpan" id="kobo.1021.2">So, let’s have a look. </span><span class="koboSpan" id="kobo.1021.3">Once we’ve run the development script, all three of our applications will run in parallel. </span><span class="koboSpan" id="kobo.1021.4">To enter the lobby, we need to access the CQA via the local development URL and provide an ID as a parameter to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1022.1">/start</span></strong><span class="koboSpan" id="kobo.1023.1"> route. </span><span class="koboSpan" id="kobo.1023.2">Remember our admin panel? </span><span class="koboSpan" id="kobo.1023.3">It has a section called </span><strong class="bold"><span class="koboSpan" id="kobo.1024.1">Share</span></strong><span class="koboSpan" id="kobo.1025.1">, where we’ve shown a list of active quizzes. </span><span class="koboSpan" id="kobo.1025.2">If you use the link from the admin panel, you should be redirected, via the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1026.1">/start/{QUIZ_ID}</span></strong><span class="koboSpan" id="kobo.1027.1"> route, to </span><span class="No-Break"><span class="koboSpan" id="kobo.1028.1">the lobby:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer089">
<span class="koboSpan" id="kobo.1029.1"><img alt="Figure 8.7 – A player has been added to the lobby" src="image/B19563_08_07.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1030.1">Figure 8.7 – A player has been added to the lobby</span></p>
<p><span class="koboSpan" id="kobo.1031.1">Now, without </span><a id="_idIndexMarker489"/><span class="koboSpan" id="kobo.1032.1">closing the existing browser window on the lobby, flip back to the admin panel and open the same link in a new browser window. </span><span class="koboSpan" id="kobo.1032.2">You should, again, be redirected to the lobby. </span><span class="koboSpan" id="kobo.1032.3">But in this case, you will enter as a new player. </span><span class="koboSpan" id="kobo.1032.4">You should see the player we added previously in the overview, ready to play! </span><span class="koboSpan" id="kobo.1032.5">If you add a new player name, the new player will be added to both browser windows in real time via the </span><span class="No-Break"><span class="koboSpan" id="kobo.1033.1">socket server!</span></span></p>
<p><span class="koboSpan" id="kobo.1034.1">Have a look at</span><a id="_idIndexMarker490"/><span class="koboSpan" id="kobo.1035.1"> the console of our terminal. </span><span class="koboSpan" id="kobo.1035.2">You will see messages indicating that the state of the players </span><span class="No-Break"><span class="koboSpan" id="kobo.1036.1">has changed:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer090">
<span class="koboSpan" id="kobo.1037.1"><img alt="Figure 8.8 – The console indicates the state of the players from the socket server" src="image/B19563_08_08.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1038.1">Figure 8.8 – The console indicates the state of the players from the socket server</span></p>
<p><span class="koboSpan" id="kobo.1039.1">Since we’ve already</span><a id="_idIndexMarker491"/><span class="koboSpan" id="kobo.1040.1"> connected our views and routes, we can trigger the start of a quiz. </span><span class="koboSpan" id="kobo.1040.2">If one of the players hits </span><strong class="bold"><span class="koboSpan" id="kobo.1041.1">Start</span></strong><span class="koboSpan" id="kobo.1042.1">, the quiz will automatically iterate over all of the questions and eventually end up at the </span><strong class="bold"><span class="koboSpan" id="kobo.1043.1">Final Score</span></strong><span class="koboSpan" id="kobo.1044.1"> view. </span><span class="koboSpan" id="kobo.1044.2">Feel free to try it out. </span><span class="koboSpan" id="kobo.1044.3">You will notice that t</span><a id="_idTextAnchor273"/><span class="koboSpan" id="kobo.1045.1">he quiz gets processed by both browser windows at the </span><span class="No-Break"><span class="koboSpan" id="kobo.1046.1">same time!</span></span></p>
<h2 id="_idParaDest-164"><a id="_idTextAnchor274"/><span class="koboSpan" id="kobo.1047.1">We need some answers</span></h2>
<p><span class="koboSpan" id="kobo.1048.1">Alright – it’s </span><a id="_idIndexMarker492"/><span class="koboSpan" id="kobo.1049.1">time to build on the core of our app: the answering mechanism. </span><span class="koboSpan" id="kobo.1049.2">For this and upcoming sections, I recommend preparing a quiz that has four questions. </span><span class="koboSpan" id="kobo.1049.3">That way, we can test all of the mechanics for a </span><span class="No-Break"><span class="koboSpan" id="kobo.1050.1">reasonable duration.</span></span></p>
<p><span class="koboSpan" id="kobo.1051.1">We’re going to create a new component in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1052.1">./components</span></strong><span class="koboSpan" id="kobo.1053.1"> folder called </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1054.1">QuestionForm.vue</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1055.1">: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.16-QuestionForm.vue"><span class="No-Break"><span class="koboSpan" id="kobo.1056.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.16-QuestionForm.vue</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.1057.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1058.1">Similar to</span><a id="_idIndexMarker493"/><span class="koboSpan" id="kobo.1059.1"> how we are adding and showing players, we are using the socket connection to emit our users’ input (</span><em class="italic"><span class="koboSpan" id="kobo.1060.1">line 12</span></em><span class="koboSpan" id="kobo.1061.1">), while also reading the actual state and presenting it in the UI (</span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1062.1">lines 15–17</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1063.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.1064.1">In the </span><strong class="bold"><span class="koboSpan" id="kobo.1065.1">Question</span></strong><span class="koboSpan" id="kobo.1066.1"> view (</span><strong class="source-inline"><span class="koboSpan" id="kobo.1067.1">./src/views/Question.vue</span></strong><span class="koboSpan" id="kobo.1068.1">), we’ll import and display this component next to showing the current question as the title of </span><span class="No-Break"><span class="koboSpan" id="kobo.1069.1">the view:</span></span></p>
<pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.1070.1">&lt;script setup lang="ts"&gt;</span></strong><strong class="bold"><span class="koboSpan" id="kobo.1071.1">import { computed } from 'vue'</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1072.1">import { state } from '@/socket'</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1073.1">import type { QuizQuestion } from '@/types/quiz'</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1074.1">import QuestionForm from '@/components/QuestionForm.vue';</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1075.1">const question = computed((): QuizQuestion =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1076.1">  return state.quizCurrentQuestion</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1077.1">})</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1078.1">&lt;/script&gt;</span></strong><span class="koboSpan" id="kobo.1079.1">
&lt;template&gt;
  &lt;div class="my-8"&gt;
</span><strong class="bold"><span class="koboSpan" id="kobo.1080.1">    &lt;h1 class="text-h3 mb-8"&gt;{{ question.question }}&lt;/h1&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1081.1">    &lt;QuestionForm /&gt;</span></strong><span class="koboSpan" id="kobo.1082.1">
  &lt;/div&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.1083.1">By adding this </span><a id="_idIndexMarker494"/><span class="koboSpan" id="kobo.1084.1">component to the view, our users can each try and answer the question. </span><span class="koboSpan" id="kobo.1084.2">And how about we show the user the results as well? </span><span class="koboSpan" id="kobo.1084.3">Let’s create a new component called </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1085.1">AnswerResult.vue</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1086.1">: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.17-AnswerResult.vue"><span class="No-Break"><span class="koboSpan" id="kobo.1087.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.17-AnswerResult.vue</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.1088.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1089.1">In the preceding file, we’re using the state of the quiz coming from the socket server to display whether the individual user has answered correctly. </span><span class="koboSpan" id="kobo.1089.2">As you can see, we can perfectly track which user is which and show them a customized interface. </span><span class="koboSpan" id="kobo.1089.3">In this case, we’re doing the filtering on the </span><span class="No-Break"><span class="koboSpan" id="kobo.1090.1">client app.</span></span></p>
<p><span class="koboSpan" id="kobo.1091.1">Again, we can</span><a id="_idIndexMarker495"/><span class="koboSpan" id="kobo.1092.1"> add this </span><strong class="source-inline"><span class="koboSpan" id="kobo.1093.1">AnswerResult</span></strong><span class="koboSpan" id="kobo.1094.1"> component to the correct view – in this case, the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1095.1">Answer.vue</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1096.1"> file:</span></span></p>
<pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.1097.1">&lt;script setup lang="ts"&gt;</span></strong><strong class="bold"><span class="koboSpan" id="kobo.1098.1">import AnswerResult from '@/components/AnswerResult.vue'</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1099.1">&lt;/script&gt;</span></strong><span class="koboSpan" id="kobo.1100.1">
&lt;template&gt;
  &lt;div class="my-8"&gt;
    &lt;h1 class="text-h3 mb-8"&gt;Answers&lt;/h1&gt;
    </span><strong class="bold"><span class="koboSpan" id="kobo.1101.1">&lt;answer-result /&gt;</span></strong><span class="koboSpan" id="kobo.1102.1">
  &lt;/div&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.1103.1">At this point, the client application already starts to closely resemble the result we’re </span><span class="No-Break"><span class="koboSpan" id="kobo.1104.1">going for:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer091">
<span class="koboSpan" id="kobo.1105.1"><img alt="Figure 8.9 – Example of the quiz’s state when answered correctly!" src="image/B19563_08_09.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1106.1">Figure 8.9 – Example of the quiz’s state when answered correctly!</span></p>
<p><span class="koboSpan" id="kobo.1107.1">At this point, our </span><a id="_idIndexMarker496"/><span class="koboSpan" id="kobo.1108.1">work is getting a bit repetitive, so let’s f</span><a id="_idTextAnchor275"/><span class="koboSpan" id="kobo.1109.1">inalize our app by showing intermediate results and the </span><span class="No-Break"><span class="koboSpan" id="kobo.1110.1">final score!</span></span></p>
<h2 id="_idParaDest-165"><a id="_idTextAnchor276"/><span class="koboSpan" id="kobo.1111.1">Keeping and showing the score</span></h2>
<p><span class="koboSpan" id="kobo.1112.1">For our</span><a id="_idIndexMarker497"/><span class="koboSpan" id="kobo.1113.1"> scoreboard, we’ll create another component called </span><strong class="source-inline"><span class="koboSpan" id="kobo.1114.1">ScoreBoard.vue</span></strong><span class="koboSpan" id="kobo.1115.1"> in the components </span><span class="No-Break"><span class="koboSpan" id="kobo.1116.1">folder: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.18-ScoreBoard.vue"><span class="No-Break"><span class="koboSpan" id="kobo.1117.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.18-ScoreBoard.vue</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.1118.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1119.1">We’ll add the component to the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.1120.1">ScoreBoard</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1121.1"> view:</span></span></p>
<pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.1122.1">&lt;script setup lang="ts"&gt;</span></strong><strong class="bold"><span class="koboSpan" id="kobo.1123.1">import ScoreBoard from '@/components/ScoreBoard.vue';</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1124.1">&lt;/script&gt;</span></strong><span class="koboSpan" id="kobo.1125.1">
&lt;template&gt;
  &lt;div class="my-8"&gt;
    &lt;h1 class="text-h3 mb-8"&gt;Scoreboard&lt;/h1&gt;
</span><strong class="bold"><span class="koboSpan" id="kobo.1126.1">    &lt;score-board /&gt;</span></strong><span class="koboSpan" id="kobo.1127.1">
  &lt;/div&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.1128.1">For the final score, we want to do something extra fun for the winner. </span><span class="koboSpan" id="kobo.1128.2">We’ll install the </span><em class="italic"><span class="koboSpan" id="kobo.1129.1">Vue Confetti Explosion</span></em><span class="koboSpan" id="kobo.1130.1"> component (</span><a href="https://github.com/valgeirb/vue-confetti-explosion"><span class="koboSpan" id="kobo.1131.1">https://github.com/valgeirb/vue-confetti-explosion</span></a><span class="koboSpan" id="kobo.1132.1">) by running the following command in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1133.1">./app</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.1134.1">folder’s terminal:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.1135.1">
npm install vue-confetti-explosion</span></pre> <p><span class="koboSpan" id="kobo.1136.1">And for our grand finale, we’ll make sure to include confetti for the quiz winner by creating the following contents in a component called </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1137.1">FinalScoreBoard.vue</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1138.1">: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.19-FinalScoreBoard.vue"><span class="No-Break"><span class="koboSpan" id="kobo.1139.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/08.quiz/.notes/8.19-FinalScoreBoard.vue</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.1140.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.1141.1">The important bit here is that we identify which user is the winner and shower that user with confetti (</span><em class="italic"><span class="koboSpan" id="kobo.1142.1">lines 6, </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.1143.1">22–24, 53–55</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.1144.1">)!</span></span></p>
<p><span class="koboSpan" id="kobo.1145.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.1146.1">FinalScoreBoard</span></strong><span class="koboSpan" id="kobo.1147.1"> component also needs to be added to its corresponding view </span><span class="No-Break"><span class="koboSpan" id="kobo.1148.1">file (</span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1149.1">./src/views/FinalScore.vue</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1150.1">):</span></span></p>
<pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.1151.1">&lt;script setup lang="ts"&gt;</span></strong><strong class="bold"><span class="koboSpan" id="kobo.1152.1">import FinalScoreBoard from '@/components/FinalScoreBoard.vue';</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1153.1">&lt;/script&gt;</span></strong><span class="koboSpan" id="kobo.1154.1">
&lt;template&gt;
  &lt;div class="my-8"&gt;
</span><strong class="bold"><span class="koboSpan" id="kobo.1155.1">    &lt;h1 class="text-h3 mb-8"&gt;Scoreboard&lt;/h1&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1156.1">    &lt;final-score-board /&gt;</span></strong><span class="koboSpan" id="kobo.1157.1">
  &lt;/div&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.1158.1">And with that, our</span><a id="_idIndexMarker498"/><span class="koboSpan" id="kobo.1159.1"> app is complete! </span><span class="koboSpan" id="kobo.1159.2">You should now be able to complete the quiz with one or more players at the </span><span class="No-Break"><span class="koboSpan" id="kobo.1160.1">same time:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer092">
<span class="koboSpan" id="kobo.1161.1"><img alt="Figure 8.10 – There can be only one winner in this game" src="image/B19563_08_10.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.1162.1">Figure 8.10 – There can be only one winner in this game</span></p>
<p><span class="koboSpan" id="kobo.1163.1">I think it’s brilliant that our client apps have almost no state</span><a id="_idTextAnchor277"/><span class="koboSpan" id="kobo.1164.1"> worth mentioning. </span><span class="koboSpan" id="kobo.1164.2">All of it is handled by the central </span><span class="No-Break"><span class="koboSpan" id="kobo.1165.1">socket server!</span></span></p>
<h1 id="_idParaDest-166"><a id="_idTextAnchor278"/><span class="koboSpan" id="kobo.1166.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.1167.1">This was quite a lengthy chapter that covered three different apps. </span><span class="koboSpan" id="kobo.1167.2">I hope the distinct roles of the individual apps are clear. </span><span class="koboSpan" id="kobo.1167.3">I also hope you appreciate the differences between a socket server setup and a RESTful server. </span><span class="koboSpan" id="kobo.1167.4">We’ve used both in this chapter, each with </span><span class="No-Break"><span class="koboSpan" id="kobo.1168.1">its strengths.</span></span></p>
<p><span class="koboSpan" id="kobo.1169.1">Also, with the amount of code we’ve written in this chapter, it should be clear that this code is not at the level of sturdiness nor as secure as you would realistically want it to be when it’s production-ready. </span><span class="koboSpan" id="kobo.1169.2">I want to stress that this wasn’t the focus of </span><span class="No-Break"><span class="koboSpan" id="kobo.1170.1">this chapter!</span></span></p>
<p><span class="koboSpan" id="kobo.1171.1">One of the new concepts that was introduced in this chapter was Nuxt. </span><span class="koboSpan" id="kobo.1171.2">As you may have noticed, it has very powerful capabilities that enhance both the final product and the developer experience. </span><span class="koboSpan" id="kobo.1171.3">You could consider Nuxt a default extension of any Vue application. </span><span class="koboSpan" id="kobo.1171.4">I can get behind the philosophy of making it easy to do things right while making it hard to do things wrong. </span><span class="koboSpan" id="kobo.1171.5">The opinionated setup that Nuxt encourages makes it easy to get </span><span class="No-Break"><span class="koboSpan" id="kobo.1172.1">started with.</span></span></p>
<p><span class="koboSpan" id="kobo.1173.1">The socket server is sort of an odd one between all of our projects. </span><span class="koboSpan" id="kobo.1173.2">But as we can see from the implementation on the client side, its real-time updates fit very well with the reactivity model of </span><span class="No-Break"><span class="koboSpan" id="kobo.1174.1">Vue applications.</span></span></p>
<p><span class="koboSpan" id="kobo.1175.1">As a closing remark, we’ve also made some small quality-of-life improvements in our development workflow by creating scripts that automate repetitive tasks for us. </span><span class="koboSpan" id="kobo.1175.2">You can consider it as a sort of stepping stone toward workspaces or monorepo setups, which expand even further upon managing projects that depend on </span><span class="No-Break"><span class="koboSpan" id="kobo.1176.1">each other.</span></span></p>
<p><span class="koboSpan" id="kobo.1177.1">In the next chapter, we’ll scope down on the number of applications and build something fun too by using artificial intelligence and object recognition in a </span><span class="No-Break"><span class="koboSpan" id="kobo.1178.1">Vue app!</span></span></p>
</div>
</body></html>
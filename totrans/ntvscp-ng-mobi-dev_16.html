<html><head></head><body>
        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Deploying to Google Play</h1>
                
            
            <article>
                
<p class="mce-root">Although deploying an app to Google Play can be slightly simpler when compared to the Apple App Store, there's still a few key steps that we need to pay attention to. We covered some preparation steps in <a href="part0154.html#4IRMK0-289fe2426d594f99a90e4363b2c9c34d" class="calibre3">Chapter 14</a>, <em class="calibre21">Deployment Preparation with webpack Bundling</em>, and <a href="part0163.html#4REBM0-289fe2426d594f99a90e4363b2c9c34d" class="calibre3">Chapter 15</a>, <em class="calibre21">Deploying to the Apple App Store</em>, such as using webpack to bundle the app and preparing app icons and splash screens, so we will jump right into building a releasable APK.</p>
<p class="mce-root">We express our gratitude to TJ VanToll for an excellent eight-step article to deploy NativeScript apps (<a href="https://www.nativescript.org/blog/steps-to-publish-your-nativescript-app-to-the-app-stores" class="calibre3">https://www.nativescript.org/blog/steps-to-publish-your-nativescript-app-to-the-app-stores</a>) from which we will insert excerpts from and expand wherever possible.</p>
<p class="mce-root">The following topics are covered in this chapter:</p>
<ul class="calibre13">
<li class="calibre14">Generating a keystore to build your APK with</li>
<li class="calibre14">Building a releasable APK with the NativeScript CLI</li>
<li class="calibre14">Uploading the APK to Google Play for publication</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Building an APK for Google Play</h1>
                
            
            <article>
                
<p class="mce-root">Before you open Google Play to register and publish this app (which is the next step), let's double-check a couple of things to ensure that our metadata is correct.</p>
<p class="mce-root">Open <kbd class="calibre11">app/App_Resources/Android/app.gradle</kbd> and ensure that the <kbd class="calibre11">applicationId</kbd> is correct for your package name:</p>
<div class="mce-root1"><img class="image-border65" src="../images/00075.jpeg"/></div>
<p class="mce-root">Also, open <kbd class="calibre11">package.json</kbd> at the root of the project and double-check the <kbd class="calibre11">nativescript.id</kbd> there as well for good measure:</p>
<div class="mce-root1"><img class="image-border66" src="../images/00076.jpeg"/></div>
<p class="mce-root">Now, you will need to generate an executable Android file for your application. On Android, this file has a <kbd class="calibre11">.apk</kbd> extension, and you can generate this file using the NativeScript CLI.</p>
<p class="mce-root">The <kbd class="calibre11">tns run</kbd> command you were using during NativeScript development actually generates a <kbd class="calibre11">.apk</kbd> file for you and installs that file on an Android emulator or device. However, for a Google Play release, the build you create must also be code signed. You can refer to Android's documentation (<a href="https://developer.android.com/studio/publish/app-signing.html" class="calibre3">https://developer.android.com/studio/publish/app-signing.html</a>) on code signing if you want to dive into the cryptographic details, but at a high level, you will need to do the following two things to create a release version of your Android app:</p>
<ul class="calibre13">
<li class="calibre14">Create a <kbd class="calibre11">.keystore</kbd> or <kbd class="calibre11">.jks</kbd> (Java keystore) file</li>
<li class="calibre14">Use that <kbd class="calibre11">.keystore</kbd> or <kbd class="calibre11">.jks</kbd> file to sign in to your app during a build</li>
</ul>
<p class="mce-root">The Android documentation provides you a few options on how you can create your keystore file (<a href="https://developer.android.com/studio/publish/app-signing.html#release-mode" class="calibre3">https://developer.android.com/studio/publish/app-signing.html#release-mode</a>). Our preferred approach is the <kbd class="calibre11">keytool</kbd> command-line utility, which is included in the Java JDK that NativeScript installs for you, so it should already be available on your development machine's command line.</p>
<p class="mce-root">To use <kbd class="calibre11">keytool</kbd> to generate a keystore for code signing our app, we will use the following command:</p>
<pre class="calibre22"><strong class="calibre1">keytool -genkey -v -keystore nstudio.jks -keyalg RSA -keysize 2048 -validity 10000 -alias nstudio</strong></pre>
<p class="mce-root">The <kbd class="calibre11">keytool</kbd> utility will ask you a number of questions, several of which are optional (name of organization and the names of your city, state, and country), but the most important ones are the passwords for both the keystore and the alias (more on that later on). Here's what the <kbd class="calibre11">keytool</kbd> process looks like when we generate the keystore:</p>
<div class="mce-root1"><img class="image-border20" src="../images/00077.jpeg"/></div>
<p class="mce-root">Before we move on to how to use this <kbd class="calibre11">.jks</kbd> file, there's one important thing you need to know. Place this <kbd class="calibre11">.jks</kbd> file somewhere safe, and do not forget the password for the keystore or for the alias. (Personally, I like using the same password for my keystore and my aliases to simplify my life.) Android requires you to use this exact same <kbd class="calibre11">.jks</kbd> file to sign in to any and all updates to your app. This means that if you lose this <kbd class="calibre11">.jks</kbd> file, or its password, you will not be able to update your Android app. You'll have to create a brand new entry in Google Play, and your existing users will not be able to upgrade—so take care not to lose it!</p>
<p class="mce-root">Oh, and one more thing to note in most cases is that you'll want to use a single keystore file to sign in to all of your personal or company's Android applications. Remember how you had to pass a -alias flag to the keytool utility, and how that alias had its own password? It turns out that one keystore can have many aliases, and you'll want to create one for each Android app that you build. </p>
<p class="mce-root">Okay, so now that you have this <kbd class="calibre11">.jks</kbd> file, and you have it stored in a nice and secure location, the rest of the process is quite easy.</p>
<p class="mce-root">Build our Android app using webpack and pass it the information you just used to create the <kbd class="calibre11">.jks</kbd> file. For example, the following command is used to create a release build of <kbd class="calibre11">nStudio</kbd>:</p>
<pre class="calibre22"><strong class="calibre1">npm run build-android-bundle -- --release --keyStorePath ~/path/to/nstudio.jks --keyStorePassword our-pass --keyStoreAlias nstudio --keyStoreAliasPassword our-alias-pass</strong></pre>
<p class="mce-root">Once the command finishes running, you'll have a releasable <kbd class="calibre11">.apk</kbd> file in your app's <kbd class="calibre11">platforms/android/build/outputs/apk</kbd> folder; note the location of that file, as you'll need it in the next step—deploying your app on Google Play:</p>
<div class="mce-root1"><img class="image-border20" src="../images/00078.jpeg"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Uploading to Google Play</h1>
                
            
            <article>
                
<p class="mce-root">Google Play is where Android users find and install apps, and the Google Play Developer Console (<a href="https://play.google.com/apps/publish/" class="calibre3">https://play.google.com/apps/publish/</a>) is where developers register and upload apps for users.</p>
<p class="mce-root">You will first create a new application by its name and then see it listed:</p>
<div class="mce-root1"><img class="image-border67" src="../images/00079.jpeg"/></div>
<p class="mce-root">Android's documentation on uploading apps and setting up your store listing is quite good, so we will not recreate all that information here. Instead, a few tips will be provided that you might find helpful when uploading your own NativeScript apps to Google Play.</p>
<p class="mce-root">On the <span>Store Listing</span> tab in the Google Play Developer Console, you'll have to provide at least two screenshots of your app in action, as follows: </p>
<div class="mce-root1"><img class="image-border68" src="../images/00080.jpeg"/></div>
<p class="mce-root">Launch your app in an Android <strong class="calibre1">Android Virtual Device</strong> (<strong class="calibre1">AVD</strong>) using the <kbd class="calibre11">tns run android --emulator</kbd> command. The Android AVDs have a built-in way of taking screenshots using the little camera icon in the emulator's sidebar.</p>
<p class="mce-root">Use this button to take a few screenshots of the most important screens in your app, and the image files themselves will appear on your desktop. From there, you could take those files and upload them directly into the Google Play Developer Console. A 1024 x 500 <span>Feature Graphic</span> image file is also required, which will appear at the top of your store listing, as shown in the following screenshot:</p>
<div class="mce-root1"><img class="image-border69" src="../images/00081.jpeg"/></div>
<p class="mce-root">Although not shown in the preceding screenshot, we recommend that you use a service like DaVinci (<a href="https://www.davinciapps.com" class="calibre3">https://www.davinciapps.com</a>) to add a little flair to your screenshots, and turn them into a little tutorial of what your app does.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">APK</h1>
                
            
            <article>
                
<p class="mce-root">The <span>App Releases</span> section of the Google Play Developer Console is where you upload the <kbd class="calibre11">.apk</kbd> file you generated in the preceding step of this chapter. </p>
<p class="mce-root">You may see mention of opting into <span>Google Play App Signing</span> when you view the <span>App Releases</span> section. It's best to opt in now rather than later. Once you've opted in, it will show <span>Enabled</span>:</p>
<div class="mce-root1"><img class="image-border70" src="../images/00082.jpeg"/></div>
<p class="mce-root">You can then proceed to upload the apk in your app's <kbd class="calibre11">platforms/android/build/outputs/apk</kbd> folder.</p>
<p class="mce-root">Once you have your APK uploaded, you should see it listed on that same page where you can type out release notes for the uploaded version in multiple languages of your choice:</p>
<div class="mce-root1"><img class="image-border71" src="../images/00083.jpeg"/></div>
<p class="mce-root">After you click on <span>Save</span> on that page, you will probably want to return to the <span>Store listing</span> section to finish filling out all of your app's information. Once you have everything set, you're ready to submit your app. Android app reviews generally take a few hours, and unless Google flags any problems, your app should be available in Google Play within half a day or so.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Summary</h1>
                
            
            <article>
                
<p class="mce-root">Woohoo! We built an app from <em class="calibre21">zero to published</em> in both stores, Apple App Store and Google Play. This has been quite an adventure with many twists and turns. We sincerely hope that this has given you deep insight into NativeScript for Angular app development as well as demystified any areas of this exciting tech stack for those who have been curious.</p>
<p class="mce-root">Both NativeScript and Angular have thriving global communities, and we encourage you to get involved, speak about your experiences, and share your excitement with others with all the exhilarating projects you and your teams may be working on. Never hesitate to reach out and ask for help, as we all take responsibility in our love and admiration for these two technologies.</p>
<p class="mce-root">There are some additional helpful resources that you can check out:</p>
<ul class="calibre13">
<li class="calibre14"><a href="http://forum.nativescript.org" class="calibre3">http://forum.nativescript.org</a></li>
<li class="calibre14"><a href="http://nativescript.rocks" class="calibre3">http://nativescript.rocks</a></li>
</ul>
<p class="mce-root">And of course get to know the docs! <br class="title-page-name"/>
<a href="http://docs.nativescript.org/angular/start/introduction.html" class="calibre3">http://docs.nativescript.org/angular/start/introduction.html</a></p>
<p class="mce-root">Cheers!</p>


            </article>

            
        </section>
    </body></html>
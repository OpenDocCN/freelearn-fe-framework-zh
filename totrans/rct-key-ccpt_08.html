<html><head></head><body>
  <div class="Basic-Text-Frame" id="_idContainer148">
   <h1 class="chapterNumber">
    <span class="koboSpan" id="kobo.1.1">
     8
    </span>
   </h1>
   <h1 class="chapterTitle" id="_idParaDest-151">
    <span class="koboSpan" id="kobo.2.1">
     Handling Side Effects
    </span>
   </h1>
   <div class="note">
    <p class="normal">
     <span class="koboSpan" id="kobo.3.1">
      Learning Objectives
     </span>
    </p>
    <p class="normal">
     <span class="koboSpan" id="kobo.4.1">
      By the end of this chapter, you will be able to do the following:
     </span>
    </p>
    <ul>
     <li class="bulletList">
      <span class="koboSpan" id="kobo.5.1">
       Identify side effects in your React apps
      </span>
     </li>
     <li class="bulletList">
      <span class="koboSpan" id="kobo.6.1">
       Understand and use the
      </span>
      <code class="inlineCode">
       <span class="koboSpan" id="kobo.7.1">
        useEffect()
       </span>
      </code>
      <span class="koboSpan" id="kobo.8.1">
       Hook
      </span>
     </li>
     <li class="bulletList">
      <span class="koboSpan" id="kobo.9.1">
       Utilize the different features and concepts related to the
      </span>
      <code class="inlineCode">
       <span class="koboSpan" id="kobo.10.1">
        useEffect()
       </span>
      </code>
      <span class="koboSpan" id="kobo.11.1">
       Hook to avoid bugs and optimize your code
      </span>
     </li>
     <li class="bulletList">
      <span class="koboSpan" id="kobo.12.1">
       Handle side effects related and unrelated to state changes
      </span>
     </li>
    </ul>
   </div>
   <h1 class="heading-1" id="_idParaDest-152">
    <span class="koboSpan" id="kobo.13.1">
     Introduction
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.14.1">
     While all React examples previously covered in this book have been relatively straightforward, and many key React concepts were introduced, it is unlikely that many real apps could be built with those concepts alone.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.15.1">
     Most real apps that you will build as a React developer also need to send HTTP requests, access the browser storage and log analytics data, or perform any other kind of similar task, and with components, props, events, and state alone, you’ll often encounter problems when trying to add such features to your app.
    </span>
    <span class="koboSpan" id="kobo.15.2">
     Detailed explanations and examples will be discussed later in this chapter, but the core problem is that tasks like this will often interfere with React’s component rendering cycle, leading to unexpected bugs or even breaking the app.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.16.1">
     This chapter will take a closer look at those kinds of actions, analyze what they have in common, and most importantly, teach you how to correctly handle such tasks in React apps.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-153">
    <span class="koboSpan" id="kobo.17.1">
     What’s the Problem?
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.18.1">
     Before exploring a solution, it’s important to first understand the concrete problem.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.19.1">
     Actions that are
    </span>
    <a id="_idIndexMarker344">
    </a>
    <span class="koboSpan" id="kobo.20.1">
     not directly related to producing a (new) user interface state often clash with React’s component rendering cycle.
    </span>
    <span class="koboSpan" id="kobo.20.2">
     They may introduce bugs or even break the entire web app.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.21.1">
     Consider the following example code snippet (important: don’t execute this code as it will cause an infinite loop and send a large number of HTTP requests behind the scenes):
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.22.1">import</span></span><span class="koboSpan" id="kobo.23.1"> { useState } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.24.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.25.1">'react'</span></span><span class="koboSpan" id="kobo.26.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.27.1">import</span></span><span class="koboSpan" id="kobo.28.1"> classes </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.29.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.30.1">'./BlogPosts.module.css'</span></span><span class="koboSpan" id="kobo.31.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.32.1">async</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.33.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.34.1">fetchPosts</span></span><span class="koboSpan" id="kobo.35.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.36.1">const</span></span><span class="koboSpan" id="kobo.37.1"> response = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.38.1">await</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.39.1">fetch</span></span><span class="koboSpan" id="kobo.40.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.41.1">'https://jsonplaceholder.typicode.com/posts'</span></span><span class="koboSpan" id="kobo.42.1">);
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.43.1">const</span></span><span class="koboSpan" id="kobo.44.1"> blogPosts = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.45.1">await</span></span><span class="koboSpan" id="kobo.46.1"> response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.47.1">json</span></span><span class="koboSpan" id="kobo.48.1">();
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.49.1">return</span></span><span class="koboSpan" id="kobo.50.1"> blogPosts;
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.51.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.52.1">BlogPosts</span></span><span class="koboSpan" id="kobo.53.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.54.1">const</span></span><span class="koboSpan" id="kobo.55.1"> [loadedPosts, setLoadedPosts] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.56.1">useState</span></span><span class="koboSpan" id="kobo.57.1">([]);
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.58.1">fetchPosts</span></span><span class="koboSpan" id="kobo.59.1">().</span><span class="hljs-title"><span class="koboSpan" id="kobo.60.1">then</span></span><span class="koboSpan" id="kobo.61.1">(</span><span class="hljs-function"><span class="koboSpan" id="kobo.62.1">(</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.63.1">fetchedPosts</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.64.1">) =&gt;</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.65.1">setLoadedPosts</span></span><span class="koboSpan" id="kobo.66.1">(fetchedPosts));
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.67.1">return</span></span><span class="koboSpan" id="kobo.68.1"> (
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.69.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.70.1">ul</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.71.1">className</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.72.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.73.1">{classes.posts}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.74.1">&gt;</span></span>
<span class="language-xml"><span class="koboSpan" id="kobo.75.1">      {loadedPosts.map((post) =&gt; (</span></span>
<span class="language-xml">        </span><span class="hljs-tag"><span class="koboSpan" id="kobo.76.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.77.1">li</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.78.1">key</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.79.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.80.1">{post.id}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.81.1">&gt;</span></span><span class="language-xml"><span class="koboSpan" id="kobo.82.1">{post.title}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.83.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.84.1">li</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.85.1">&gt;</span></span>
<span class="language-xml"><span class="koboSpan" id="kobo.86.1">      ))}</span></span>
<span class="language-xml">    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.87.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.88.1">ul</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.89.1">&gt;</span></span><span class="koboSpan" id="kobo.90.1">
  );
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.91.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.92.1">default</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.93.1">BlogPosts</span></span><span class="koboSpan" id="kobo.94.1">;
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.95.1">
     So what’s the problem with this code?
    </span>
    <span class="koboSpan" id="kobo.95.2">
     Why does it create an infinite loop?
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.96.1">
     In this example, a React component (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.97.1">
      BlogPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.98.1">
     ) is created.
    </span>
    <span class="koboSpan" id="kobo.98.2">
     In addition, a non-component function (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.99.1">
      fetchPosts()
     </span>
    </code>
    <span class="koboSpan" id="kobo.100.1">
     ) is defined.
    </span>
    <span class="koboSpan" id="kobo.100.2">
     That function uses the built-in
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.101.1">
      fetch()
     </span>
    </code>
    <span class="koboSpan" id="kobo.102.1">
     function (provided by the browser) to send an HTTP request to an external
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.103.1">
      application programming interface
     </span>
    </strong>
    <span class="koboSpan" id="kobo.104.1">
     (
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.105.1">
      API
     </span>
    </strong>
    <span class="koboSpan" id="kobo.106.1">
     ) and
    </span>
    <a id="_idIndexMarker345">
    </a>
    <span class="koboSpan" id="kobo.107.1">
     fetch some data.
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.108.1">
       Note
      </span>
     </strong>
    </p>
    <p class="normal">
     <span class="koboSpan" id="kobo.109.1">
      The
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.110.1">
       fetch()
      </span>
     </code>
     <span class="koboSpan" id="kobo.111.1">
      function is
     </span>
     <a id="_idIndexMarker346">
     </a>
     <span class="koboSpan" id="kobo.112.1">
      made available by the browser (all modern browsers support this function).
     </span>
     <span class="koboSpan" id="kobo.112.2">
      You can learn more about
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.113.1">
       fetch()
      </span>
     </code>
     <span class="koboSpan" id="kobo.114.1">
      at
     </span>
     <a href="https://academind.com/tutorials/xhr-fetch-axios-the-fetch-api">
      <span class="url">
       <span class="koboSpan" id="kobo.115.1">
        https://academind.com/tutorials/xhr-fetch-axios-the-fetch-api
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.116.1">
      .
     </span>
    </p>
    <p class="normal">
     <span class="koboSpan" id="kobo.117.1">
      The
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.118.1">
       fetch()
      </span>
     </code>
     <span class="koboSpan" id="kobo.119.1">
      function yields a
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.120.1">
       promise
      </span>
     </strong>
     <span class="koboSpan" id="kobo.121.1">
      , which, in this example, is handled via
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.122.1">
       async
      </span>
     </code>
     <span class="koboSpan" id="kobo.123.1">
      /
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.124.1">
       await
      </span>
     </code>
     <span class="koboSpan" id="kobo.125.1">
      .
     </span>
     <span class="koboSpan" id="kobo.125.2">
      Just like
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.126.1">
       fetch()
      </span>
     </code>
     <span class="koboSpan" id="kobo.127.1">
      , promises are a key web development concept, which
     </span>
     <a id="_idIndexMarker347">
     </a>
     <span class="koboSpan" id="kobo.128.1">
      you can learn more about (along with
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.129.1">
       async
      </span>
     </code>
     <span class="koboSpan" id="kobo.130.1">
      /
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.131.1">
       await
      </span>
     </code>
     <span class="koboSpan" id="kobo.132.1">
      ) at
     </span>
     <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function">
      <span class="url">
       <span class="koboSpan" id="kobo.133.1">
        https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.134.1">
      .
     </span>
    </p>
    <p class="normal">
     <span class="koboSpan" id="kobo.135.1">
      An API, in this
     </span>
     <a id="_idIndexMarker348">
     </a>
     <span class="koboSpan" id="kobo.136.1">
      context, is a site that exposes various paths to which requests can be sent—either to submit or to fetch data.
     </span>
     <a href="https://jsonplaceholder.typicode.com">
      <span class="url">
       <span class="koboSpan" id="kobo.137.1">
        jsonplaceholder.typicode.com
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.138.1">
      is a dummy API, responding with dummy data.
     </span>
     <span class="koboSpan" id="kobo.138.2">
      It can be used in scenarios like the preceding example, where you just need an API to send requests to.
     </span>
     <span class="koboSpan" id="kobo.138.3">
      You can use it to test some concept or code without connecting or creating a real backend API.
     </span>
     <span class="koboSpan" id="kobo.138.4">
      In this case, it’s used to explore some React problems and concepts.
     </span>
     <span class="koboSpan" id="kobo.138.5">
      Basic knowledge about sending HTTP requests with
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.139.1">
       fetch()
      </span>
     </code>
     <span class="koboSpan" id="kobo.140.1">
      and APIs is expected for this chapter and the book overall.
     </span>
     <span class="koboSpan" id="kobo.140.2">
      If needed, you can use pages such as MDN (
     </span>
     <a href="https://developer.mozilla.org/">
      <span class="url">
       <span class="koboSpan" id="kobo.141.1">
        https://developer.mozilla.org/
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.142.1">
      ) to strengthen your knowledge of such core concepts.
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.143.1">
     In the preceding
    </span>
    <a id="_idIndexMarker349">
    </a>
    <span class="koboSpan" id="kobo.144.1">
     code snippet, the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.145.1">
      BlogPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.146.1">
     component utilizes
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.147.1">
      useState()
     </span>
    </code>
    <span class="koboSpan" id="kobo.148.1">
     to register a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.149.1">
      loadedPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.150.1">
     state value.
    </span>
    <span class="koboSpan" id="kobo.150.2">
     The state is used to output a list of blog posts.
    </span>
    <span class="koboSpan" id="kobo.150.3">
     Those blog posts are not defined in the app itself though.
    </span>
    <span class="koboSpan" id="kobo.150.4">
     Instead, they are fetched from the external API mentioned in the note box.
    </span>
   </p>
   <p class="normal">
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.151.1">
      fetchPosts()
     </span>
    </code>
    <span class="koboSpan" id="kobo.152.1">
     , which is the utility function that contains the code for fetching blog posts data from that backend API using the built-in
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.153.1">
      fetch()
     </span>
    </code>
    <span class="koboSpan" id="kobo.154.1">
     function, is called directly in the component function body.
    </span>
    <span class="koboSpan" id="kobo.154.2">
     Since
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.155.1">
      fetchPosts()
     </span>
    </code>
    <span class="koboSpan" id="kobo.156.1">
     is an
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.157.1">
      async
     </span>
    </code>
    <span class="koboSpan" id="kobo.158.1">
     function (using
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.159.1">
      async
     </span>
    </code>
    <span class="koboSpan" id="kobo.160.1">
     /
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.161.1">
      await
     </span>
    </code>
    <span class="koboSpan" id="kobo.162.1">
     ), it returns a promise.
    </span>
    <span class="koboSpan" id="kobo.162.2">
     In
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.163.1">
      BlogPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.164.1">
     , the code that should be executed once the promise resolves is registered via the built-in
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.165.1">
      then()
     </span>
    </code>
    <span class="koboSpan" id="kobo.166.1">
     method.
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.167.1">
       Note
      </span>
     </strong>
    </p>
    <p class="normal">
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.168.1">
       async
      </span>
     </code>
     <span class="koboSpan" id="kobo.169.1">
      /
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.170.1">
       await
      </span>
     </code>
     <span class="koboSpan" id="kobo.171.1">
      is not used directly in the component function body because regular React components must not be
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.172.1">
       async
      </span>
     </code>
     <span class="koboSpan" id="kobo.173.1">
      functions.
     </span>
     <span class="koboSpan" id="kobo.173.2">
      Such functions automatically return a promise as a value (even without an explicit
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.174.1">
       return
      </span>
     </code>
     <span class="koboSpan" id="kobo.175.1">
      statement), which is an invalid return value for a React component.
     </span>
    </p>
    <p class="normal">
     <span class="koboSpan" id="kobo.176.1">
      That being said, there are indeed React components that are allowed to use
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.177.1">
       async
      </span>
     </code>
     <span class="koboSpan" id="kobo.178.1">
      /
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.179.1">
       await
      </span>
     </code>
     <span class="koboSpan" id="kobo.180.1">
      and
     </span>
     <a id="_idIndexMarker350">
     </a>
     <span class="koboSpan" id="kobo.181.1">
      return a promise.
     </span>
     <span class="koboSpan" id="kobo.181.2">
      So-called
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.182.1">
       React Server Components
      </span>
     </strong>
     <span class="koboSpan" id="kobo.183.1">
      are not restricted to returning JSX code, strings, etc.
     </span>
     <span class="koboSpan" id="kobo.183.2">
      This feature will be discussed in detail in
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.184.1">
       Chapter 16
      </span>
     </em>
     <span class="koboSpan" id="kobo.185.1">
      ,
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.186.1">
       React Server Components &amp; Server Actions
      </span>
     </em>
     <span class="koboSpan" id="kobo.187.1">
      .
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.188.1">
     Once the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.189.1">
      fetchPosts()
     </span>
    </code>
    <span class="koboSpan" id="kobo.190.1">
     promise resolves, the extracted posts data (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.191.1">
      fetchedPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.192.1">
     ) is set as the new
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.193.1">
      loadedPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.194.1">
     state (via
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.195.1">
      setLoadedPosts(fetchedPosts)
     </span>
    </code>
    <span class="koboSpan" id="kobo.196.1">
     ).
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.197.1">
     If you were to
    </span>
    <a id="_idIndexMarker351">
    </a>
    <span class="koboSpan" id="kobo.198.1">
     run the preceding code (which you should not do!), it would at first seem to work.
    </span>
    <span class="koboSpan" id="kobo.198.2">
     But behind the scenes, it would actually start an infinite loop, hammering the API with HTTP requests.
    </span>
    <span class="koboSpan" id="kobo.198.3">
     This is because, as a result of getting a response from the HTTP request,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.199.1">
      setLoadedPosts()
     </span>
    </code>
    <span class="koboSpan" id="kobo.200.1">
     is used to set a new state.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.201.1">
     Earlier in this book (in
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.202.1">
      Chapter 4
     </span>
    </em>
    <span class="koboSpan" id="kobo.203.1">
     ,
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.204.1">
      Working with Events and State
     </span>
    </em>
    <span class="koboSpan" id="kobo.205.1">
     ), you learned that whenever the state of a component changes, React re-evaluates the component to which the state belongs.
    </span>
    <span class="koboSpan" id="kobo.205.2">
     “Re-evaluating” simply means that the component function is executed again (by React, automatically).
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.206.1">
     Since this
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.207.1">
      BlogPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.208.1">
     component calls
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.209.1">
      fetchPosts()
     </span>
    </code>
    <span class="koboSpan" id="kobo.210.1">
     (which sends an HTTP request) directly inside the component function body, this HTTP request will be sent every time the component function is executed.
    </span>
    <span class="koboSpan" id="kobo.210.2">
     And as the state (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.211.1">
      loadedPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.212.1">
     ) is updated as a result of getting a response from that HTTP request, this process begins again, and an infinite loop is created.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.213.1">
     The root problem, in this case, is that sending an HTTP request is a side effect—a concept that will be explored in greater detail in the next section.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-154">
    <span class="koboSpan" id="kobo.214.1">
     Understanding Side Effects
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.215.1">
     Side effects are actions or processes that occur in addition to another
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.216.1">
      main process
     </span>
    </em>
    <span class="koboSpan" id="kobo.217.1">
     .
    </span>
    <span class="koboSpan" id="kobo.217.2">
     At least, this is a
    </span>
    <a id="_idIndexMarker352">
    </a>
    <span class="koboSpan" id="kobo.218.1">
     concise definition that helps with understanding side effects in the context of a React app.
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.219.1">
       Note
      </span>
     </strong>
    </p>
    <p class="normal">
     <span class="koboSpan" id="kobo.220.1">
      If you want to dive deeper into the concept of
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.221.1">
       side effects
      </span>
     </em>
     <span class="koboSpan" id="kobo.222.1">
      , you can also explore the following
     </span>
     <a id="_idIndexMarker353">
     </a>
     <span class="koboSpan" id="kobo.223.1">
      discussion about side effects on Stack Overflow:
     </span>
     <a href="https://softwareengineering.stackexchange.com/questions/40297/what-is-a-side-effect">
      <span class="url">
       <span class="koboSpan" id="kobo.224.1">
        https://softwareengineering.stackexchange.com/questions/40297/what-is-a-side-effect
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.225.1">
      .
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.226.1">
     In the case of a React component, the main process would be the component render cycle in which the main task of a component is to render the user interface that is defined in the component function (the returned JSX code).
    </span>
    <span class="koboSpan" id="kobo.226.2">
     The React component should return the final JSX code, which is then translated into DOM-manipulating instructions.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.227.1">
     For this, React considers state changes as the trigger for updating the user interface.
    </span>
    <span class="koboSpan" id="kobo.227.2">
     Registering event handlers such as
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.228.1">
      onClick
     </span>
    </code>
    <span class="koboSpan" id="kobo.229.1">
     , adding refs, or rendering child components (possibly by using props) would be other elements that belong to this main process—because all these concepts are directly related to the main task of rendering the desired user interface.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.230.1">
     Sending an HTTP request, as in the preceding example, is not part of this main process, though.
    </span>
    <span class="koboSpan" id="kobo.230.2">
     It doesn’t directly influence the user interface.
    </span>
    <span class="koboSpan" id="kobo.230.3">
     While the response data might eventually be output on the screen, it definitely won’t be used in the exact same component render cycle in which the request is sent (because HTTP requests are asynchronous tasks).
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.231.1">
     Since sending the HTTP request is not part of the main process (rendering the user interface) that’s performed by the component function, it’s considered a side effect.
    </span>
    <span class="koboSpan" id="kobo.231.2">
     It’s invoked by the same function (the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.232.1">
      BlogPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.233.1">
     component function), which primarily has a different goal.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.234.1">
     If the HTTP request were sent upon a click of a button rather than as part of the main component function body, it would not be a side effect.
    </span>
    <span class="koboSpan" id="kobo.234.2">
     Consider this example:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.235.1">import</span></span><span class="koboSpan" id="kobo.236.1"> { useState } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.237.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.238.1">'react'</span></span><span class="koboSpan" id="kobo.239.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.240.1">import</span></span><span class="koboSpan" id="kobo.241.1"> classes </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.242.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.243.1">'./BlogPosts.module.css'</span></span><span class="koboSpan" id="kobo.244.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.245.1">async</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.246.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.247.1">fetchPosts</span></span><span class="koboSpan" id="kobo.248.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.249.1">const</span></span><span class="koboSpan" id="kobo.250.1"> response = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.251.1">await</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.252.1">fetch</span></span><span class="koboSpan" id="kobo.253.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.254.1">'https://jsonplaceholder.typicode.com/posts'</span></span><span class="koboSpan" id="kobo.255.1">);
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.256.1">const</span></span><span class="koboSpan" id="kobo.257.1"> blogPosts = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.258.1">await</span></span><span class="koboSpan" id="kobo.259.1"> response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.260.1">json</span></span><span class="koboSpan" id="kobo.261.1">();
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.262.1">return</span></span><span class="koboSpan" id="kobo.263.1"> blogPosts;
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.264.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.265.1">BlogPosts</span></span><span class="koboSpan" id="kobo.266.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.267.1">const</span></span><span class="koboSpan" id="kobo.268.1"> [loadedPosts, setLoadedPosts] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.269.1">useState</span></span><span class="koboSpan" id="kobo.270.1">([]);
  </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.271.1">function</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.272.1">handleFetchPosts</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.273.1">() {</span></strong></span>
    <span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.274.1">fetchPosts</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.275.1">().</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.276.1">then</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.277.1">(</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.278.1">(</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.279.1">fetchedPosts</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.280.1">) =&gt;</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.281.1">setLoadedPosts</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.282.1">(fetchedPosts));</span></strong></span>
  <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.283.1">}</span></strong></span>
  <span class="hljs-keyword"><span class="koboSpan" id="kobo.284.1">return</span></span><span class="koboSpan" id="kobo.285.1"> (
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.286.1">&lt;&gt;</span></span>
<span class="language-xml">      </span><span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.287.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.288.1">button</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.289.1">onClick</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.290.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.291.1">{handleFetchPosts}</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.292.1">&gt;</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.293.1">Fetch Posts</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.294.1">&lt;/</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.295.1">button</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.296.1">&gt;</span></strong></span>
<span class="language-xml">      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.297.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.298.1">ul</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.299.1">className</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.300.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.301.1">{classes.posts}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.302.1">&gt;</span></span>
<span class="language-xml"><span class="koboSpan" id="kobo.303.1">        {loadedPosts.map((post) =&gt; (</span></span>
<span class="language-xml">          </span><span class="hljs-tag"><span class="koboSpan" id="kobo.304.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.305.1">li</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.306.1">key</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.307.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.308.1">{post.id}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.309.1">&gt;</span></span><span class="language-xml"><span class="koboSpan" id="kobo.310.1">{post.title}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.311.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.312.1">li</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.313.1">&gt;</span></span>
<span class="language-xml"><span class="koboSpan" id="kobo.314.1">        ))}</span></span>
<span class="language-xml">      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.315.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.316.1">ul</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.317.1">&gt;</span></span>
<span class="language-xml">    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.318.1">&lt;/&gt;</span></span><span class="koboSpan" id="kobo.319.1">
  );
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.320.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.321.1">default</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.322.1">BlogPosts</span></span><span class="koboSpan" id="kobo.323.1">;
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.324.1">
     This code is
    </span>
    <a id="_idIndexMarker354">
    </a>
    <span class="koboSpan" id="kobo.325.1">
     almost identical to the previous example, but it has one important difference: a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.326.1">
      &lt;button&gt;
     </span>
    </code>
    <span class="koboSpan" id="kobo.327.1">
     was added to the JSX code.
    </span>
    <span class="koboSpan" id="kobo.327.2">
     And it’s this button that invokes a newly added
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.328.1">
      handleFetchPosts()
     </span>
    </code>
    <span class="koboSpan" id="kobo.329.1">
     function, which then sends the HTTP request (and updates the state).
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.330.1">
     With this change made, the HTTP request is
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.331.1">
      not
     </span>
    </em>
    <span class="koboSpan" id="kobo.332.1">
     sent every time the component function re-renders (that is, is executed again).
    </span>
    <span class="koboSpan" id="kobo.332.2">
     Instead, it’s only sent whenever the button is clicked, and therefore, this does not create an infinite loop.
    </span>
    <span class="koboSpan" id="kobo.332.3">
     The HTTP request, in this case, also doesn’t postulate a side effect, because the primary goal of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.333.1">
      handleFetchPosts()
     </span>
    </code>
    <span class="koboSpan" id="kobo.334.1">
     (i.e., the main process) is to fetch new posts and update the state.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-155">
    <span class="koboSpan" id="kobo.335.1">
     Side Effects Are Not Just about HTTP Requests
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.336.1">
     In the previous example, you learned about one potential side effect that could occur in a component
    </span>
    <a id="_idIndexMarker355">
    </a>
    <span class="koboSpan" id="kobo.337.1">
     function: an HTTP request.
    </span>
    <span class="koboSpan" id="kobo.337.2">
     You also learned that HTTP requests are not always side effects.
    </span>
    <span class="koboSpan" id="kobo.337.3">
     It depends on where they are created.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.338.1">
     In general, any action that’s started upon the execution of a React component function is a side effect if that action is not directly related to the main task of rendering the component’s user interface.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.339.1">
     Here’s a non-exhaustive list of examples of side effects:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.340.1">
      Sending an HTTP request (as shown previously)
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.341.1">
      Storing data to or fetching data from browser storage (for example, via the built-in
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.342.1">
       localStorage
      </span>
     </code>
     <span class="koboSpan" id="kobo.343.1">
      object)
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.344.1">
      Setting timers (via
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.345.1">
       setTimeout()
      </span>
     </code>
     <span class="koboSpan" id="kobo.346.1">
      ) or intervals (via
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.347.1">
       setInterval()
      </span>
     </code>
     <span class="koboSpan" id="kobo.348.1">
      )
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.349.1">
      Logging data to the console via
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.350.1">
       console.log()
      </span>
     </code>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.351.1">
     Not all side effects cause infinite loops, however.
    </span>
    <span class="koboSpan" id="kobo.351.2">
     Such loops only occur if the side effect leads to a state update.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.352.1">
     Here’s an example of a side effect that would not cause an infinite loop:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.353.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.354.1">ControlCenter</span></span><span class="koboSpan" id="kobo.355.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.356.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.357.1">handleStart</span></span><span class="koboSpan" id="kobo.358.1">() {
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.359.1">// do something ...</span></span><span class="koboSpan" id="kobo.360.1">
  }
  </span><span class="hljs-variable"><span class="koboSpan" id="kobo.361.1">console</span></span><span class="koboSpan" id="kobo.362.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.363.1">log</span></span><span class="koboSpan" id="kobo.364.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.365.1">'Component is rendering!'</span></span><span class="koboSpan" id="kobo.366.1">); </span><span class="hljs-comment"><span class="koboSpan" id="kobo.367.1">// this is a side effect!</span></span>
  <span class="hljs-keyword"><span class="koboSpan" id="kobo.368.1">return</span></span><span class="koboSpan" id="kobo.369.1"> (
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.370.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.371.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.372.1">&gt;</span></span>
<span class="language-xml">      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.373.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.374.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.375.1">&gt;</span></span><span class="language-xml"><span class="koboSpan" id="kobo.376.1">Press button to start the review process</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.377.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.378.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.379.1">&gt;</span></span>
<span class="language-xml">      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.380.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.381.1">button</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.382.1">onClick</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.383.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.384.1">{handleStart}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.385.1">&gt;</span></span><span class="language-xml"><span class="koboSpan" id="kobo.386.1">Start</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.387.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.388.1">button</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.389.1">&gt;</span></span>
<span class="language-xml">    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.390.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.391.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.392.1">&gt;</span></span><span class="koboSpan" id="kobo.393.1">
  );
}
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.394.1">
     In this example,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.395.1">
      console.log(…)
     </span>
    </code>
    <span class="koboSpan" id="kobo.396.1">
     is a side effect because it’s executed as part of every component function execution and does not influence the rendered user interface (neither for this specific render cycle nor indirectly for any future render cycles in this case, unlike the previous example with the HTTP request).
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.397.1">
     Of course, using
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.398.1">
      console.log()
     </span>
    </code>
    <span class="koboSpan" id="kobo.399.1">
     like this is not causing any problems.
    </span>
    <span class="koboSpan" id="kobo.399.2">
     During development, it’s quite normal to log messages or data for debugging purposes.
    </span>
    <span class="koboSpan" id="kobo.399.3">
     Side effects aren’t necessarily a problem and, indeed, side effects like this can be used or tolerated.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.400.1">
     But you also
    </span>
    <a id="_idIndexMarker356">
    </a>
    <span class="koboSpan" id="kobo.401.1">
     often need to deal with side effects such as the HTTP request from before.
    </span>
    <span class="koboSpan" id="kobo.401.2">
     Sometimes, you need to fetch data when a component renders—probably not for every render cycle, but typically the first time it is executed (that is, when its generated user interface appears on the screen for the first time).
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.402.1">
     React offers a solution for this kind of problem as well.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-156">
    <span class="koboSpan" id="kobo.403.1">
     Dealing with Side Effects with the useEffect() Hook
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.404.1">
     In order
    </span>
    <a id="_idIndexMarker357">
    </a>
    <span class="koboSpan" id="kobo.405.1">
     to deal with side effects such as the HTTP
    </span>
    <a id="_idIndexMarker358">
    </a>
    <span class="koboSpan" id="kobo.406.1">
     request shown previously in a safe way (that is, without creating an infinite loop), React offers another core Hook: the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.407.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.408.1">
     Hook.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.409.1">
     The first example can be fixed and rewritten like this:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.410.1">import</span></span><span class="koboSpan" id="kobo.411.1"> { useState, </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.412.1">useEffect</span></strong></span><span class="koboSpan" id="kobo.413.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.414.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.415.1">'react'</span></span><span class="koboSpan" id="kobo.416.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.417.1">import</span></span><span class="koboSpan" id="kobo.418.1"> classes </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.419.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.420.1">'./BlogPosts.module.css'</span></span><span class="koboSpan" id="kobo.421.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.422.1">async</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.423.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.424.1">fetchPosts</span></span><span class="koboSpan" id="kobo.425.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.426.1">const</span></span><span class="koboSpan" id="kobo.427.1"> response = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.428.1">await</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.429.1">fetch</span></span><span class="koboSpan" id="kobo.430.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.431.1">'https://jsonplaceholder.typicode.com/posts'</span></span><span class="koboSpan" id="kobo.432.1">);
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.433.1">const</span></span><span class="koboSpan" id="kobo.434.1"> blogPosts = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.435.1">await</span></span><span class="koboSpan" id="kobo.436.1"> response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.437.1">json</span></span><span class="koboSpan" id="kobo.438.1">();
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.439.1">return</span></span><span class="koboSpan" id="kobo.440.1"> blogPosts;
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.441.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.442.1">BlogPosts</span></span><span class="koboSpan" id="kobo.443.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.444.1">const</span></span><span class="koboSpan" id="kobo.445.1"> [loadedPosts, setLoadedPosts] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.446.1">useState</span></span><span class="koboSpan" id="kobo.447.1">([]);
  </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.448.1">useEffect</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.449.1">(</span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.450.1">function</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.451.1"> () {</span></strong></span>
    <span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.452.1">fetchPosts</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.453.1">().</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.454.1">then</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.455.1">(</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.456.1">(</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.457.1">fetchedPosts</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.458.1">) =&gt;</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.459.1">setLoadedPosts</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.460.1">(fetchedPosts));</span></strong></span>
  <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.461.1">}, []);</span></strong></span>
  <span class="hljs-keyword"><span class="koboSpan" id="kobo.462.1">return</span></span><span class="koboSpan" id="kobo.463.1"> (
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.464.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.465.1">ul</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.466.1">className</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.467.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.468.1">{classes.posts}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.469.1">&gt;</span></span>
<span class="language-xml"><span class="koboSpan" id="kobo.470.1">      {loadedPosts.map((post) =&gt; (</span></span>
<span class="language-xml">        </span><span class="hljs-tag"><span class="koboSpan" id="kobo.471.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.472.1">li</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.473.1">key</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.474.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.475.1">{post.id}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.476.1">&gt;</span></span><span class="language-xml"><span class="koboSpan" id="kobo.477.1">{post.title}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.478.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.479.1">li</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.480.1">&gt;</span></span>
<span class="language-xml"><span class="koboSpan" id="kobo.481.1">      ))}</span></span>
<span class="language-xml">    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.482.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.483.1">ul</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.484.1">&gt;</span></span><span class="koboSpan" id="kobo.485.1">
  );
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.486.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.487.1">default</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.488.1">BlogPosts</span></span><span class="koboSpan" id="kobo.489.1">;
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.490.1">
     In this example, the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.491.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.492.1">
     Hook is imported and used to control the side effect (hence the name of the Hook,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.493.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.494.1">
     , as it deals with side effects in React components).
    </span>
    <span class="koboSpan" id="kobo.494.2">
     The
    </span>
    <a id="_idIndexMarker359">
    </a>
    <span class="koboSpan" id="kobo.495.1">
     exact syntax and usage will
    </span>
    <a id="_idIndexMarker360">
    </a>
    <span class="koboSpan" id="kobo.496.1">
     be explored in the next section, but if you use this Hook, you can safely run the example and get some output like this:
    </span>
   </p>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.497.1">
     <img alt="A screenshot of a computer  Description automatically generated" src="image/B31339_08_01.png"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.498.1">
     Figure 8.1: A list of dummy blog posts and no infinite loop of HTTP requests
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.499.1">
     In the preceding screenshot, you can see the list of dummy blog post titles, and most importantly, when inspecting the sent network requests, you find no infinite list of requests.
    </span>
   </p>
   <p class="normal">
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.500.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.501.1">
     is therefore the solution for problems like the one outlined previously.
    </span>
    <span class="koboSpan" id="kobo.501.2">
     It helps you deal with side effects so that you can avoid infinite loops and extract them from your component function’s main process.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.502.1">
     But how does
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.503.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.504.1">
     work, and how is it used correctly?
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-157">
    <span class="koboSpan" id="kobo.505.1">
     How to Use useEffect()
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.506.1">
     As shown in the previous example code snippet,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.507.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.508.1">
     , like all React Hooks, is executed as
    </span>
    <a id="_idIndexMarker361">
    </a>
    <span class="koboSpan" id="kobo.509.1">
     a function inside the component function (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.510.1">
      BlogPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.511.1">
     , in this case).
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.512.1">
     Although, unlike
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.513.1">
      useState()
     </span>
    </code>
    <span class="koboSpan" id="kobo.514.1">
     or
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.515.1">
      useRef()
     </span>
    </code>
    <span class="koboSpan" id="kobo.516.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.517.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.518.1">
     does not return a value, though it does accept an argument (or, actually, two arguments) like those other Hooks.
    </span>
    <span class="koboSpan" id="kobo.518.2">
     The first argument is
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.519.1">
      always
     </span>
    </em>
    <span class="koboSpan" id="kobo.520.1">
     a function.
    </span>
    <span class="koboSpan" id="kobo.520.2">
     In this case, the function passed to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.521.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.522.1">
     is an anonymous function, created via the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.523.1">
      function
     </span>
    </code>
    <span class="koboSpan" id="kobo.524.1">
     keyword.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.525.1">
     Alternatively, you could also provide an anonymous function created as an arrow function (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.526.1">
      useEffect(() =&gt; { … })
     </span>
    </code>
    <span class="koboSpan" id="kobo.527.1">
     ) or point at some named function (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.528.1">
      useEffect(doSomething)
     </span>
    </code>
    <span class="koboSpan" id="kobo.529.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.529.2">
     The only thing that matters is that the first argument passed to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.530.1">
      useEffect()
     </span>
    </code>
    <em class="italic">
     <span class="koboSpan" id="kobo.531.1">
      must
     </span>
    </em>
    <span class="koboSpan" id="kobo.532.1">
     be a function.
    </span>
    <span class="koboSpan" id="kobo.532.2">
     It must not be any other kind of value.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.533.1">
     In the preceding example,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.534.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.535.1">
     also receives a second argument: an empty array (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.536.1">
      []
     </span>
    </code>
    <span class="koboSpan" id="kobo.537.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.537.2">
     The second argument must be an array, but providing it is
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.538.1">
      optional
     </span>
    </em>
    <span class="koboSpan" id="kobo.539.1">
     .
    </span>
    <span class="koboSpan" id="kobo.539.2">
     You could also omit the second argument and just pass the first argument (the function) to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.540.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.541.1">
     .
    </span>
    <span class="koboSpan" id="kobo.541.2">
     However, in most cases, the second argument is needed to achieve the correct behavior.
    </span>
    <span class="koboSpan" id="kobo.541.3">
     Both arguments and their purpose will be explored in greater detail as follows.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.542.1">
     The first argument is a function that will be executed by React.
    </span>
    <span class="koboSpan" id="kobo.542.2">
     It will be executed
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.543.1">
      after
     </span>
    </em>
    <span class="koboSpan" id="kobo.544.1">
     every component render cycle (that is, after every component function execution).
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.545.1">
     In the preceding example, if you only provide this first argument and omit the second, you will therefore still create an infinite loop.
    </span>
    <span class="koboSpan" id="kobo.545.2">
     There will be an (invisible) timing difference because the HTTP request will now be sent after every component function execution (instead of as part of it), but you will still trigger a state change, which will still trigger the component function to execute again.
    </span>
    <span class="koboSpan" id="kobo.545.3">
     Therefore, the effect function will run again, and an infinite loop will be created.
    </span>
    <span class="koboSpan" id="kobo.545.4">
     In this case, the side effect will be extracted out of the component function technically, but the problem with the infinite loop will not be solved:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.546.1">useEffect</span></span><span class="koboSpan" id="kobo.547.1">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.548.1">function</span></span><span class="koboSpan" id="kobo.549.1"> () {
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.550.1">fetchPosts</span></span><span class="koboSpan" id="kobo.551.1">().</span><span class="hljs-title"><span class="koboSpan" id="kobo.552.1">then</span></span><span class="koboSpan" id="kobo.553.1">(</span><span class="hljs-function"><span class="koboSpan" id="kobo.554.1">(</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.555.1">fetchedPosts</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.556.1">) =&gt;</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.557.1">setLoadedPosts</span></span><span class="koboSpan" id="kobo.558.1">(fetchedPosts));
}); </span><span class="hljs-comment"><span class="koboSpan" id="kobo.559.1">// this would cause an infinite loop again!</span></span>
</code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.560.1">
     Extracting side effects out of React component functions is the main job of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.561.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.562.1">
     , and so only the first argument (the function that contains the side effect code) is mandatory.
    </span>
    <span class="koboSpan" id="kobo.562.2">
     But, as mentioned previously, you will also typically need the second argument to control the frequency with which the effect code will be executed, because that’s what the second argument (an array) will do.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.563.1">
     The second parameter received by
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.564.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.565.1">
     is
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.566.1">
      always
     </span>
    </em>
    <span class="koboSpan" id="kobo.567.1">
     an array (unless it’s omitted).
    </span>
    <span class="koboSpan" id="kobo.567.2">
     This array
    </span>
    <a id="_idIndexMarker362">
    </a>
    <span class="koboSpan" id="kobo.568.1">
     specifies the dependencies of the effect function.
    </span>
    <span class="koboSpan" id="kobo.568.2">
     Any dependency specified in this array will, once it changes, cause the effect function to execute again.
    </span>
    <span class="koboSpan" id="kobo.568.3">
     If no array is specified (that is, if the second argument is omitted), the effect function will be executed again for every component function execution:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.569.1">useEffect</span></span><span class="koboSpan" id="kobo.570.1">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.571.1">function</span></span><span class="koboSpan" id="kobo.572.1"> () {
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.573.1">fetchPosts</span></span><span class="koboSpan" id="kobo.574.1">().</span><span class="hljs-title"><span class="koboSpan" id="kobo.575.1">then</span></span><span class="koboSpan" id="kobo.576.1">(</span><span class="hljs-function"><span class="koboSpan" id="kobo.577.1">(</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.578.1">fetchedPosts</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.579.1">) =&gt;</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.580.1">setLoadedPosts</span></span><span class="koboSpan" id="kobo.581.1">(fetchedPosts));
}, []);
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.582.1">
     In the preceding example, the second argument was not omitted, but it’s an empty array.
    </span>
    <span class="koboSpan" id="kobo.582.2">
     This informs React that this effect function has no dependencies.
    </span>
    <span class="koboSpan" id="kobo.582.3">
     Therefore, the effect function will never be executed again.
    </span>
    <span class="koboSpan" id="kobo.582.4">
     Instead, it will only be executed once, when the component is rendered for the first time.
    </span>
    <span class="koboSpan" id="kobo.582.5">
     If you set no dependencies (by providing an empty array), React will execute the effect function
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.583.1">
      once
     </span>
    </em>
    <span class="koboSpan" id="kobo.584.1">
     —directly after the component function was executed for the first time.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.585.1">
     It’s important to note that specifying an empty array is very different from omitting it.
    </span>
    <span class="koboSpan" id="kobo.585.2">
     If it is omitted, no dependency information is provided to React.
    </span>
    <span class="koboSpan" id="kobo.585.3">
     Therefore, React executes the effect function after every component re-evaluation.
    </span>
    <span class="koboSpan" id="kobo.585.4">
     If an empty array is provided instead, you explicitly state that this effect has no dependencies and therefore should only run once.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.586.1">
     This brings up another important question, though: when should you add dependencies?
    </span>
    <span class="koboSpan" id="kobo.586.2">
     And how exactly are dependencies added or specified?
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-158">
    <span class="koboSpan" id="kobo.587.1">
     Effects and Their Dependencies
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.588.1">
     Omitting the second argument to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.589.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.590.1">
     causes the effect function (the first argument) to execute
    </span>
    <a id="_idIndexMarker363">
    </a>
    <span class="koboSpan" id="kobo.591.1">
     after every component function execution.
    </span>
    <span class="koboSpan" id="kobo.591.2">
     Providing an
    </span>
    <a id="_idIndexMarker364">
    </a>
    <span class="koboSpan" id="kobo.592.1">
     empty array causes the effect function to run only once (after the first component function invocation).
    </span>
    <span class="koboSpan" id="kobo.592.2">
     But is that all you can control?
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.593.1">
     No, it isn’t.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.594.1">
     The array passed to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.595.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.596.1">
     can and should contain all variables, constants, or functions that are used inside the effect function—if those variables, constants, or functions were defined inside the component function (or in some parent component function, passed down via props).
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.597.1">
     Consider this example:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.598.1">import</span></span><span class="koboSpan" id="kobo.599.1"> { useState, useEffect } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.600.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.601.1">'react'</span></span><span class="koboSpan" id="kobo.602.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.603.1">import</span></span><span class="koboSpan" id="kobo.604.1"> classes </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.605.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.606.1">'./BlogPosts.module.css'</span></span><span class="koboSpan" id="kobo.607.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.608.1">async</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.609.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.610.1">fetchPosts</span></span><span class="koboSpan" id="kobo.611.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.612.1">url</span></span><span class="koboSpan" id="kobo.613.1">) {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.614.1">const</span></span><span class="koboSpan" id="kobo.615.1"> response = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.616.1">await</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.617.1">fetch</span></span><span class="koboSpan" id="kobo.618.1">(url);
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.619.1">const</span></span><span class="koboSpan" id="kobo.620.1"> blogPosts = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.621.1">await</span></span><span class="koboSpan" id="kobo.622.1"> response.</span><span class="hljs-title"><span class="koboSpan" id="kobo.623.1">json</span></span><span class="koboSpan" id="kobo.624.1">();
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.625.1">return</span></span><span class="koboSpan" id="kobo.626.1"> blogPosts;
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.627.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.628.1">BlogPosts</span></span><span class="koboSpan" id="kobo.629.1">(</span><span class="code-highlight"><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.630.1">{ url }</span></strong></span><span class="koboSpan" id="kobo.631.1">) {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.632.1">const</span></span><span class="koboSpan" id="kobo.633.1"> [loadedPosts, setLoadedPosts] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.634.1">useState</span></span><span class="koboSpan" id="kobo.635.1">([]);
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.636.1">useEffect</span></span><span class="koboSpan" id="kobo.637.1">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.638.1">function</span></span><span class="koboSpan" id="kobo.639.1"> () {
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.640.1">fetchPosts</span></span><span class="koboSpan" id="kobo.641.1">(</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.642.1">url</span></strong></span><span class="koboSpan" id="kobo.643.1">)
     .</span><span class="hljs-title"><span class="koboSpan" id="kobo.644.1">then</span></span><span class="koboSpan" id="kobo.645.1">(</span><span class="hljs-function"><span class="koboSpan" id="kobo.646.1">(</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.647.1">fetchedPosts</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.648.1">) =&gt;</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.649.1">setLoadedPosts</span></span><span class="koboSpan" id="kobo.650.1">(fetchedPosts));
  }, </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.651.1">[url]</span></strong></span><span class="koboSpan" id="kobo.652.1">);
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.653.1">return</span></span><span class="koboSpan" id="kobo.654.1"> (
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.655.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.656.1">ul</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.657.1">className</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.658.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.659.1">{classes.posts}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.660.1">&gt;</span></span>
<span class="language-xml"><span class="koboSpan" id="kobo.661.1">      {loadedPosts.map((post) =&gt; (</span></span>
<span class="language-xml">        </span><span class="hljs-tag"><span class="koboSpan" id="kobo.662.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.663.1">li</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.664.1">key</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.665.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.666.1">{post.id}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.667.1">&gt;</span></span><span class="language-xml"><span class="koboSpan" id="kobo.668.1">{post.title}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.669.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.670.1">li</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.671.1">&gt;</span></span>
<span class="language-xml"><span class="koboSpan" id="kobo.672.1">      ))}</span></span>
<span class="language-xml">    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.673.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.674.1">ul</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.675.1">&gt;</span></span><span class="koboSpan" id="kobo.676.1">
  );
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.677.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.678.1">default</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.679.1">BlogPosts</span></span><span class="koboSpan" id="kobo.680.1">;
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.681.1">
     This example is based on the previous example, but was adjusted in one important place:
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.682.1">
      BlogPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.683.1">
     now accepts a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.684.1">
      url
     </span>
    </code>
    <span class="koboSpan" id="kobo.685.1">
     prop.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.686.1">
     Therefore, this component can now be used and configured by other components.
    </span>
    <span class="koboSpan" id="kobo.686.2">
     Of course, if some other component sets a URL that doesn’t return a list of blog posts, the app won’t work as intended.
    </span>
    <span class="koboSpan" id="kobo.686.3">
     This component therefore might be of limited practical use, but it does show the importance of effect dependencies quite well.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.687.1">
     But if that
    </span>
    <a id="_idIndexMarker365">
    </a>
    <span class="koboSpan" id="kobo.688.1">
     other component changes the URL (e.g., due to some user input there), a new request should be sent, of course.
    </span>
    <span class="koboSpan" id="kobo.688.2">
     So
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.689.1">
      BlogPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.690.1">
     should send another fetch
    </span>
    <a id="_idIndexMarker366">
    </a>
    <span class="koboSpan" id="kobo.691.1">
     request every time the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.692.1">
      url
     </span>
    </code>
    <span class="koboSpan" id="kobo.693.1">
     prop value changes.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.694.1">
     That’s why
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.695.1">
      url
     </span>
    </code>
    <span class="koboSpan" id="kobo.696.1">
     was added to the dependencies array of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.697.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.698.1">
     .
    </span>
    <span class="koboSpan" id="kobo.698.2">
     If the array had been kept empty, the effect function would only run once (as described in the previous section).
    </span>
    <span class="koboSpan" id="kobo.698.3">
     Therefore, any changes to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.699.1">
      url
     </span>
    </code>
    <span class="koboSpan" id="kobo.700.1">
     wouldn’t have any effect (no pun intended) on the effect function or the HTTP request executed as part of that function.
    </span>
    <span class="koboSpan" id="kobo.700.2">
     No new HTTP request would be sent.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.701.1">
     By adding
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.702.1">
      url
     </span>
    </code>
    <span class="koboSpan" id="kobo.703.1">
     to the dependencies array, React registers this value (in this case, a prop value, but any value can be registered) and re-executes the effect function whenever that value changes (that is, whenever a new
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.704.1">
      url
     </span>
    </code>
    <span class="koboSpan" id="kobo.705.1">
     prop value is set by the component that uses
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.706.1">
      BlogPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.707.1">
     ).
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.708.1">
     The most common types of effect dependencies are state values, props, and functions that might be executed inside of the effect function.
    </span>
    <span class="koboSpan" id="kobo.708.2">
     The latter will be analyzed in greater depth later in this chapter.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.709.1">
     As a rule, you should add all values (including functions) that are used inside an effect function to the effect dependencies array.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.710.1">
     With this new knowledge in mind, if you take another look at the preceding
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.711.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.712.1">
     example code, you might spot some missing dependencies:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.713.1">useEffect</span></span><span class="koboSpan" id="kobo.714.1">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.715.1">function</span></span><span class="koboSpan" id="kobo.716.1"> () {
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.717.1">fetchPosts</span></span><span class="koboSpan" id="kobo.718.1">(url)
    .</span><span class="hljs-title"><span class="koboSpan" id="kobo.719.1">then</span></span><span class="koboSpan" id="kobo.720.1">(</span><span class="hljs-function"><span class="koboSpan" id="kobo.721.1">(</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.722.1">fetchedPosts</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.723.1">) =&gt;</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.724.1">setLoadedPosts</span></span><span class="koboSpan" id="kobo.725.1">(fetchedPosts));
}, [url]);
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.726.1">
     Why are
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.727.1">
      fetchPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.728.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.729.1">
      fetchedPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.730.1">
     , and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.731.1">
      setLoadedPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.732.1">
     not added as dependencies?
    </span>
    <span class="koboSpan" id="kobo.732.2">
     These are, after all, values and functions used inside of the effect function.
    </span>
    <span class="koboSpan" id="kobo.732.3">
     The next section will address this in detail.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-159">
    <span class="koboSpan" id="kobo.733.1">
     Unnecessary Dependencies
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.734.1">
     In the
    </span>
    <a id="_idIndexMarker367">
    </a>
    <span class="koboSpan" id="kobo.735.1">
     previous example, it might seem as if
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.736.1">
      fetchPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.737.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.738.1">
      fetchedPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.739.1">
     , and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.740.1">
      setLoadedPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.741.1">
     should be added as dependencies to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.742.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.743.1">
     , as shown here:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.744.1">useEffect</span></span><span class="koboSpan" id="kobo.745.1">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.746.1">function</span></span><span class="koboSpan" id="kobo.747.1"> () {
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.748.1">fetchPosts</span></span><span class="koboSpan" id="kobo.749.1">(url)
    .</span><span class="hljs-title"><span class="koboSpan" id="kobo.750.1">then</span></span><span class="koboSpan" id="kobo.751.1">(</span><span class="hljs-function"><span class="koboSpan" id="kobo.752.1">(</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.753.1">fetchedPosts</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.754.1">) =&gt;</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.755.1">setLoadedPosts</span></span><span class="koboSpan" id="kobo.756.1">(fetchedPosts));
}, [url, fetchPosts, fetchedPosts, setLoadedPosts]);
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.757.1">
     However, for
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.758.1">
      fetchPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.759.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.760.1">
      fetchedPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.761.1">
     , this would be incorrect.
    </span>
    <span class="koboSpan" id="kobo.761.2">
     And for
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.762.1">
      setLoadedPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.763.1">
     , it would be unnecessary.
    </span>
   </p>
   <p class="normal">
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.764.1">
      fetchedPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.765.1">
     should not be added because it’s not an external dependency.
    </span>
    <span class="koboSpan" id="kobo.765.2">
     It’s a local variable (or argument, to be precise), defined and used inside the effect function.
    </span>
    <span class="koboSpan" id="kobo.765.3">
     It’s not defined in the component function to which the effect belongs.
    </span>
    <span class="koboSpan" id="kobo.765.4">
     If you try to add it as a dependency, you’ll get an error:
    </span>
   </p>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.766.1">
     <img alt="A screen shot of a computer  Description automatically generated" src="image/B31339_08_02.png"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.767.1">
     Figure 8.2: An error occurred—fetchedPosts could not be found
    </span>
   </p>
   <p class="normal">
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.768.1">
      fetchPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.769.1">
     , the function that sends the actual HTTP request, is not a function defined inside of the effect function.
    </span>
    <span class="koboSpan" id="kobo.769.2">
     But it still shouldn’t be added because it is defined outside the component function.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.770.1">
     Therefore, there is no way for this function to change.
    </span>
    <span class="koboSpan" id="kobo.770.2">
     It’s defined once (in the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.771.1">
      BlogPosts.jsx
     </span>
    </code>
    <span class="koboSpan" id="kobo.772.1">
     file), and it can’t change.
    </span>
    <span class="koboSpan" id="kobo.772.2">
     That said, this would not be the case if it were defined inside the component function.
    </span>
    <span class="koboSpan" id="kobo.772.3">
     In that case, whenever the component function executes again, the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.773.1">
      fetchPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.774.1">
     function would be recreated as well.
    </span>
    <span class="koboSpan" id="kobo.774.2">
     This is a scenario that will be discussed later in this chapter (in the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.775.1">
      Functions as Dependencies
     </span>
    </em>
    <span class="koboSpan" id="kobo.776.1">
     section).
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.777.1">
     In this example though,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.778.1">
      fetchPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.779.1">
     can’t change.
    </span>
    <span class="koboSpan" id="kobo.779.2">
     Therefore, it doesn’t have to be added as a dependency (and consequently should not be).
    </span>
    <span class="koboSpan" id="kobo.779.3">
     The same would be true for functions, or any kind of values, provided by the browser or third-party packages.
    </span>
    <span class="koboSpan" id="kobo.779.4">
     Any value
    </span>
    <a id="_idIndexMarker368">
    </a>
    <span class="koboSpan" id="kobo.780.1">
     that’s not defined inside a component function shouldn’t be added to the dependencies array.
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.781.1">
       Note
      </span>
     </strong>
    </p>
    <p class="normal">
     <span class="koboSpan" id="kobo.782.1">
      It may be confusing that a function could change—after all, the logic is hardcoded, right?
     </span>
     <span class="koboSpan" id="kobo.782.2">
      But in JavaScript, functions are actually just objects and therefore may change.
     </span>
     <span class="koboSpan" id="kobo.782.3">
      When the code that contains a function is executed again (e.g., a component function being executed again by React), a new function object will be created in memory.
     </span>
    </p>
    <p class="normal">
     <span class="koboSpan" id="kobo.783.1">
      If this is not something you’re familiar with, the following resource should be helpful:
     </span>
     <a href="https://academind.com/tutorials/javascript-functions-are-objects">
      <span class="url">
       <span class="koboSpan" id="kobo.784.1">
        https://academind.com/tutorials/javascript-functions-are-objects
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.785.1">
      .
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.786.1">
     So
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.787.1">
      fetchedPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.788.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.789.1">
      fetchPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.790.1">
     should both not be added (for different reasons).
    </span>
    <span class="koboSpan" id="kobo.790.2">
     What about
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.791.1">
      setLoadedPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.792.1">
     ?
    </span>
   </p>
   <p class="normal">
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.793.1">
      setLoadedPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.794.1">
     is the state updating function returned by
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.795.1">
      useState()
     </span>
    </code>
    <span class="koboSpan" id="kobo.796.1">
     for the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.797.1">
      loadedPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.798.1">
     state value.
    </span>
    <span class="koboSpan" id="kobo.798.2">
     Therefore, like
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.799.1">
      fetchPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.800.1">
     , it’s a function.
    </span>
    <span class="koboSpan" id="kobo.800.2">
     Unlike
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.801.1">
      fetchPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.802.1">
     , though, it’s a function that’s defined inside the component function (because
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.803.1">
      useState()
     </span>
    </code>
    <span class="koboSpan" id="kobo.804.1">
     is called inside the component function).
    </span>
    <span class="koboSpan" id="kobo.804.2">
     It’s a function created by React (since it’s returned by
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.805.1">
      useState()
     </span>
    </code>
    <span class="koboSpan" id="kobo.806.1">
     ), but it’s still a function.
    </span>
    <span class="koboSpan" id="kobo.806.2">
     Theoretically, it should therefore be added as a dependency.
    </span>
    <span class="koboSpan" id="kobo.806.3">
     And indeed, you can add it without any negative consequences.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.807.1">
     But state updating functions returned by
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.808.1">
      useState()
     </span>
    </code>
    <span class="koboSpan" id="kobo.809.1">
     are a special case: React guarantees that those functions will never change or be recreated.
    </span>
    <span class="koboSpan" id="kobo.809.2">
     When the surrounding component function (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.810.1">
      BlogPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.811.1">
     ) is executed again,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.812.1">
      useState()
     </span>
    </code>
    <span class="koboSpan" id="kobo.813.1">
     also executes again.
    </span>
    <span class="koboSpan" id="kobo.813.2">
     However, a new state updating function is only created the first time a component function is called by React.
    </span>
    <span class="koboSpan" id="kobo.813.3">
     Subsequent executions don’t lead to a new state updating function being created.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.814.1">
     Because of this special behavior (i.e., React guaranteeing that the function itself never changes), state updating functions may (and actually should) be omitted from the dependencies array.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.815.1">
     For all these reasons,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.816.1">
      fetchedPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.817.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.818.1">
      fetchPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.819.1">
     , and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.820.1">
      setLoadedPosts
     </span>
    </code>
    <span class="koboSpan" id="kobo.821.1">
     should all not be added to the dependencies array of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.822.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.823.1">
     .
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.824.1">
      url
     </span>
    </code>
    <span class="koboSpan" id="kobo.825.1">
     is the only dependency used by the effect function that may change (that is, when the user enters a new URL into the input field) and therefore should be listed in the array.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.826.1">
     To sum
    </span>
    <a id="_idIndexMarker369">
    </a>
    <span class="koboSpan" id="kobo.827.1">
     it up, when it comes to adding values to the effect dependencies array, there are three kinds of exceptions:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.828.1">
      Internal values (or functions) that are defined and used inside the effect (such as
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.829.1">
       fetchedPosts
      </span>
     </code>
     <span class="koboSpan" id="kobo.830.1">
      )
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.831.1">
      External values that are not defined inside a component function (such as
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.832.1">
       fetchPosts
      </span>
     </code>
     <span class="koboSpan" id="kobo.833.1">
      )
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.834.1">
      State updating functions (such as
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.835.1">
       setLoadedPosts
      </span>
     </code>
     <span class="koboSpan" id="kobo.836.1">
      )
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.837.1">
     In all other cases, if a value is used in the effect function, it
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.838.1">
      must be added
     </span>
    </em>
    <span class="koboSpan" id="kobo.839.1">
     to the dependencies array!
    </span>
    <span class="koboSpan" id="kobo.839.2">
     Omitting values incorrectly can lead to unexpected effect executions (that is, an effect executing too often or not often enough).
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-160">
    <span class="koboSpan" id="kobo.840.1">
     Cleaning Up after Effects
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.841.1">
     To perform a certain task (for example, sending an HTTP request), many effects should simply be
    </span>
    <a id="_idIndexMarker370">
    </a>
    <span class="koboSpan" id="kobo.842.1">
     triggered when their dependencies change.
    </span>
    <span class="koboSpan" id="kobo.842.2">
     While some effects can be re-executed multiple times without issue, there are also effects that, if they execute again before the previous task has finished, are an indication that the task performed needs to be canceled.
    </span>
    <span class="koboSpan" id="kobo.842.3">
     Or, maybe there is some other kind of cleanup work that should be performed when the same effect executes again.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.843.1">
     Here’s an example, where an effect sets a timer:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.844.1">import</span></span><span class="koboSpan" id="kobo.845.1"> { useState, useEffect } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.846.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.847.1">'react'</span></span><span class="koboSpan" id="kobo.848.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.849.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.850.1">Alert</span></span><span class="koboSpan" id="kobo.851.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.852.1">const</span></span><span class="koboSpan" id="kobo.853.1"> [alertDone, setAlertDone] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.854.1">useState</span></span><span class="koboSpan" id="kobo.855.1">(</span><span class="hljs-literal"><span class="koboSpan" id="kobo.856.1">false</span></span><span class="koboSpan" id="kobo.857.1">);
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.858.1">useEffect</span></span><span class="koboSpan" id="kobo.859.1">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.860.1">function</span></span><span class="koboSpan" id="kobo.861.1"> () {
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.862.1">console</span></span><span class="koboSpan" id="kobo.863.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.864.1">log</span></span><span class="koboSpan" id="kobo.865.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.866.1">'Starting Alert Timer!'</span></span><span class="koboSpan" id="kobo.867.1">);
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.868.1">setTimeout</span></span><span class="koboSpan" id="kobo.869.1">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.870.1">function</span></span><span class="koboSpan" id="kobo.871.1"> () {
      </span><span class="hljs-variable"><span class="koboSpan" id="kobo.872.1">console</span></span><span class="koboSpan" id="kobo.873.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.874.1">log</span></span><span class="koboSpan" id="kobo.875.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.876.1">'Timer expired!'</span></span><span class="koboSpan" id="kobo.877.1">);
      </span><span class="hljs-title"><span class="koboSpan" id="kobo.878.1">setAlertDone</span></span><span class="koboSpan" id="kobo.879.1">(</span><span class="hljs-literal"><span class="koboSpan" id="kobo.880.1">true</span></span><span class="koboSpan" id="kobo.881.1">);
    }, </span><span class="hljs-number"><span class="koboSpan" id="kobo.882.1">2000</span></span><span class="koboSpan" id="kobo.883.1">);
  }, []);
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.884.1">return</span></span><span class="koboSpan" id="kobo.885.1"> (
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.886.1">&lt;&gt;</span></span>
<span class="language-xml"><span class="koboSpan" id="kobo.887.1">      {!alertDone &amp;&amp; </span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.888.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.889.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.890.1">&gt;</span></span><span class="language-xml"><span class="koboSpan" id="kobo.891.1">Relax, you still got some time!</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.892.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.893.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.894.1">&gt;</span></span><span class="language-xml"><span class="koboSpan" id="kobo.895.1">}</span></span>
<span class="language-xml"><span class="koboSpan" id="kobo.896.1">      {alertDone &amp;&amp; </span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.897.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.898.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.899.1">&gt;</span></span><span class="language-xml"><span class="koboSpan" id="kobo.900.1">Time to get up!</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.901.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.902.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.903.1">&gt;</span></span><span class="language-xml"><span class="koboSpan" id="kobo.904.1">}</span></span>
<span class="language-xml">    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.905.1">&lt;/&gt;</span></span><span class="koboSpan" id="kobo.906.1">
  );
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.907.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.908.1">default</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.909.1">Alert</span></span><span class="koboSpan" id="kobo.910.1">;
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.911.1">
     This
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.912.1">
      Alert
     </span>
    </code>
    <span class="koboSpan" id="kobo.913.1">
     component
    </span>
    <a id="_idIndexMarker371">
    </a>
    <span class="koboSpan" id="kobo.914.1">
     is used in the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.915.1">
      App
     </span>
    </code>
    <span class="koboSpan" id="kobo.916.1">
     component:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.917.1">import</span></span><span class="koboSpan" id="kobo.918.1"> { useState } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.919.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.920.1">'react'</span></span><span class="koboSpan" id="kobo.921.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.922.1">import</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.923.1">Alert</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.924.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.925.1">'./components/Alert.jsx'</span></span><span class="koboSpan" id="kobo.926.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.927.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.928.1">App</span></span><span class="koboSpan" id="kobo.929.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.930.1">const</span></span><span class="koboSpan" id="kobo.931.1"> [showAlert, setShowAlert] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.932.1">useState</span></span><span class="koboSpan" id="kobo.933.1">(</span><span class="hljs-literal"><span class="koboSpan" id="kobo.934.1">false</span></span><span class="koboSpan" id="kobo.935.1">);
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.936.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.937.1">handleShowAlert</span></span><span class="koboSpan" id="kobo.938.1">() {
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.939.1">// state updating is done by passing a function to setShowAlert</span></span>
    <span class="hljs-comment"><span class="koboSpan" id="kobo.940.1">// because the new state depends on the previous state (it's the opposite)</span></span>
    <span class="hljs-title"><span class="koboSpan" id="kobo.941.1">setShowAlert</span></span><span class="koboSpan" id="kobo.942.1">(</span><span class="hljs-function"><span class="koboSpan" id="kobo.943.1">(</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.944.1">isShowing</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.945.1">) =&gt;</span></span><span class="koboSpan" id="kobo.946.1"> !isShowing);
  }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.947.1">return</span></span><span class="koboSpan" id="kobo.948.1"> (
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.949.1">&lt;&gt;</span></span>
<span class="language-xml">      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.950.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.951.1">button</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.952.1">onClick</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.953.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.954.1">{handleShowAlert}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.955.1">&gt;</span></span>
<span class="language-xml"><span class="koboSpan" id="kobo.956.1">        {showAlert ? </span><span class="koboSpan" id="kobo.956.2">'Hide' : 'Show'} Alert</span></span>
<span class="language-xml">      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.957.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.958.1">button</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.959.1">&gt;</span></span>
<span class="language-xml"><span class="koboSpan" id="kobo.960.1">      {showAlert &amp;&amp; </span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.961.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.962.1">Alert</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.963.1"> /&gt;</span></span><span class="language-xml"><span class="koboSpan" id="kobo.964.1">}</span></span>
<span class="language-xml">    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.965.1">&lt;/&gt;</span></span><span class="koboSpan" id="kobo.966.1">
  );
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.967.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.968.1">default</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.969.1">App</span></span><span class="koboSpan" id="kobo.970.1">;
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.971.1">
     In the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.972.1">
      App
     </span>
    </code>
    <span class="koboSpan" id="kobo.973.1">
     component, the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.974.1">
      Alert
     </span>
    </code>
    <span class="koboSpan" id="kobo.975.1">
     component is shown conditionally.
    </span>
    <span class="koboSpan" id="kobo.975.2">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.976.1">
      showAlert
     </span>
    </code>
    <span class="koboSpan" id="kobo.977.1">
     state is toggled via the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.978.1">
      handleShowAlert
     </span>
    </code>
    <span class="koboSpan" id="kobo.979.1">
     function (which is triggered upon a button click).
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.980.1">
     In the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.981.1">
      Alert
     </span>
    </code>
    <span class="koboSpan" id="kobo.982.1">
     component, a timer is set using
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.983.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.984.1">
     .
    </span>
    <span class="koboSpan" id="kobo.984.2">
     Without
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.985.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.986.1">
     , an infinite loop would be created, since the timer, upon expiration, changes some component state (the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.987.1">
      alertDone
     </span>
    </code>
    <span class="koboSpan" id="kobo.988.1">
     state via the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.989.1">
      setAlertDone
     </span>
    </code>
    <span class="koboSpan" id="kobo.990.1">
     state updating function).
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.991.1">
     The dependency array is an empty array because this effect function does not use any component values, variables, or functions.
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.992.1">
      console.log()
     </span>
    </code>
    <span class="koboSpan" id="kobo.993.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.994.1">
      setTimeout()
     </span>
    </code>
    <span class="koboSpan" id="kobo.995.1">
     are functions built into the browser (and therefore external functions), and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.996.1">
      setAlertDone()
     </span>
    </code>
    <span class="koboSpan" id="kobo.997.1">
     can be omitted because of the reasons mentioned in the previous section.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.998.1">
     If you run
    </span>
    <a id="_idIndexMarker372">
    </a>
    <span class="koboSpan" id="kobo.999.1">
     this app and then start toggling the alert (by clicking the button), you’ll notice strange behavior.
    </span>
    <span class="koboSpan" id="kobo.999.2">
     The timer is set every time the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1000.1">
      Alert
     </span>
    </code>
    <span class="koboSpan" id="kobo.1001.1">
     component is rendered.
    </span>
    <span class="koboSpan" id="kobo.1001.2">
     But it’s not clearing the existing timer.
    </span>
    <span class="koboSpan" id="kobo.1001.3">
     This is due to the fact that multiple timers are running simultaneously, as you can clearly see if you look at the JavaScript console in your browser’s developer tools:
    </span>
   </p>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.1002.1">
     <img alt="A screenshot of a computer  Description automatically generated" src="image/B31339_08_03.png"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.1003.1">
     Figure 8.3: Multiple timers are started
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1004.1">
     This example is deliberately kept simple, but there are other scenarios in which you may have an ongoing HTTP request that should be aborted before a new one is sent.
    </span>
    <span class="koboSpan" id="kobo.1004.2">
     There are cases like that, where an effect should be cleaned up first before it runs again.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1005.1">
     React also provides a solution for those kinds of situations: the effect function passed as a first argument to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1006.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1007.1">
     can return an optional cleanup function.
    </span>
    <span class="koboSpan" id="kobo.1007.2">
     If you do return a function inside your effect function, React will execute that function every time
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1008.1">
      before
     </span>
    </em>
    <span class="koboSpan" id="kobo.1009.1">
     it runs the effect again.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1010.1">
     Here’s the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1011.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1012.1">
     call of the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1013.1">
      Alert
     </span>
    </code>
    <span class="koboSpan" id="kobo.1014.1">
     component with a cleanup function being returned:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.1015.1">useEffect</span></span><span class="koboSpan" id="kobo.1016.1">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1017.1">function</span></span><span class="koboSpan" id="kobo.1018.1"> () {
  </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1019.1">let</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1020.1"> timer;</span></strong></span>
  <span class="hljs-variable"><span class="koboSpan" id="kobo.1021.1">console</span></span><span class="koboSpan" id="kobo.1022.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1023.1">log</span></span><span class="koboSpan" id="kobo.1024.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1025.1">'Starting Alert Timer!'</span></span><span class="koboSpan" id="kobo.1026.1">);
  </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1027.1">timer =</span></strong></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.1028.1">setTimeout</span></span><span class="koboSpan" id="kobo.1029.1">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1030.1">function</span></span><span class="koboSpan" id="kobo.1031.1"> () {
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1032.1">console</span></span><span class="koboSpan" id="kobo.1033.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1034.1">log</span></span><span class="koboSpan" id="kobo.1035.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1036.1">'Timer expired!'</span></span><span class="koboSpan" id="kobo.1037.1">);
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1038.1">setAlertDone</span></span><span class="koboSpan" id="kobo.1039.1">(</span><span class="hljs-literal"><span class="koboSpan" id="kobo.1040.1">true</span></span><span class="koboSpan" id="kobo.1041.1">);
  }, </span><span class="hljs-number"><span class="koboSpan" id="kobo.1042.1">2000</span></span><span class="koboSpan" id="kobo.1043.1">);
  </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1044.1">return</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1045.1">function</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1046.1">() {</span></strong></span>
    <span class="code-highlight"><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.1047.1">clearTimeout</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1048.1">(timer);</span></strong></span>
  <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1049.1">}</span></strong></span><span class="koboSpan" id="kobo.1050.1">
}, []);
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1051.1">
     In this
    </span>
    <a id="_idIndexMarker373">
    </a>
    <span class="koboSpan" id="kobo.1052.1">
     updated example, a new
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1053.1">
      timer
     </span>
    </code>
    <span class="koboSpan" id="kobo.1054.1">
     variable (a local variable that is only accessible inside the effect function) is added.
    </span>
    <span class="koboSpan" id="kobo.1054.2">
     That variable stores a reference to the timer that’s created by
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1055.1">
      setTimeout()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1056.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1056.2">
     This reference can then be used together with
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1057.1">
      clearTimeout()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1058.1">
     to remove a timer.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1059.1">
     The timer is removed in a function returned by the effect function—which is the cleanup function that will be executed automatically by React before the effect function is called the next time.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1060.1">
     You can see the cleanup function in action if you add a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1061.1">
      console.log()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1062.1">
     statement to it:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1063.1">return</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1064.1">function</span></span><span class="koboSpan" id="kobo.1065.1">() {
  </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1066.1">console</span></span><span class="koboSpan" id="kobo.1067.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1068.1">log</span></span><span class="koboSpan" id="kobo.1069.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1070.1">'Cleanup!'</span></span><span class="koboSpan" id="kobo.1071.1">);
  </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1072.1">clearTimeout</span></span><span class="koboSpan" id="kobo.1073.1">(timer);
}
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1074.1">
     In your JavaScript console, this looks as follows:
    </span>
   </p>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.1075.1">
     <img alt="A screenshot of a computer  Description automatically generated" src="image/B31339_08_04.png"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.1076.1">
     Figure 8.4: The cleanup function is executed before the effect runs again
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1077.1">
     In the preceding screenshot, you can see that the cleanup function is executed (indicated by the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1078.1">
      Cleanup!
     </span>
    </code>
    <span class="koboSpan" id="kobo.1079.1">
     log) right before the effect function is executed again.
    </span>
    <span class="koboSpan" id="kobo.1079.2">
     You can also see that the timer is cleared successfully: the first timer never expires (there is no
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1080.1">
      Timer expired!
     </span>
    </code>
    <span class="koboSpan" id="kobo.1081.1">
     log for the first timer in the screenshot).
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1082.1">
     The cleanup
    </span>
    <a id="_idIndexMarker374">
    </a>
    <span class="koboSpan" id="kobo.1083.1">
     function is not executed when the effect function is called for the first time.
    </span>
    <span class="koboSpan" id="kobo.1083.2">
     However, it will be called by React whenever a component that contains an effect unmounts (that is, when it’s removed from the DOM).
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1084.1">
     If an effect has multiple dependencies, the effect function will be executed whenever any of the dependency values change.
    </span>
    <span class="koboSpan" id="kobo.1084.2">
     Therefore, the cleanup function will also be called every time some dependency changes.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-161">
    <span class="koboSpan" id="kobo.1085.1">
     Dealing with Multiple Effects
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.1086.1">
     Thus far, all the
    </span>
    <a id="_idIndexMarker375">
    </a>
    <span class="koboSpan" id="kobo.1087.1">
     examples in this chapter have dealt with only one
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1088.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1089.1">
     call.
    </span>
    <span class="koboSpan" id="kobo.1089.2">
     You are not limited to only one call per component though.
    </span>
    <span class="koboSpan" id="kobo.1089.3">
     You can call
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1090.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1091.1">
     as often as needed—and can therefore register as many effect functions as needed.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1092.1">
     But how many effect functions do you need?
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1093.1">
     You could start putting every side effect into its own
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1094.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1095.1">
     wrapper.
    </span>
    <span class="koboSpan" id="kobo.1095.2">
     You could put every HTTP request, every
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1096.1">
      console.log()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1097.1">
     statement, and every timer into separate effect functions.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1098.1">
     That said, as you can see in some of the previous examples—specifically, the code snippet in the previous section—that’s not necessary.
    </span>
    <span class="koboSpan" id="kobo.1098.2">
     There, you have multiple effects in one
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1099.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1100.1">
     call (three
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1101.1">
      console.log()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1102.1">
     statements and one timer).
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1103.1">
     A better approach would be to split your effect functions by dependencies.
    </span>
    <span class="koboSpan" id="kobo.1103.2">
     If one side effect
    </span>
    <a id="_idIndexMarker376">
    </a>
    <span class="koboSpan" id="kobo.1104.1">
     depends on state A and another side effect depends on state B, you could put them into separate effect functions (unless those two states are related), as shown here:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1105.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1106.1">Demo</span></span><span class="koboSpan" id="kobo.1107.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1108.1">const</span></span><span class="koboSpan" id="kobo.1109.1"> [a, setA] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1110.1">useState</span></span><span class="koboSpan" id="kobo.1111.1">(</span><span class="hljs-number"><span class="koboSpan" id="kobo.1112.1">0</span></span><span class="koboSpan" id="kobo.1113.1">); </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1114.1">// state updating functions aren't called</span></span>
  <span class="hljs-keyword"><span class="koboSpan" id="kobo.1115.1">const</span></span><span class="koboSpan" id="kobo.1116.1"> [b, setB] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1117.1">useState</span></span><span class="koboSpan" id="kobo.1118.1">(</span><span class="hljs-number"><span class="koboSpan" id="kobo.1119.1">0</span></span><span class="koboSpan" id="kobo.1120.1">); </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1121.1">// in this example</span></span>
  <span class="hljs-title"><span class="koboSpan" id="kobo.1122.1">useEffect</span></span><span class="koboSpan" id="kobo.1123.1">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1124.1">function</span></span><span class="koboSpan" id="kobo.1125.1">() {
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1126.1">console</span></span><span class="koboSpan" id="kobo.1127.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1128.1">log</span></span><span class="koboSpan" id="kobo.1129.1">(a);
  }, [a]);  
 
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.1130.1">useEffect</span></span><span class="koboSpan" id="kobo.1131.1">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1132.1">function</span></span><span class="koboSpan" id="kobo.1133.1">() {
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1134.1">console</span></span><span class="koboSpan" id="kobo.1135.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1136.1">log</span></span><span class="koboSpan" id="kobo.1137.1">(b);
  }, [b]);
  </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1138.1">// return some JSX code ...</span></span><span class="koboSpan" id="kobo.1139.1">
}
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1140.1">
     But the best approach is to split your effect functions by logic.
    </span>
    <span class="koboSpan" id="kobo.1140.2">
     If one effect deals with fetching data via an HTTP request and another effect is about setting a timer, it will often make sense to put them into different effect functions (that is, different
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1141.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1142.1">
     calls).
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-162">
    <span class="koboSpan" id="kobo.1143.1">
     Functions as Dependencies
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.1144.1">
     Different
    </span>
    <a id="_idIndexMarker377">
    </a>
    <span class="koboSpan" id="kobo.1145.1">
     effects have different kinds of dependencies, and one common kind of dependency is functions.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1146.1">
     As mentioned previously, functions in JavaScript are just objects.
    </span>
    <span class="koboSpan" id="kobo.1146.2">
     Therefore, whenever some code that contains a function definition is executed, a new function object is created and stored in memory.
    </span>
    <span class="koboSpan" id="kobo.1146.3">
     When calling a function, it’s that specific function object in memory that is executed.
    </span>
    <span class="koboSpan" id="kobo.1146.4">
     In some scenarios (for example, for functions defined in component functions), it’s possible that multiple objects based on the same function code exist in memory.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1147.1">
     Because of this behavior, functions that are referenced in code are not necessarily equal, even if they are based on the same function definition.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1148.1">
     Consider this example:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1149.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1150.1">Alert</span></span><span class="koboSpan" id="kobo.1151.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1152.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1153.1">setAlert</span></span><span class="koboSpan" id="kobo.1154.1">() {
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1155.1">setTimeout</span></span><span class="koboSpan" id="kobo.1156.1">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1157.1">function</span></span><span class="koboSpan" id="kobo.1158.1">() {
      </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1159.1">console</span></span><span class="koboSpan" id="kobo.1160.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1161.1">log</span></span><span class="koboSpan" id="kobo.1162.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1163.1">'Alert expired!'</span></span><span class="koboSpan" id="kobo.1164.1">);
    }, </span><span class="hljs-number"><span class="koboSpan" id="kobo.1165.1">2000</span></span><span class="koboSpan" id="kobo.1166.1">);
  }
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.1167.1">useEffect</span></span><span class="koboSpan" id="kobo.1168.1">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1169.1">function</span></span><span class="koboSpan" id="kobo.1170.1">() {
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1171.1">setAlert</span></span><span class="koboSpan" id="kobo.1172.1">();
  }, [setAlert]);
  </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1173.1">// return some JSX code ...</span></span><span class="koboSpan" id="kobo.1174.1">
}
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1175.1">
     In this
    </span>
    <a id="_idIndexMarker378">
    </a>
    <span class="koboSpan" id="kobo.1176.1">
     example, instead of creating a timer directly inside the effect function, a separate
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1177.1">
      setAlert()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1178.1">
     function is created in the component function.
    </span>
    <span class="koboSpan" id="kobo.1178.2">
     That
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1179.1">
      setAlert()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1180.1">
     function is then used in the effect function passed to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1181.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1182.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1182.2">
     Since that function is used there, and because it’s defined in the component function, it should be added as a dependency to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1183.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1184.1">
     .
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1185.1">
     Another reason for this is that every time the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1186.1">
      Alert
     </span>
    </code>
    <span class="koboSpan" id="kobo.1187.1">
     component function is executed again (e.g., because some state or prop value changes), a new
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1188.1">
      setAlert
     </span>
    </code>
    <span class="koboSpan" id="kobo.1189.1">
     function object will be created.
    </span>
    <span class="koboSpan" id="kobo.1189.2">
     In this example, that wouldn’t be problematic because
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1190.1">
      setAlert
     </span>
    </code>
    <span class="koboSpan" id="kobo.1191.1">
     only contains static code.
    </span>
    <span class="koboSpan" id="kobo.1191.2">
     A new function object created for
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1192.1">
      setAlert
     </span>
    </code>
    <span class="koboSpan" id="kobo.1193.1">
     would work exactly in the same way as the previous one; therefore, it would not matter.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1194.1">
     But now consider this adjusted example:
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.1195.1">
       Note
      </span>
     </strong>
    </p>
    <p class="normal">
     <span class="koboSpan" id="kobo.1196.1">
      The complete app can be found on GitHub at
     </span>
     <a href="https://github.com/mschwarzmueller/book-react-key-concepts-e2/tree/08-effects/examples/function-dependencies">
      <span class="url">
       <span class="koboSpan" id="kobo.1197.1">
        https://github.com/mschwarzmueller/book-react-key-concepts-e2/tree/08-effects/examples/function-dependencies
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.1198.1">
      .
     </span>
    </p>
   </div>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1199.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1200.1">Alert</span></span><span class="koboSpan" id="kobo.1201.1">() {
  </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1202.1">const</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1203.1"> [alertMsg, setAlertMsg] = </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1204.1">useState</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1205.1">(</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1206.1">'Expired!'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1207.1">);</span></strong></span>
  <span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1208.1">function</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1209.1">handleChangeAlertMsg</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1210.1">(</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.1211.1">event</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1212.1">) {</span></strong></span>
    <span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1213.1">setAlertMsg</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1214.1">(event.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1215.1">target</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1216.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1217.1">value</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1218.1">);</span></strong></span>
  <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1219.1">}</span></strong></span>
  <span class="hljs-keyword"><span class="koboSpan" id="kobo.1220.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1221.1">setAlert</span></span><span class="koboSpan" id="kobo.1222.1">() {
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1223.1">setTimeout</span></span><span class="koboSpan" id="kobo.1224.1">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1225.1">function</span></span><span class="koboSpan" id="kobo.1226.1"> () {
      </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1227.1">console</span></span><span class="koboSpan" id="kobo.1228.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1229.1">log</span></span><span class="koboSpan" id="kobo.1230.1">(</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1231.1">alertMsg</span></strong></span><span class="koboSpan" id="kobo.1232.1">);
    }, </span><span class="hljs-number"><span class="koboSpan" id="kobo.1233.1">2000</span></span><span class="koboSpan" id="kobo.1234.1">);
  }
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.1235.1">useEffect</span></span><span class="koboSpan" id="kobo.1236.1">(
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1237.1">function</span></span><span class="koboSpan" id="kobo.1238.1"> () {
      </span><span class="hljs-title"><span class="koboSpan" id="kobo.1239.1">setAlert</span></span><span class="koboSpan" id="kobo.1240.1">();
    },
    []
  );
  </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1241.1">return</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1242.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.1243.1">input</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1244.1">type</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1245.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1246.1">"text"</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1247.1">onChange</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1248.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1249.1">{handleChangeAlertMsg}</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1250.1"> /&gt;</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1251.1">;</span></strong></span><span class="koboSpan" id="kobo.1252.1">
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1253.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1254.1">default</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1255.1">Alert</span></span><span class="koboSpan" id="kobo.1256.1">;
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1257.1">
     Now, a new
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1258.1">
      alertMsg
     </span>
    </code>
    <span class="koboSpan" id="kobo.1259.1">
     state is
    </span>
    <a id="_idIndexMarker379">
    </a>
    <span class="koboSpan" id="kobo.1260.1">
     used for setting the actual alert message that’s logged to the console.
    </span>
    <span class="koboSpan" id="kobo.1260.2">
     In addition, the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1261.1">
      setAlert
     </span>
    </code>
    <span class="koboSpan" id="kobo.1262.1">
     dependency was removed from
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1263.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1264.1">
     .
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1265.1">
     If you run this code, you’ll get the following output:
    </span>
   </p>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.1266.1">
     <img alt="A screenshot of a computer  Description automatically generated" src="image/B31339_08_05.png"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.1267.1">
     Figure 8.5: The console log does not reflect the entered value
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1268.1">
     In this screenshot, you can see that, despite a different value being entered into the input field, the original alert message is output.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1269.1">
     The reason
    </span>
    <a id="_idIndexMarker380">
    </a>
    <span class="koboSpan" id="kobo.1270.1">
     for this behavior is that the new alert message is not picked up.
    </span>
    <span class="koboSpan" id="kobo.1270.2">
     It’s not used because, despite the component function being executed again (because the state changed), the effect is not executed again.
    </span>
    <span class="koboSpan" id="kobo.1270.3">
     And the original execution of the effect still uses the old version of the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1271.1">
      setAlert
     </span>
    </code>
    <span class="koboSpan" id="kobo.1272.1">
     function—the old
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1273.1">
      setAlert
     </span>
    </code>
    <span class="koboSpan" id="kobo.1274.1">
     function object, which has the old alert message locked in.
    </span>
    <span class="koboSpan" id="kobo.1274.2">
     That’s how JavaScript functions work, and that’s why, in this case, the desired result is not achieved.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1275.1">
     The solution to the problem is simple though: add
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1276.1">
      setAlert
     </span>
    </code>
    <span class="koboSpan" id="kobo.1277.1">
     as a dependency to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1278.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1279.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1279.2">
     You should always add all values, variables, or functions used in an effect as dependencies, and this example shows
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1280.1">
      why
     </span>
    </em>
    <span class="koboSpan" id="kobo.1281.1">
     you should do that.
    </span>
    <span class="koboSpan" id="kobo.1281.2">
     Even functions can change.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1282.1">
     If you add
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1283.1">
      setAlert
     </span>
    </code>
    <span class="koboSpan" id="kobo.1284.1">
     to the effect dependency array, you’ll get a different output:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.1285.1">useEffect</span></span><span class="koboSpan" id="kobo.1286.1">(
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1287.1">function</span></span><span class="koboSpan" id="kobo.1288.1"> () {
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1289.1">setAlert</span></span><span class="koboSpan" id="kobo.1290.1">();
  },
  [setAlert]
);
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1291.1">
     Please note that only a pointer to the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1292.1">
      setAlert
     </span>
    </code>
    <span class="koboSpan" id="kobo.1293.1">
     function is added.
    </span>
    <span class="koboSpan" id="kobo.1293.2">
     You don’t execute the function in the dependencies array (that would add the return value of the function as a dependency, which is typically not the goal).
    </span>
   </p>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.1294.1">
     <img alt="A screenshot of a computer  Description automatically generated" src="image/B31339_08_06.png"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.1295.1">
     Figure 8.6: Multiple timers are started
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1296.1">
     Now, a new
    </span>
    <a id="_idIndexMarker381">
    </a>
    <span class="koboSpan" id="kobo.1297.1">
     timer is started for every keystroke, and as a result, the entered message is output in the console.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1298.1">
     Of course, this might also not be the desired result.
    </span>
    <span class="koboSpan" id="kobo.1298.2">
     You might only be interested in the final error message that was entered.
    </span>
    <span class="koboSpan" id="kobo.1298.3">
     This can be achieved by adding a cleanup function to the effect (and adjusting
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1299.1">
      setAlert
     </span>
    </code>
    <span class="koboSpan" id="kobo.1300.1">
     a little bit):
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1301.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1302.1">setAlert</span></span><span class="koboSpan" id="kobo.1303.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1304.1">return</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.1305.1">setTimeout</span></span><span class="koboSpan" id="kobo.1306.1">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1307.1">function</span></span><span class="koboSpan" id="kobo.1308.1"> () {
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1309.1">console</span></span><span class="koboSpan" id="kobo.1310.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1311.1">log</span></span><span class="koboSpan" id="kobo.1312.1">(alertMsg);
  }, </span><span class="hljs-number"><span class="koboSpan" id="kobo.1313.1">2000</span></span><span class="koboSpan" id="kobo.1314.1">);
}
</span><span class="hljs-title"><span class="koboSpan" id="kobo.1315.1">useEffect</span></span><span class="koboSpan" id="kobo.1316.1">(
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1317.1">function</span></span><span class="koboSpan" id="kobo.1318.1"> () {
    </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1319.1">const</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1320.1"> timer = </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1321.1">setAlert</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1322.1">();</span></strong></span>
    <span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1323.1">return</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1324.1">function</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1325.1"> () {</span></strong></span>
      <span class="code-highlight"><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.1326.1">clearTimeout</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1327.1">(timer);</span></strong></span>
    <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1328.1">};</span></strong></span><span class="koboSpan" id="kobo.1329.1">
  },
  [setAlert]
);
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1330.1">
     As shown in the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1331.1">
      Cleaning Up after Effects
     </span>
    </em>
    <span class="koboSpan" id="kobo.1332.1">
     section, the timer is cleared with the help of a timer reference and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1333.1">
      clearTimeout()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1334.1">
     in the effect’s cleanup function.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1335.1">
     After adjusting the code like this, only the final alert message that was entered will be output.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1336.1">
     Seeing the
    </span>
    <a id="_idIndexMarker382">
    </a>
    <span class="koboSpan" id="kobo.1337.1">
     cleanup function in action again is helpful; the main takeaway is the importance of adding all dependencies, though—including function dependencies.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1338.1">
     An alternative to including the function as a dependency would be to move the entire function definition into the effect function, because any value that’s defined and used inside of an effect function must not be added as a dependency:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.1339.1">useEffect</span></span><span class="koboSpan" id="kobo.1340.1">(
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1341.1">function</span></span><span class="koboSpan" id="kobo.1342.1"> () {
    </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1343.1">function</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1344.1">setAlert</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1345.1">() {</span></strong></span>
      <span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1346.1">return</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.1347.1">setTimeout</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1348.1">(</span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1349.1">function</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1350.1"> () {</span></strong></span>
        <span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1351.1">console</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1352.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1353.1">log</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1354.1">(alertMsg);</span></strong></span>
      <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1355.1">}, </span></strong><strong class="hljs-number-slc"><span class="koboSpan" id="kobo.1356.1">2000</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1357.1">);</span></strong></span>
    <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1358.1">}</span></strong></span>
    <span class="hljs-keyword"><span class="koboSpan" id="kobo.1359.1">const</span></span><span class="koboSpan" id="kobo.1360.1"> timer = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1361.1">setAlert</span></span><span class="koboSpan" id="kobo.1362.1">();
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1363.1">return</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1364.1">function</span></span><span class="koboSpan" id="kobo.1365.1"> () {
      </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1366.1">clearTimeout</span></span><span class="koboSpan" id="kobo.1367.1">(timer);
    };
  },
  []
);
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1368.1">
     Of course, you could also get rid of the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1369.1">
      setAlert
     </span>
    </code>
    <span class="koboSpan" id="kobo.1370.1">
     function altogether then and just move the function’s code into the effect function.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1371.1">
     Either way, you will have to add a new dependency,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1372.1">
      alertMsg
     </span>
    </code>
    <span class="koboSpan" id="kobo.1373.1">
     , which is now used inside of the effect function.
    </span>
    <span class="koboSpan" id="kobo.1373.2">
     Even though the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1374.1">
      setAlert
     </span>
    </code>
    <span class="koboSpan" id="kobo.1375.1">
     function isn’t a dependency anymore, you still must add any values used (and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1376.1">
      alertMsg
     </span>
    </code>
    <span class="koboSpan" id="kobo.1377.1">
     is used in the effect function now):
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.1378.1">useEffect</span></span><span class="koboSpan" id="kobo.1379.1">(
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1380.1">function</span></span><span class="koboSpan" id="kobo.1381.1"> () {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1382.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1383.1">setAlert</span></span><span class="koboSpan" id="kobo.1384.1">() {
      </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1385.1">return</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.1386.1">setTimeout</span></span><span class="koboSpan" id="kobo.1387.1">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1388.1">function</span></span><span class="koboSpan" id="kobo.1389.1"> () {
        </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1390.1">console</span></span><span class="koboSpan" id="kobo.1391.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1392.1">log</span></span><span class="koboSpan" id="kobo.1393.1">(alertMsg);
      }, </span><span class="hljs-number"><span class="koboSpan" id="kobo.1394.1">2000</span></span><span class="koboSpan" id="kobo.1395.1">);
    }
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1396.1">const</span></span><span class="koboSpan" id="kobo.1397.1"> timer = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1398.1">setAlert</span></span><span class="koboSpan" id="kobo.1399.1">();
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1400.1">return</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1401.1">function</span></span><span class="koboSpan" id="kobo.1402.1"> () {
      </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1403.1">clearTimeout</span></span><span class="koboSpan" id="kobo.1404.1">(timer);
    };
  },
  </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1405.1">[alertMsg]</span></strong></span><span class="koboSpan" id="kobo.1406.1">
);
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1407.1">
     Hence, this alternative way of writing the code just comes down to personal preferences.
    </span>
    <span class="koboSpan" id="kobo.1407.2">
     It does not reduce the number of dependencies.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1408.1">
     You would
    </span>
    <a id="_idIndexMarker383">
    </a>
    <span class="koboSpan" id="kobo.1409.1">
     get rid of a function dependency if you were to move the function out of the component function.
    </span>
    <span class="koboSpan" id="kobo.1409.2">
     This is because, as mentioned in the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1410.1">
      Unnecessary Dependencies
     </span>
    </em>
    <span class="koboSpan" id="kobo.1411.1">
     section, external dependencies (for example, those built into the browser or defined outside of component functions) should not be added as dependencies.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1412.1">
     However, in the case of the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1413.1">
      setAlert
     </span>
    </code>
    <span class="koboSpan" id="kobo.1414.1">
     function, this is not possible because
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1415.1">
      setAlert
     </span>
    </code>
    <span class="koboSpan" id="kobo.1416.1">
     uses
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1417.1">
      alertMsg
     </span>
    </code>
    <span class="koboSpan" id="kobo.1418.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1418.2">
     Since
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1419.1">
      alertMsg
     </span>
    </code>
    <span class="koboSpan" id="kobo.1420.1">
     is a component state value, the function that uses it must be defined inside the component function; otherwise, it won’t have access to that state value.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1421.1">
     This can all sound quite confusing, but it comes down to two simple rules:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.1422.1">
      Always add all non-external dependencies—no matter whether they’re variables or functions.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.1423.1">
      Functions are just objects and can change if their surrounding code executes again.
     </span>
    </li>
   </ul>
   <h2 class="heading-2" id="_idParaDest-163">
    <span class="koboSpan" id="kobo.1424.1">
     Avoiding Unnecessary Effect Executions
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.1425.1">
     Since
    </span>
    <a id="_idIndexMarker384">
    </a>
    <span class="koboSpan" id="kobo.1426.1">
     all dependencies should be added to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1427.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1428.1">
     , you sometimes end up with code that causes an effect to execute unnecessarily.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1429.1">
     Consider the example component below:
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.1430.1">
       Note
      </span>
     </strong>
    </p>
    <p class="normal">
     <span class="koboSpan" id="kobo.1431.1">
      The
     </span>
     <a id="_idIndexMarker385">
     </a>
     <span class="koboSpan" id="kobo.1432.1">
      complete example can be found on GitHub at
     </span>
     <a href="https://github.com/mschwarzmueller/book-react-key-concepts-e2/tree/08-effects/examples/unnecessary-executions">
      <span class="url">
       <span class="koboSpan" id="kobo.1433.1">
        https://github.com/mschwarzmueller/book-react-key-concepts-e2/tree/08-effects/examples/unnecessary-executions
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.1434.1">
      .
     </span>
    </p>
   </div>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1435.1">import</span></span><span class="koboSpan" id="kobo.1436.1"> { useState, useEffect } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1437.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1438.1">'react'</span></span><span class="koboSpan" id="kobo.1439.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1440.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1441.1">Alert</span></span><span class="koboSpan" id="kobo.1442.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1443.1">const</span></span><span class="koboSpan" id="kobo.1444.1"> [enteredEmail, setEnteredEmail] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1445.1">useState</span></span><span class="koboSpan" id="kobo.1446.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1447.1">''</span></span><span class="koboSpan" id="kobo.1448.1">);
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1449.1">const</span></span><span class="koboSpan" id="kobo.1450.1"> [enteredPassword, setEnteredPassword] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1451.1">useState</span></span><span class="koboSpan" id="kobo.1452.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1453.1">''</span></span><span class="koboSpan" id="kobo.1454.1">);
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1455.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1456.1">handleUpdateEmail</span></span><span class="koboSpan" id="kobo.1457.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1458.1">event</span></span><span class="koboSpan" id="kobo.1459.1">) {
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1460.1">setEnteredEmail</span></span><span class="koboSpan" id="kobo.1461.1">(event.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1462.1">target</span></span><span class="koboSpan" id="kobo.1463.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1464.1">value</span></span><span class="koboSpan" id="kobo.1465.1">);
  }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1466.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1467.1">handleUpdatePassword</span></span><span class="koboSpan" id="kobo.1468.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1469.1">event</span></span><span class="koboSpan" id="kobo.1470.1">) {
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1471.1">setEnteredPassword</span></span><span class="koboSpan" id="kobo.1472.1">(event.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1473.1">target</span></span><span class="koboSpan" id="kobo.1474.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1475.1">value</span></span><span class="koboSpan" id="kobo.1476.1">);
  }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1477.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1478.1">validateEmail</span></span><span class="koboSpan" id="kobo.1479.1">() {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1480.1">if</span></span><span class="koboSpan" id="kobo.1481.1"> (!enteredEmail.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1482.1">includes</span></span><span class="koboSpan" id="kobo.1483.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1484.1">'@'</span></span><span class="koboSpan" id="kobo.1485.1">)) {
      </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1486.1">console</span></span><span class="koboSpan" id="kobo.1487.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1488.1">log</span></span><span class="koboSpan" id="kobo.1489.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1490.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1491.1">Invalid email!'</span></span><span class="koboSpan" id="kobo.1492.1">);
    }
  }
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.1493.1">useEffect</span></span><span class="koboSpan" id="kobo.1494.1">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1495.1">function</span></span><span class="koboSpan" id="kobo.1496.1"> () {
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1497.1">validateEmail</span></span><span class="koboSpan" id="kobo.1498.1">();
  }, [validateEmail]);
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1499.1">return</span></span><span class="koboSpan" id="kobo.1500.1"> (
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1501.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1502.1">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1503.1">&gt;</span></span>
<span class="language-xml">      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1504.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1505.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1506.1">&gt;</span></span>
<span class="language-xml">        </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1507.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1508.1">label</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1509.1">&gt;</span></span><span class="language-xml"><span class="koboSpan" id="kobo.1510.1">Email</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1511.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1512.1">label</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1513.1">&gt;</span></span>
<span class="language-xml">        </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1514.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1515.1">input</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1516.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1517.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1518.1">"email"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1519.1">onChange</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1520.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1521.1">{handleUpdateEmail}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1522.1"> /&gt;</span></span>
<span class="language-xml">      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1523.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1524.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1525.1">&gt;</span></span>
<span class="language-xml">      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1526.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1527.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1528.1">&gt;</span></span>
<span class="language-xml">        </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1529.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1530.1">label</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1531.1">&gt;</span></span><span class="language-xml"><span class="koboSpan" id="kobo.1532.1">Password</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1533.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1534.1">label</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1535.1">&gt;</span></span>
<span class="language-xml">        </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1536.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1537.1">input</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1538.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1539.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1540.1">"password"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1541.1">onChange</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1542.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1543.1">{handleUpdatePassword}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1544.1"> /&gt;</span></span>
<span class="language-xml">      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1545.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1546.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1547.1">&gt;</span></span>
<span class="language-xml">      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1548.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1549.1">button</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1550.1">&gt;</span></span><span class="language-xml"><span class="koboSpan" id="kobo.1551.1">Save</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1552.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1553.1">button</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1554.1">&gt;</span></span>
<span class="language-xml">    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1555.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1556.1">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1557.1">&gt;</span></span><span class="koboSpan" id="kobo.1558.1">
  );
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1559.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1560.1">default</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1561.1">Alert</span></span><span class="koboSpan" id="kobo.1562.1">;
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1563.1">
     This component contains a form with two inputs.
    </span>
    <span class="koboSpan" id="kobo.1563.2">
     The entered values are stored in two different state values (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1564.1">
      enteredEmail
     </span>
    </code>
    <span class="koboSpan" id="kobo.1565.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1566.1">
      enteredPassword
     </span>
    </code>
    <span class="koboSpan" id="kobo.1567.1">
     ).
    </span>
    <span class="koboSpan" id="kobo.1567.2">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1568.1">
      validateEmail()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1569.1">
     function then performs some email validation and, if the email address is invalid, logs a message to the console.
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1570.1">
      validateEmail()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1571.1">
     is executed with the help of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1572.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1573.1">
     .
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1574.1">
     The problem
    </span>
    <a id="_idIndexMarker386">
    </a>
    <span class="koboSpan" id="kobo.1575.1">
     with this code is that the effect function will be executed whenever
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1576.1">
      validateEmail
     </span>
    </code>
    <span class="koboSpan" id="kobo.1577.1">
     changes because, correctly,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1578.1">
      validateEmail
     </span>
    </code>
    <span class="koboSpan" id="kobo.1579.1">
     was added as a dependency.
    </span>
    <span class="koboSpan" id="kobo.1579.2">
     But
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1580.1">
      validateEmail
     </span>
    </code>
    <span class="koboSpan" id="kobo.1581.1">
     will change whenever the component function is executed again.
    </span>
    <span class="koboSpan" id="kobo.1581.2">
     And that’s not just the case for state changes to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1582.1">
      enteredEmail
     </span>
    </code>
    <span class="koboSpan" id="kobo.1583.1">
     but also whenever
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1584.1">
      enteredPassword
     </span>
    </code>
    <span class="koboSpan" id="kobo.1585.1">
     changes—even though that state value is not used at all inside of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1586.1">
      validateEmail
     </span>
    </code>
    <span class="koboSpan" id="kobo.1587.1">
     .
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1588.1">
     This unnecessary effect execution can be avoided with various solutions:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.1589.1">
      You could move the code inside of
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1590.1">
       validateEmail
      </span>
     </code>
     <span class="koboSpan" id="kobo.1591.1">
      directly into the effect function (
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1592.1">
       enteredEmail
      </span>
     </code>
     <span class="koboSpan" id="kobo.1593.1">
      would then be the only dependency of the effect, avoiding effect executions when any other state changes).
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.1594.1">
      You could avoid using
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1595.1">
       useEffect()
      </span>
     </code>
     <span class="koboSpan" id="kobo.1596.1">
      altogether since you could perform email validation inside of
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1597.1">
       handleUpdateEmail
      </span>
     </code>
     <span class="koboSpan" id="kobo.1598.1">
      .
     </span>
     <span class="koboSpan" id="kobo.1598.2">
      Having
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1599.1">
       console.log()
      </span>
     </code>
     <span class="koboSpan" id="kobo.1600.1">
      (a side effect) in there would be acceptable since it wouldn’t cause any harm.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.1601.1">
      You could call
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1602.1">
       validateEmail()
      </span>
     </code>
     <span class="koboSpan" id="kobo.1603.1">
      directly in the component function—since it doesn’t change any state, it wouldn’t trigger an infinite loop.
     </span>
    </li>
   </ul>
   <div class="note">
    <p class="normal">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.1604.1">
       Note
      </span>
     </strong>
    </p>
    <p class="normal">
     <span class="koboSpan" id="kobo.1605.1">
      There is an article in the official React documentation that highlights scenarios where you might not need
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1606.1">
       useEffect()
      </span>
     </code>
     <span class="koboSpan" id="kobo.1607.1">
      :
     </span>
     <a href="https://react.dev/learn/you-might-not-need-an-effect">
      <span class="url">
       <span class="koboSpan" id="kobo.1608.1">
        https://react.dev/learn/you-might-not-need-an-effect
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.1609.1">
      .
     </span>
    </p>
    <p class="normal">
     <span class="koboSpan" id="kobo.1610.1">
      In addition, I created a video that summarizes the most important situations in which you do or do not need
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1611.1">
       useEffect()
      </span>
     </code>
     <span class="koboSpan" id="kobo.1612.1">
      :
     </span>
     <a href="https://www.youtube.com/watch?v=V1f8MOQiHRw">
      <span class="url">
       <span class="koboSpan" id="kobo.1613.1">
        https://www.youtube.com/watch?v=V1f8MOQiHRw
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.1614.1">
      .
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.1615.1">
     Of course, in some other scenarios, you might need to use
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1616.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1617.1">
     .
    </span>
    <span class="koboSpan" id="kobo.1617.2">
     Fortunately, React also offers a solution for situations like this: you can wrap the function that’s used as a dependency with another React Hook, the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1618.1">
      useCallback()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1619.1">
     Hook.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1620.1">
     The
    </span>
    <a id="_idIndexMarker387">
    </a>
    <span class="koboSpan" id="kobo.1621.1">
     adjusted code would look like this:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1622.1">import</span></span><span class="koboSpan" id="kobo.1623.1"> { useState, useEffect, useCallback } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1624.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1625.1">'react'</span></span><span class="koboSpan" id="kobo.1626.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1627.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1628.1">Alert</span></span><span class="koboSpan" id="kobo.1629.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1630.1">const</span></span><span class="koboSpan" id="kobo.1631.1"> [enteredEmail, setEnteredEmail] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1632.1">useState</span></span><span class="koboSpan" id="kobo.1633.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1634.1">''</span></span><span class="koboSpan" id="kobo.1635.1">);
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1636.1">const</span></span><span class="koboSpan" id="kobo.1637.1"> [enteredPassword, setEnteredPassword] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1638.1">useState</span></span><span class="koboSpan" id="kobo.1639.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1640.1">''</span></span><span class="koboSpan" id="kobo.1641.1">);
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1642.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1643.1">handleUpdateEmail</span></span><span class="koboSpan" id="kobo.1644.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1645.1">event</span></span><span class="koboSpan" id="kobo.1646.1">) {
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1647.1">setEnteredEmail</span></span><span class="koboSpan" id="kobo.1648.1">(event.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1649.1">target</span></span><span class="koboSpan" id="kobo.1650.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1651.1">value</span></span><span class="koboSpan" id="kobo.1652.1">);
  }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1653.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1654.1">handleUpdatePassword</span></span><span class="koboSpan" id="kobo.1655.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1656.1">event</span></span><span class="koboSpan" id="kobo.1657.1">) {
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1658.1">setEnteredPassword</span></span><span class="koboSpan" id="kobo.1659.1">(event.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1660.1">target</span></span><span class="koboSpan" id="kobo.1661.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1662.1">value</span></span><span class="koboSpan" id="kobo.1663.1">);
  }
  </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1664.1">const</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1665.1"> validateEmail = </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1666.1">useCallback</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1667.1">(</span></strong></span>
    <span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1668.1">function</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1669.1"> () {</span></strong></span>
      <span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1670.1">if</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1671.1"> (!enteredEmail.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1672.1">includes</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1673.1">(</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1674.1">'@'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1675.1">)) {</span></strong></span>
        <span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1676.1">console</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1677.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1678.1">log</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1679.1">(</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1680.1">'Invalid email!'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1681.1">);</span></strong></span>
      <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1682.1">}</span></strong></span>
    <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1683.1">},</span></strong></span>
    <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1684.1">[enteredEmail]</span></strong></span>
  <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1685.1">);</span></strong></span>
  <span class="hljs-title"><span class="koboSpan" id="kobo.1686.1">useEffect</span></span><span class="koboSpan" id="kobo.1687.1">(
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1688.1">function</span></span><span class="koboSpan" id="kobo.1689.1">() {
      </span><span class="hljs-title"><span class="koboSpan" id="kobo.1690.1">validateEmail</span></span><span class="koboSpan" id="kobo.1691.1">();
    },
    [validateEmail]
  );
  </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1692.1">// return JSX code ...</span></span><span class="koboSpan" id="kobo.1693.1">
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1694.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1695.1">default</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1696.1">Alert</span></span><span class="koboSpan" id="kobo.1697.1">;
</span></code></pre>
   <p class="normal">
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1698.1">
      useCallback()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1699.1">
     , like all React Hooks, is a function that’s executed directly inside the component function.
    </span>
    <span class="koboSpan" id="kobo.1699.2">
     Like
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1700.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1701.1">
     , it accepts two arguments: another function (which can be anonymous or a named function) and a dependencies array.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1702.1">
     Unlike
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1703.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1704.1">
     , though,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1705.1">
      useCallback()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1706.1">
     does not execute the received function.
    </span>
    <span class="koboSpan" id="kobo.1706.2">
     Instead,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1707.1">
      useCallback()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1708.1">
     ensures that a function is only recreated if one of the specified dependencies has changed.
    </span>
    <span class="koboSpan" id="kobo.1708.2">
     The default JavaScript behavior of creating a new function object whenever the surrounding code executes again is (synthetically) disabled.
    </span>
   </p>
   <p class="normal">
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1709.1">
      useCallback()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1710.1">
     returns the latest saved function object.
    </span>
    <span class="koboSpan" id="kobo.1710.2">
     Hence, that returned value (which is a function) is saved in a variable or constant (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1711.1">
      validateEmail
     </span>
    </code>
    <span class="koboSpan" id="kobo.1712.1">
     in the previous example).
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1713.1">
     Since the
    </span>
    <a id="_idIndexMarker388">
    </a>
    <span class="koboSpan" id="kobo.1714.1">
     function wrapped by
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1715.1">
      useCallback()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1716.1">
     now only changes when one of the dependencies changes, the returned function can be used as a dependency for
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1717.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1718.1">
     without executing that effect for all kinds of state changes or component updates.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1719.1">
     In the case of the preceding example, the effect function would then only execute when
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1720.1">
      enteredEmail
     </span>
    </code>
    <span class="koboSpan" id="kobo.1721.1">
     changes—because that’s the only change that will lead to a new
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1722.1">
      validateEmail
     </span>
    </code>
    <span class="koboSpan" id="kobo.1723.1">
     function object being created.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1724.1">
     Another common reason for unnecessary effect execution is the usage of objects as dependencies, like in this example:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1725.1">import</span></span><span class="koboSpan" id="kobo.1726.1"> { useEffect } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1727.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1728.1">'react'</span></span><span class="koboSpan" id="kobo.1729.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1730.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1731.1">Error</span></span><span class="koboSpan" id="kobo.1732.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1733.1">props</span></span><span class="koboSpan" id="kobo.1734.1">) {
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.1735.1">useEffect</span></span><span class="koboSpan" id="kobo.1736.1">(
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1737.1">function</span></span><span class="koboSpan" id="kobo.1738.1"> () {
      </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1739.1">// performing some error logging</span></span>
      <span class="hljs-comment"><span class="koboSpan" id="kobo.1740.1">// in a real app, a HTTP request might be sent to some analytics API</span></span>
      <span class="hljs-variable"><span class="koboSpan" id="kobo.1741.1">console</span></span><span class="koboSpan" id="kobo.1742.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1743.1">log</span></span><span class="koboSpan" id="kobo.1744.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1745.1">'An error occurred!'</span></span><span class="koboSpan" id="kobo.1746.1">);
      </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1747.1">console</span></span><span class="koboSpan" id="kobo.1748.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1749.1">log</span></span><span class="koboSpan" id="kobo.1750.1">(props.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1751.1">message</span></span><span class="koboSpan" id="kobo.1752.1">);
    },
    [props]
  );
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1753.1">return</span></span> <span class="hljs-tag"><span class="koboSpan" id="kobo.1754.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1755.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1756.1">&gt;</span></span><span class="language-xml"><span class="koboSpan" id="kobo.1757.1">{props.message}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1758.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1759.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1760.1">&gt;</span></span><span class="koboSpan" id="kobo.1761.1">;
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1762.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1763.1">default</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1764.1">Error</span></span><span class="koboSpan" id="kobo.1765.1">;
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1766.1">
     This
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1767.1">
      Error
     </span>
    </code>
    <span class="koboSpan" id="kobo.1768.1">
     component is used in another component, the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1769.1">
      Form
     </span>
    </code>
    <span class="koboSpan" id="kobo.1770.1">
     component, like this:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1771.1">import</span></span><span class="koboSpan" id="kobo.1772.1"> { useState } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1773.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1774.1">'react'</span></span><span class="koboSpan" id="kobo.1775.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1776.1">import</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1777.1">Error</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1778.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1779.1">'./Error.jsx'</span></span><span class="koboSpan" id="kobo.1780.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1781.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1782.1">Form</span></span><span class="koboSpan" id="kobo.1783.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1784.1">const</span></span><span class="koboSpan" id="kobo.1785.1"> [enteredEmail, setEnteredEmail] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1786.1">useState</span></span><span class="koboSpan" id="kobo.1787.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1788.1">''</span></span><span class="koboSpan" id="kobo.1789.1">);
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1790.1">const</span></span><span class="koboSpan" id="kobo.1791.1"> [errorMessage, setErrorMessage] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1792.1">useState</span></span><span class="koboSpan" id="kobo.1793.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1794.1">''</span></span><span class="koboSpan" id="kobo.1795.1">);
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1796.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1797.1">handleUpdateEmail</span></span><span class="koboSpan" id="kobo.1798.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1799.1">event</span></span><span class="koboSpan" id="kobo.1800.1">) {
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1801.1">setEnteredEmail</span></span><span class="koboSpan" id="kobo.1802.1">(event.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1803.1">target</span></span><span class="koboSpan" id="kobo.1804.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1805.1">value</span></span><span class="koboSpan" id="kobo.1806.1">);
  }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1807.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1808.1">handleSubmitForm</span></span><span class="koboSpan" id="kobo.1809.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1810.1">event</span></span><span class="koboSpan" id="kobo.1811.1">) {
    event.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1812.1">preventDefault</span></span><span class="koboSpan" id="kobo.1813.1">();
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1814.1">if</span></span><span class="koboSpan" id="kobo.1815.1"> (!enteredEmail.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1816.1">endsWith</span></span><span class="koboSpan" id="kobo.1817.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1818.1">'.com'</span></span><span class="koboSpan" id="kobo.1819.1">)) {
      </span><span class="hljs-title"><span class="koboSpan" id="kobo.1820.1">setErrorMessage</span></span><span class="koboSpan" id="kobo.1821.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1822.1">'Only email addresses ending with .com are accepted!'</span></span><span class="koboSpan" id="kobo.1823.1">);
    }
  }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1824.1">return</span></span><span class="koboSpan" id="kobo.1825.1"> (
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1826.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1827.1">form</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1828.1">onSubmit</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1829.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1830.1">{handleSubmitForm}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1831.1">&gt;</span></span>
<span class="language-xml">      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1832.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1833.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1834.1">&gt;</span></span>
<span class="language-xml">        </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1835.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1836.1">label</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1837.1">&gt;</span></span><span class="language-xml"><span class="koboSpan" id="kobo.1838.1">Email</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1839.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1840.1">label</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1841.1">&gt;</span></span>
<span class="language-xml">        </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1842.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1843.1">input</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1844.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1845.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1846.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1847.1">email"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1848.1">onChange</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1849.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1850.1">{handleUpdateEmail}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1851.1"> /&gt;</span></span>
<span class="language-xml">      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1852.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1853.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1854.1">&gt;</span></span>
<span class="language-xml"><span class="koboSpan" id="kobo.1855.1">      {errorMessage &amp;&amp; </span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1856.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1857.1">Error</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1858.1">message</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1859.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1860.1">{errorMessage}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1861.1"> /&gt;</span></span><span class="language-xml"><span class="koboSpan" id="kobo.1862.1">}</span></span>
<span class="language-xml">      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1863.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1864.1">button</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1865.1">&gt;</span></span><span class="language-xml"><span class="koboSpan" id="kobo.1866.1">Submit</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1867.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1868.1">button</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1869.1">&gt;</span></span>
<span class="language-xml">    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1870.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1871.1">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1872.1">&gt;</span></span><span class="koboSpan" id="kobo.1873.1">
  );
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1874.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1875.1">default</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1876.1">Form</span></span><span class="koboSpan" id="kobo.1877.1">;
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1878.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1879.1">
      Error
     </span>
    </code>
    <span class="koboSpan" id="kobo.1880.1">
     component receives an error message via props (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1881.1">
      props.message
     </span>
    </code>
    <span class="koboSpan" id="kobo.1882.1">
     ) and displays it
    </span>
    <a id="_idIndexMarker389">
    </a>
    <span class="koboSpan" id="kobo.1883.1">
     on the screen.
    </span>
    <span class="koboSpan" id="kobo.1883.2">
     In addition, with the help of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1884.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1885.1">
     , it does some error logging.
    </span>
    <span class="koboSpan" id="kobo.1885.2">
     In this example, the error is simply output to the JavaScript console.
    </span>
    <span class="koboSpan" id="kobo.1885.3">
     In a real app, the error might be sent to some analytics API via an HTTP request.
    </span>
    <span class="koboSpan" id="kobo.1885.4">
     Either way, a side effect that depends on the error message is performed.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1886.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1887.1">
      Form
     </span>
    </code>
    <span class="koboSpan" id="kobo.1888.1">
     component contains two state values, tracking the entered email address as well as the error status of the input.
    </span>
    <span class="koboSpan" id="kobo.1888.2">
     If an invalid input value is submitted,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1889.1">
      errorMessage
     </span>
    </code>
    <span class="koboSpan" id="kobo.1890.1">
     is set and the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1891.1">
      Error
     </span>
    </code>
    <span class="koboSpan" id="kobo.1892.1">
     component is displayed.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1893.1">
     The interesting part about this example is the dependency array of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1894.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1895.1">
     inside the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1896.1">
      Error
     </span>
    </code>
    <span class="koboSpan" id="kobo.1897.1">
     component.
    </span>
    <span class="koboSpan" id="kobo.1897.2">
     It contains the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1898.1">
      props
     </span>
    </code>
    <span class="koboSpan" id="kobo.1899.1">
     object as a dependency (
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1900.1">
      props
     </span>
    </code>
    <span class="koboSpan" id="kobo.1901.1">
     is always an object, grouping all prop values together).
    </span>
    <span class="koboSpan" id="kobo.1901.2">
     When using objects (props or any other object; it does not matter) as dependencies for
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1902.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1903.1">
     , unnecessary effect function executions can be the result.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1904.1">
     You can
    </span>
    <a id="_idIndexMarker390">
    </a>
    <span class="koboSpan" id="kobo.1905.1">
     see this problem in this example.
    </span>
    <span class="koboSpan" id="kobo.1905.2">
     If you run the app and enter an invalid email address (e.g.,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1906.1">
      test@test.de
     </span>
    </code>
    <span class="koboSpan" id="kobo.1907.1">
     ), you’ll notice that subsequent keystrokes in the email input field will cause the error message to be logged (via the effect function) for every keystroke.
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.1908.1">
       Note
      </span>
     </strong>
    </p>
    <p class="normal">
     <span class="koboSpan" id="kobo.1909.1">
      The full code can be found on GitHub at
     </span>
     <a href="https://github.com/mschwarzmueller/book-react-key-concepts-e2/tree/08-effects/examples/objects-as-dependencies">
      <span class="url">
       <span class="koboSpan" id="kobo.1910.1">
        https://github.com/mschwarzmueller/book-react-key-concepts-e2/tree/08-effects/examples/objects-as-dependencies
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.1911.1">
      .
     </span>
    </p>
   </div>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.1912.1">
     <img alt="A screenshot of a computer  Description automatically generated" src="image/B31339_08_07.png"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.1913.1">
     Figure 8.7: A new error message is logged for every keystroke
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1914.1">
     Those extra executions can occur because component re-evaluations (i.e., component functions being invoked again by React) will produce brand-new JavaScript objects.
    </span>
    <span class="koboSpan" id="kobo.1914.2">
     Even if the values of properties of those objects did not change (as in the preceding example), technically, a brand-new object in memory is created by JavaScript.
    </span>
    <span class="koboSpan" id="kobo.1914.3">
     Since the effect depends on the entire object, React only “sees” that there is a new version of that object and hence runs the effect again.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1915.1">
     In the preceding example, a new props object (for the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1916.1">
      Error
     </span>
    </code>
    <span class="koboSpan" id="kobo.1917.1">
     component) is created whenever the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1918.1">
      Form
     </span>
    </code>
    <span class="koboSpan" id="kobo.1919.1">
     component function is called by React—even if the error message (the only prop value that’s set) did not change.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1920.1">
     In this
    </span>
    <a id="_idIndexMarker391">
    </a>
    <span class="koboSpan" id="kobo.1921.1">
     example, that’s just annoying since it clutters the JavaScript console in the developer tools.
    </span>
    <span class="koboSpan" id="kobo.1921.2">
     However, if you were sending an HTTP request to some analytics backend API, it could cause bandwidth problems and make the app slower.
    </span>
    <span class="koboSpan" id="kobo.1921.3">
     Therefore, it’s best if you get into the habit of avoiding unnecessary effect executions as a general rule.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1922.1">
     In the case of object dependencies, the best way to avoid unnecessary executions is to simply destructure the object so that you can pass only those object properties as dependencies that are needed by the effect:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1923.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1924.1">Error</span></span><span class="koboSpan" id="kobo.1925.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1926.1">props</span></span><span class="koboSpan" id="kobo.1927.1">) {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1928.1">const</span></span><span class="koboSpan" id="kobo.1929.1"> { message } = props; </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1930.1">// destructure to extract required properties</span></span>
  <span class="hljs-title"><span class="koboSpan" id="kobo.1931.1">useEffect</span></span><span class="koboSpan" id="kobo.1932.1">(
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1933.1">function</span></span><span class="koboSpan" id="kobo.1934.1"> () {
      </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1935.1">console</span></span><span class="koboSpan" id="kobo.1936.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1937.1">log</span></span><span class="koboSpan" id="kobo.1938.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1939.1">'An error occurred!'</span></span><span class="koboSpan" id="kobo.1940.1">);
      </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1941.1">console</span></span><span class="koboSpan" id="kobo.1942.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1943.1">log</span></span><span class="koboSpan" id="kobo.1944.1">(message);
    },
    </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1945.1">// [props] // don't use the entire props object!</span></span><span class="koboSpan" id="kobo.1946.1">
    [message]
  );
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1947.1">return</span></span> <span class="hljs-tag"><span class="koboSpan" id="kobo.1948.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1949.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1950.1">&gt;</span></span><span class="language-xml"><span class="koboSpan" id="kobo.1951.1">{message}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1952.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1953.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1954.1">&gt;</span></span><span class="koboSpan" id="kobo.1955.1">;
}
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1956.1">
     In the case of props, you could also destructure the object right in the component function parameter list:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1957.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1958.1">Error</span></span><span class="koboSpan" id="kobo.1959.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1960.1">{message}</span></span><span class="koboSpan" id="kobo.1961.1">) {
  </span><span class="hljs-comment"><span class="koboSpan" id="kobo.1962.1">// ...</span></span><span class="koboSpan" id="kobo.1963.1">
}
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1964.1">
     Using this approach, you ensure that only the required property values are set as dependencies.
    </span>
    <span class="koboSpan" id="kobo.1964.2">
     Therefore, even if the object gets recreated, the property value (in this case, the value of the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1965.1">
      message
     </span>
    </code>
    <span class="koboSpan" id="kobo.1966.1">
     property) is the only thing that matters.
    </span>
    <span class="koboSpan" id="kobo.1966.2">
     If it doesn’t change, the effect function won’t be executed again.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-164">
    <span class="koboSpan" id="kobo.1967.1">
     Effects and Asynchronous Code
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.1968.1">
     Some effects deal with asynchronous code (sending HTTP requests is a typical example).
    </span>
    <span class="koboSpan" id="kobo.1968.2">
     When
    </span>
    <a id="_idIndexMarker392">
    </a>
    <span class="koboSpan" id="kobo.1969.1">
     performing asynchronous tasks in effect functions, there is one important rule to keep in mind, though: the effect function itself should not be asynchronous and should not return a promise.
    </span>
    <span class="koboSpan" id="kobo.1969.2">
     This does not mean that you can’t work with promises in effects—you just must not return a promise.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1970.1">
     You might want to use
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1971.1">
      async
     </span>
    </code>
    <span class="koboSpan" id="kobo.1972.1">
     /
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1973.1">
      await
     </span>
    </code>
    <span class="koboSpan" id="kobo.1974.1">
     to simplify asynchronous code, but when doing so inside of an effect function, it’s easy to accidentally return a promise.
    </span>
    <span class="koboSpan" id="kobo.1974.2">
     For example, the following code would work but does not follow best practices:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.1975.1">useEffect</span></span><span class="koboSpan" id="kobo.1976.1">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1977.1">async</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1978.1">function</span></span><span class="koboSpan" id="kobo.1979.1"> () {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1980.1">const</span></span><span class="koboSpan" id="kobo.1981.1"> fetchedPosts = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1982.1">await</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1983.1">fetchPosts</span></span><span class="koboSpan" id="kobo.1984.1">();
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.1985.1">setLoadedPosts</span></span><span class="koboSpan" id="kobo.1986.1">(fetchedPosts);
}, []);
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1987.1">
     Adding the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1988.1">
      async
     </span>
    </code>
    <span class="koboSpan" id="kobo.1989.1">
     keyword in front of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1990.1">
      function
     </span>
    </code>
    <span class="koboSpan" id="kobo.1991.1">
     unlocks the usage of
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1992.1">
      await
     </span>
    </code>
    <span class="koboSpan" id="kobo.1993.1">
     inside the function—which makes dealing with asynchronous code (that is, with promises) more convenient.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1994.1">
     But the effect function passed to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1995.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.1996.1">
     should only return a normal function, if anything.
    </span>
    <span class="koboSpan" id="kobo.1996.2">
     It should not return a promise.
    </span>
    <span class="koboSpan" id="kobo.1996.3">
     Indeed, React actually issues a warning when trying to run code like the preceding snippet:
    </span>
   </p>
   <figure class="mediaobject">
    <em class="italic">
     <span class="koboSpan" id="kobo.1997.1">
      <img alt="A screenshot of a computer code  Description automatically generated" src="image/B31339_08_08.png"/>
     </span>
    </em>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.1998.1">
     Figure 8.8: React shows a warning about async being used in an effect function
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1999.1">
     To avoid this warning, you can use promises without
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.2000.1">
      async
     </span>
    </code>
    <span class="koboSpan" id="kobo.2001.1">
     /
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.2002.1">
      await
     </span>
    </code>
    <span class="koboSpan" id="kobo.2003.1">
     , like this:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.2004.1">useEffect</span></span><span class="koboSpan" id="kobo.2005.1">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2006.1">function</span></span><span class="koboSpan" id="kobo.2007.1"> () {
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.2008.1">fetchPosts</span></span><span class="koboSpan" id="kobo.2009.1">().</span><span class="hljs-title"><span class="koboSpan" id="kobo.2010.1">then</span></span><span class="koboSpan" id="kobo.2011.1">(</span><span class="hljs-function"><span class="koboSpan" id="kobo.2012.1">(</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2013.1">fetchedPosts</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.2014.1">) =&gt;</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2015.1">setLoadedPosts</span></span><span class="koboSpan" id="kobo.2016.1">(fetchedPosts));
}, []);
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.2017.1">
     This works
    </span>
    <a id="_idIndexMarker393">
    </a>
    <span class="koboSpan" id="kobo.2018.1">
     because the effect function doesn’t return the promise.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.2019.1">
     Alternatively, if you want to use
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.2020.1">
      async
     </span>
    </code>
    <span class="koboSpan" id="kobo.2021.1">
     /
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.2022.1">
      await
     </span>
    </code>
    <span class="koboSpan" id="kobo.2023.1">
     , you can create a separate wrapper function inside of the effect function, which is then executed in the effect:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.2024.1">useEffect</span></span><span class="koboSpan" id="kobo.2025.1">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2026.1">function</span></span><span class="koboSpan" id="kobo.2027.1"> () {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2028.1">async</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2029.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2030.1">loadData</span></span><span class="koboSpan" id="kobo.2031.1">() {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2032.1">const</span></span><span class="koboSpan" id="kobo.2033.1"> fetchedPosts = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2034.1">await</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2035.1">fetchPosts</span></span><span class="koboSpan" id="kobo.2036.1">();
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.2037.1">setLoadedPosts</span></span><span class="koboSpan" id="kobo.2038.1">(fetchedPosts);
  }
 
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.2039.1">loadData</span></span><span class="koboSpan" id="kobo.2040.1">();
}, []);
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.2041.1">
     By doing that, the effect function itself is not asynchronous (it does not return a promise), but you can still use
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.2042.1">
      async
     </span>
    </code>
    <span class="koboSpan" id="kobo.2043.1">
     /
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.2044.1">
      await
     </span>
    </code>
    <span class="koboSpan" id="kobo.2045.1">
     .
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-165">
    <span class="koboSpan" id="kobo.2046.1">
     Rules of Hooks
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.2047.1">
     In this chapter, two new Hooks were introduced:
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.2048.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.2049.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.2050.1">
      useCallback()
     </span>
    </code>
    <span class="koboSpan" id="kobo.2051.1">
     .
    </span>
    <span class="koboSpan" id="kobo.2051.2">
     Both Hooks are
    </span>
    <a id="_idIndexMarker394">
    </a>
    <span class="koboSpan" id="kobo.2052.1">
     very important—
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.2053.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.2054.1">
     especially, as this is a Hook you will typically use a lot.
    </span>
    <span class="koboSpan" id="kobo.2054.2">
     Together with
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.2055.1">
      useState()
     </span>
    </code>
    <span class="koboSpan" id="kobo.2056.1">
     (introduced in
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.2057.1">
      Chapter 4
     </span>
    </em>
    <span class="koboSpan" id="kobo.2058.1">
     ,
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.2059.1">
      Working with Events and State
     </span>
    </em>
    <span class="koboSpan" id="kobo.2060.1">
     ) and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.2061.1">
      useRef()
     </span>
    </code>
    <span class="koboSpan" id="kobo.2062.1">
     (introduced in
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.2063.1">
      Chapter 7
     </span>
    </em>
    <span class="koboSpan" id="kobo.2064.1">
     ,
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.2065.1">
      Portals and Refs
     </span>
    </em>
    <span class="koboSpan" id="kobo.2066.1">
     ), you now have a solid set of key React Hooks.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.2067.1">
     When working with
    </span>
    <a id="_idIndexMarker395">
    </a>
    <span class="koboSpan" id="kobo.2068.1">
     React Hooks, there are two rules (the so-called
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.2069.1">
      rules of Hooks
     </span>
    </strong>
    <span class="koboSpan" id="kobo.2070.1">
     ) you must follow:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.2071.1">
      Only call Hooks at the top level of component functions.
     </span>
     <span class="koboSpan" id="kobo.2071.2">
      Don’t call them inside of
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.2072.1">
       if
      </span>
     </code>
     <span class="koboSpan" id="kobo.2073.1">
      statements, loops, or nested functions.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.2074.1">
      Only call Hooks inside of React components or custom Hooks (custom Hooks will be covered in
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.2075.1">
       Chapter 12
      </span>
     </em>
     <span class="koboSpan" id="kobo.2076.1">
      ,
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.2077.1">
       Building Custom React Hooks
      </span>
     </em>
     <span class="koboSpan" id="kobo.2078.1">
      ).
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.2079.1">
     These rules exist because React Hooks won’t work as intended if used in a non-compliant way.
    </span>
    <span class="koboSpan" id="kobo.2079.2">
     Fortunately, React will generate a warning message if you violate one of these rules; hence, you will notice if you accidentally do so.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-166">
    <span class="koboSpan" id="kobo.2080.1">
     Summary and Key Takeaways
    </span>
   </h1>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.2081.1">
      Actions that are not directly related to the main process of a function can be considered side effects.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.2082.1">
      Side effects can be asynchronous tasks (for example, sending an HTTP request), but can also be synchronous (for example,
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.2083.1">
       console.log()
      </span>
     </code>
     <span class="koboSpan" id="kobo.2084.1">
      or accessing browser storage).
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.2085.1">
      Side effects are often needed to achieve a certain goal, but it’s a good idea to separate them from the main process of a function.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.2086.1">
      Side effects can become problematic if they cause infinite loops (because of the update cycles between effect and state).
     </span>
    </li>
    <li class="bulletList">
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.2087.1">
       useEffect()
      </span>
     </code>
     <span class="koboSpan" id="kobo.2088.1">
      is a React Hook that should be used to wrap side effects and perform them in a safe way.
     </span>
    </li>
    <li class="bulletList">
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.2089.1">
       useEffect()
      </span>
     </code>
     <span class="koboSpan" id="kobo.2090.1">
      takes an effect function and an array of effect dependencies.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.2091.1">
      The effect function is executed directly after the component function is invoked (not simultaneously).
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.2092.1">
      Any value, variable, or function used inside of an effect should be added to the dependencies array.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.2093.1">
      Dependency array exceptions are external values (defined outside of a component function), state updating functions, or values defined and used inside of the effect function.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.2094.1">
      If no dependency array is specified, the effect function executes after every component function invocation.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.2095.1">
      If an empty dependency array is specified, the effect function runs once when the component first mounts (that is, when it is created for the first time).
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.2096.1">
      Effect functions can also return optional cleanup functions that are called right before an effect function is executed again (and right before a component is removed from the DOM).
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.2097.1">
      Effect functions must not return promises.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.2098.1">
      For function dependencies,
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.2099.1">
       useCallback()
      </span>
     </code>
     <span class="koboSpan" id="kobo.2100.1">
      can help reduce the number of effect executions.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.2101.1">
      For object dependencies, destructuring can help reduce the number of effect executions.
     </span>
    </li>
   </ul>
   <h2 class="heading-2" id="_idParaDest-167">
    <span class="koboSpan" id="kobo.2102.1">
     What’s Next?
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.2103.1">
     Dealing with side effects is a common problem when building apps because most apps need some kind of side effects (for example, sending an HTTP request) to work correctly.
    </span>
    <span class="koboSpan" id="kobo.2103.2">
     Therefore, side effects aren’t a problem themselves, but they can cause problems (for example, infinite loops) if handled incorrectly.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.2104.1">
     With the knowledge gained in this chapter, you know how to handle side effects efficiently with
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.2105.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.2106.1">
     and related key concepts.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.2107.1">
     Many side effects are triggered because of user input or interaction—for example, because some form was submitted.
    </span>
    <span class="koboSpan" id="kobo.2107.2">
     The next chapter will revisit the concept of form submissions by exploring React’s
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.2108.1">
      form actions
     </span>
    </strong>
    <span class="koboSpan" id="kobo.2109.1">
     feature.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-168">
    <span class="koboSpan" id="kobo.2110.1">
     Test Your Knowledge!
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.2111.1">
     Test your knowledge of the concepts covered in this chapter by answering the following questions.
    </span>
    <span class="koboSpan" id="kobo.2111.2">
     You can then compare your answers to examples that can be found at
    </span>
    <a href="https://github.com/mschwarzmueller/book-react-key-concepts-e2/blob/08-effects/exercises/questions-answers.md">
     <span class="url">
      <span class="koboSpan" id="kobo.2112.1">
       https://github.com/mschwarzmueller/book-react-key-concepts-e2/blob/08-effects/exercises/questions-answers.md
      </span>
     </span>
    </a>
    <span class="koboSpan" id="kobo.2113.1">
     :
    </span>
   </p>
   <ol>
    <li class="numberedList" value="1">
     <span class="koboSpan" id="kobo.2114.1">
      How would you define a side effect?
     </span>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.2115.1">
      What’s a potential problem that could arise with some side effects in React components?
     </span>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.2116.1">
      How does the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.2117.1">
       useEffect()
      </span>
     </code>
     <span class="koboSpan" id="kobo.2118.1">
      Hook work?
     </span>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.2119.1">
      Which values should
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.2120.1">
       not
      </span>
     </em>
     <span class="koboSpan" id="kobo.2121.1">
      be added to the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.2122.1">
       useEffect()
      </span>
     </code>
     <span class="koboSpan" id="kobo.2123.1">
      dependencies array?
     </span>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.2124.1">
      Which value can be returned by the effect function?
     </span>
     <span class="koboSpan" id="kobo.2124.2">
      And which kind of value
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.2125.1">
       must not
      </span>
     </em>
     <span class="koboSpan" id="kobo.2126.1">
      be returned?
     </span>
    </li>
   </ol>
   <h1 class="heading-1" id="_idParaDest-169">
    <span class="koboSpan" id="kobo.2127.1">
     Apply What You Learned
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.2128.1">
     Now that you know about effects, you can add even more exciting features to your React apps.
    </span>
    <span class="koboSpan" id="kobo.2128.2">
     Fetching data via HTTP upon rendering a component is just as easy as accessing browser storage when some state changes.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.2129.1">
     In the following section, you’ll find an activity that allows you to practice working with effects and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.2130.1">
      useEffect()
     </span>
    </code>
    <span class="koboSpan" id="kobo.2131.1">
     .
    </span>
    <span class="koboSpan" id="kobo.2131.2">
     As always, you will need to employ some of the concepts covered in earlier chapters (such as working with state).
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-170">
    <span class="koboSpan" id="kobo.2132.1">
     Activity 8.1: Building a Basic Blog
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.2133.1">
     In this activity, you must add logic to an existing React app to render a list of blog post titles fetched from a backend web API and submit newly added blog posts to that same API.
    </span>
    <span class="koboSpan" id="kobo.2133.2">
     The backend API used is
    </span>
    <a href="https://jsonplaceholder.typicode.com/">
     <span class="url">
      <span class="koboSpan" id="kobo.2134.1">
       https://jsonplaceholder.typicode.com/
      </span>
     </span>
    </a>
    <span class="koboSpan" id="kobo.2135.1">
     , which is a dummy API that doesn’t actually store any data you send to it.
    </span>
    <span class="koboSpan" id="kobo.2135.2">
     It will always return the same dummy data, but it’s perfect for practicing sending HTTP requests.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.2136.1">
     As a bonus, you can also add logic to change the text of the submit button while the HTTP request to save the new blog post is on its way.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.2137.1">
     Use your knowledge about effects and browser-side HTTP requests to implement a solution.
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.2138.1">
       Note
      </span>
     </strong>
    </p>
    <p class="normal">
     <span class="koboSpan" id="kobo.2139.1">
      You can find the starting code for this activity at
     </span>
     <a href="https://github.com/mschwarzmueller/book-react-key-concepts-e2/tree/08-effects/activities/practice-1-start">
      <span class="url">
       <span class="koboSpan" id="kobo.2140.1">
        https://github.com/mschwarzmueller/book-react-key-concepts-e2/tree/08-effects/activities/practice-1-start
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.2141.1">
      .
     </span>
     <span class="koboSpan" id="kobo.2141.2">
      When downloading this code, you’ll always download the entire repository.
     </span>
     <span class="koboSpan" id="kobo.2141.3">
      Make sure to then navigate to the subfolder with the starting code (
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.2142.1">
       activities/practice-1-start
      </span>
     </code>
     <span class="koboSpan" id="kobo.2143.1">
      , in this case) to use the right code snapshot.
     </span>
    </p>
    <p class="normal">
     <span class="koboSpan" id="kobo.2144.1">
      For this activity, you need to know how to send HTTP requests (
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.2145.1">
       GET
      </span>
     </code>
     <span class="koboSpan" id="kobo.2146.1">
      ,
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.2147.1">
       POST
      </span>
     </code>
     <span class="koboSpan" id="kobo.2148.1">
      , and so on) via JavaScript (for example, via the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.2149.1">
       fetch()
      </span>
     </code>
     <span class="koboSpan" id="kobo.2150.1">
      function or with the help of a third-party library).
     </span>
     <span class="koboSpan" id="kobo.2150.2">
      If you don’t have that knowledge yet, this resource can get you started:
     </span>
     <a href="http://packt.link/DJ6Hx">
      <span class="url">
       <span class="koboSpan" id="kobo.2151.1">
        http://packt.link/DJ6Hx
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.2152.1">
      .
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.2153.1">
     After downloading the code and running
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.2154.1">
      npm install
     </span>
    </code>
    <span class="koboSpan" id="kobo.2155.1">
     in the project folder to install all required dependencies, the solution steps are as follows:
    </span>
   </p>
   <ol>
    <li class="numberedList" value="1">
     <span class="koboSpan" id="kobo.2156.1">
      Send a
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.2157.1">
       GET
      </span>
     </code>
     <span class="koboSpan" id="kobo.2158.1">
      HTTP request to the dummy API to fetch blog posts inside the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.2159.1">
       App
      </span>
     </code>
     <span class="koboSpan" id="kobo.2160.1">
      component (when the component is first rendered).
     </span>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.2161.1">
      Display the fetched dummy blog posts on the screen.
     </span>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.2162.1">
      Handle form submissions and send a
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.2163.1">
       POST
      </span>
     </code>
     <span class="koboSpan" id="kobo.2164.1">
      HTTP request (with some dummy data) to the dummy backend API.
     </span>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.2165.1">
      Bonus: Set the button caption to
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.2166.1">
       Saving…
      </span>
     </code>
     <span class="koboSpan" id="kobo.2167.1">
      while the request is on its way (and to
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.2168.1">
       Save
      </span>
     </code>
     <span class="koboSpan" id="kobo.2169.1">
      when it’s not).
     </span>
    </li>
   </ol>
   <p class="normal">
    <span class="koboSpan" id="kobo.2170.1">
     The expected result should be a user interface that looks like this:
    </span>
   </p>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.2171.1">
     <img alt="img" src="image/B31339_08_09.png"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.2172.1">
     Figure 8.9: The final user interface
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.2173.1">
       Note
      </span>
     </strong>
    </p>
    <p class="normal">
     <span class="koboSpan" id="kobo.2174.1">
      You will find a full example solution here:
     </span>
     <a href="https://github.com/mschwarzmueller/book-react-key-concepts-e2/tree/08-effects/activities/practice-1">
      <span class="url">
       <span class="koboSpan" id="kobo.2175.1">
        https://github.com/mschwarzmueller/book-react-key-concepts-e2/tree/08-effects/activities/practice-1
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.2176.1">
      .
     </span>
    </p>
   </div>
  </div>
 </body></html>
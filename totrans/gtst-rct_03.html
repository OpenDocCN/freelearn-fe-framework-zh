<html><head></head><body>
<div id="page" style="height:0pt"/><div class="book" title="Chapter&#xA0;3.&#xA0;Working with Properties"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03" class="calibre1"/>Chapter 3. Working with Properties</h1></div></div></div><p class="calibre7">In this chapter, we will be exploring how to work with ReactJS properties. We're also going to learn how to integrate ReactJS with an external API (Facebook Open-Graph API) and render incoming data in a set of components. This chapter will cover the following items:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Component properties</li><li class="listitem">Component's data flow</li><li class="listitem">Configuring and consuming Facebook Open-Graph API</li><li class="listitem">Creating a ReactJS component and list data from API</li></ul></div></div>

<div class="book" title="Chapter&#xA0;3.&#xA0;Working with Properties">
<div class="book" title="Component properties"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_1"><a id="ch03lvl1sec18" class="calibre1"/>Component properties</h1></div></div></div><p class="calibre7">In the <a id="id89" class="calibre1"/>
<a class="calibre1" title="Chapter 2. Exploring JSX and the ReactJS Anatomy" href="part0020_split_000.html#page">Chapter 2</a>, <span class="strong"><em class="calibre12">Exploring JSX and ReactJS Anatomy</em></span>, we talked a lot about ReactJS properties and used them throughout our examples, but so far, we've just used them like HTML properties. They play a role that is far beyond that. It's common to use them to pass data through your components tree that defines your view; to pass configuration properties that come from parent components; to pass callbacks for user input, UI/custom events that need to be triggered outside, and so on.</p><p class="calibre7">Properties of a ReactJS component can't be changed once the component is rendered in the DOM.</p><p class="calibre7">Properties define the declarative interface of the component. In a <code class="literal">h1</code> element that renders a name property, for example, you can't change this name once it's rendered, unless you create another instance of the component and render it in the same place in the DOM, replacing the old rendered component.</p><div class="informaltable"><pre class="programlisting">var GreetingsComponent = React.createClass({
  render: function() {
    return (
      &lt;h1&gt;Hello {this.props.name}!&lt;/h1&gt;
    );
  }
});

<span class="strong"><strong class="calibre8">React.render(&lt;GreetingsComponent name="Readers" /&gt;, document.body);</strong></span>
<span class="strong"><strong class="calibre8">// instead of rendering on the body rendering in a specific id ('app)</strong></span>
<span class="strong"><strong class="calibre8">React.render(&lt;GreetingsComponent name="Folks" /&gt;, document.getElemenById('app'));</strong></span>
</pre></div><p class="calibre7">This happens <a id="id90" class="calibre1"/>because ReactJS represents the state of your component at any point in time and not only at initialization. Consider the following example:</p><div class="informaltable"><pre class="programlisting">var CustomInput = React.createClass({
  render: function() {
    return (
      &lt;input type="text" value={this.props.text} /&gt;
    );
  }
});

React.render(&lt;CustomInput text="Learning ReactJS" /&gt;, document.body);</pre></div><p class="calibre7">The input text being rendered is considered to be a controlled component because it won't change the value even if you try typing on it. If we don't specify the <code class="literal"> valu</code>e property of the input then it is considered to be an uncontrolled component. Controlled components have their data updated via the ReactJS data flow and component cycle. However, if you did not specify the value property, the value property would not be controlled by ReactJS and would exist externally to the ReactJS data flow. The correct way to change the value from forms inputs or other components is to set up <code class="literal">state</code> for them, which will be described in more detail in the next chapter.</p></div></div>

<div class="book" title="Chapter&#xA0;3.&#xA0;Working with Properties">
<div class="book" title="Component properties">
<div class="book" title="Data flow with properties"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec28" class="calibre1"/>Data flow with properties</h2></div></div></div><p class="calibre7">One <a id="id91" class="calibre1"/>of the ReactJS fundamentals and best practices is to pass data to nested components through properties. In that way, the children components can have the single responsibility of rendering only what they have to render and pass the job to further components, thus ensuring the separation of concerns. It's also used for configuring nested components so that the ones at the top of the hierarchy can say what particular aspects the children components should have, just by passing properties. It's also common to define functions on parent nodes and pass them to children as a callback to be triggered whenever the child component wants, improving the component reusability and testability.</p><p class="calibre7">Let's demonstrate a small example simulating a static to-do list. The list is split into small components that render only the necessary and pass properties down to children components, defining<a id="id92" class="calibre1"/> the whole functionality of the view. This is what it is going to render at the end:</p><div class="mediaobject"><img src="../images/00005.jpeg" alt="Data flow with properties" class="calibre9"/></div><p class="calibre10"> </p><p class="calibre7">We're going to break our view into smaller components and will start doing it from the innermost one to the  topmost one. Before we start, let's discuss a little more about each component and its role in view:</p><div class="book"><ul class="itemizedlist"><li class="listitem"><code class="literal">TaskList</code> – This component represents a list (the <code class="literal">ul </code>element) that accepts an array of tasks to be rendered. It iterates through the tasks array creating a <code class="literal">TaskItem</code> component. Along with passing the task details through a property, to be rendered in the <code class="literal">TaskItem</code> component, it also passes some function callbacks that, for now, will just fake some operations to simplify the demonstration.</li><li class="listitem"><code class="literal">TaskItem</code> – This component represent a single task (the <code class="literal">li</code> element) that renders the task name, an input checkbox representing whether the task is completed, and a button to remove the task. Again, the input and the button will just log some text to simplify the demonstration.<p class="calibre24">The <code class="literal">TaskItem</code> component should look like this:</p><div class="informaltable"><pre class="programlisting">var TaskItem = React.createClass({
  render: function() {
    var task = this.props.task;

    return (
      &lt;li&gt;
        &lt;span&gt;{task.name}&lt;/span&gt;
        &lt;div&gt;
          &lt;input type="checkbox"

               if (task.completed) {checked = "checked<span class="strong"><strong class="calibre8">";</strong></span>} else { checked =  "";<span class="strong"><strong class="calibre8">
</strong></span>}
            onChange={this.props.markTaskComplete

          &lt;button onClick={this.props.removeTask}&gt;Remove&lt;/button&gt;
        &lt;/div&gt;
      &lt;/li&gt;
    );
  }
});</pre></div><p class="calibre24">The <code class="literal">TaskList</code> component should be<a id="id93" class="calibre1"/> as follows:</p><div class="informaltable"><pre class="programlisting">var TaskList = React.createClass({
  markTaskCompleted: function (task) {
    console.log('task ' + task.name + ' has been completed!');
  },

  removeTask: function (task) {
    console.log('task ' + task.name + ' has been removed!');
  },

  render: function() {
/*The map() method creates a new array with the results of calling a provided     function on every element in this array. Here this.props.tasks will create a new array, with the callback as task. (source  HYPERLINK "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/map HYPERLINK "").  */
    var taskItems = this.props.tasks.map(function (task) {
      return &lt;TaskItem task={task}
                       markTaskCompleted={this.markTaskCompleted}
                       removeTask={this.removeTask} /&gt;;
    }.bind(this));
/*The bind() method creates a new function that, when called, has its this keyword set to the provided value, with a given sequence of arguments (if any) this (source  HYPERLINK "https://developer.mozilla.org/en-
US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind). .bind is used in this case to simply more arguments and esnsure a parent chind relationship, which is not new to ReactJS but a concenpt of core Javascript. */
    return (
      &lt;ul&gt;
        {taskItems}
      &lt;/ul&gt;
    );
  }
});</pre></div></li></ul></div><p class="calibre7">The task list <a id="id94" class="calibre1"/>has a bit more functionality and code. It takes care of rendering the list of tasks and handles operations on it. This is a very common pattern in ReactJS, to maintain the control of your model objects in a single place that is, of course, if it's responsibility for doing so. In a more complicated scenario, you would have some "controllers" or "containers" (as they like to call them in the ReactJS community), each one having its own task and encapsulating what they are responsible for. Thus, all of the containers are having their own responsibility and not interfering with each other.</p><p class="calibre7">There is just one missing part in our static task list example, which is to render the component in an HTML element:</p><div class="informaltable"><pre class="programlisting">var tasks = [
  { name: 'Write this book with love &lt;3', completed: false },
  { name: 'Learn isomorphic web apps', completed: false },
  { name: 'Study FLUX architecture', completed: true },
];

React.render(&lt;TaskList tasks={tasks} /&gt;, document.body);</pre></div><p class="calibre7">We're passing some static tasks to the list to explain how properties work and some practices on how to use them. We think that small examples as to-do/tasks/hello-worlds don't represent the real-world problems that we face day by day; although they are great for starting to learn a tool functionality, they fail when you try to make more reasonable examples that have asynchronous operations, deal with outside APIs, authentication, and so on. For that reason, the following topics will cover how to set up our real scenario applications using Facebook API (also known as Open-Graph API), logins into Facebook, and lists that a logged-in user likes.</p></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Configuring Facebook Open-Graph API"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec19" class="calibre1"/>Configuring Facebook Open-Graph API</h1></div></div></div><p class="calibre7">In the <a id="id95" class="calibre1"/>following sections, we're going to learn more about Facebook Open-Graph API and configure it so we can start crafting some code to build our awesome application.</p></div>

<div class="book" title="Configuring Facebook Open-Graph API">
<div class="book" title="What it is and how to configure it"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch03lvl2sec29" class="calibre1"/>What it is and how to configure it</h2></div></div></div><p class="calibre7"><span class="strong"><strong class="calibre8">Facebook Open-Graph API</strong></span> is a service for getting, editing, and adding common Facebook <a id="id96" class="calibre1"/>resources. Some of its functionalities that you can use in your own application are: login; request user-specific resource permissions such as manage events, post to friends walls, and the list goes on. It has a bunch of functionalities that you can use and integrate your app with. One of the main functionalities used by third-party applications is, of course, the login integration. You can use it just as a login platform, for instance, if you don't want or don't have time to build one.</p><div class="informaltable" title="Note"><h3 class="title2"><a id="tip02" class="calibre1"/>Tip</h3><p class="calibre7">The<a id="id97" class="calibre1"/> API documentation is provided at <a class="calibre1" href="https://developers.facebook.com/">https://developers.facebook.com/</a> and it's recommended that you check this out.</p></div><p class="calibre7">If you want to test some requests to their API, without having to start developing an application from scratch, you can use a very useful tool called <span class="strong"><em class="calibre12">Graph API Explorer</em></span>. It's commonly used for testing out an endpoint before developing it or just checking how the response JSON result is returned. Graph API Explorer can be found at the <span class="strong"><strong class="calibre8">Tools &amp; Support</strong></span> menu item at the top header. This is what the tool looks like:</p><div class="mediaobject"><img src="../images/00006.jpeg" alt="What it is and how to configure it" class="calibre9"/></div><p class="calibre10"> </p><p class="calibre7">Most of the resources available on Facebook Open-Graph API require authorization. Just a few are available without having to provide an <span class="strong"><strong class="calibre8">access token</strong></span>. An access token is a kind of ticket used<a id="id98" class="calibre1"/> by your application to act on the user's behalf, so you can get or submit data. Basically, you ask Facebook for some user's permissions; Facebook opens a popup asking the user to log in and shows the permissions your app is requesting; once the user allows them, Facebook will send back the user information/object to your page with the generated access token. From that time on, you have access to other Open-Graph API resources<a id="id99" class="calibre1"/> that your app needs. You just have to <a id="id100" class="calibre1"/>provide this token to every subsequent request you make. This is how <span class="strong"><em class="calibre12">OAuth</em></span> authorization standards work but this book will not cover OAuth in detail, as it is not the purpose of this book.</p><div class="informaltable" title="Note"><h3 class="title2"><a id="note05" class="calibre1"/>Note</h3><p class="calibre7">You can<a id="id101" class="calibre1"/> find more details about <span class="strong"><em class="calibre12">OAuth</em></span> at <a class="calibre1" href="http://oauth.net/2/">http://oauth.net/2/</a>.</p></div><p class="calibre7">In Graph API Explorer, you can get an access token by clicking on the button <span class="strong"><strong class="calibre8">Get Access Token</strong></span>. This will open a popup with a bunch of permissions that your operation can use. Once you have selected the permissions you want, Graph API Explorer will show a popup requesting you to confirm the permissions requested. This process generates a new access token that allows you to make request actions to those restricted resources. Try checking out the <code class="literal">user_likes</code> permission and requesting your user's list of likes through the endpoint <code class="literal">/me/likes</code>:</p><div class="mediaobject"><img src="../images/00007.jpeg" alt="What it is and how to configure it" class="calibre9"/></div><p class="calibre10"> </p><p class="calibre7">You will probably see a JSON result in the box below the <span class="strong"><strong class="calibre8">Submit</strong></span> button.</p><p class="calibre7">This works very well when in Graph API Explorer but this is used just for testing purposes. In order to make that work, we have to create an application (APP-ID) at the Facebook developers site. This follows the OAuth standards specification and allows the user, who is logging in to your app, to know more about your application before granting access. In order to create an application in Facebook and obtain this APP-ID, go to the <span class="strong"><strong class="calibre8">My Apps</strong></span> menu at the header of the page; there will be an option for creating a new app.</p><div class="mediaobject"><img src="../images/00008.jpeg" alt="What it is and how to configure it" class="calibre9"/></div><p class="calibre10"> </p><p class="calibre7">At the time<a id="id102" class="calibre1"/> of writing this book, the Facebook<a id="id103" class="calibre1"/> Open-Graph API recommended version was v.2.2.</p></div><div class="book" title="Creating an app-id on the Facebook developers site"><div class="book"><div class="book"><div class="book"><div class="calibre11" id="calibre_pb_2"/>
</div></div></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Configuring Facebook Open-Graph API">
<div class="book" title="Creating an app-id on the Facebook developers site">
<div class="book">
<div class="book">
<div class="book">
<h2 class="title1" id="calibre_pb_3"><a id="ch03lvl2sec30" class="calibre1"/>Creating an app-id on the Facebook developers site</h2></div></div></div><p class="calibre7">When you click the <span class="strong"><strong class="calibre8">Add a New App</strong></span> button <a id="id104" class="calibre1"/>shown in the preceding image, Facebook will ask you which type of application you need.</p><div class="mediaobject"><img src="../images/00009.jpeg" alt="Creating an app-id on the Facebook developers site" class="calibre9"/></div><p class="calibre10"> </p><p class="calibre7">Choose the <span class="strong"><strong class="calibre8">Website</strong></span> option, which indicates our app is going to run in a separate web page with no Facebook content around. After that, give it a fancy, original, and unpredictable name as I did: <code class="literal">learning-reactjs</code>. Once it's done, you will be redirected to the app details and configuration page that looks something like this:</p><div class="mediaobject"><img src="../images/00010.jpeg" alt="Creating an app-id on the Facebook developers site" class="calibre9"/></div><p class="calibre10"> </p><p class="calibre7">Yay! We have our app-id ready; now we<a id="id105" class="calibre1"/> can use it to make request calls to Facebook Open-Graph API.</p><div class="informaltable" title="Note"><h3 class="title2"><a id="note06" class="calibre1"/>Note</h3><p class="calibre7">One important thing to note is that some permissions require further analysis from Facebook before going into production. As we are going to use this just for getting the data of our own user, it's OK. If you try to log in with a different user, it won't be possible as the <code class="literal">user_likes</code> permission requires your application to be submitted to analysis and doing that takes lots of time and should be done just in case you want to put your application into production.</p></div></div></div>

<div class="book" title="Configuring Facebook Open-Graph API">
<div class="book" title="Open-Graph JavaScript SDK"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec31" class="calibre1"/>Open-Graph JavaScript SDK</h2></div></div></div><p class="calibre7">Facebook <a id="id106" class="calibre1"/>Open-Graph API provides SDKs for common programming languages to ease the pain of consuming their resources. The <a id="id107" class="calibre1"/>JavaScript SDK can be found at <a class="calibre1" href="https://developers.facebook.com/docs/javascript">https://developers.facebook.com/docs/javascript</a>. Their documentation (<a class="calibre1" href="https://developers.facebook.com/docs/javascript/quickstart/v2.5">https://developers.facebook.com/docs/javascript/quickstart/v2.5</a>) is comprehensive<a id="id108" class="calibre1"/> and they have tutorials such as logging in, working with multiple requests, and so on. If you're considering taking an advanced course in learning Open-Graph API using JavaScript SDK, it is worth taking a look afterward.</p><p class="calibre7">Just to<a id="id109" class="calibre1"/> recap what we're about to do: we're going to create a simple HTML page that will load the Facebook JavaScript SDK. After that, we're going to log in to Facebook and request our logged-in user list of likes and pass it to a ReactJS component, which we will also create, through properties.</p><p class="calibre7">The Facebook JavaScript SDK needs to be loaded in the background, without the waiting time (asynchronously) after the page finishes loading. In order to do that, we need to create a <code class="literal">script</code> HTML element, put its <code class="literal">src </code>(source) attribute to point to the SDK script, and, finally, insert that into the DOM. Fortunately, the SDK page has an example ready to use and you just need to replace the <code class="literal">APP-ID</code> property within it. We are going to use their example. This is what the script looks like:</p><div class="informaltable"><pre class="programlisting">&lt;script&gt;
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '784445024959168',
      xfbml      : true,
      version    : 'v2.2'
    });
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;

     js.src = "//connect.facebook.net/en_US/sdk/debug.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));
&lt;/script&gt;</pre></div><div class="informaltable" title="Note"><h3 class="title2"><a id="note07" class="calibre1"/>Note</h3><p class="calibre7"><code class="literal">window.fbAsyncInit</code> is an initialization function with your Facebook <code class="literal">appId</code> and other details.</p></div><p class="calibre7">Once the asynchronous initialization is done, if the concerned element is found, then JavaScript(js) connects with <code class="literal">//connect.facebook.net/en_US/sdk/debug.js</code>.</p><p class="calibre7">We need to change the <code class="literal">appId</code> parameter to <code class="literal">t Facebook-app-id</code>.</p><p class="calibre7">So, let's get started by creating an <code class="literal">index.html</code> file inside a separate folder to organize things. The <a id="id110" class="calibre1"/>page will be like this:</p><div class="informaltable"><pre class="programlisting">&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;Rahh&lt;/title&gt;
    &lt;script src="http://fb.me/react-0.12.2.js"&gt;&lt;/script&gt;
    &lt;script src="http://fb.me/JSXTransformer-0.12.2.js"&gt;&lt;/script&gt;
  &lt;/head&gt;
  &lt;body&gt;
    
    &lt;h1&gt;Facebook User's list of likes&lt;/h1&gt;
    &lt;a onClick='logout()' href='#'&gt;Logout&lt;/a&gt;
    &lt;div id="main"&gt;&lt;/div&gt;

    &lt;script&gt;
      window.fbAsyncInit = function() {
        FB.init({
          appId      : '784445024959168',
          xfbml      : true,
          version    : 'v2.2'
        });

        checkLoginStatusAndLoadUserLikes();
      };

      (function(d, s, id){
         var js, fjs = d.getElementsByTagName(s)[0];
         if (d.getElementById(id)) {return;}
         js = d.createElement(s); js.id = id;
         //js.src = "//connect.facebook.net/en_US/sdk.js";
         js.src = "//connect.facebook.net/en_US/sdk/debug.js";
         fjs.parentNode.insertBefore(js, fjs);
       }(document, 'script', 'facebook-jssdk'));
    &lt;/script&gt;

    &lt;script type="text/jsx" src="index.jsx"&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre></div><p class="calibre7">We are commenting the <code class="literal">js.src</code> line and duplicating it with a debug JavaScript file. This helps with finding errors and debugging your script.</p><div class="informaltable" title="Note"><h3 class="title2"><a id="note08" class="calibre1"/>Note</h3><p class="calibre7">A <span class="strong"><strong class="calibre8">Content Delivery Network</strong></span> or <span class="strong"><strong class="calibre8">Content Distribution Network</strong></span> (<span class="strong"><strong class="calibre8">CDN</strong></span>) is a globally <a id="id111" class="calibre1"/>distributed <a id="id112" class="calibre1"/>network of proxies. Source: https://en.wikipedia.org/wiki/Server_(computing)</p><p class="calibre7">Servers are<a id="id113" class="calibre1"/> deployed in multiple data centers. Source: <a class="calibre1" href="https://en.wikipedia.org/wiki/Data_center">https://en.wikipedia.org/wiki/Data_center</a></p><p class="calibre7">The goal<a id="id114" class="calibre1"/> of a CDN is to serve content to end users with high availability and high performance. Source <a class="calibre1" href="https://en.wikipedia.org/wiki/Content_delivery_network">https://en.wikipedia.org/wiki/Content_delivery_network</a></p></div><p class="calibre7">First, we <a id="id115" class="calibre1"/>need to reference ReactJS dependencies and we are referencing the CDN version ones to make it easier to demonstrate and for learning purposes. After referencing the dependencies, we create some HTML elements, a title, a logout anchor to log out from Facebook, and a <code class="literal">div</code> that will be the host for the ReactJS component to be rendered. Later, we configure the Facebook Open-Graph JavaScript SDK as explained before, but with one extra command, <code class="literal">checkLoginStatusAndLoadUserLikes();</code>, that will be explained soon. Lastly, we reference our <code class="literal">index.jsx</code> file that will contain the magic to make it all happen.</p><p class="calibre7">We put the <code class="literal">checkLoginStatusAndLoadUserLikes</code> call within the <code class="literal">fbAsyncInit </code>function because the Open-Graph SDK JavaScript triggers that function once it is loaded, so this is the right place to call Open-Graph API calls. Continuing with our development, inside our <code class="literal">index.jsx </code>file, let's implement the <code class="literal">logout </code>and <code class="literal">checkLoginStatusAndLoadUserLikes</code> functions and test it out in order to see the Facebook integration working.</p><p class="calibre7">The <code class="literal">logout</code> function should be as simple as this:</p><div class="informaltable"><pre class="programlisting">function logout() {
  FB.logout();
}</pre></div><p class="calibre7">This will just log the user out of Facebook, requiring him to log in again. As we'll keep it simple, for learning purposes, we're not going to handle the scenario where the user logs in and out to manage the list of likes when these events happen in sequence. So, let's implement our <code class="literal">checkLoginStatusAndLoadUserLikes</code> function:</p><div class="informaltable"><pre class="programlisting">function checkLoginStatusAndLoadUserLikes() {
  FB.login(function(response) {
    console.log('We are live!!');
  });
}</pre></div><p class="calibre7">This is a very straightforward code as well. Every call made by the Open-Graph JavaScript SDK will be done asynchronously, so we have to provide a functions callback that will be triggered once the request made to Facebook API returns with the response. In this code, we're going <a id="id116" class="calibre1"/>to log in to the console once we've logged in to the app. This process will call a Facebook login popup:</p><div class="mediaobject"><img src="../images/00011.jpeg" alt="Open-Graph JavaScript SDK" class="calibre9"/></div><p class="calibre10"> </p><p class="calibre7">Try it out! Load the screen and once logged in, click the logout anchor and reload the page again, check out the console from your browser, and see the log we've printed. The following image shows the login popup.</p><div class="informaltable" title="Note"><h3 class="title2"><a id="note09" class="calibre1"/>Note</h3><p class="calibre7">In order to make it work in <code class="literal">localhost:3000</code>, it's necessary that you run the Python <code class="literal">SimpleHTTPServer</code> command from inside the code folder, <code class="literal">python -m SimpleHTTPServer</code>. For more details about this command and other ways of running your app, check <a class="calibre1" title="Chapter 1. Getting Started with ReactJS" href="part0015_split_000.html#page">Chapter 1</a>, <span class="strong"><em class="calibre12">Getting Started with ReactJS</em></span>.</p><p class="calibre7">You can also make it work by using the following command:</p><div class="informaltable"><pre class="programlisting">
<span class="strong"><strong class="calibre8">npm -g install httpster</strong></span>
</pre></div><p class="calibre7">httpster:  Is a simple http server to run the static content. In chrome browser the <code class="literal">index.html</code> file sometime's doesn't render due to X-origin error. Hence running this webserver from your application directory, will be easier to test your application in Chrome. Just run the command httpster from your application's <code class="literal">root</code> directory.</p><p class="calibre7">By Default the server runs in port <code class="literal">3333</code>, thus <code class="literal">localhost:3333</code> in the browsers should render the <code class="literal">index.html</code> page of your application.</p></div><p class="calibre7">Now that <a id="id117" class="calibre1"/>we have our integration working, let's get this list of likes for the logged-in user. Change your <code class="literal">checkLoginStatusAndLoadUserLikes</code> function to be like so:</p><div class="informaltable"><pre class="programlisting">function checkLoginStatusAndLoadUserLikes() {
  FB.getLoginStatus(function(response) {
    if (response.status === 'connected') {
      loadUserAndLikes();
    } else {
      loginAndLoadUserLikes();
    }
  });
}</pre></div><p class="calibre7">The first step is to check out where the user is already logged in. Calling the <code class="literal">FB.getLoginStatus</code> function can do this. Inside the callback function, the parameter passed represents the response from the API. This response contains information about the login status for the user. This will be a very common parameter as other API calls also return a response object back to your callback function. The status that represents that the user has authorized the app and has successfully logged in is the <code class="literal">connected</code> one. If the user is already logged in, we just call the <code class="literal">loadUserAndLikes</code> function, but if it's not connected then it calls another function that will log in and then call the API to load the user's list of likes.</p><p class="calibre7">The function <code class="literal">loginAndLoadUserLikes</code> should be as follows:</p><div class="informaltable"><pre class="programlisting">function loginAndLoadUserLikes() {
  FB.login(function(response) {
    loadUserAndLikes();
  }, {scope: 'user_likes'});
}</pre></div><p class="calibre7">The login functionality has been moved to this method. Once the login operation is complete then we call <code class="literal">loadUserAndLikes</code>. Notice that we now pass an object at the end of the login function c<code class="literal">all {scope: 'user_likes'}</code>; this object represents the scope/permissions on Facebook, as required by our applicaton. In the following example, within the first function call (<code class="literal">loadUserAndLikes</code>), the <code class="literal">userResponse</code> of the logged-in user is returned. Then the API lists all the likes of that logged-in user.</p><p class="calibre7">The function <code class="literal">loadUserAndLikes</code> should look like this:</p><div class="informaltable"><pre class="programlisting">function loadUserAndLikes() {
  FB.api('/me', function(userResponse) {
    console.log(1, userResponse);
    FB.api('/me/likes', function(likesResponse) {
      console.log(2, likesResponse);
    });
  });
}</pre></div><p class="calibre7">You can have as much JavaScript code as you want inside JSX files. It's not a specific type of file that understands only its own syntax, it just converts the places where you use JSX-specific syntax markup instead.</p><p class="calibre7">Notice<a id="id118" class="calibre1"/> that we are making two requests for the API: the first one will get the user details and the other will get the user's list of likes. We are logging them to the console in order to test first before we implement our ReactJS component to render it. This is what it logs out for my user:</p><div class="mediaobject"><img src="../images/00012.jpeg" alt="Open-Graph JavaScript SDK" class="calibre9"/></div><p class="calibre10"> </p><p class="calibre7">Until now, we have explored Facebook Open-Graph API and ways to configure it. You might be wondering what it has to do with learning ReactJS? All I can say is that, in my experience, all the examples that most people try to provide when teaching a new library or framework, rely on <span class="strong"><strong class="calibre8">To-Do</strong></span> apps, synchronous operations and, when they use an external. It doesn't make common integration tasks such as login. Such integration gives a better idea of how the thing being taught works when we put more realistic scenarios into place and try to make them as straightforward as possible. After finishing this <a id="id119" class="calibre1"/>example, we will have an idea about how to integrate ReactJS with your own private API, for instance.</p></div></div>
<div class="book" title="Rendering data in a ReactJS component"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec20" class="calibre1"/>Rendering data in a ReactJS component</h1></div></div></div><p class="calibre7">We now <a id="id120" class="calibre1"/>have our data to pass to the ReactJS component we're going to create. First, let's start with the <code class="literal">UserDetails</code> component. This is going to show a link with the logged-in username and the source to this user Facebook page. First, remove our old logout anchor from the <code class="literal">index.html</code> file as this is not going to be necessary anymore. Our logout functionality will be moved to our ReactJS component instead. We'll also create another <code class="literal">div</code>, named <code class="literal">user</code>, above the main <code class="literal">div</code>; this new element will hold the <code class="literal">UserDetails</code> component. The changes in <code class="literal">index.html</code> should look like this:</p><div class="informaltable"><pre class="programlisting">&lt;h1&gt;Facebook User's list of likes&lt;/h1&gt;
&lt;div id="user"&gt;&lt;/div&gt;
&lt;div id="main"&gt;&lt;/div&gt;</pre></div><p class="calibre7">You can create the <code class="literal">UserDetails </code>ReactJS component at the bottom of the <code class="literal">index.jsx</code> file:</p><div class="informaltable"><pre class="programlisting">var UserDetails = React.createClass({
    handleLogout: function () {
    FB.logout(function () {
      alert("You're logged out, refresh the page in order to login again.");
    });
  }
  render: function () {
    return (
      &lt;section id="user-details"&gt;
        &lt;a href={this.props.userDetails.link} target="__blank"&gt;
          {this.props.userDetails.name}
        &lt;/a&gt;
        {' | '}
        &lt;a href="#" onClick={this.handleLogout}&gt;Logout&lt;/a&gt;
      &lt;/section&gt;
    )
  },
});</pre></div><p class="calibre7">Now, we need to change the <code class="literal">loadUserAndLikes</code> function to call the <code class="literal">React.render</code> method, pointing it to the user HTML <code class="literal">div</code> element:</p><div class="informaltable"><pre class="programlisting">function loadUserAndLikes () {
  FB.api('/me', function (userResponse) {
    React.render(&lt;UserDetails userDetails={userResponse} /&gt;, document.getElementById('user'));

    FB.api('/me/likes', function (likesResponse) {
      console.log(2, likesResponse);
    });
  });
}</pre></div><p class="calibre7">As you<a id="id121" class="calibre1"/> can see, the <code class="literal">UserDetails</code> ReactJS component is very straightforward and basic; it works like a template and just renders data that is passed to it. Don't be disappointed with this because we're going to give this more functionality in coming chapters, such as rendering a login button when logged out, instead of asking to refresh the page, hiding the list, and showing a loading <code class="literal">gif</code> image when waiting for the SDK response. All of those features require that we deal with a state and this is going to be covered in the next chapter.</p><p class="calibre7">You can test it by refreshing the page, clicking the logout button, and refreshing the page again. Once you log in on Facebook, the user details should be displayed in the browser, below the title of our page.</p><p class="calibre7">We now need to render the user's list of likes and substitute the ugly <code class="literal">console.log(2, likesResponse);</code> command to a ReactJS render function. First, let's create our <code class="literal">UserLikesList</code> component at the bottom of the <code class="literal">index.jsx</code> file:</p><div class="informaltable"><pre class="programlisting">var UserLikesList = React.createClass({
  render: function() {
    var items = this.props.list.map(function (likeObject) {
      return &lt;UserLikeItem data={likeObject} /&gt;;
    });

    return (
      &lt;ul id="user-likes-list"&gt;
        {items}
      &lt;/ul&gt;
    );
  }
});</pre></div><p class="calibre7">We create an array of <code class="literal">UserLikeItem</code> components called <code class="literal">items</code> and we're rendering them inside the list <code class="literal">&lt;ul&gt;</code> element. The <code class="literal">UserLikeItem</code> component should look like this:</p><div class="informaltable"><pre class="programlisting">var UserLikeItem = React.createClass({
  render: function() {
    var data = this.props.data;

    return (
      &lt;li&gt;
        &lt;img src={data.picture.data.url} title={data.name} /&gt;

        &lt;h1&gt;{data.name} &lt;small&gt;{data.category}&lt;/small&gt;&lt;/h1&gt;
      &lt;/li&gt;
    );
  }
});</pre></div><p class="calibre7">We put <a id="id122" class="calibre1"/>our property data in a separate variable to avoid long names inside the component markup. Note that we are also displaying an image from the liked Facebook resource; because of that, we also need to ask that in our API call and render our component passing this list of likes:</p><div class="informaltable"><pre class="programlisting">function loadUserAndLikes () {
  FB.api('/me', function (userResponse) {
    React.render(&lt;UserDetails userDetails={userResponse} /&gt;, document.getElementById('user'));

<span class="strong"><strong class="calibre8">    var fields = { fields: 'category,name,picture.type(normal)' };</strong></span>
<span class="strong"><strong class="calibre8">    FB.api('/me/likes', fields, function (likesResponse) {</strong></span>
<span class="strong"><strong class="calibre8">      React.render(&lt;UserLikesList list={likesResponse.data} /&gt;, document.getElementById('main'));</strong></span>
<span class="strong"><strong class="calibre8">    });</strong></span>
  });
}</pre></div><p class="calibre7">We've changed the <code class="literal">loadUserAndLikes</code> function to ask the API to also bring a picture of the liked Facebook resource. By default, it's omitted from the response.</p><p class="calibre7">Try it out and see if you get a list of your likes displayed in the page. It might be looking very odd because we haven't created any style. Create a style element in the <code class="literal">index.html</code> page for styling our list: a very basic one but just for making our example more pleasing to look at:</p><div class="informaltable"><pre class="programlisting">&lt;style&gt;
  #user-likes-list {
    list-style: none;
    padding: 5px;
    margin: 0;
  }
  #user-likes-list li {
    display: inline-block;
    width: 270px;
    margin: 5px;
    background-color: rgb(122, 174, 233);
    height: 100px;
    overflow: hidden;
  }
  #user-likes-list img {
    display: inline-block;
    vertical-align: top;
    width: 100px;
  }
  #user-likes-list h1 {
    font-size: 1.4em;
    display: inline-block;
    width: 160px;
    vertical-align: top;
    margin-left: 5px;
    color: rgb(20, 90, 169);
    margin: 5px 0 0 5px;
  }
  #user-likes-list small {
    font-size: 0.7em;
    display: block;
    color: rgb(145, 50, 0);
    margin-top: 5px;
  }
&lt;/style&gt;</pre></div><div class="mediaobject"><img src="../images/00013.jpeg" alt="Rendering data in a ReactJS component" class="calibre9"/></div><p class="calibre10"> </p><p class="calibre7">OK, maybe it's bad without styling. Anyway, you can always ask a designer for help!</p><p class="calibre7">ReactJS properties<a id="id123" class="calibre1"/> make your components configurable and changeable. As you can see, it's very straightforward to create ReactJS components and render them in your page, even in an existing one. You don't need to make the whole app support the framework or start one from scratch. You simply define what your components are, considering them as a set, avoiding big ones that are difficult to maintain, and render them somewhere in the page. Its power increases by intelligently working with stateful components, and this is our next step in learning ReactJS.</p></div>
<div class="book" title="Summary"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec21" class="calibre1"/>Summary</h1></div></div></div><p class="calibre7">In this chapter, we've learned how to pass properties to ReactJS components and render the UI based on those components. We have also learned how to make a parent component to communicate with its children. We have seen how to configure Facebook Open-Graph API, how to integrate that with ReactJS using login functionality, and how to render the response of an API request call into a set of smaller ReactJS components.</p><p class="calibre7">In the next chapter, we are going to dive into stateful components and explore how to make mutable ReactJS components based on a user's input or for any other reason that requires the state to change and your UI to represent that automatically.</p></div></body></html>
- en: '5'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Implementing React Contexts
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the previous chapters, we learned about the State Hook, the Reducer Hook,
    and the Effect Hook. We developed a small blog application using these Hooks.
    As we noticed during the development of our blog app, we had to pass down the
    `username` state from the `App` component to the `UserBar` component, and from
    the `UserBar` component to the `Login`, `Register`, and `Logout` components. To
    avoid having to pass down the state like this, we are now going to learn about
    React Context and Context Hooks.
  prefs: []
  type: TYPE_NORMAL
- en: We are going to begin by learning what React Context is, and what providers
    and consumers are, by implementing themes as an example for contexts. Then, we
    are going to use Hooks as a context consumer and discuss when contexts should
    be used. Finally, we are going to implement global state using contexts.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following topics will be covered in this chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: Introducing React Context
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Implementing themes via context
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Alternatives to contexts
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Using context for global state
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Technical requirements
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'A fairly recent version of Node.js should already be installed. The Node Package
    Manager (`npm`) also needs to be installed (it should come with Node.js). For
    more information on how to install Node.js, please check out the official website:
    [https://nodejs.org/](https://nodejs.org/).'
  prefs: []
  type: TYPE_NORMAL
- en: 'We are going to use **Visual Studio Code** (**VS Code**) for the guides in
    this book, but everything should work similarly in any other editor. For more
    information on how to install VS Code, please refer to the official website: [https://code.visualstudio.com](https://code.visualstudio.com).'
  prefs: []
  type: TYPE_NORMAL
- en: 'In this book, we use the following versions:'
  prefs: []
  type: TYPE_NORMAL
- en: Node.js v22.14.0
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`npm` v10.9.2'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: VS Code v1.97.2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: While installing a newer version should not be an issue, please note that certain
    steps might work differently on a newer version. If you are having an issue with
    the code and steps provided in this book, please try using the mentioned versions.
  prefs: []
  type: TYPE_NORMAL
- en: 'You can find the code for this chapter on GitHub: [https://github.com/PacktPublishing/Learn-React-Hooks-Second-Edition/tree/main/Chapter05](https://github.com/PacktPublishing/Learn-React-Hooks-Second-Edition/tree/main/Chapter05).'
  prefs: []
  type: TYPE_NORMAL
- en: It is highly recommended that you write the code on your own. Do not simply
    run the code examples that are provided with the book. It is important to write
    the code yourself to be able to learn and understand it properly. However, if
    you run into any issues, you can always refer to the code example.
  prefs: []
  type: TYPE_NORMAL
- en: Introducing React Context
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the previous chapters, we passed down the `username` state and `setUsername`
    function from the `App` component to the `UserBar` component; and then from the
    `UserBar` component to the `Logout`, `Login`, and `Register` components. React
    Context provides a solution to this cumbersome way of passing down props over
    multiple levels of components, by allowing us to share values between components
    without having to explicitly pass them down via props. As we are going to see,
    contexts are perfect for sharing global state across the whole application.
  prefs: []
  type: TYPE_NORMAL
- en: Passing down props
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Before learning about React Context in depth, let’s recap what we implemented
    in the earlier chapters to get a feeling for the problem that contexts solve.
    You do not need to edit any code at this point; these steps are just a recap of
    what we have already done. Just read along for the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'In `src/App.jsx`, we defined the `username` state and `setUsername` function
    using a State Hook:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, we passed the `username` state and `setUsername` function to the `UserBar`
    component:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'In the `src/user/UserBar.jsx` file, we defined a `UserBar` component that takes
    the `username` state as a prop and then passes it down to the `Logout` component.
    We also passed down the `setUsername` function to the `Logout`, `Login`, and `Register`
    components:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Finally, we used the `setUsername` function and the `username` state in the
    `Logout`, `Login`, and `Register` components:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: React Context allows us to skip *steps 2* and *3* and jump straight from *step
    1* to *step 4*. As you can imagine, in larger apps, context becomes even more
    useful because we might have to pass down props over many levels.
  prefs: []
  type: TYPE_NORMAL
- en: In the next section, we are first going to learn how context works by implementing
    a theme system for our blog. Then, we will use React Context to deal with the
    `username` global state in our blog app.
  prefs: []
  type: TYPE_NORMAL
- en: Implementing themes via context
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**React Context** is used to share values across a tree of React components.
    Usually, we want to share global values, such as the `username` state, the theme
    of our app, or the chosen language (if the app supports multiple languages).'
  prefs: []
  type: TYPE_NORMAL
- en: 'React Context consists of three parts:'
  prefs: []
  type: TYPE_NORMAL
- en: The **context** itself, which defines a default value and allows us to provide
    and consume values
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The **provider**, which provides (sets) the value
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The **consumer**, which consumes (uses) the value
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Defining the context
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'First, we have to define the context. The way this works has not changed since
    Hooks were introduced. We simply use the `createContext(defaultValue)` function
    from React to create a new context object. In this case, we will set the default
    value to `{ primaryColor: ''maroon'' }`, so our default primary color, when no
    provider is defined, will be maroon.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, let’s get started defining the context:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Copy the `Chapter04_2` folder to a new `Chapter05_1` folder by executing the
    following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Open the new `Chapter05_1` folder in VS Code.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: To keep our project clean as it grows, we are now extending the folder structure
    by grouping by base primitives first, then grouping by features within that folder.
    Create a new `src/contexts/` folder now.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Also, create a new `src/components/` folder.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Move the `src/post/` and `src/user/` folders into the `src/components/` folder.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Edit `src/App.jsx` and adjust the imports, as follows:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Create a new `src/contexts/ThemeContext.js` file. Inside it, import the `createContext`
    function:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, define the context with the aforementioned default value:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: When the context is consumed but no provider is defined, then it will return
    this default value.
  prefs: []
  type: TYPE_NORMAL
- en: Note how we are exporting `ThemeContext` here because we are going to need to
    import it later to create the provider and consume it using a Context Hook.
  prefs: []
  type: TYPE_NORMAL
- en: That’s all we need to do to define a context with React.
  prefs: []
  type: TYPE_NORMAL
- en: Quick detour – absolute imports
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: If we were to import the context in a component now, we would have to import
    from `../../contexts/ThemeContext.js`. Besides the fact that it becomes hard to
    read when files are deeply nested, it can cause issues when organizing files into
    subfolders later. To avoid these problems, we can use **absolute imports**. Absolute
    imports allow us to import from the root of a project. They are implemented using
    **resolve aliases** in Vite. Basically, we can tell Vite to resolve a special
    character, such as an `@` symbol, to an absolute path to the `src` folder. This
    means that we can import the context from `@/contexts/ThemeContext.js` instead.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s get started configuring absolute imports now:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Edit `vite.config.js` and import the `path` utils:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'In the `config` object, add a `resolve` alias, as follows:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Additionally, we can improve autocompletion in our code editor or IDE by creating
    a `jsconfig.json` file. This file will tell the editor about our absolute import
    configuration and let us easily import files from it. Create a new `jsconfig.json`
    file now.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Inside it, add the following config:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Now that we can use absolute imports, let’s continue defining the consumer.
  prefs: []
  type: TYPE_NORMAL
- en: Defining the consumer
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'To use a context, we need a consumer. Let’s first revisit the traditional way
    of defining a consumer before we get started using Hooks:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Edit `src/components/post/Post.jsx` and import `ThemeContext` there:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Wrap the whole component with a `ThemeContext.Consumer` component and a **render
    function** as its `children` prop, to make use of the context value:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: The render function allows us to pass values down to the children of a component.
  prefs: []
  type: TYPE_NORMAL
- en: 'Inside the render function, we can now make use of the context value to set
    the color of the title of a blog post, as follows:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Using contexts like this works, but as we have learned in the first chapter,
    using components with render functions in this way clutters the React tree and
    makes our app harder to debug and maintain.
  prefs: []
  type: TYPE_NORMAL
- en: Using Hooks to consume a context
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A better way to consume contexts is using a Context Hook! That way, we can use
    context values like any other value.
  prefs: []
  type: TYPE_NORMAL
- en: 'Follow these steps to change the consumer to a Context Hook:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Edit `src/components/post/Post.jsx` and add the following import:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, define a Context Hook, as follows:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Next, *remove* the following highlighted parts of the code:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: As you can see, using a Context Hook allows us to directly consume the value
    from the context and simply render the post without needing a wrapper component.
  prefs: []
  type: TYPE_NORMAL
- en: 'Start the blog app by executing the following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'We can see that the title of blog posts is now maroon colored:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 5.1 – Using a Context Hook to change the theme of our app](img/B31327_05_01.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5.1 – Using a Context Hook to change the theme of our app
  prefs: []
  type: TYPE_NORMAL
- en: As we can see, the theme context successfully provides the color for the post
    title.
  prefs: []
  type: TYPE_NORMAL
- en: Defining the provider
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Contexts use the default value that is passed to `createContext` when there
    is no provider defined. For example, let’s imagine our component uses `ThemeContext`
    and is rendered as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: Then, `primaryColor` will be set to `maroon` (we defined this earlier). This
    can be used as a fallback, for example, when the component is not embedded in
    the app but instead embedded in an interactive style guide (such as Storybook).
  prefs: []
  type: TYPE_NORMAL
- en: 'When there is a provider defined, they will use the value of the provider.
    Let’s render the component like this instead:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: Then, `primaryColor` will be set to `black`.
  prefs: []
  type: TYPE_NORMAL
- en: 'If there are multiple providers in the tree, the components will use the value
    from the closest parent provider. For example, let’s say we render components
    like this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: Then, `primaryColor` in the component will be set to `red`, as that is the provider
    closest to the component in the tree. However, `OtherComponent` in this example
    will still have `primaryColor` set to `black`.
  prefs: []
  type: TYPE_NORMAL
- en: As we can see, a context without a provider is just a static value; the provider
    (especially in combination with other Hooks, such as a State Hook for the value)
    is what allows us to dynamically change the value of a context.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s define the provider now. Follow these steps to get started:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Edit `src/App.jsx` and import `ThemeContext`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE21]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, wrap the contents of the `App` component with the `ThemeContext.Provider`
    component, and provide a value:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE22]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: As we can see, the post titles are now back to being rendered in black. If we
    want to change the value of our context, we can simply adjust the `value` prop
    that is passed to the `provider` component. We could also, for example, use a
    State Hook to dynamically change the value of a context. We will try this later
    when we use a context for the global state.
  prefs: []
  type: TYPE_NORMAL
- en: If we do not pass a `value` prop to the provider, the default value of a context
    will *not* be used! If we define a provider without a `value` prop, then the value
    of the context will be `undefined`.
  prefs: []
  type: TYPE_NORMAL
- en: Now that we have defined a single provider for the context, let’s move on to
    defining multiple nested providers.
  prefs: []
  type: TYPE_NORMAL
- en: Nesting providers
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'With React Context, it is also possible to define multiple providers for the
    same context. Using this technique, we can override the context value in certain
    parts of our app. For example, let’s say we want to implement a featured posts
    section for our blog app. Then, we could do the following:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Edit `src/App.jsx` and define a new `featuredPosts` array:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE23]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, inside the `App` component, render a new `PostList` component rendering
    the `featuredPosts` array, but wrap it inside another `ThemeContext.Provider`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE24]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'You will now see that the featured post has a different color from the other
    posts:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 5.2 – Implementing featured posts by overriding context values with
    nested providers](img/B31327_05_02.png)'
  prefs: []
  type: TYPE_IMG
- en: Figure 5.2 – Implementing featured posts by overriding context values with nested
    providers
  prefs: []
  type: TYPE_NORMAL
- en: '**Example code**'
  prefs: []
  type: TYPE_NORMAL
- en: The example code for this section can be found in the `Chapter05/Chapter05_1`
    folder. Check the `README.md` file inside the folder for instructions on how to
    set up and run the example.
  prefs: []
  type: TYPE_NORMAL
- en: Alternatives to contexts
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We should be careful not to use React Context too often, as it makes reusing
    components more difficult. We should only use context when we need to access data
    in many components, which are at different nesting levels. Additionally, we need
    to make sure that we only use contexts for non-frequently changing data. Frequently
    changing values of contexts, especially contexts that are used high up in the
    component tree, may cause large parts of the component tree to re-render, resulting
    in performance problems. That is why, for frequently changing values, we should
    use a state management solution such as Jotai, Redux, or MobX instead. These state
    management solutions allow us to access small parts of the state in a fine-grained
    way and thus reduce the amount of re-renders. Good candidates for contexts are
    features such as theming and translation (i18n) systems.
  prefs: []
  type: TYPE_NORMAL
- en: 'If we only want to avoid having to pass down props, in some cases, we can pass
    down the rendered component instead of the data. For example, let’s say we have
    a `Page` component that renders a `Header` component, which renders a `Profile`
    component, which then renders an `Avatar` component. We get a `headerSize` prop
    passed to the `Page` component, which we need in the `Header` component, but also
    in the `Avatar` component:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE25]'
  prefs: []
  type: TYPE_PRE
- en: 'Instead of passing down props through multiple levels, we could do the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE26]'
  prefs: []
  type: TYPE_PRE
- en: Now, only the `Page` component needs to know about the props, and there is no
    need to pass them down further in the tree. In this case, contexts are not necessary.
  prefs: []
  type: TYPE_NORMAL
- en: Such a pattern is called **inversion of control**, and it can make your code
    much cleaner than passing down props or using a context. However, we should not
    always use this pattern either because it makes the higher-level component more
    complicated.
  prefs: []
  type: TYPE_NORMAL
- en: Now, let’s continue by learning about using context for global state.
  prefs: []
  type: TYPE_NORMAL
- en: Using context for global state
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: After learning how to use React Context to implement themes in our blog app,
    we are now going to use a context to avoid having to manually pass down the `username`
    and `setUsername` props. The user state is a global state, which means it is used
    across the whole app. It also does not change frequently. As such, it is a good
    candidate for using a context. Like we did before, we start by defining the context.
  prefs: []
  type: TYPE_NORMAL
- en: Defining the context
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'To define the context, we need to use the `createContext` function again. In
    this case, we set the default value to an array with an empty string and a **no-op
    function** (a function that does nothing). Later, when defining the provider,
    we will provide this array by using the result from the State Hook. Remember,
    the State Hook returns an array like this: `[value, setValue]`.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, let’s get started defining the context:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Copy the `Chapter05_1` folder to a new `Chapter05_2` folder by executing the
    following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE27]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Open the new `Chapter05_2` folder in VS Code.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Create a new `src/contexts/UserContext.js` file. Inside it, import the `createContext`
    function:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE28]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, define the context with the aforementioned default value, which imitates
    the return value of a State Hook, but with an empty string and a **no-op function**
    (a function that does nothing):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE29]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: When the context is consumed but no provider is defined, then it will return
    this default value.
  prefs: []
  type: TYPE_NORMAL
- en: Now, let’s continue with defining the context provider.
  prefs: []
  type: TYPE_NORMAL
- en: Defining the context provider
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We have already created a State Hook for the `username` state. We can now use
    the result from this State Hook and pass it to the context provider so that any
    component in our app can make use of it.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let’s get started defining the context provider now:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Edit `src/App.jsx` and import `UserContext`, as follows:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE30]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, wrap the result of the `App` component with `UserContext.Provider`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE31]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Now, we can *remove* the following props we previously passed down:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE32]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Do not forget to add the closing tag for `UserContext.Provider`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE33]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Of course, it is also possible to use a similar pattern to pass the result of
    a Reducer Hook into a context.
  prefs: []
  type: TYPE_NORMAL
- en: The context provider now provides the `username` value and the `setUsername`
    function to the rest of our app.
  prefs: []
  type: TYPE_NORMAL
- en: Refactoring the app to use UserContext
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Now that we have a context provider, we can refactor the rest of our app to
    use the context instead of props.
  prefs: []
  type: TYPE_NORMAL
- en: 'Follow these steps to get started:'
  prefs: []
  type: TYPE_NORMAL
- en: 'First, edit `src/components/user/UserBar.jsx` and add imports to the `useContext`
    function and `UserContext`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE34]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, *remove* the props passed to the component:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE35]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Next, define the Context Hook and get the `username` value from it:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE36]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'We can now *remove* the props passed down to the other components:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE37]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Edit `src/components/user/Login.jsx` and add an import of `useContext` and
    `UserContext`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE38]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, *remove* the props from the component:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE39]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Add the Context Hook:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE40]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: If we do not need the first element of an array, we can skip it when destructuring
    by simply putting a comma without specifying the name of the first variable.
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: 'Edit `src/components/user/Logout.jsx` and add an import of `useContext` and
    `UserContext`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE41]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, *remove* the props from the component:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE42]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Add the Context Hook:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE43]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Edit `src/components/user/Register.jsx` and add an import of `useContext` and
    `UserContext`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE44]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, *remove* the props from the component:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE45]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Add the Context Hook:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE46]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Edit `src/components/post/CreatePost.jsx` and add an import of `useContext`
    and `UserContext`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE47]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Then, *remove* the `username` prop from the component:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE48]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Add the Context Hook, as follows:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE49]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: 'Start the app, as follows:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE50]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: Now, the app works the same way as before, but our code is a lot cleaner and
    more concise, all thanks to React Context and the Context Hook!
  prefs: []
  type: TYPE_NORMAL
- en: '**Example code**'
  prefs: []
  type: TYPE_NORMAL
- en: The example code for this section can be found in the `Chapter05/Chapter05_2`
    folder. Check the `README.md` file inside the folder for instructions on how to
    set up and run the example.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we first learned about React Context as an alternative to passing
    down props over multiple levels of React components. We then learned about context
    providers and consumers, and the new way to define consumers via Hooks. We used
    what we learned in practice, by implementing theme support in our blog app. Next,
    we learned when it does not make sense to use contexts, and when we should use
    inversion of control instead. Finally, we used a context for the global `username`
    state in our blog app.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we are going to learn how to request data from a server,
    using React and Hooks. Then, we are going to learn about React Suspense, so that
    we do not have to wait for the requests to finish before rendering our app.
  prefs: []
  type: TYPE_NORMAL
- en: Questions
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To recap what we have learned in this chapter, try to answer the following
    questions:'
  prefs: []
  type: TYPE_NORMAL
- en: What problem do contexts avoid?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: What are the three parts that contexts consist of?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Are all parts required to be defined in order to use contexts?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: What is the advantage of using Hooks instead of traditional context consumers?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: What is an alternative to contexts and when should we use it?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How can we implement dynamically changing contexts?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: When does it make sense to use contexts for state?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Further reading
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'If you are interested in more information about the concepts that we have learned
    in this chapter, take a look at the following links:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Official docs on React Context: [https://react.dev/learn/passing-data-deeply-with-context](https://react.dev/learn/passing-data-deeply-with-context)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'List of HTML color codes (if you want to adjust your theme): [https://www.rapidtables.com/web/color/html-color-codes.html](https://www.rapidtables.com/web/color/html-color-codes.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Example of contexts for local state used by `react-aria`: [https://react-spectrum.adobe.com/react-aria/advanced.html#contexts](https://react-spectrum.adobe.com/react-aria/advanced.html#contexts)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Example of contexts for global state used by `react-i18next`: [https://react.i18next.com/latest/i18nextprovider](https://react.i18next.com/latest/i18nextprovider)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Learn more on Discord
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To join the Discord community for this book – where you can share feedback,
    ask questions to the author, and learn about new releases – follow the QR code
    below:'
  prefs: []
  type: TYPE_NORMAL
- en: '[https://packt.link/wnXT0](Chapter_05.xhtml)'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/image_%283%29.png)'
  prefs: []
  type: TYPE_IMG

<html><head></head><body>
<div id="_idContainer033">
<h1 class="chapter-number" id="_idParaDest-55"><a id="_idTextAnchor056"/><span class="koboSpan" id="kobo.1.1">5</span></h1>
<h1 id="_idParaDest-56"><a id="_idTextAnchor057"/><span class="koboSpan" id="kobo.2.1">Implementing Redux in Our Funbook App</span></h1>
<p><span class="koboSpan" id="kobo.3.1">In the previous chapter, we got our hands “dirty” a little bit. </span><span class="koboSpan" id="kobo.3.2">I hope you liked building the Funbook app! </span><span class="koboSpan" id="kobo.3.3">We managed to build the frontend of a functioning app. </span><span class="koboSpan" id="kobo.3.4">Of course, the functionalities we created were limited. </span><span class="koboSpan" id="kobo.3.5">A real-world social media app would be much more robust, with many more components and user flows. </span><span class="koboSpan" id="kobo.3.6">However, bigger apps bring their own set of problems: handling large datasets, establishing style guides, managing analytics, and many other problems that we don’t want to spend our time on. </span><span class="koboSpan" id="kobo.3.7">We are here to talk about different solutions for state management. </span><span class="koboSpan" id="kobo.3.8">In the interest of staying focused, I added a few functionalities to our app that were not described in detail in the previous chapter. </span><span class="koboSpan" id="kobo.3.9">I added a modal displaying an enlarged version of the images on the </span><strong class="bold"><span class="koboSpan" id="kobo.4.1">Feed</span></strong><span class="koboSpan" id="kobo.5.1"> surface, another modal displaying images added by the users listed at the top of the </span><strong class="bold"><span class="koboSpan" id="kobo.6.1">Feed</span></strong><span class="koboSpan" id="kobo.7.1"> surface and components and styles for the </span><strong class="bold"><span class="koboSpan" id="kobo.8.1">Login</span></strong><span class="koboSpan" id="kobo.9.1"> surface, and a functioning </span><strong class="bold"><span class="koboSpan" id="kobo.10.1">Like</span></strong><span class="koboSpan" id="kobo.11.1"> button in the modal with the images, connected to the </span><strong class="bold"><span class="koboSpan" id="kobo.12.1">Profile</span></strong><span class="koboSpan" id="kobo.13.1"> surface. </span><span class="koboSpan" id="kobo.13.2">You can find the full example app in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.14.1">example-app-full</span></strong><span class="koboSpan" id="kobo.15.1"> folder </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">on GitHub:</span></span></p>
<p><a href="https://github.com/PacktPublishing/Simplifying-State-Management-in-React-Native/tree/main/example-app-full"><span class="No-Break"><span class="koboSpan" id="kobo.17.1">https://github.com/PacktPublishing/Simplifying-State-Management-in-React-Native/tree/main/example-app-full</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.18.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.19.1">This app will be the base for all our state management experiments throughout this book. </span><span class="koboSpan" id="kobo.19.2">We will start our experiments by looking at the oldest state management </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">library: </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.21.1">Redux</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.23.1">In this chapter, we will do </span><span class="No-Break"><span class="koboSpan" id="kobo.24.1">the following:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.25.1">Go over a brief history </span><span class="No-Break"><span class="koboSpan" id="kobo.26.1">of </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.27.1">Redux</span></strong></span></li>
<li><span class="koboSpan" id="kobo.28.1">Install and configure </span><strong class="bold"><span class="koboSpan" id="kobo.29.1">Redux</span></strong><span class="koboSpan" id="kobo.30.1"> in the </span><span class="No-Break"><span class="koboSpan" id="kobo.31.1">Funbook app</span></span></li>
<li><span class="koboSpan" id="kobo.32.1">Add </span><strong class="bold"><span class="koboSpan" id="kobo.33.1">Redux</span></strong><span class="koboSpan" id="kobo.34.1"> functionalities to </span><span class="No-Break"><span class="koboSpan" id="kobo.35.1">the app</span></span></li>
<li><span class="koboSpan" id="kobo.36.1">Learn about </span><span class="No-Break"><span class="koboSpan" id="kobo.37.1">debugging </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.38.1">Redux</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.39.1">By the end of this chapter, you should feel comfortable using </span><strong class="bold"><span class="koboSpan" id="kobo.40.1">Redux</span></strong><span class="koboSpan" id="kobo.41.1">-specific jargon, such as reducer, actions, and store. </span><span class="koboSpan" id="kobo.41.2">You should also have a good understanding of what it takes to configure and use </span><strong class="bold"><span class="koboSpan" id="kobo.42.1">Redux</span></strong><span class="koboSpan" id="kobo.43.1"> in a real </span><strong class="bold"><span class="koboSpan" id="kobo.44.1">React </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.45.1">Native</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.46.1"> app.</span></span></p>
<h1 id="_idParaDest-57"><a id="_idTextAnchor058"/><span class="koboSpan" id="kobo.47.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.48.1">In order to follow along with this chapter, you will need some knowledge of JavaScript and ReactJS. </span><span class="koboSpan" id="kobo.48.2">If you have followed the previous two chapters of this book, you should be able to go forward without </span><span class="No-Break"><span class="koboSpan" id="kobo.49.1">any issues.</span></span></p>
<p><span class="koboSpan" id="kobo.50.1">Feel free to use an IDE of your choice, as React Native does not need any specific functionality. </span><span class="koboSpan" id="kobo.50.2">Currently, the most popular IDEs for frontend developers are Microsoft’s VSCode, Atom, Sublime Text, </span><span class="No-Break"><span class="koboSpan" id="kobo.51.1">and WebStorm.</span></span></p>
<p><span class="koboSpan" id="kobo.52.1">The code snippets provided in this chapter are here to illustrate what we should be doing with the code. </span><span class="koboSpan" id="kobo.52.2">They do not provide the whole picture. </span><span class="koboSpan" id="kobo.52.3">To code along easier, please open the GitHub repo in your IDE and look at the files in there. </span><span class="koboSpan" id="kobo.52.4">You can either start with the files in the folder named </span><strong class="source-inline"><span class="koboSpan" id="kobo.53.1">example-app-full</span></strong><span class="koboSpan" id="kobo.54.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.55.1">chapter-5</span></strong><span class="koboSpan" id="kobo.56.1">. </span><span class="koboSpan" id="kobo.56.2">If you start with </span><strong class="source-inline"><span class="koboSpan" id="kobo.57.1">example-app-full</span></strong><span class="koboSpan" id="kobo.58.1">, you will be responsible for implementing the solutions described in this chapter. </span><span class="koboSpan" id="kobo.58.2">If you choose to look at </span><strong class="source-inline"><span class="koboSpan" id="kobo.59.1">chapter-5</span></strong><span class="koboSpan" id="kobo.60.1">, you will see the entire solution implemented </span><span class="No-Break"><span class="koboSpan" id="kobo.61.1">by me.</span></span></p>
<p><span class="koboSpan" id="kobo.62.1">If you get stuck or lost, you can check the code in the </span><span class="No-Break"><span class="koboSpan" id="kobo.63.1">GitHub repo:</span></span></p>
<p><a href="https://github.com/PacktPublishing/Simplifying-State-Management-in-React-Native/tree/main/chapter-5"><span class="No-Break"><span class="koboSpan" id="kobo.64.1">https://github.com/PacktPublishing/Simplifying-State-Management-in-React-Native/tree/main/chapter-5</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.65.1">.</span></span></p>
<h1 id="_idParaDest-58"><a id="_idTextAnchor059"/><span class="koboSpan" id="kobo.66.1">What is Redux? </span><span class="koboSpan" id="kobo.66.2">A brief history</span></h1>
<p><span class="koboSpan" id="kobo.67.1">We went over a brief history of </span><strong class="bold"><span class="koboSpan" id="kobo.68.1">React</span></strong><span class="koboSpan" id="kobo.69.1"> in </span><a href="B18396_01.xhtml#_idTextAnchor017"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.70.1">Chapter 1</span></em></span></a><span class="koboSpan" id="kobo.71.1">, </span><em class="italic"><span class="koboSpan" id="kobo.72.1">What are React and React Native?.</span></em><span class="koboSpan" id="kobo.73.1"> If you skipped that chapter, or </span><a id="_idIndexMarker209"/><span class="koboSpan" id="kobo.74.1">simply don’t remember, don’t worry. </span><span class="koboSpan" id="kobo.74.2">All you need to know is that </span><strong class="bold"><span class="koboSpan" id="kobo.75.1">ReactJS</span></strong><span class="koboSpan" id="kobo.76.1"> was published in 2013 and it opened doors to creating beautiful single-page applications. </span><strong class="bold"><span class="koboSpan" id="kobo.77.1">ReactJS</span></strong><span class="koboSpan" id="kobo.78.1"> was an exciting library to use! </span><span class="koboSpan" id="kobo.78.2">A lot of people jumped on the </span><a id="_idIndexMarker210"/><span class="koboSpan" id="kobo.79.1">opportunity and started re-writing their websites. </span><span class="koboSpan" id="kobo.79.2">As time passed, many developers would discover that creating and maintaining large applications with </span><strong class="bold"><span class="koboSpan" id="kobo.80.1">ReactJS</span></strong><span class="koboSpan" id="kobo.81.1"> became tedious. </span><span class="koboSpan" id="kobo.81.2">Don’t forget this was happening before the </span><strong class="bold"><span class="koboSpan" id="kobo.82.1">ReactJS</span></strong><span class="koboSpan" id="kobo.83.1"> team introduced hooks and context. </span><span class="koboSpan" id="kobo.83.2">Developers had to pass props from parents to nested children, going through multiple levels of irrelevant components. </span><span class="koboSpan" id="kobo.83.3">This is called </span><strong class="bold"><span class="koboSpan" id="kobo.84.1">prop</span></strong><span class="koboSpan" id="kobo.85.1"> drilling, as</span><a id="_idIndexMarker211"/><span class="koboSpan" id="kobo.86.1"> getting to the child component through many ancestors feels </span><span class="No-Break"><span class="koboSpan" id="kobo.87.1">like drilling.</span></span></p>
<p><span class="koboSpan" id="kobo.88.1">In 2015, something very interesting happened: </span><em class="italic"><span class="koboSpan" id="kobo.89.1">Dan Abramov</span></em><span class="koboSpan" id="kobo.90.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.91.1">Andrew Clark</span></em><span class="koboSpan" id="kobo.92.1"> wrote and published a new open source library called Redux. </span><span class="koboSpan" id="kobo.92.2">ReactJS developers were mostly confused at first, given that </span><strong class="bold"><span class="koboSpan" id="kobo.93.1">Redux</span></strong><span class="koboSpan" id="kobo.94.1"> introduced</span><a id="_idIndexMarker212"/><span class="koboSpan" id="kobo.95.1"> new concepts to the </span><strong class="bold"><span class="koboSpan" id="kobo.96.1">ReactJS</span></strong><span class="koboSpan" id="kobo.97.1"> world. </span><span class="koboSpan" id="kobo.97.2">We could start thinking about global states that are accessible from anywhere in the app. </span><span class="koboSpan" id="kobo.97.3">In order to change a global state, we would need to use special functions called “actions” and also use something called “reducers"... </span><span class="koboSpan" id="kobo.97.4">This was a lot to take in! </span><span class="koboSpan" id="kobo.97.5">Regardless, this new library solved a very real problem, so the only thing to do was to buckle up, watch Dan Abramov’s tutorials, and use this new and </span><span class="No-Break"><span class="koboSpan" id="kobo.98.1">amazing tool!</span></span></p>
<p><span class="koboSpan" id="kobo.99.1">Thanks to Dan Abramov’s efforts to teach, explain, and popularize </span><strong class="bold"><span class="koboSpan" id="kobo.100.1">Redux</span></strong><span class="koboSpan" id="kobo.101.1">, it became a staple of </span><strong class="bold"><span class="koboSpan" id="kobo.102.1">ReactJS</span></strong><span class="koboSpan" id="kobo.103.1"> development. </span><span class="koboSpan" id="kobo.103.2">As years passed, new concepts for managing global states were created, some similar and some very different from </span><strong class="bold"><span class="koboSpan" id="kobo.104.1">Redux</span></strong><span class="koboSpan" id="kobo.105.1">. </span><span class="koboSpan" id="kobo.105.2">Compared to the newer solutions, </span><strong class="bold"><span class="koboSpan" id="kobo.106.1">Redux</span></strong><span class="koboSpan" id="kobo.107.1"> can feel clunky, as it has a large amount of boilerplate code. </span><span class="koboSpan" id="kobo.107.2">Even the library author expressed his doubts </span><span class="No-Break"><span class="koboSpan" id="kobo.108.1">through Twitter:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer030">
<span class="koboSpan" id="kobo.109.1"><img alt="Figure 5.1 – Dan Abramov’s tweet saying he does not understand the Redux example code " src="image/Figure_5.01_B18396.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.110.1">Figure 5.1 – Dan Abramov’s tweet saying he does not understand the Redux example code</span></p>
<p><span class="koboSpan" id="kobo.111.1">Around 2016, the maintenance of </span><strong class="bold"><span class="koboSpan" id="kobo.112.1">Redux</span></strong><span class="koboSpan" id="kobo.113.1"> was passed to </span><em class="italic"><span class="koboSpan" id="kobo.114.1">Mark Erikson</span></em><span class="koboSpan" id="kobo.115.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.116.1">Tim Dorr</span></em><span class="koboSpan" id="kobo.117.1">. </span><span class="koboSpan" id="kobo.117.2">I had the chance to exchange a few messages with Mark Erikson. </span><span class="koboSpan" id="kobo.117.3">He explained to me that he’s not getting paid for maintaining </span><strong class="bold"><span class="koboSpan" id="kobo.118.1">Redux</span></strong><span class="koboSpan" id="kobo.119.1">; he does it in his spare time, even though it can be very time-consuming. </span><span class="koboSpan" id="kobo.119.2">He says himself that he became a </span><strong class="bold"><span class="koboSpan" id="kobo.120.1">Redux</span></strong><span class="koboSpan" id="kobo.121.1"> maintainer by accident, but after reading his excellent blog post on this topic, I would say he became a </span><strong class="bold"><span class="koboSpan" id="kobo.122.1">Redux</span></strong><span class="koboSpan" id="kobo.123.1"> maintainer because of the amazing amount of work he put into </span><strong class="bold"><span class="koboSpan" id="kobo.124.1">Redux</span></strong><span class="koboSpan" id="kobo.125.1"> documentation and the time he spent helping developers who use </span><strong class="bold"><span class="koboSpan" id="kobo.126.1">Redux</span></strong><span class="koboSpan" id="kobo.127.1">. </span><span class="koboSpan" id="kobo.127.2">You can read the full story on his blog (link in the </span><em class="italic"><span class="koboSpan" id="kobo.128.1">Further reading</span></em><span class="koboSpan" id="kobo.129.1"> section). </span><span class="koboSpan" id="kobo.129.2">Mark added that he likes maintaining </span><strong class="bold"><span class="koboSpan" id="kobo.130.1">Redux</span></strong><span class="koboSpan" id="kobo.131.1">. </span><span class="koboSpan" id="kobo.131.2">He butts heads with developers who are unhappy with the decisions he’s making sometimes, but he also receives support from fellow OSS maintainers, as well as conference invites. </span><span class="koboSpan" id="kobo.131.3">I asked Mark what he thinks about </span><strong class="bold"><span class="koboSpan" id="kobo.132.1">Redux</span></strong><span class="koboSpan" id="kobo.133.1">’s place in the current state management libraries landscape. </span><span class="koboSpan" id="kobo.133.2">He pointed out there are many resources (NPM statistics, GitHub statistics, etc.) proving that </span><strong class="bold"><span class="koboSpan" id="kobo.134.1">Redux</span></strong><span class="koboSpan" id="kobo.135.1"> is still by far the most widely used state management library with </span><strong class="bold"><span class="koboSpan" id="kobo.136.1">React</span></strong><span class="koboSpan" id="kobo.137.1"> apps. </span><span class="koboSpan" id="kobo.137.2">However, as Mark said, </span><strong class="bold"><span class="koboSpan" id="kobo.138.1">Redux</span></strong><span class="koboSpan" id="kobo.139.1"> was</span><a id="_idIndexMarker213"/><span class="koboSpan" id="kobo.140.1"> heavily over-used from 2016 to 2017. </span><span class="koboSpan" id="kobo.140.2">During that time, a lot of developers raised legitimate complaints about the size of </span><strong class="bold"><span class="koboSpan" id="kobo.141.1">Redux</span></strong><span class="koboSpan" id="kobo.142.1">’s boilerplate. </span><span class="koboSpan" id="kobo.142.2">This situation led in turn to a backlash on Twitter, where a lot of people made claims that “</span><strong class="bold"><span class="koboSpan" id="kobo.143.1">Redux</span></strong><span class="koboSpan" id="kobo.144.1"> is dead” because one tool or another “killed it.” </span></p>
<p><span class="koboSpan" id="kobo.145.1">“</span><strong class="bold"><span class="koboSpan" id="kobo.146.1">RTK</span></strong><span class="koboSpan" id="kobo.147.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.148.1">React-Redux</span></strong><span class="koboSpan" id="kobo.149.1"> hooks changed that narrative. </span><span class="koboSpan" id="kobo.149.2">If you look at discussions on Reddit and Twitter today, you do see a good number of folks saying how much they love RTK and recommending it,” </span><span class="No-Break"><span class="koboSpan" id="kobo.150.1">Mark said.</span></span></p>
<p><strong class="bold"><span class="koboSpan" id="kobo.151.1">Redux</span></strong><span class="koboSpan" id="kobo.152.1"> is currently a mature and trusted solution for managing global states in </span><strong class="bold"><span class="koboSpan" id="kobo.153.1">React</span></strong><span class="koboSpan" id="kobo.154.1"> and </span><strong class="bold"><span class="koboSpan" id="kobo.155.1">React Native</span></strong><span class="koboSpan" id="kobo.156.1"> apps. </span><span class="koboSpan" id="kobo.156.2">We’ve looked briefly at its history in this section. </span><span class="koboSpan" id="kobo.156.3">It is obvious that it has its shortcomings. </span><span class="koboSpan" id="kobo.156.4">To quote Mark Erikson, “This is a useful tool, not meant for every situation, but a very valid choice.” </span><span class="koboSpan" id="kobo.156.5">It has its fans and haters, but it’s worth knowing about – and that’s why we’re here! </span><span class="No-Break"><span class="koboSpan" id="kobo.157.1">Let’s go!</span></span></p>
<h1 id="_idParaDest-59"><a id="_idTextAnchor060"/><span class="koboSpan" id="kobo.158.1">Installing and configuring Redux</span></h1>
<p><span class="koboSpan" id="kobo.159.1">As with any library that we would like to add to our project, we will start by reading the documentation. </span><span class="koboSpan" id="kobo.159.2">The </span><strong class="bold"><span class="koboSpan" id="kobo.160.1">Redux</span></strong><span class="koboSpan" id="kobo.161.1"> documentation has evolved a lot over the years. </span><span class="koboSpan" id="kobo.161.2">In 2022, the recommended install includes </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.162.1">Redux Toolkit</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.163.1">.</span></span></p>
<p><strong class="bold"><span class="koboSpan" id="kobo.164.1">Redux Toolkit</span></strong><span class="koboSpan" id="kobo.165.1"> is </span><a id="_idIndexMarker214"/><span class="koboSpan" id="kobo.166.1">the recommended official approach to using </span><strong class="bold"><span class="koboSpan" id="kobo.167.1">Redux</span></strong><span class="koboSpan" id="kobo.168.1">. </span><span class="koboSpan" id="kobo.168.2">It contains commonly used packages and dependencies for building </span><strong class="bold"><span class="koboSpan" id="kobo.169.1">Redux</span></strong><span class="koboSpan" id="kobo.170.1"> apps. </span><span class="koboSpan" id="kobo.170.2">This toolkit also simplifies a lot of tasks necessary for using </span><strong class="bold"><span class="koboSpan" id="kobo.171.1">Redux</span></strong><span class="koboSpan" id="kobo.172.1">, such as creating the store or reducers. </span><span class="koboSpan" id="kobo.172.2">Any user is free to install and use core </span><strong class="bold"><span class="koboSpan" id="kobo.173.1">Redux</span></strong><span class="koboSpan" id="kobo.174.1">, but we will use the recommended approach and use </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.175.1">Redux Toolkit</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.176.1">.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.177.1">Why not just Redux?</span></p>
<p class="callout"><span class="koboSpan" id="kobo.178.1">The Redux library has evolved a lot since its conception in 2015. </span><span class="koboSpan" id="kobo.178.2">Its ecosystem has also grown a lot. </span><span class="koboSpan" id="kobo.178.3">The recommended Redux Toolkit is the most practical addition to Redux apps written in 2022, although it is not </span><span class="No-Break"><span class="koboSpan" id="kobo.179.1">a necessity.</span></span></p>
<p><span class="koboSpan" id="kobo.180.1">Let’s start by </span><a id="_idIndexMarker215"/><span class="koboSpan" id="kobo.181.1">going into the files for the full app, which is placed in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.182.1">example-app-full</span></strong><span class="koboSpan" id="kobo.183.1"> folder. </span><span class="koboSpan" id="kobo.183.2">Feel free to work directly on those files on your computer. </span><span class="koboSpan" id="kobo.183.3">You</span><a id="_idIndexMarker216"/><span class="koboSpan" id="kobo.184.1"> can also fork the repository or copy the files from this folder. </span><span class="koboSpan" id="kobo.184.2">These files include everything you need to run a complete app. </span><span class="koboSpan" id="kobo.184.3">If you prefer to follow along with the working code, you should look in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.185.1">chapter-5</span></strong><span class="koboSpan" id="kobo.186.1"> folder. </span><span class="koboSpan" id="kobo.186.2">That is where all completed work for this chapter </span><span class="No-Break"><span class="koboSpan" id="kobo.187.1">is placed.</span></span></p>
<p><span class="koboSpan" id="kobo.188.1">Let’s get started. </span><span class="koboSpan" id="kobo.188.2">Follow </span><span class="No-Break"><span class="koboSpan" id="kobo.189.1">these steps:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.190.1">Once you are inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.191.1">app</span></strong><span class="koboSpan" id="kobo.192.1"> folder, run the </span><span class="No-Break"><span class="koboSpan" id="kobo.193.1">following command:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.194.1">npm install @reduxjs/toolkit</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.195.1">We will go ahead and install the complementary packages recommended in the </span><span class="No-Break"><span class="koboSpan" id="kobo.196.1">Redux documentation.</span></span></p>
<ol>
<li value="2"><span class="koboSpan" id="kobo.197.1">Let’s run the </span><span class="No-Break"><span class="koboSpan" id="kobo.198.1">following commands:</span></span><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.199.1">npm install react-redux</span></strong></pre><pre class="console">
<strong class="bold"><span class="koboSpan" id="kobo.200.1">npm install --save-dev @redux-devtools/core</span></strong></pre></li>
</ol>
<p><span class="koboSpan" id="kobo.201.1">Now that the dependencies are installed, we can take a minute to talk about </span><strong class="bold"><span class="koboSpan" id="kobo.202.1">Redux</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.203.1">core concepts.</span></span></p>
<p><span class="koboSpan" id="kobo.204.1">The main concept, and the absolute most important one, is that with </span><strong class="bold"><span class="koboSpan" id="kobo.205.1">Redux</span></strong><span class="koboSpan" id="kobo.206.1">, we consider the state a plain object. </span><span class="koboSpan" id="kobo.206.2">The </span><strong class="bold"><span class="koboSpan" id="kobo.207.1">Redux</span></strong><span class="koboSpan" id="kobo.208.1"> documentation uses a to-do app as an example, but we can go ahead and use our </span><span class="No-Break"><span class="koboSpan" id="kobo.209.1">Funbook app.</span></span></p>
<p><span class="koboSpan" id="kobo.210.1">If we were to represent the state of the logged-in user of the Funbook app with a single object, it may look something </span><span class="No-Break"><span class="koboSpan" id="kobo.211.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.212.1">
{
    userLoggedIn: true,
    userData: {
        id: 3,
        name: "John Doe",
        email: "john@doe.com",
        image: "imageURL",
        addedImages: […],
        likedImages: […],
        numberOfPosts: 35,
        numberOfFollowers: 1552,
        numberOfFollows: 128,
        idsOfFollowedUsers: […],
        idsOfConversations: […]
    },
}</span></pre>
<p><span class="koboSpan" id="kobo.213.1">In this example, we are trying to figure out holistically what user data will be necessary for the entire app. </span><span class="koboSpan" id="kobo.213.2">This is what is considered the GLOBAL state. </span><span class="koboSpan" id="kobo.213.3">We are not going surface to surface; we want to know all the data relevant to the user. </span><span class="koboSpan" id="kobo.213.4">Therefore, in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.214.1">userData</span></strong><span class="koboSpan" id="kobo.215.1"> object here, you will find data such as the username and email, which will be used on the </span><strong class="bold"><span class="koboSpan" id="kobo.216.1">Profile</span></strong><span class="koboSpan" id="kobo.217.1"> surface, an array of IDs of followed users, which we can use on the </span><strong class="bold"><span class="koboSpan" id="kobo.218.1">Feed</span></strong><span class="koboSpan" id="kobo.219.1"> surface for the list of avatars, and the array of IDs of conversations necessary for the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.220.1">Conversations</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.221.1"> surface.</span></span></p>
<p><span class="koboSpan" id="kobo.222.1">Of course, not all our </span><a id="_idIndexMarker217"/><span class="koboSpan" id="kobo.223.1">app data is directly dependent on the logged-in user. </span><span class="koboSpan" id="kobo.223.2">Let’s try</span><a id="_idIndexMarker218"/><span class="koboSpan" id="kobo.224.1"> and imagine the shape of the part of our global state for the modals present on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.225.1">Feed</span></strong><span class="koboSpan" id="kobo.226.1"> surface. </span><span class="koboSpan" id="kobo.226.2">Here’s what the state of the modal opened on an image click may </span><span class="No-Break"><span class="koboSpan" id="kobo.227.1">look like:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.228.1">
{
    imageModalOpen: true,
    imageId: 3,
    authorId: 3,
    imageUrl: "imageUrl",
    numberOfLikes: 28,
    numberOfConversations: 12,
    numberOfFollows: 128
}</span></pre>
<p><span class="koboSpan" id="kobo.229.1">Going </span><a id="_idIndexMarker219"/><span class="koboSpan" id="kobo.230.1">around the app, we may want to consider the shape of the slice of a</span><a id="_idIndexMarker220"/><span class="koboSpan" id="kobo.231.1"> global state related to the </span><strong class="bold"><span class="koboSpan" id="kobo.232.1">Conversations</span></strong><span class="koboSpan" id="kobo.233.1"> surface. </span><span class="koboSpan" id="kobo.233.2">In my opinion, the data shape we fetch from the fake API set up on GitHub Pages fits very well with the shape of the </span><span class="No-Break"><span class="koboSpan" id="kobo.234.1">global state:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.235.1">
[
  {
    "id": 1,
    "userId": 2,
    "text": "Hey, how's it going?"
</span><span class="koboSpan" id="kobo.235.2">  },
  {
    "id": 2,
    "userId": 4,
    "text": "Yo, are you going to the wedding?"
</span><span class="koboSpan" id="kobo.235.3">  },
//…</span></pre>
<p><span class="koboSpan" id="kobo.236.1">Having the global state be the same shape as the API response is generally welcome. </span><span class="koboSpan" id="kobo.236.2">In these cases, you, as the frontend developer, will not have to reshape the data or remember what keys are used where and why. </span><span class="koboSpan" id="kobo.236.3">In a perfect world, the API responses would always fit the shape of the data necessary to be shown on the UI. </span><span class="koboSpan" id="kobo.236.4">However, in the real world, that may mean that the frontend would be unnecessarily fetching data that can be shared between surfaces, or fetching unnecessarily big datasets </span><span class="No-Break"><span class="koboSpan" id="kobo.237.1">or images.</span></span></p>
<p><span class="koboSpan" id="kobo.238.1">I feel we are getting the hang of this whole idea of a global state, right? </span><span class="koboSpan" id="kobo.238.2">Feel free to try and figure out on your own what other slices of the global state our app may need. </span><span class="koboSpan" id="kobo.238.3">Maybe you can </span><a id="_idIndexMarker221"/><span class="koboSpan" id="kobo.239.1">sketch out the shape of the global state necessary for the</span><a id="_idIndexMarker222"/><span class="koboSpan" id="kobo.240.1"> modal displayed when an avatar is pressed – or maybe what exactly is needed for the </span><strong class="source-inline"><span class="koboSpan" id="kobo.241.1">Favorited</span></strong><span class="koboSpan" id="kobo.242.1"> images surface, and the same data on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.243.1">Profile</span></strong><span class="koboSpan" id="kobo.244.1"> surface. </span><span class="koboSpan" id="kobo.244.2">Come back here when you feel ready to move on to the second </span><strong class="bold"><span class="koboSpan" id="kobo.245.1">Redux</span></strong><span class="koboSpan" id="kobo.246.1"> concept: </span><span class="No-Break"><span class="koboSpan" id="kobo.247.1">dispatching actions.</span></span></p>
<p><span class="koboSpan" id="kobo.248.1">Oh hi! </span><span class="koboSpan" id="kobo.248.2">You’re back! </span><span class="koboSpan" id="kobo.248.3">Great! </span><span class="koboSpan" id="kobo.248.4">Let’s talk more about </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.249.1">Redux</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.250.1"> then!</span></span></p>
<h2 id="_idParaDest-60"><a id="_idTextAnchor061"/><span class="koboSpan" id="kobo.251.1">Dispatching actions</span></h2>
<p><span class="koboSpan" id="kobo.252.1">Let’s say we’ve set up the </span><a id="_idIndexMarker223"/><span class="koboSpan" id="kobo.253.1">global state – we replaced a lot of unnecessary props and we’re happy – but what if we want to change something? </span><span class="koboSpan" id="kobo.253.2">What if the user likes an image? </span><span class="koboSpan" id="kobo.253.3">What if the user adds a new image or follows another user? </span><span class="koboSpan" id="kobo.253.4">We need to tell our state that something has changed. </span><span class="koboSpan" id="kobo.253.5">This is when we will dispatch actions. </span><span class="koboSpan" id="kobo.253.6">An action</span><a id="_idIndexMarker224"/><span class="koboSpan" id="kobo.254.1"> is a plain JavaScript object that describes what is happening. </span><span class="koboSpan" id="kobo.254.2">We could dispatch an action that looks </span><span class="No-Break"><span class="koboSpan" id="kobo.255.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.256.1">
{ type: 'LIKE_IMAGE', payload: { Object with data about the liked image } }</span></pre>
<p><span class="koboSpan" id="kobo.257.1">What now? </span><span class="koboSpan" id="kobo.257.2">Has the global state changed magically? </span><span class="koboSpan" id="kobo.257.3">Unfortunately, no. </span><span class="koboSpan" id="kobo.257.4">We still need to tell </span><strong class="bold"><span class="koboSpan" id="kobo.258.1">Redux</span></strong><span class="koboSpan" id="kobo.259.1"> to change the state based on this action. </span><span class="koboSpan" id="kobo.259.2">The missing piece of this puzzle that ties the actions to the state is called a </span><a id="_idIndexMarker225"/><span class="koboSpan" id="kobo.260.1">reducer. </span><span class="koboSpan" id="kobo.260.2">Reducer functions are plain </span><strong class="bold"><span class="koboSpan" id="kobo.261.1">JavaScript</span></strong><span class="koboSpan" id="kobo.262.1"> functions that take in the old state and the action and return the new state of the app. </span><span class="koboSpan" id="kobo.262.2">Here’s what a very simple reducer for liked images may </span><span class="No-Break"><span class="koboSpan" id="kobo.263.1">look like:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.264.1">
function likedImages(state =[], action) {
  if (action.type === 'LIKE_IMAGE') {
    let newLikedImages = state;
    newLikedImages.push(action.payload);
    return newLikedImages
  } else {
    return state
  }
}</span></pre>
<p><span class="koboSpan" id="kobo.265.1">We are taking in the old state – in this case, the array of liked images. </span><span class="koboSpan" id="kobo.265.2">We are then adding the new item and returning the new state. </span><span class="koboSpan" id="kobo.265.3">We also get some very elegant error handling in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.266.1">else</span></strong><span class="koboSpan" id="kobo.267.1"> block, where if there are any problems, the app will return to the </span><span class="No-Break"><span class="koboSpan" id="kobo.268.1">old state.</span></span></p>
<p><span class="koboSpan" id="kobo.269.1">I have described three concepts in </span><span class="No-Break"><span class="koboSpan" id="kobo.270.1">this section:</span></span></p>
<ol>
<li value="1"><strong class="bold"><span class="koboSpan" id="kobo.271.1">The store</span></strong><span class="koboSpan" id="kobo.272.1"> – the </span><a id="_idIndexMarker226"/><span class="koboSpan" id="kobo.273.1">single source of truth for the </span><span class="No-Break"><span class="koboSpan" id="kobo.274.1">global state</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.275.1">Reducers</span></strong><span class="koboSpan" id="kobo.276.1"> – functions that take in the old state and the action, do what you need them to do, and</span><a id="_idIndexMarker227"/><span class="koboSpan" id="kobo.277.1"> return the </span><span class="No-Break"><span class="koboSpan" id="kobo.278.1">new state</span></span></li>
<li><strong class="bold"><span class="koboSpan" id="kobo.279.1">Actions</span></strong><span class="koboSpan" id="kobo.280.1"> – plain</span><a id="_idIndexMarker228"/><span class="koboSpan" id="kobo.281.1"> JavaScript objects containing information for </span><span class="No-Break"><span class="koboSpan" id="kobo.282.1">the store</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.283.1">These are basically all you </span><a id="_idIndexMarker229"/><span class="koboSpan" id="kobo.284.1">need to know to start using </span><strong class="bold"><span class="koboSpan" id="kobo.285.1">Redux</span></strong><span class="koboSpan" id="kobo.286.1"> effectively. </span><span class="koboSpan" id="kobo.286.2">If you would like to read more about the concepts and the history of this great library, check out the </span><em class="italic"><span class="koboSpan" id="kobo.287.1">Further reading</span></em><span class="koboSpan" id="kobo.288.1"> section where you’ll find links to the </span><strong class="bold"><span class="koboSpan" id="kobo.289.1">Redux</span></strong><span class="koboSpan" id="kobo.290.1"> documentation. </span><span class="koboSpan" id="kobo.290.2">Now that we know the basics, we are ready to apply this fresh knowledge to a </span><span class="No-Break"><span class="koboSpan" id="kobo.291.1">real app.</span></span></p>
<h1 id="_idParaDest-61"><a id="_idTextAnchor062"/><span class="koboSpan" id="kobo.292.1">Adding Redux functionalities to the app</span></h1>
<p><span class="koboSpan" id="kobo.293.1">We have installed the </span><strong class="bold"><span class="koboSpan" id="kobo.294.1">Redux Toolkit</span></strong><span class="koboSpan" id="kobo.295.1"> with our friendly package manager in the previous </span><a id="_idIndexMarker230"/><span class="koboSpan" id="kobo.296.1">section, but we haven’t made any </span><a id="_idIndexMarker231"/><span class="koboSpan" id="kobo.297.1">real changes in our app yet. </span><span class="koboSpan" id="kobo.297.2">We have, however, thought about the data flows in our app in the previous chapters. </span><span class="koboSpan" id="kobo.297.3">The work that we need to do now is going to be very similar. </span><span class="koboSpan" id="kobo.297.4">We will start by designing the state structure and actions. </span><span class="koboSpan" id="kobo.297.5">When we have both of those, we will add reducers to tie </span><span class="No-Break"><span class="koboSpan" id="kobo.298.1">everything together.</span></span></p>
<p><span class="koboSpan" id="kobo.299.1">There’s a lot of work ahead of us, so let’s try to break it down into smaller chunks. </span><span class="koboSpan" id="kobo.299.2">We will start by looking at the user state and how we could manage a user’s logged-in and logged-out state with a global state in </span><strong class="bold"><span class="koboSpan" id="kobo.300.1">Redux</span></strong><span class="koboSpan" id="kobo.301.1">. </span><span class="koboSpan" id="kobo.301.2">We will then do that same walkthrough for liked images in our app. </span><span class="koboSpan" id="kobo.301.3">When we have successfully set up those two pieces of the global state, we will look at how we can combine them and use them in our app. </span><span class="koboSpan" id="kobo.301.4">We will then create some actions to handle events in the app. </span><span class="koboSpan" id="kobo.301.5">Once we have the state and the actions, we’ll take a brief look at how data can be fetched in an app with </span><strong class="bold"><span class="koboSpan" id="kobo.302.1">Redux</span></strong><span class="koboSpan" id="kobo.303.1">. </span><span class="koboSpan" id="kobo.303.2">Finally, we will be ready to get rid of the </span><strong class="bold"><span class="koboSpan" id="kobo.304.1">React</span></strong><span class="koboSpan" id="kobo.305.1"> context we used before for managing the state of </span><span class="No-Break"><span class="koboSpan" id="kobo.306.1">our app.</span></span></p>
<h2 id="_idParaDest-62"><a id="_idTextAnchor063"/><span class="koboSpan" id="kobo.307.1">User login state walkthrough</span></h2>
<p><span class="koboSpan" id="kobo.308.1">Let’s start with the user </span><a id="_idIndexMarker232"/><span class="koboSpan" id="kobo.309.1">state. </span><span class="koboSpan" id="kobo.309.2">We will create a new file called </span><strong class="source-inline"><span class="koboSpan" id="kobo.310.1">store.js</span></strong><span class="koboSpan" id="kobo.311.1"> where we will store our initial state slices. </span><span class="koboSpan" id="kobo.311.2">We will add this </span><strong class="bold"><span class="koboSpan" id="kobo.312.1">JavaScript</span></strong><span class="koboSpan" id="kobo.313.1"> object to </span><span class="No-Break"><span class="koboSpan" id="kobo.314.1">that file:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.315.1">
export const user = {
  userLoggedIn: false,
  userData: null,
};</span></pre>
<p><span class="koboSpan" id="kobo.316.1">When the app is first loaded, we will assume the user is not logged in and there is no </span><span class="No-Break"><span class="koboSpan" id="kobo.317.1">user data.</span></span></p>
<p><span class="koboSpan" id="kobo.318.1">Now, we need to think of an action that will be dispatched when the user is logging in. </span><span class="koboSpan" id="kobo.318.2">It should look </span><span class="No-Break"><span class="koboSpan" id="kobo.319.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.320.1">
{type: 'LOGIN', payload: userData}</span></pre>
<p><span class="koboSpan" id="kobo.321.1">The last part is the reducer. </span><span class="koboSpan" id="kobo.321.2">Let’s create a new folder for our reducers, called… well, </span><strong class="source-inline"><span class="koboSpan" id="kobo.322.1">reducers</span></strong><span class="koboSpan" id="kobo.323.1">. </span><span class="koboSpan" id="kobo.323.2">Inside this folder, we will create our reducer file, which should look </span><span class="No-Break"><span class="koboSpan" id="kobo.324.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.325.1">
// reducers/user.js
import { user } from "../store";
export const login = (state=user, action) =&gt; {
  if (action.type === 'LOGIN') {
    return {
        ...state,
        user: {
          userLoggedIn: true,
          user: action.payload,
        },
    }
  } else {
    return state
  }
}</span></pre>
<p><span class="koboSpan" id="kobo.326.1">We are importing our user object as the initial state and then we’re adding a switch that will listen to specific actions. </span><span class="koboSpan" id="kobo.326.2">Let’s listen to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.327.1">'</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.328.1">LOGIN'</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.329.1"> action.</span></span></p>
<p><span class="koboSpan" id="kobo.330.1">But wait – what if our user would like to sign out? </span><span class="koboSpan" id="kobo.330.2">We need another action specifically </span><span class="No-Break"><span class="koboSpan" id="kobo.331.1">for this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.332.1">
{ type: 'LOGOUT' }</span></pre>
<p><span class="koboSpan" id="kobo.333.1">I didn’t add any action</span><a id="_idIndexMarker233"/><span class="koboSpan" id="kobo.334.1"> payload in this case, because we will not be passing any actual data. </span><span class="koboSpan" id="kobo.334.2">We only want to wipe the data and we will do that in the reducer. </span><span class="koboSpan" id="kobo.334.3">We could add another ‘</span><strong class="source-inline"><span class="koboSpan" id="kobo.335.1">if</span></strong><span class="koboSpan" id="kobo.336.1">’ statement to the reducer, but big </span><strong class="source-inline"><span class="koboSpan" id="kobo.337.1">if-else</span></strong><span class="koboSpan" id="kobo.338.1"> statements become difficult to read and reason about. </span><span class="koboSpan" id="kobo.338.2">In the case of reducers, it’s a good idea to use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.339.1">switch</span></strong><span class="koboSpan" id="kobo.340.1"> statement, since we’re effectively switching between different states of the app. </span><span class="koboSpan" id="kobo.340.2">Here’s what our reducer will </span><span class="No-Break"><span class="koboSpan" id="kobo.341.1">look like:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.342.1">
export const login = (state=user, action) =&gt; {
  switch (action.type) {
    case "LOGIN": {
      return {
        ...state,
        user: {
          userLoggedIn: true,
          user: action.payload,
        },
      };
    }
    case "LOGOUT": {
      return {
        ...state,
        user: {
          userLoggedIn: false,
          user: null,
        },
      };
    }
    default:
      return state;
  }
}</span></pre>
<p><span class="koboSpan" id="kobo.343.1">OK – now when a user logs in, we will set the global state of the app to reflect that, right? </span><span class="koboSpan" id="kobo.343.2">Almost! </span><span class="koboSpan" id="kobo.343.3">We still need to find the right place in our code where we will dispatch this action, and that place is the login button on the </span><strong class="bold"><span class="koboSpan" id="kobo.344.1">Login</span></strong><span class="koboSpan" id="kobo.345.1"> surface – but our </span><strong class="bold"><span class="koboSpan" id="kobo.346.1">Login</span></strong><span class="koboSpan" id="kobo.347.1"> surface is shown based on the local state of the main component! </span><span class="koboSpan" id="kobo.347.2">That means there’s still a little bit more work that we need to do before we will see the magic of Redux. </span><span class="koboSpan" id="kobo.347.3">Don’t worry though, it </span><a id="_idIndexMarker234"/><span class="koboSpan" id="kobo.348.1">will be </span><span class="No-Break"><span class="koboSpan" id="kobo.349.1">worth it!</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.350.1">Important information</span></p>
<p class="callout"><span class="koboSpan" id="kobo.351.1">If you do have any doubts about all this extra work we seem to be doing, I invite you, my dear reader, to read the </span><strong class="bold"><span class="koboSpan" id="kobo.352.1">React Navigation</span></strong><span class="koboSpan" id="kobo.353.1"> documentation on authentication flows: </span><a href="https://reactnavigation.org/docs/auth-flow/"><span class="koboSpan" id="kobo.354.1">https://reactnavigation.org/docs/auth-flow/</span></a><span class="koboSpan" id="kobo.355.1">. </span><span class="koboSpan" id="kobo.355.2">In this</span><a id="_idIndexMarker235"/><span class="koboSpan" id="kobo.356.1"> documentation, you will find that you should not manually navigate when conditionally rendering screens. </span><span class="koboSpan" id="kobo.356.2">You would also need to set up the context and preferably use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.357.1">useReducer</span></strong><span class="koboSpan" id="kobo.358.1"> hook from </span><strong class="bold"><span class="koboSpan" id="kobo.359.1">ReactJS</span></strong><span class="koboSpan" id="kobo.360.1">. </span><span class="koboSpan" id="kobo.360.2">If </span><strong class="source-inline"><span class="koboSpan" id="kobo.361.1">useReducer</span></strong><span class="koboSpan" id="kobo.362.1"> sounds familiar at this point, that is because it’s a </span><strong class="bold"><span class="koboSpan" id="kobo.363.1">ReactJS</span></strong><span class="koboSpan" id="kobo.364.1"> hook with identical functionality to the </span><strong class="bold"><span class="koboSpan" id="kobo.365.1">Redux</span></strong><span class="koboSpan" id="kobo.366.1"> reducers. </span><span class="koboSpan" id="kobo.366.2">I hope by now you are starting to feel convinced that using a state management library such as </span><strong class="bold"><span class="koboSpan" id="kobo.367.1">Redux</span></strong><span class="koboSpan" id="kobo.368.1"> is a great solution for React </span><span class="No-Break"><span class="koboSpan" id="kobo.369.1">Native apps.</span></span></p>
<p><span class="koboSpan" id="kobo.370.1">You may wonder why we used </span><a id="_idIndexMarker236"/><span class="koboSpan" id="kobo.371.1">a spread operator with the state and then changed the value of </span><strong class="source-inline"><span class="koboSpan" id="kobo.372.1">userLoggedIn</span></strong><span class="koboSpan" id="kobo.373.1">. </span><span class="koboSpan" id="kobo.373.2">Theoretically, it would be easier to just change the value in the state, no? </span><span class="koboSpan" id="kobo.373.3">Not in </span><strong class="bold"><span class="koboSpan" id="kobo.374.1">Redux</span></strong><span class="koboSpan" id="kobo.375.1">. </span><strong class="bold"><span class="koboSpan" id="kobo.376.1">Redux</span></strong><span class="koboSpan" id="kobo.377.1"> is very adamant about the reducers NOT being able to modify the current state. </span><span class="koboSpan" id="kobo.377.2">Reducers can only copy the state and make changes to the copied values. </span><span class="koboSpan" id="kobo.377.3">This is important so that our code is predictable. </span><span class="koboSpan" id="kobo.377.4">If many reducers changed the same slice of state, who’s to say what would be </span><span class="No-Break"><span class="koboSpan" id="kobo.378.1">the result?</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.379.1">Immutability</span></p>
<p class="callout"><span class="koboSpan" id="kobo.380.1">This is a very fancy word, isn’t it? </span><span class="koboSpan" id="kobo.380.2">It means that something is not capable of change, or that it should not be changed. </span><span class="koboSpan" id="kobo.380.3">In the case of JavaScript apps, immutable data management can increase performance and make programming and debugging easier. </span><span class="koboSpan" id="kobo.380.4">Redux reducers take in the old state and the action and return a new state object; they should never apply changes to the “old” </span><span class="No-Break"><span class="koboSpan" id="kobo.381.1">state object.</span></span></p>
<p><span class="koboSpan" id="kobo.382.1">If you are curious about the key concepts of </span><strong class="bold"><span class="koboSpan" id="kobo.383.1">Redux</span></strong><span class="koboSpan" id="kobo.384.1">, I invite you again to the </span><em class="italic"><span class="koboSpan" id="kobo.385.1">Further reading</span></em><span class="koboSpan" id="kobo.386.1"> section, where you will find a link to a free course on </span><a href="http://Egghead.io"><span class="koboSpan" id="kobo.387.1">Egghead.io</span></a><span class="koboSpan" id="kobo.388.1">, created by the author of </span><strong class="bold"><span class="koboSpan" id="kobo.389.1">Redux</span></strong><span class="koboSpan" id="kobo.390.1">, </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.391.1">Dan Abramov</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.392.1">.</span></span></p>
<h2 id="_idParaDest-63"><a id="_idTextAnchor064"/><span class="koboSpan" id="kobo.393.1">Using Redux for liked images</span></h2>
<p><span class="koboSpan" id="kobo.394.1">Our global state</span><a id="_idIndexMarker237"/><span class="koboSpan" id="kobo.395.1"> is rather poor so far. </span><span class="koboSpan" id="kobo.395.2">Keeping the user data in the global state is great but we can surely do more with this great tool. </span><span class="koboSpan" id="kobo.395.3">How about liking posts? </span><span class="koboSpan" id="kobo.395.4">The reducer for liking posts will look </span><span class="No-Break"><span class="koboSpan" id="kobo.396.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.397.1">
export const likedImages = (state = [], action) =&gt; {
  if (action.type === "LIKE_IMAGE") {
    let newLikedImages = state;
    newLikedImages.push(action.payload);
    return newLikedImages;
  } else {
    return state;
  }
};</span></pre>
<p><span class="koboSpan" id="kobo.398.1">And what if the user decided to unlike a post? </span><span class="koboSpan" id="kobo.398.2">Let’s add an action and a reducer for </span><span class="No-Break"><span class="koboSpan" id="kobo.399.1">this scenario:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.400.1">
{ type: 'UNLIKE_IMAGE', payload: { Object with data about the unliked image } }</span></pre>
<p><span class="koboSpan" id="kobo.401.1">Now, let’s </span><a id="_idIndexMarker238"/><span class="koboSpan" id="kobo.402.1">adjust our reducer. </span><span class="koboSpan" id="kobo.402.2">Since we have multiple actions in a single reducer, we will use a </span><strong class="source-inline"><span class="koboSpan" id="kobo.403.1">switch</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.404.1">statement again:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.405.1">
// ./reducers/likedImages.js
export const likedImagesReducer = (state = [], action) =&gt; {
  switch (action.type) {
    case "LIKE_IMAGE": {
      const newLikedImage = action.payload;
      return [...state, newLikedImage];
    }
    case "UNLIKE_IMAGE": {
      const stateWithoutLikedImage = state.filter(
        (item) =&gt; item !== action.payload
      );
      return stateWithoutLikedImage;
    }
    default: {
      throw new Error(`Unhandled action type: ${action.type}`);
    }
  }
};</span></pre>
<h2 id="_idParaDest-64"><a id="_idTextAnchor065"/><span class="koboSpan" id="kobo.406.1">Combining various pieces of global state</span></h2>
<p><span class="koboSpan" id="kobo.407.1">We have two</span><a id="_idIndexMarker239"/><span class="koboSpan" id="kobo.408.1"> reducers, each one meant to manage two different actions. </span><span class="koboSpan" id="kobo.408.2">What we need to do now is create a store that will represent the global state of the Funbook app and pass actions into reducers. </span><span class="koboSpan" id="kobo.408.3">We could use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.409.1">createStore</span></strong><span class="koboSpan" id="kobo.410.1"> function from core </span><strong class="bold"><span class="koboSpan" id="kobo.411.1">Redux</span></strong><span class="koboSpan" id="kobo.412.1">, but that would require adding more boilerplate files and functions, and it is not the recommended approach for modern </span><strong class="bold"><span class="koboSpan" id="kobo.413.1">Redux</span></strong><span class="koboSpan" id="kobo.414.1">. </span><span class="koboSpan" id="kobo.414.2">The recommended approach is </span><a id="_idIndexMarker240"/><span class="koboSpan" id="kobo.415.1">using </span><strong class="bold"><span class="koboSpan" id="kobo.416.1">Redux Toolkit</span></strong><span class="koboSpan" id="kobo.417.1">, which we will do right now. </span><strong class="bold"><span class="koboSpan" id="kobo.418.1">Redux Toolkit</span></strong><span class="koboSpan" id="kobo.419.1"> offers a special </span><strong class="source-inline"><span class="koboSpan" id="kobo.420.1">configureStore</span></strong><span class="koboSpan" id="kobo.421.1"> function, which will do a lot of heavy lifting for us. </span><span class="koboSpan" id="kobo.421.2">All we need to do is add </span><span class="No-Break"><span class="koboSpan" id="kobo.422.1">this function:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.423.1">
// ./store.js
import { configureStore } from "@reduxjs/toolkit";
import usersReducer from "./reducers/users";
import likedImagesReducer from "./reducers/likedImages";
export const store = configureStore({
  reducer: {
    user: usersReducer,
    likedImages: likedImagesReducer,
  },
});</span></pre>
<p><span class="koboSpan" id="kobo.424.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.425.1">configureStore</span></strong><span class="koboSpan" id="kobo.426.1"> function combined our two reducers for us, creating a root reducer required by </span><strong class="bold"><span class="koboSpan" id="kobo.427.1">Redux</span></strong><span class="koboSpan" id="kobo.428.1">. </span><span class="koboSpan" id="kobo.428.2">This single root reducer is required to achieve a single source of truth in the app. </span><span class="koboSpan" id="kobo.428.3">This function also adds some useful middleware functionalities, which will check for common mistakes and expose our code for </span><span class="No-Break"><span class="koboSpan" id="kobo.429.1">easier debugging.</span></span></p>
<p><span class="koboSpan" id="kobo.430.1">We created the </span><a id="_idIndexMarker241"/><span class="koboSpan" id="kobo.431.1">global state, and we configured it with the reducers thanks to </span><strong class="bold"><span class="koboSpan" id="kobo.432.1">Redux</span></strong> <strong class="bold"><span class="koboSpan" id="kobo.433.1">Toolkit</span></strong><span class="koboSpan" id="kobo.434.1">. </span><span class="koboSpan" id="kobo.434.2">Now, we need to tell our Funbook app to use this state. </span><span class="koboSpan" id="kobo.434.3">In order to do so, we will use a </span><strong class="source-inline"><span class="koboSpan" id="kobo.435.1">&lt;Provider&gt;</span></strong><span class="koboSpan" id="kobo.436.1"> component wrapper provided (no pun intended) by the </span><strong class="bold"><span class="koboSpan" id="kobo.437.1">Redux</span></strong><span class="koboSpan" id="kobo.438.1"> library. </span><span class="koboSpan" id="kobo.438.2">If you paid attention while we were setting up the app without any exterior libraries, you will have noticed that the </span><strong class="bold"><span class="koboSpan" id="kobo.439.1">React</span></strong><span class="koboSpan" id="kobo.440.1"> context also uses </span><strong class="source-inline"><span class="koboSpan" id="kobo.441.1">&lt;Provider&gt;</span></strong><span class="koboSpan" id="kobo.442.1"> components. </span><span class="koboSpan" id="kobo.442.2">The naming convention is not an accident. </span><span class="koboSpan" id="kobo.442.3">Both </span><strong class="source-inline"><span class="koboSpan" id="kobo.443.1">&lt;Provider&gt;</span></strong><span class="koboSpan" id="kobo.444.1"> components serve the same purpose and </span><strong class="bold"><span class="koboSpan" id="kobo.445.1">React</span></strong><span class="koboSpan" id="kobo.446.1"> context uses a lot of the same high-level logic </span><span class="No-Break"><span class="koboSpan" id="kobo.447.1">as </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.448.1">Redux</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.449.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.450.1">Let’s import the necessary elements into our main app </span><span class="No-Break"><span class="koboSpan" id="kobo.451.1">file, </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.452.1">App.js</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.453.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.454.1">
import { store } from "./store";
import { Provider } from "react-redux";</span></pre>
<p><span class="koboSpan" id="kobo.455.1">And let’s wrap our app in the </span><span class="No-Break"><span class="koboSpan" id="kobo.456.1">Redux </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.457.1">&lt;Provider&gt;</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.458.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.459.1">
export default function App() {
//…
  return (
    &lt;SafeAreaProvider&gt;
      &lt;Provider store={store}&gt;
//…</span></pre>
<p><span class="koboSpan" id="kobo.460.1">This looks familiar, doesn’t it? </span><strong class="bold"><span class="koboSpan" id="kobo.461.1">Redux</span></strong><span class="koboSpan" id="kobo.462.1">’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.463.1">&lt;Provider&gt;</span></strong><span class="koboSpan" id="kobo.464.1"> shares a lot of similarities with </span><strong class="bold"><span class="koboSpan" id="kobo.465.1">React’s</span></strong><span class="koboSpan" id="kobo.466.1"> context. </span><span class="koboSpan" id="kobo.466.2">I cannot give you any links to official blog posts from the Meta team where React maintainers officially explain this. </span><span class="koboSpan" id="kobo.466.3">I can, however, give you my personal opinion that the React team saw the solution that </span><strong class="bold"><span class="koboSpan" id="kobo.467.1">Redux</span></strong><span class="koboSpan" id="kobo.468.1"> was bringing to large </span><strong class="bold"><span class="koboSpan" id="kobo.469.1">React</span></strong><span class="koboSpan" id="kobo.470.1"> apps and thought that some of its principles were worth importing into the </span><strong class="bold"><span class="koboSpan" id="kobo.471.1">React</span></strong><span class="koboSpan" id="kobo.472.1"> repository itself. </span><span class="koboSpan" id="kobo.472.2">There are other state management solutions out there, obviously. </span><span class="koboSpan" id="kobo.472.3">If there weren’t, I wouldn’t be able to write this book! </span><span class="koboSpan" id="kobo.472.4">Regardless, </span><strong class="bold"><span class="koboSpan" id="kobo.473.1">Redux</span></strong><span class="koboSpan" id="kobo.474.1"> holds a special place in the </span><span class="No-Break"><span class="koboSpan" id="kobo.475.1">React ecosystem.</span></span></p>
<p><span class="koboSpan" id="kobo.476.1">After this short break, we will dive back into our code! </span><span class="koboSpan" id="kobo.476.2">We have our store and </span><strong class="source-inline"><span class="koboSpan" id="kobo.477.1">Provider</span></strong><span class="koboSpan" id="kobo.478.1"> set up. </span><span class="koboSpan" id="kobo.478.2">We also have two reducers ready: for user data and liked images data. </span><span class="koboSpan" id="kobo.478.3">Let’s start with replacing the liked images. </span><span class="koboSpan" id="kobo.478.4">We’ll go into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.479.1">surfaces</span></strong><span class="koboSpan" id="kobo.480.1"> folder, where we will find the Favorited surface. </span><span class="koboSpan" id="kobo.480.2">This, in turn, will lead us to the component named </span><strong class="source-inline"><span class="koboSpan" id="kobo.481.1">ListOfFavorites</span></strong><span class="koboSpan" id="kobo.482.1">, which displays data from the </span><span class="No-Break"><span class="koboSpan" id="kobo.483.1">Favorited context.</span></span></p>
<p><span class="koboSpan" id="kobo.484.1">We will remove </span><a id="_idIndexMarker242"/><span class="koboSpan" id="kobo.485.1">this context and use </span><strong class="bold"><span class="koboSpan" id="kobo.486.1">Redux</span></strong><span class="koboSpan" id="kobo.487.1"> data. </span><span class="koboSpan" id="kobo.487.2">We will start by importing a </span><strong class="source-inline"><span class="koboSpan" id="kobo.488.1">useSelector</span></strong><span class="koboSpan" id="kobo.489.1"> hook from Redux, and then we will fetch the actual data from </span><strong class="bold"><span class="koboSpan" id="kobo.490.1">Redux</span></strong><span class="koboSpan" id="kobo.491.1"> using </span><span class="No-Break"><span class="koboSpan" id="kobo.492.1">this hook:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.493.1">
// src/components/ListOfFavorites
import { useSelector } from "react-redux";
export const ListOfFavorites = ({ navigation }) =&gt; {
    const { likedImages } = useSelector((state) =&gt;      state.likedImages);
//…</span></pre>
<p><span class="koboSpan" id="kobo.494.1">Do you have our app running on your phone or in the simulator? </span><span class="koboSpan" id="kobo.494.2">I hope you do because then you will notice something just went </span><span class="No-Break"><span class="koboSpan" id="kobo.495.1">very wrong!</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer031">
<span class="koboSpan" id="kobo.496.1"><img alt="Figure 5.2 – iPhone simulator screenshot with a Redux error " src="image/Figure_5.02_B18396.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.497.1">Figure 5.2 – iPhone simulator screenshot with a Redux error</span></p>
<p><strong class="bold"><span class="koboSpan" id="kobo.498.1">Unhandled action type</span></strong><span class="koboSpan" id="kobo.499.1">…? </span><span class="koboSpan" id="kobo.499.2">I </span><a id="_idIndexMarker243"/><span class="koboSpan" id="kobo.500.1">think I’ve seen this somewhere… Oh yes! </span><span class="koboSpan" id="kobo.500.2">That’s the default in our </span><strong class="source-inline"><span class="koboSpan" id="kobo.501.1">switch</span></strong><span class="koboSpan" id="kobo.502.1"> statement in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.503.1">likedImages</span></strong><span class="koboSpan" id="kobo.504.1"> reducer! </span><span class="koboSpan" id="kobo.504.2">This is not really the default that we want, so let’s go ahead and change it so that it returns the initial state </span><span class="No-Break"><span class="koboSpan" id="kobo.505.1">by default:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.506.1">
//reducers/likedImages.js
export const likedImagesReducer = (state = [], action) =&gt; {
  switch (action.type) {
  //…
    default: {
      return state;
    }
  }
};</span></pre>
<p><span class="koboSpan" id="kobo.507.1">The app loads correctly – we’re back in business! </span><span class="koboSpan" id="kobo.507.2">We are passing the initial state as the default value to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.508.1">likedImages</span></strong><span class="koboSpan" id="kobo.509.1"> reducer, which means we are passing an empty array – but we want to fetch image data. </span><span class="koboSpan" id="kobo.509.2">We did this before in the Context Providers using </span><strong class="source-inline"><span class="koboSpan" id="kobo.510.1">fetch</span></strong><span class="koboSpan" id="kobo.511.1">. </span><strong class="source-inline"><span class="koboSpan" id="kobo.512.1">FavoritedContextProvided</span></strong><span class="koboSpan" id="kobo.513.1"> used React’s </span><strong class="source-inline"><span class="koboSpan" id="kobo.514.1">useReducer</span></strong><span class="koboSpan" id="kobo.515.1"> hook along with an </span><strong class="source-inline"><span class="koboSpan" id="kobo.516.1">init_likes</span></strong><span class="koboSpan" id="kobo.517.1"> action dispatched when the images were fetched successfully. </span><span class="koboSpan" id="kobo.517.2">When it comes to </span><strong class="bold"><span class="koboSpan" id="kobo.518.1">Redux</span></strong><span class="koboSpan" id="kobo.519.1">, we do not add functions inside </span><strong class="source-inline"><span class="koboSpan" id="kobo.520.1">Provider</span></strong><span class="koboSpan" id="kobo.521.1">. </span><span class="koboSpan" id="kobo.521.2">We will create a fetching function inside an action, and then we will dispatch that action when the Favorited surface is rendered. </span><span class="koboSpan" id="kobo.521.3">This is a simplistic solution for a simple app. </span><span class="koboSpan" id="kobo.521.4">If you are working on a bigger app, you would probably need to concern yourself with caching, avoiding duplicate requests or a cache lifetime. </span><span class="koboSpan" id="kobo.521.5">In that case, you should look into a tool provided by Redux Toolkit, called RTK Query, which </span><a id="_idIndexMarker244"/><span class="koboSpan" id="kobo.522.1">simplifies data fetching and caching in </span><a id="_idIndexMarker245"/><span class="No-Break"><span class="koboSpan" id="kobo.523.1">Redux apps.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.524.1">A full toolbelt</span></p>
<p class="callout"><span class="koboSpan" id="kobo.525.1">It may start to feel overwhelming learning about so many tools at once. </span><span class="koboSpan" id="kobo.525.2">We started with Redux, continued with Redux Toolkit, and now we’re adding RTK Query. </span><span class="koboSpan" id="kobo.525.3">Don’t worry too much at this point about libraries and tool names. </span><span class="koboSpan" id="kobo.525.4">We’re here to learn how to effectively write an app with a state managed by Redux, and we’re following the documentation and best practices to do so. </span><span class="koboSpan" id="kobo.525.5">Once you’re familiar with the suggested solution, feel free to look around the Redux ecosystem and find the approach that you like the most. </span><span class="koboSpan" id="kobo.525.6">There are no wrong answers when it comes to what you like and </span><span class="No-Break"><span class="koboSpan" id="kobo.526.1">don’t like!</span></span></p>
<h2 id="_idParaDest-65"><a id="_idTextAnchor066"/><span class="koboSpan" id="kobo.527.1">Taking advantage of Redux Toolkit for creating actions</span></h2>
<p><span class="koboSpan" id="kobo.528.1">Our reducer is</span><a id="_idIndexMarker246"/><span class="koboSpan" id="kobo.529.1"> very limited so far. </span><span class="koboSpan" id="kobo.529.2">We can’t use it directly to fetch data, because as the rules of reducers state, reducers cannot be used to do any asynchronous logic. </span><span class="koboSpan" id="kobo.529.3">If we were writing our app sometime around 2018 or 2019, we would probably create a separate </span><strong class="source-inline"><span class="koboSpan" id="kobo.530.1">actions</span></strong><span class="koboSpan" id="kobo.531.1"> file, manually configure </span><strong class="bold"><span class="koboSpan" id="kobo.532.1">Redux</span></strong><span class="koboSpan" id="kobo.533.1"> middleware functions to manage asynchronous API calls, and finally proceed to write the fetching actions. </span><span class="koboSpan" id="kobo.533.2">Luckily, in 2022, we can take advantage of Redux Toolkit, which comes bundled with all the necessary helper functions and a utility called </span><strong class="source-inline"><span class="koboSpan" id="kobo.534.1">createSlice</span></strong><span class="koboSpan" id="kobo.535.1">. </span><span class="koboSpan" id="kobo.535.2">A “slice” in </span><strong class="bold"><span class="koboSpan" id="kobo.536.1">Redux</span></strong><span class="koboSpan" id="kobo.537.1"> lingo is a collection of reducers and actions for a single feature in your app. </span><span class="koboSpan" id="kobo.537.2">Let’s </span><a id="_idIndexMarker247"/><span class="koboSpan" id="kobo.538.1">convert our </span><strong class="source-inline"><span class="koboSpan" id="kobo.539.1">likedImages</span></strong><span class="koboSpan" id="kobo.540.1"> reducer into a </span><strong class="bold"><span class="koboSpan" id="kobo.541.1">Redux</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.542.1">Toolkit slice:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.543.1">
//reducers/likedImages.js
import { createSlice } from "@reduxjs/toolkit";
export const likedImagesSlice = createSlice({
  name: "likedImages",
  initialState: [],
  reducers: {
    likeImage: (state) =&gt; {
      const newLikedImage = action.payload;
      return [...state, newLikedImage];
    },
    unLikeImage: (state, action) =&gt; {
      const stateWithoutLikedImage = state.filter(
        (item) =&gt; item !== action.payload
      );
      return stateWithoutLikedImage;
    },
  },
});
export const { init, likeImage, unLikeImage } = likedImagesSlice.actions;
export default likedImagesSlice.reducer;</span></pre>
<h2 id="_idParaDest-66"><a id="_idTextAnchor067"/><span class="koboSpan" id="kobo.544.1">Fetching data</span></h2>
<p><span class="koboSpan" id="kobo.545.1">Since </span><strong class="bold"><span class="koboSpan" id="kobo.546.1">Redux</span></strong><span class="koboSpan" id="kobo.547.1"> was </span><a id="_idIndexMarker248"/><span class="koboSpan" id="kobo.548.1">conceived as a state management tool, it did not come ready to manage fetching data out of the box – but, again, we are using </span><strong class="bold"><span class="koboSpan" id="kobo.549.1">Redux Toolkit</span></strong><span class="koboSpan" id="kobo.550.1">, which is bundled with the necessary middleware that will let our Redux store digest fetched data. </span><span class="koboSpan" id="kobo.550.2">We will use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.551.1">createAsyncThunk</span></strong><span class="koboSpan" id="kobo.552.1"> function from </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.553.1">Redux Toolkit</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.554.1">.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.555.1">What’s a thunk?</span></p>
<p class="callout"><span class="koboSpan" id="kobo.556.1">A thunk</span><a id="_idIndexMarker249"/><span class="koboSpan" id="kobo.557.1"> is a special sort of function that’s returned by another function. </span><span class="koboSpan" id="kobo.557.2">This name is not related to </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.558.1">Redux</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.559.1"> itself.</span></span></p>
<p><span class="koboSpan" id="kobo.560.1">Here’s what our fetching thunk will </span><span class="No-Break"><span class="koboSpan" id="kobo.561.1">look like:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.562.1">
import { createAsyncThunk } from "@reduxjs/toolkit";
import { requestBase } from "./src/utils/constants";
export const fetchLikedImages = createAsyncThunk(
  "likedImages/initLikedImages",
  async () =&gt; {
      const response = await fetch(requestBase + "/john_doe/        likedImages.json");
    return await response.json();
  }
);</span></pre>
<p><span class="koboSpan" id="kobo.563.1">Now, we need to tell our </span><strong class="bold"><span class="koboSpan" id="kobo.564.1">Redux</span></strong><span class="koboSpan" id="kobo.565.1"> slice about this function. </span><span class="koboSpan" id="kobo.565.2">We will use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.566.1">extraReducers</span></strong><span class="koboSpan" id="kobo.567.1"> function provided by </span><strong class="bold"><span class="koboSpan" id="kobo.568.1">Redux Toolkit</span></strong><span class="koboSpan" id="kobo.569.1"> to keep our reducer clean </span><span class="No-Break"><span class="koboSpan" id="kobo.570.1">and readable:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.571.1">
// reducers/likedImages.js
import { createSlice } from "@reduxjs/toolkit";
import { fetchLikedImages } from "../asyncFetches";
export const likedImagesSlice = createSlice({
  name: "likedImages",
  initialState: {
    likedImages: [],
    loading: true,
  },
  reducers: {
   //…
  },
  extraReducers: (builder) =&gt; {
    builder.addCase(fetchLikedImages.pending, (state) =&gt; {
      state.loading = true;
    });
      builder.addCase(fetchLikedImages.fulfilled,        (state, action) =&gt; {
      state.likedImages = action.payload;
      state.loading = false;
    });
    builder.addCase(fetchLikedImages.rejected, (state) =&gt; {
      state.loading = false;
    });
  },
});</span></pre>
<p><span class="koboSpan" id="kobo.572.1">Now that we </span><a id="_idIndexMarker250"/><span class="koboSpan" id="kobo.573.1">have a pretty elegant way to manage fetching, including a pending state and rejected state, let’s actually fetch our data. </span><span class="koboSpan" id="kobo.573.2">We should not fetch it in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.574.1">ListOfFavorited</span></strong><span class="koboSpan" id="kobo.575.1"> component, because we need to have the image data available as soon as the entire app is rendered. </span><span class="koboSpan" id="kobo.575.2">We should fetch the images in the parent </span><span class="No-Break"><span class="koboSpan" id="kobo.576.1">component, </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.577.1">Home</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.578.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.579.1">
//src/surfaces/Home
import { fetchLikedImages } from "../../asyncFetches";
import { useDispatch, useEffect } from "react-redux";
// …
export const Home = () =&gt; {
  const dispatch = useDispatch();
  useEffect(() =&gt; {
    dispatch(fetchLikedImages());
  }, []);</span></pre>
<p><span class="koboSpan" id="kobo.580.1">This way, the liked images data will be fetched when the app is rendered and the user is on the </span><strong class="bold"><span class="koboSpan" id="kobo.581.1">Feed</span></strong><span class="koboSpan" id="kobo.582.1"> screen. </span><span class="koboSpan" id="kobo.582.2">Once the image data is fetched, we can read it from our global state in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.583.1">ListOfFavorites</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.584.1"> component:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.585.1">
//src/components/ListOfFavorites
import { useSelector, useDispatch } from "react-redux";
export const ListOfFavorites = ({ navigation }) =&gt; {
    const { likedImages } = useSelector((state) =&gt;      state.likedImages);
  const dispatch = useDispatch();
  const [imageList, setImageList] = useState([]);
useEffect(() =&gt; {
    const reversedImages = [...likedImages].reverse();
    setImageList(reversedImages);
  }, [likedImages]);
if (!imageList) {
    return &lt;AppLoading /&gt;;
  }
//…
      &lt;FlatList
        data={imageList}
        renderItem={renderItem}
        keyExtractor={(item) =&gt; item.itemId}
       //…</span></pre>
<p><span class="koboSpan" id="kobo.586.1">You may have</span><a id="_idIndexMarker251"/><span class="koboSpan" id="kobo.587.1"> noticed how the fetched data is passed to the </span><span class="No-Break"><span class="koboSpan" id="kobo.588.1">state hook:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.589.1">
const reversedImages = [...likedImages].reverse();</span></pre>
<p><span class="koboSpan" id="kobo.590.1">We are using the ES6 spread operator in order to apply the </span><strong class="source-inline"><span class="koboSpan" id="kobo.591.1">reverse()</span></strong><span class="koboSpan" id="kobo.592.1"> function to a copy of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.593.1">likedImages</span></strong><span class="koboSpan" id="kobo.594.1"> array. </span><span class="koboSpan" id="kobo.594.2">This is because the </span><strong class="source-inline"><span class="koboSpan" id="kobo.595.1">likedImages</span></strong><span class="koboSpan" id="kobo.596.1"> array is read-only and we cannot operate directly </span><span class="No-Break"><span class="koboSpan" id="kobo.597.1">on it.</span></span></p>
<h2 id="_idParaDest-67"><a id="_idTextAnchor068"/><span class="koboSpan" id="kobo.598.1">Replacing the context</span></h2>
<p><span class="koboSpan" id="kobo.599.1">Take a moment to</span><a id="_idIndexMarker252"/><span class="koboSpan" id="kobo.600.1"> look at what you have accomplished. </span><span class="koboSpan" id="kobo.600.2">You effectively replaced the Favorited context with Redux! </span><span class="koboSpan" id="kobo.600.3">The last thing we need to do is to replace the actions when an image is liked or not and then we’ll be ready to do </span><span class="No-Break"><span class="koboSpan" id="kobo.601.1">some cleanup!</span></span></p>
<p><span class="koboSpan" id="kobo.602.1">Let’s go into</span><a id="_idIndexMarker253"/><span class="koboSpan" id="kobo.603.1"> the </span><strong class="source-inline"><span class="koboSpan" id="kobo.604.1">ImageDetailsModal</span></strong><span class="koboSpan" id="kobo.605.1"> surface and replace context-related code with </span><span class="No-Break"><span class="koboSpan" id="kobo.606.1">Redux code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.607.1">
//src/surfaces/ImageDetailsModal
import { likeImage, unLikeImage } from "../../reducers/  likedImages";
import { useDispatch, useSelector } from "react-redux";
export const ImageDetailsModal = ({ navigation, route }) =&gt; {
    const { likedImages } = useSelector((state) =&gt;      state.likedImages);
  const [isCurrentImageLiked, setIsCurrentImageLiked] = useState(false);
  const dispatch = useDispatch();
  useEffect(() =&gt; {
    const checkIfLiked =
      likedImages?.filter(
          (favoritedImg) =&gt; favoritedImg.itemId ===            route.params.imageItem.itemId
      ).length &gt; 0;
    setIsCurrentImageLiked(checkIfLiked);
  }, [likedImages]);</span></pre>
<p><span class="koboSpan" id="kobo.608.1">The last thing we need to change is the function called when the </span><strong class="bold"><span class="koboSpan" id="kobo.609.1">Like</span></strong><span class="koboSpan" id="kobo.610.1"> button is </span><span class="No-Break"><span class="koboSpan" id="kobo.611.1">clicked on:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.612.1">
&lt;Pressable
          onPress={() =&gt; {
            if (isCurrentImageLiked) {
              dispatch(unLikeImage(route.params.imageItem));
            } else {
              dispatch(likeImage(route.params.imageItem));
            }
          }}
        &gt;</span></pre>
<p><span class="koboSpan" id="kobo.613.1">And we’re</span><a id="_idIndexMarker254"/><span class="koboSpan" id="kobo.614.1"> done with applying </span><strong class="bold"><span class="koboSpan" id="kobo.615.1">Redux</span></strong><span class="koboSpan" id="kobo.616.1"> to the liked images! </span><span class="koboSpan" id="kobo.616.2">We can remove the </span><strong class="source-inline"><span class="koboSpan" id="kobo.617.1">Favorited</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.618.1">context </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.619.1">Provider</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.620.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.621.1">Our app consists of functional components only, so we can use </span><strong class="bold"><span class="koboSpan" id="kobo.622.1">Redux</span></strong><span class="koboSpan" id="kobo.623.1"> hooks. </span><span class="koboSpan" id="kobo.623.2">If we had class components, we would have to wrap them with special functions called </span><strong class="source-inline"><span class="koboSpan" id="kobo.624.1">mapStateToProps</span></strong><span class="koboSpan" id="kobo.625.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.626.1">mapDispatchToProps</span></strong><span class="koboSpan" id="kobo.627.1">. </span><span class="koboSpan" id="kobo.627.2">Modern </span><strong class="bold"><span class="koboSpan" id="kobo.628.1">React</span></strong><span class="koboSpan" id="kobo.629.1"> apps can be built without class components though – as you can see in the </span><span class="No-Break"><span class="koboSpan" id="kobo.630.1">Funbook app.</span></span></p>
<p><span class="koboSpan" id="kobo.631.1">In this section, you learned how to create a Redux store for the user state and liked images. </span><span class="koboSpan" id="kobo.631.2">We added reducers for both pieces of the store, as well as actions. </span><span class="koboSpan" id="kobo.631.3">We took advantage of a few utilities provided by Redux Toolkit to make our lives easier. </span><span class="koboSpan" id="kobo.631.4">We pulled it all together and were finally able to remove a little bit of React’s context. </span><span class="koboSpan" id="kobo.631.5">Replacing all other pieces of context with </span><strong class="bold"><span class="koboSpan" id="kobo.632.1">Redux</span></strong><span class="koboSpan" id="kobo.633.1"> is a very good exercise to get the hang of this state management library. </span><span class="koboSpan" id="kobo.633.2">If you prefer to just take a look at what it would look like, check out the book repo and the </span><span class="No-Break"><span class="koboSpan" id="kobo.634.1">folder: </span></span><a href="https://github.com/PacktPublishing/Simplifying-State-Management-in-React-Native/tree/main/chapter-5-complete"><span class="No-Break"><span class="koboSpan" id="kobo.635.1">https://github.com/PacktPublishing/Simplifying-State-Management-in-React-Native/tree/main/chapter-5-complete</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.636.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.637.1">We will now take a look at handling problems and debugging issues that may arise while </span><span class="No-Break"><span class="koboSpan" id="kobo.638.1">using Redux.</span></span></p>
<h1 id="_idParaDest-68"><a id="_idTextAnchor069"/><span class="koboSpan" id="kobo.639.1">Debugging</span></h1>
<p><span class="koboSpan" id="kobo.640.1">Our Funbook app is quite </span><a id="_idIndexMarker255"/><span class="koboSpan" id="kobo.641.1">simple so far. </span><span class="koboSpan" id="kobo.641.2">However, when working with bigger apps you will notice that the state becomes more and more complicated with every added feature. </span><span class="koboSpan" id="kobo.641.3">Sometimes, features have overlapping states or complex actions, responsible for many things happening across the app. </span><span class="koboSpan" id="kobo.641.4">In order to hunt down bugs related to complex state changes, we can use a dedicated debugger. </span><span class="koboSpan" id="kobo.641.5">Configuring developer tools in a bare </span><strong class="bold"><span class="koboSpan" id="kobo.642.1">Redux</span></strong><span class="koboSpan" id="kobo.643.1"> app takes a couple of steps, but we’re using </span><strong class="bold"><span class="koboSpan" id="kobo.644.1">Redux Toolkit</span></strong><span class="koboSpan" id="kobo.645.1">! </span><span class="koboSpan" id="kobo.645.2">And it comes to the rescue yet again. </span><strong class="bold"><span class="koboSpan" id="kobo.646.1">Redux Toolkit</span></strong><span class="koboSpan" id="kobo.647.1"> is preconfigured to work with the </span><strong class="bold"><span class="koboSpan" id="kobo.648.1">Redux</span></strong><span class="koboSpan" id="kobo.649.1"> DevTools extension, which runs in the browser. </span><span class="koboSpan" id="kobo.649.2">Since we are working on a React Native app, we will need to use another tool, called </span><strong class="bold"><span class="koboSpan" id="kobo.650.1">React Native</span></strong><span class="koboSpan" id="kobo.651.1"> Debugger. </span><span class="koboSpan" id="kobo.651.2">Mac users can install it using the </span><span class="No-Break"><span class="koboSpan" id="kobo.652.1">Homebrew tool:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.653.1">
brew install react-native-debugger</span></pre>
<p><span class="koboSpan" id="kobo.654.1">If you’re not using a Mac computer, you will find a prebuilt binary of this app on their installation instructions </span><span class="No-Break"><span class="koboSpan" id="kobo.655.1">page: </span></span><a href="https://github.com/jhen0409/react-native-debugger"><span class="No-Break"><span class="koboSpan" id="kobo.656.1">https://github.com/jhen0409/react-native-debugger</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.657.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.658.1">Once the remote Debugger</span><a id="_idIndexMarker256"/><span class="koboSpan" id="kobo.659.1"> is installed, you can run it by typing the following command into </span><span class="No-Break"><span class="koboSpan" id="kobo.660.1">your Terminal:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.661.1">
open "rndebugger://set-debugger-loc?host=localhost&amp;port=8081"</span></pre>
<p><span class="koboSpan" id="kobo.662.1">Since we are using </span><strong class="bold"><span class="koboSpan" id="kobo.663.1">Expo</span></strong><span class="koboSpan" id="kobo.664.1">, there are a few changes we need to make to actually be able to debug our app. </span><span class="koboSpan" id="kobo.664.2">So far, the </span><strong class="bold"><span class="koboSpan" id="kobo.665.1">React</span></strong> <strong class="bold"><span class="koboSpan" id="kobo.666.1">Native</span></strong><span class="koboSpan" id="kobo.667.1"> Debugger tool with the default config has not found </span><span class="No-Break"><span class="koboSpan" id="kobo.668.1">our app:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer032">
<span class="koboSpan" id="kobo.669.1"><img alt="Figure 5.3 – React Native Debugger after installation " src="image/Figure_5.03_B18396.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.670.1">Figure 5.3 – React Native Debugger after installation</span></p>
<p><span class="koboSpan" id="kobo.671.1">We need to tell </span><strong class="bold"><span class="koboSpan" id="kobo.672.1">React Native</span></strong><span class="koboSpan" id="kobo.673.1"> Debugger</span><a id="_idIndexMarker257"/><span class="koboSpan" id="kobo.674.1"> to look for the right port, which, in the case of </span><strong class="bold"><span class="koboSpan" id="kobo.675.1">Expo</span></strong><span class="koboSpan" id="kobo.676.1">-managed apps, is </span><strong class="source-inline"><span class="koboSpan" id="kobo.677.1">19000</span></strong><span class="koboSpan" id="kobo.678.1">. </span><span class="koboSpan" id="kobo.678.2">You will probably need to stop the debugger and the app, then run the following command to open React Native Debugger on the </span><span class="No-Break"><span class="koboSpan" id="kobo.679.1">right port:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.680.1">
open "rndebugger://set-debugger-loc?host=localhost&amp;port=19000"</span></pre>
<p><span class="koboSpan" id="kobo.681.1">Finally, restart the app by stopping the server in the Terminal and rerunning it </span><span class="No-Break"><span class="koboSpan" id="kobo.682.1">as follows:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.683.1">
expo start</span></pre>
<p><strong class="bold"><span class="koboSpan" id="kobo.684.1">React Native</span></strong><span class="koboSpan" id="kobo.685.1"> Debugger</span><a id="_idIndexMarker258"/><span class="koboSpan" id="kobo.686.1"> is a very useful tool, not only for debugging Redux but also for inspecting all sorts of bugs in </span><strong class="bold"><span class="koboSpan" id="kobo.687.1">React </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.688.1">Native</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.689.1"> apps.</span></span></p>
<p><span class="koboSpan" id="kobo.690.1">In this section, we went over installing and using the </span><strong class="bold"><span class="koboSpan" id="kobo.691.1">React Native</span></strong><span class="koboSpan" id="kobo.692.1"> Debugger tool. </span><span class="koboSpan" id="kobo.692.2">I encourage you to look around this very useful tool, inspect the app, and maybe add some bad code to see what an error in this tool may </span><span class="No-Break"><span class="koboSpan" id="kobo.693.1">look like.</span></span></p>
<h1 id="_idParaDest-69"><a id="_idTextAnchor070"/><span class="koboSpan" id="kobo.694.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.695.1">We’ve come a long way on our journey through the state management ecosystem. </span><span class="koboSpan" id="kobo.695.2">In this chapter, we talked about what is considered the most common solution for state management in </span><strong class="bold"><span class="koboSpan" id="kobo.696.1">React</span></strong><span class="koboSpan" id="kobo.697.1"> apps – </span><strong class="bold"><span class="koboSpan" id="kobo.698.1">Redux</span></strong><span class="koboSpan" id="kobo.699.1">. </span><span class="koboSpan" id="kobo.699.2">This library has gone through many changes itself. </span><span class="koboSpan" id="kobo.699.3">Using it in 2022 is quite different from how it was in 2016 thanks to </span><strong class="bold"><span class="koboSpan" id="kobo.700.1">Redux</span></strong> <strong class="bold"><span class="koboSpan" id="kobo.701.1">Toolkit, which</span></strong><span class="koboSpan" id="kobo.702.1"> we learned about. </span><span class="koboSpan" id="kobo.702.2">We talked about the </span><strong class="bold"><span class="koboSpan" id="kobo.703.1">Redux</span></strong><span class="koboSpan" id="kobo.704.1"> store, reducers, and actions. </span><span class="koboSpan" id="kobo.704.2">We’ve also implemented Redux for liked images in our Funbook app. </span><span class="koboSpan" id="kobo.704.3">We’re now ready to compare this library to its descendant: </span><strong class="bold"><span class="koboSpan" id="kobo.705.1">MobX</span></strong><span class="koboSpan" id="kobo.706.1">. </span><span class="koboSpan" id="kobo.706.2">In the next chapter, we will start by taking a brief look at the history and the high-level ideas behind </span><strong class="bold"><span class="koboSpan" id="kobo.707.1">MobX</span></strong><span class="koboSpan" id="kobo.708.1">. </span><span class="koboSpan" id="kobo.708.2">We will then take </span><strong class="source-inline"><span class="koboSpan" id="kobo.709.1">example-app-full</span></strong><span class="koboSpan" id="kobo.710.1"> as our starting point and try to replace the </span><strong class="source-inline"><span class="koboSpan" id="kobo.711.1">LikedImages</span></strong><span class="koboSpan" id="kobo.712.1"> context as we did </span><span class="No-Break"><span class="koboSpan" id="kobo.713.1">with </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.714.1">Redux</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.715.1">.</span></span></p>
<h1 id="_idParaDest-70"><a id="_idTextAnchor071"/><span class="koboSpan" id="kobo.716.1">Further reading</span></h1>
<ul>
<li><a href="https://redux.js.org/introduction/why-rtk-is-redux-today"><span class="koboSpan" id="kobo.717.1">https://redux.js.org/introduction/why-rtk-is-redux-today</span></a><span class="koboSpan" id="kobo.718.1"> – Why use </span><span class="No-Break"><span class="koboSpan" id="kobo.719.1">Redux Toolkit?</span></span></li>
<li><a href="https://redux.js.org/introduction/core-concepts"><span class="koboSpan" id="kobo.720.1">https://redux.js.org/introduction/core-concepts</span></a><span class="koboSpan" id="kobo.721.1"> – Redux </span><span class="No-Break"><span class="koboSpan" id="kobo.722.1">core concepts.</span></span></li>
<li><a href="https://blog.isquaredsoftware.com/2016/09/how-i-got-here-my-journey-into-the-world-of-redux-and-open-source/"><span class="koboSpan" id="kobo.723.1">https://blog.isquaredsoftware.com/2016/09/how-i-got-here-my-journey-into-the-world-of-redux-and-open-source/</span></a><span class="koboSpan" id="kobo.724.1"> – Mark Erikson’s blog on how he became a </span><span class="No-Break"><span class="koboSpan" id="kobo.725.1">Redux maintainer.</span></span></li>
<li><a href="https://blog.isquaredsoftware.com/2018/03/redux-not-dead-yet/"><span class="koboSpan" id="kobo.726.1">https://blog.isquaredsoftware.com/2018/03/redux-not-dead-yet/</span></a><span class="koboSpan" id="kobo.727.1"> – Redux is </span><span class="No-Break"><span class="koboSpan" id="kobo.728.1">not dead.</span></span></li>
<li><a href="https://egghead.io/courses/fundamentals-of-redux-course-from-dan-abramov-bd5cc867"><span class="koboSpan" id="kobo.729.1">https://egghead.io/courses/fundamentals-of-redux-course-from-dan-abramov-bd5cc867</span></a><span class="koboSpan" id="kobo.730.1"> – Egghead tutorial by </span><span class="No-Break"><span class="koboSpan" id="kobo.731.1">Dan Abramov.</span></span></li>
<li><a href="https://stackoverflow.com/a/34582848/8798164"><span class="koboSpan" id="kobo.732.1">https://stackoverflow.com/a/34582848/8798164</span></a><span class="koboSpan" id="kobo.733.1"> – Stack Overflow answer about </span><span class="No-Break"><span class="koboSpan" id="kobo.734.1">state mutations.</span></span></li>
<li><a href="https://redux.js.org/tutorials/essentials/part-2-app-structure#rules-of-reducers"><span class="koboSpan" id="kobo.735.1">https://redux.js.org/tutorials/essentials/part-2-app-structure#rules-of-reducers</span></a><span class="koboSpan" id="kobo.736.1"> – Rules </span><span class="No-Break"><span class="koboSpan" id="kobo.737.1">of Reducers.</span></span></li>
<li><a href="https://daveceddia.com/what-is-a-thunk/"><span class="koboSpan" id="kobo.738.1">https://daveceddia.com/what-is-a-thunk/</span></a><span class="koboSpan" id="kobo.739.1"> – what is </span><span class="No-Break"><span class="koboSpan" id="kobo.740.1">a thunk?</span></span></li>
</ul>
</div>
</body></html>
<html><head></head><body>
  <div id="_idContainer157">
    <h1 class="chapterNumber">3</h1>
    <h1 id="_idParaDest-77" class="chapterTitle">Architecting an Enterprise App</h1>
    <p class="normal">In <em class="chapterRef">Chapter 2</em>, <em class="italic">Forms, Observables, Signals, and Subjects</em>, we used the LocalCast Weather app to demonstrate various features of Angular to learn as well as experiment with and inform us if these features are suitable for more complex enterprise applications. Building enterprise applications is as much about the people building them as it is the technology used to build them. An over-eager approach to consuming and rolling out unproven tech is guaranteed to create the<strong class="keyWord"> sinkhole effect</strong> in your project. If you’re unfamiliar with sinkholes, they are a natural <a id="_idIndexMarker208"/>phenomenon that occurs due to the dissolution of underlying ground material. At some point, usually suddenly, the ground collapses to devastating effect, revealing a giant hole in the ground.</p>
    <p class="normal">In this book, I’ve done my best only to include tried and true, mature, and well-supported technologies and practices. LocalCast Weather includes all the cutting-edge features of Angular, like a root-level standalone project with standalone components, signals, and control flow syntax. With standalone components, we shed the concept of shared modules, helping resolve circular dependency issues and unnecessary bloat due to overstuffed shared modules. However, frustrations exist. Standalone projects require libraries to support providers instead of modules; when a provider is missing, applying a library to a project with feature modules becomes tedious guesswork.</p>
    <p class="normal">Control flow syntax, in preview, produces easier-to-read templates and removes the need to import structural directives, which reduces boilerplate. Meanwhile, Angular Signals, in partial preview, won’t bring major value until signal-based components are rolled out. Regardless, Angular Signals draws from new JavaScript primitives, covered later, in the <em class="italic">Minimalist JavaScript solutions</em> section, you should know and learn to use outside of Angular. Before diving into specifics, let’s consider the bigger picture.</p>
    <p class="normal">The most common type of app built in an enterprise is a <strong class="keyWord">Line-of-Business</strong> (<strong class="keyWord">LOB</strong>) application. LOB apps are the bread and butter of the <a id="_idIndexMarker209"/>software development world. As Wikipedia defines it, LOB is a general term that refers to a product or a set of related products that serve a particular customer transaction or business need. LOB apps present an excellent opportunity to demonstrate various features and functionality without getting into the contorted or specialized scenarios that large enterprise applications usually need to address.</p>
    <p class="normal">The Pareto principle, also known as the 80-20 rule, states<a id="_idIndexMarker210"/> that we can accomplish 80% of our goals with 20% of the overall effort. We will apply the 80-20 rule to the design and architecture of our LOB app. Given the common use cases LOB apps cover, they are perfect for the 80-20 learning experience. With only 20% of the effort, you can learn about 80% of what you need to deliver high-quality experiences to your users.</p>
    <p class="normal">LOB apps have a curious property to them. If you build a semi-useful app, its demand grows uncontrollably, and you quickly become the victim of your success. It’s challenging to balance the architectural needs of a project; you want to avoid potentially devastating under-engineering and, on the flip side, avoid costly over-engineering for an app that will never need it.</p>
    <p class="normal">In this chapter, I’m going to introduce you to ingredients that will allow you to be successful in your enterprise, things you should consider as an architect, various tools you should consider when building a performant app, how to design a large app using router-first architecture, and the 80-20 design solution to address the challenges of delivering a modern web application incrementally and iteratively.</p>
    <p class="normal">As you read in <em class="chapterRef">Chapter 1</em>, <em class="italic">Angular’s Architecture and Concepts</em>, software architecture doesn’t stay static. It’s essential to experiment with new ideas by using coding katas, proof-of-concept apps, and reference projects to practice getting better at creating more flexible architectures.</p>
    <p class="normal">In this and the remaining chapters of the book, we’ll set up a new application with rich features that can meet the demands of an LOB application with scalable architecture and engineering best practices that will help you start small and be able to grow your solution quickly if there’s demand. We will follow<a id="_idIndexMarker211"/> the <strong class="keyWord">Router-First Architecture</strong>, a design pattern relying on reusable components to create a grocery store LOB application named <strong class="keyWord">LemonMart</strong>. We’ll discuss designing around major data entities and the importance of completing high-level mock-ups for your application before implementing various conditional navigation elements, which may change significantly during the design phase.</p>
    <p class="normal">In this chapter, you will learn about the following:</p>
    <ul>
      <li class="bulletList">Succeeding as a technical lead or architect</li>
      <li class="bulletList">Ingredients for succeeding in your enterprise</li>
      <li class="bulletList">Kanban planning using GitHub projects</li>
      <li class="bulletList">Tools for building high-performance apps</li>
      <li class="bulletList">Applying the 80-20 solution to software development</li>
      <li class="bulletList">Learning how to build router-first apps</li>
    </ul>
    <p class="normal">Let’s start by covering non-technical aspects of a project that you must have a grasp of, so you can set up your team for success.</p>
    <h1 id="_idParaDest-78" class="heading-1">Succeeding as a technical lead or architect</h1>
    <p class="normal">I will be using the terms <strong class="keyWord">technical lead</strong> and <strong class="keyWord">architect</strong> interchangeably. Depending on the size of your organization, this may be two separate roles or one. But no matter which specific role you fulfill, in these <a id="_idIndexMarker212"/>roles, it is up to you to ensure the success of your project and, most importantly, the well-being of your team members.</p>
    <h2 id="_idParaDest-79" class="heading-2">Understand the business impact</h2>
    <p class="normal">Your first task should be to understand <a id="_idIndexMarker213"/>the business impact of your project. Some questions to ask are:</p>
    <ul>
      <li class="bulletList">How critical is the success of this project to the business?</li>
      <li class="bulletList">What are the consequences of failure? </li>
      <li class="bulletList">What does it mean to fail? </li>
      <li class="bulletList">Which features will deliver the most value?</li>
      <li class="bulletList">What are the parameters you must operate under? </li>
      <li class="bulletList">What’s negotiable and what’s not?</li>
    </ul>
    <p class="normal">The answers you get to these questions will vary how your project should operate significantly. If the survival or reputation of the business is at stake, you must amplify the aspects of the project that’ll ensure the business survives or its reputation isn’t tarnished. If a certain feature set will bring the most value, then focus all attention on getting performant and high-quality UX in that section and simplify the rest for the initial release. If certain personnel or technology is being dictated, weigh that against other factors. Expend all your energy and capital ensuring that the technology picked by your <strong class="keyWord">Chief Technology Officer</strong> (<strong class="keyWord">CTO</strong>) is a good fit for a project that will be a sink or swim moment for the <a id="_idIndexMarker214"/>company. Don’t fight<a id="_idIndexMarker215"/> unnecessary battles.</p>
    <h2 id="_idParaDest-80" class="heading-2">Set parameters of success</h2>
    <p class="normal">As a general principle, it’s advisable to leverage the strengths and passions of your team members. This is critical if resources or <a id="_idIndexMarker216"/>time is tight. People will work harder to invest in your project if they’re also investing their time in a technology that they’re passionate about. But don’t do this at the cost of failure – going back to my point on over-eager use of new tech at the beginning of the chapter.</p>
    <p class="normal">It is important to establish clear parameters for success for your team. This will only be possible if you <em class="italic">yourself </em>have a clear understanding of the business impact. You and your team members are on a journey. You’re all walking on a path. Falling off the path means peril, either for individual team members or the project’s success. It is up to you to vary how wide or narrow this path is. If you leave it too narrow, your team members will suffocate and be frustrated due to the lack of freedom or intense scrutiny. On the contrary, if you leave it too wide, you’ll have more experimentation than any real work to do. You must set guard rails on the path at just the right amount to match the team and project needs.</p>
    <h2 id="_idParaDest-81" class="heading-2">Elastic leadership</h2>
    <p class="normal">Your leadership style can’t be static. It must be <em class="italic">elastic</em>. All teams and projects have a lifecycle. They can go through periods <a id="_idIndexMarker217"/>of survival, learning, or self-organizing. Depending on deadlines or outside factors, teams can be forced from one state to another.</p>
    <div class="note">
      <p class="normal">Check out Roy Osherove’s excellent content on elastic leadership at <a href="https://www.elasticleadership.com"><span class="url">https://www.elasticleadership.com</span></a>.</p>
    </div>
    <p class="normal">Understand what state your team is in and vary your leadership style accordingly. Survival mode requires a dictator- or protector-style leader, where you’re heavily involved with all team activities and are directing individual tasks and actions. Your goal should be to move teams in this state to learning mode. This is where you become a coach, where you are not as involved in daily activities but instead focus on what team members should learn and how they should grow. The next step up would be a team in <em class="italic">self-organizing</em> mode. These teams are resilient, they grow on their own, and they can take general direction and strategy and execute them. At this point, you need to be a facilitator or a servant leader. If you dictate to a mature team, you’ll quickly lose that team.</p>
    <div class="note">
      <p class="normal">Google’s <strong class="keyWord">DevOps Research and Assessment</strong> (<strong class="keyWord">DORA</strong>) program contains 30 capabilities across technical, process, and <a id="_idIndexMarker218"/>cultural topics that your team and organization can master to become a high-performing team. The research program has been running since 2014, considering input from 33,000 professionals from various industries and governments. Learn more about the program at <a href="https://dora.dev"><span class="url">https://dora.dev</span></a>.</p>
    </div>
    <p class="normal">If you don’t understand these concepts, you’re likely to put your team members in situations where they’ll burn out, working<a id="_idIndexMarker219"/> overtime and with low morale, which could also impact family life and cause stress and high turnover. In that case, you may need to look in the mirror, with so many people standing there. All factors lead to a vicious cycle that is not good for running a healthy organization. As the saying goes, it’s not a sprint but a marathon. It’s as much about the journey as reaching the end goal. Don’t fail your team.</p>
    <h1 id="_idParaDest-82" class="heading-1">Ingredients of a successful project</h1>
    <p class="normal">You understand the business impact of your project and you have a team eager to start; now what? You must have a plan, of course. As the German field marshal Moltke the Elder put it (or at least the modern<a id="_idIndexMarker220"/> paraphrase of it), <em class="italic">“No plan survives first contact with the enemy.”</em></p>
    <p class="normal">Half a century later, Winston Churchill and Dwight D. Eisenhower added, <em class="italic">“Plans are of little importance [or are worthless], but planning is essential [or indispensable].”</em></p>
    <h2 id="_idParaDest-83" class="heading-2">Agile software development</h2>
    <p class="normal">Over the past decade, Agile software management has taken over the world, replacing waterfall project execution with <a id="_idIndexMarker221"/>Scrum and Gantt charts with Kanban boards and iterative and incremental delivery every two weeks instead of multi-year development cycles with long lead times and expensive <strong class="keyWord">Quality Assurance</strong> (<strong class="keyWord">QA</strong>) and support cycles. Statistics show that Agile projects have a higher success rate than waterfall <a id="_idIndexMarker222"/>projects. This intuitively makes sense because iterative and incremental delivery ensures success happens as soon as possible.</p>
    <p class="normal">The Agile<a id="_idIndexMarker223"/> Manifesto, located at <a href="http://agilemanifesto.org"><span class="url">http://agilemanifesto.org</span></a>, published in 2001, highlights the key<a id="_idIndexMarker224"/> ingredients for becoming Agile:</p>
    <blockquote class="packt_quote">
      <p class="quote">Individuals and interactions over processes and tools</p>
      <p class="quote">Working software over comprehensive documentation</p>
      <p class="quote">Customer collaboration over contract negotiation</p>
      <p class="quote">Responding to change over following a plan</p>
    </blockquote>
    <p class="normal">Most individuals are introduced to Agile when they join a Scrum team, and because of this most people conflate Agile and Scrum. Scrum is a management framework. Concepts like sprints, planning meetings, retrospectives, and other optional elements like user stories and story points have nothing to do with Agile. It is possible to execute Scrum and abuse every Agile value possible.</p>
    <p class="normal">At the <em class="italic">deliver:Agile 2018</em> conference in Austin, Texas, I listened to a talk by Ron Jeffries (a signatory of the 2001 Agile Manifesto) and Chet Hendrickson (a guy with an incredible sense of humor who rightly picked on me for having all sorts of JavaScript stickers on the lid of my MacBook) about Agile development. They focused on the “working software” component of the Agile Manifesto to drive home an important point. No amount of process, management oversight, or meetings will result in software delivery. As I aptly put it in my 2018 talk titled, Ship It or It Never Happened:</p>
    <blockquote class="packt_quote">
      <p class="quote">”It’s not up to them [the managers]</p>
      <p class="quote">it’s up to us [the developers].”</p>
    </blockquote>
    <p class="normal">It’s not about creating pretty diagrams with endless iterations over imaginary architecture. It’s not about delivering story points, checking boxes, and moving cards from one column to another. In short, don’t be a process monkey. Focus on delivering working code.</p>
    <h2 id="_idParaDest-84" class="heading-2">Agile engineering best practices</h2>
    <p class="normal">The best way to accomplish this is<a id="_idIndexMarker225"/> by delivering and adhering to Agile engineering best practices:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1"><strong class="keyWord">Test-Driven Development</strong> (<strong class="keyWord">TDD</strong>): Writing <a id="_idIndexMarker226"/>tests before writing actual code to ensure code meets requirements.</li>
      <li class="numberedList"><strong class="keyWord">Continuous Integration</strong> (<strong class="keyWord">CI</strong>): Running <a id="_idIndexMarker227"/>automated builds and tests on code commits frequently to catch issues <a id="_idIndexMarker228"/>early.</li>
      <li class="numberedList"><strong class="keyWord">Continuous Delivery</strong> (<strong class="keyWord">CD</strong>): Ensure <a id="_idIndexMarker229"/>every product iteration is in a releasable state.</li>
      <li class="numberedList"><strong class="keyWord">Pair programming</strong>: Team members learn from each other as they work on tasks together.</li>
      <li class="numberedList"><strong class="keyWord">Refactoring</strong>: Continuously improve the codebase as part of daily work.</li>
      <li class="numberedList"><strong class="keyWord">Simple and evolutionary design</strong>: Designs should be as simple as possible to achieve current requirements without over-engineering and be flexible or open-ended enough that they can evolve over time.</li>
      <li class="numberedList"><strong class="keyWord">Behavior-Driven Development</strong> (<strong class="keyWord">BDD</strong>): Use tests based on the expected behavior of software, backed <a id="_idIndexMarker230"/>with concrete examples, in a syntax like Gherkin (<code class="inlineCode">Given</code>, <code class="inlineCode">When</code>, <code class="inlineCode">Then</code> format) so technical and non-technical people can collaborate.</li>
      <li class="numberedList"><strong class="keyWord">Frequent releases</strong>: Deliver software in small batches frequently.</li>
      <li class="numberedList"><strong class="keyWord">High cohesion and low coupling</strong>: Modules or components focus on a single task, while these modules or components have minimal dependencies on each other.</li>
      <li class="numberedList">Adhere to SOLID principles:<ol class="alphabeticList" style="list-style-type: lower-alpha;">
          <li class="alphabeticList" value="1"><strong class="keyWord">Single responsibility principle</strong>: A function or class should only be responsible for one<a id="_idIndexMarker231"/> task.</li>
          <li class="alphabeticList"><strong class="keyWord">Open/closed principle</strong>: Code should be open for extension (i.e., extensible) but closed for modification (i.e., extensible without having to rewrite the algorithm).</li>
          <li class="alphabeticList"><strong class="keyWord">Liskov substitution principle</strong>: Inheriting from a super/base class shouldn’t result in unexpected behavior.</li>
          <li class="alphabeticList"><strong class="keyWord">Interface segregation principle</strong>: Expose the most minimal interface required.</li>
          <li class="alphabeticList"><strong class="keyWord">Dependency inversion principle</strong>: Modules/components should depend on abstractions instead <a id="_idIndexMarker232"/>of concrete implementations.</li>
        </ol>
      </li>
      <li class="numberedList"><strong class="keyWord">DRY principle</strong>: Don’t repeat yourself. Applying DRY helps make code easier to maintain. If you need to <a id="_idIndexMarker233"/>change something, you only have to change it in one place instead of many<a id="_idIndexMarker234"/> places. However, taking DRY too far can sometimes overcomplicate code, so use judgment to find the right balance. The principle is about <a id="_idIndexMarker235"/>sensibly reducing duplication, not eliminating it entirely.</li>
    </ol>
    <h2 id="_idParaDest-85" class="heading-2">Engineering excellence and craftsmanship</h2>
    <p class="normal">Adhering to these principles requires engineering excellence and a craftsmanship mindset. People on your team need to care about their work, be proud of the code they write, and be satisfied with the<a id="_idIndexMarker236"/> results they produce.</p>
    <p class="normal">Translating requirements and designs to working code is not easy. Doing it iteratively and incrementally requires a deep understanding of technology, tools, and business requirements. However, being able to write code simultaneously without over-engineering it while also keeping it flexible is not only possible, but it should also be the goal of every engineer.</p>
    <p class="normal">Oh, and pick a component library and stick to it, but also avoid vendor lock-in. Good luck!</p>
    <h1 id="_idParaDest-86" class="heading-1">Angular in an enterprise</h1>
    <p class="normal">Angular is not appropriate for use on every project. However, Angular is preferred in an enterprise because of the advanced concepts <a id="_idIndexMarker237"/>supported by the framework, such as <strong class="keyWord">Dependency Injection</strong> (<strong class="keyWord">DI</strong>), native <a id="_idIndexMarker238"/>TypeScript support, a modular architecture, robust packaging, testing, accessibility tools, and a commitment to release new versions regularly. The amalgamation of these tools helps applications scale beyond small apps to truly large-scale applications with 1,000+ views.</p>
    <div class="note">
      <p class="normal">For <strong class="keyWord">Content Management System</strong> (<strong class="keyWord">CMS</strong>) style use <a id="_idIndexMarker239"/>cases and simple applications, you should consider using Analog. Analog is a meta-framework for building <a id="_idIndexMarker240"/>apps and websites with Angular: <a href="https://analogjs.org"><span class="url">https://analogjs.org</span></a>. Analog comes pre-configured with <strong class="keyWord">Server-Side Rendering</strong> (<strong class="keyWord">SSR</strong>), <strong class="keyWord">Static Site Generation</strong> (<strong class="keyWord">SSG</strong>), Vite (<a href="https://vitejs.dev"><span class="url">https://vitejs.dev</span></a>) tooling, and <a id="_idIndexMarker241"/>convention-based routing and API routes for a no-frills, all-excitement development experience.</p>
      <p class="normal">In fact, <a href="https://AngularForEnterprise.com"><span class="url">https://AngularForEnterprise.com</span></a> was created using Analog.</p>
    </div>
    <h2 id="_idParaDest-87" class="heading-2">Diverse coding paradigm support</h2>
    <p class="normal">Angular allows for different styles of programming. You can choose between imperative and reactive coding, leverage OOP concepts <a id="_idIndexMarker242"/>or completely ignore them, have inline and compact single-file components, or use up to four files to contain the same code. This variety is a strength when supporting a diverse population of developers, but it can also be a weakness by allowing multiple implementation styles within the same project. It is important to control this by establishing team norms around which programming style and paradigm to use. Linting and code-style tools like ESLint can help keep the code’s appearance uniform but are ineffective at detecting or preventing paradigm shifts in code.</p>
    <h2 id="_idParaDest-88" class="heading-2">Community support</h2>
    <p class="normal">Angular has a great and engaged community filled with brilliant, respectful, and positive individuals who collaborate to build tools around Angular and evangelize it across the tech community. Google also supports Angular with the Google Developer Expert program, which I’ve been lucky to <a id="_idIndexMarker243"/>have been a part of, where the Angular team meets with active community members, gives them early access, listens to their feedback, and encourages collaboration. This means that when your enterprise needs support, there’s a trustworthy community of individuals out there that you can tap into for advice.</p>
    <p class="normal">As discussed in the introduction and <em class="italic">Future of Angular</em> sections of <em class="chapterRef">Chapter 1</em>, <em class="italic">Angular’s Architecture and Concepts</em>, as the size of a web application grows, performance issues begin cropping up in rendering the application, the tooling struggles to support the number of contributors to the project, and the architecture becomes inadequate in handling the complexity and variety of requirements. More on architecture when we discuss the 80-20 solution and router-first architecture later in the chapter.</p>
    <div class="packt_tip">
      <p class="normal">You can find and contribute to a community-curated list of tools for building enterprise applications using <a id="_idIndexMarker244"/>Angular at <a href="https://angularforenterprise.com/enterprise-tools"><span class="url">https://angularforenterprise.com/enterprise-tools</span></a>.</p>
    </div>
    <p class="normal">Next, let’s dive into tools that <a id="_idIndexMarker245"/>can support building high-performance apps with good UX and DevEx.</p>
    <h1 id="_idParaDest-89" class="heading-1">Tools and techniques for high-performance apps</h1>
    <p class="normal">In this section, we will cover topics related to building high-performance apps. While some of these tools are specific to Angular, the <a id="_idIndexMarker246"/>general sentiment and advice apply to all web applications. This means that a complicated and large application should still be able to: </p>
    <ul>
      <li class="bulletList">Hit a smooth 60 FPS rendering target</li>
      <li class="bulletList">Respond to user clicks within 340 ms</li>
      <li class="bulletList">Provide fast feedback loops to developers</li>
      <li class="bulletList">Run builds and automated tests as quickly as possible</li>
    </ul>
    <p class="normal">Let’s first talk about runtime performance.</p>
    <h2 id="_idParaDest-90" class="heading-2">Runtime performance</h2>
    <p class="normal">Bad performance has real consequences for a business. In 2008, it was reported that a latency increase of 100 ms reduced<a id="_idIndexMarker247"/> Amazon’s sales by 1%. In 2006, Google observed that an additional 0.5 seconds in generating a search page led to a 20% decrease in traffic. These are astounding numbers at Amazon and Google’s scales, where milliseconds translate to millions of dollars. This may mean thousands or hundreds of thousands of dollars at your organization’s scale. Considering performance trends over time, these smaller numbers can still multiply to millions.</p>
    <p class="normal">The browser is a complicated runtime environment, and the frameworks we use to develop web applications obfuscate the runtime in exchange for rich features and easier-to-maintain code. This obfuscation introduces performance issues specific to framework code on top of native browser-related optimization requirements. And in 2024, the frameworks we use have become incredibly complicated.</p>
    <p class="normal">Let’s understand what kind of indicators <a id="_idIndexMarker248"/>we can use to understand the runtime performance of a web application:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">First Contentful Paint</strong> (<strong class="keyWord">FCP</strong>): Measures the<a id="_idIndexMarker249"/> time from page start to the first visual content displayed</li>
      <li class="bulletList"><strong class="keyWord">Time to Interactive</strong> (<strong class="keyWord">TTI</strong>): Measures a <a id="_idIndexMarker250"/>page’s load responsiveness and helps identify where a page looks interactive but isn’t</li>
      <li class="bulletList"><strong class="keyWord">Latency</strong>: The delay between a user’s action and its response</li>
      <li class="bulletList"><strong class="keyWord">Frame drops</strong>: Occurrences when frames can’t be generated fast enough to render a UI smoothly</li>
    </ul>
    <p class="normal">We can use the profiling tools in our browser’s DevTools to discover these issues. Below is an annotated example of a <strong class="keyWord">flame chart </strong>(often referred <a id="_idIndexMarker251"/>to as a flame graph) created by Michael Hladky, which highlights the various stages of the bootstrap process of an Angular app:</p>
    <figure class="mediaobject"><img src="../Images/B18047_03_01.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 3.1: Flame chart of Angular Bootstrap phase. Credit Michael Hladky</p>
    <p class="normal">The x axis of the chart shows times, and the y-axis shows the stack of function calls. A wide bar indicates a function taking a long time to execute or being called frequently. A tall stack includes a deep chain of function calls. You may use these visual clues to zoom into the chart and investigate <a id="_idIndexMarker252"/>performance issues.</p>
    <div class="note">
      <p class="normal">If you’re unfamiliar with using Chrome’s profiling features, please refer to <a href="https://developer.chrome.com/docs/devtools/performance/reference"><span class="url">https://developer.chrome.com/docs/devtools/performance/reference</span></a>.</p>
    </div>
    <h2 id="_idParaDest-91" class="heading-2">Root cause of performance bottlenecks</h2>
    <p class="normal">What’s slowing us down? During the bootstrap<a id="_idIndexMarker253"/> process of an application or when loading a new page, several things happen:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1"><strong class="keyWord">Downloading JavaScript</strong>: This includes application, framework, and third-party library code. The larger the size, the slower it is.</li>
      <li class="numberedList"><strong class="keyWord">Executing JavaScript</strong>: Code needs to be unzipped and loaded into memory, then parsed by the JavaScript engine for just-in-time execution; DOM elements and framework hooks need to be scaffolded.</li>
      <li class="numberedList"><strong class="keyWord">Hydrating app code</strong>: The framework must compute the application’s state (visual and data), connect event listeners to the DOM, and render.</li>
      <li class="numberedList"><strong class="keyWord">Change detection</strong>: The framework must traverse the component tree to determine if the UI should be updated due to a state change.</li>
    </ol>
    <p class="normal">Executing these steps sequentially, presuming your application or API code is free of major issues, is the main root cause of performance issues with large web applications. In the current state of SPA frameworks, these issues are inescapable and/or very expensive to overcome.</p>
    <div class="packt_tip">
      <p class="normal">An example of an inescapable issue would be rendering too many interactive components on the screen. A very expensive solution to this might be to patch every single component with custom code to circumvent the normal lifecycle of the framework and coerce it to behave in a way that could only benefit the application you’re building.</p>
    </div>
    <h2 id="_idParaDest-92" class="heading-2">Minimalist JavaScript solutions</h2>
    <p class="normal">ECMAScript 2022, widely supported by all major browsers, has built-in fundamentals that allow us to build performant and reactive <a id="_idIndexMarker254"/>web applications from scratch. For only 1-2 kb of “framework” code, we can vastly improve the DevEx and create modern and fast websites.</p>
    <h3 id="_idParaDest-93" class="heading-3">ArrowJS</h3>
    <p class="normal">At the Frontrunners 2023 conference in<a id="_idIndexMarker255"/> Washington DC, I attended a talk by Justin Schroeder about his frontend library named ArrowJS, Reactivity without the framework. More information<a id="_idIndexMarker256"/> can be found at <a href="https://www.arrow-js.com"><span class="url">https://www.arrow-js.com</span></a>. In his talk, Justin covered the fundamentals that made his library possible:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">WeakMap</strong>: A WeakMap is a collection of <a id="_idIndexMarker257"/>key-value pairs where the keys are objects with arbitrary values. The keys are weakly referenced, meaning they can be garbage collected if no other references exist. Normally the map itself would count as a reference and thus remain in memory.</li>
      <li class="bulletList"><strong class="keyWord">Proxy</strong>: A proxy is an object that <a id="_idIndexMarker258"/>wraps another object or function and allows you to intercept and define custom behavior for fundamental operations. They are like middleware for your objects. Signals use a proxy under the covers. They are also useful in form validation.</li>
      <li class="bulletList"><strong class="keyWord">Set</strong>: A set is a collection <a id="_idIndexMarker259"/>of values where each value must be unique, meaning the same value cannot appear more than once. They are useful for tracking dependencies.</li>
      <li class="bulletList"><strong class="keyWord">Tagged</strong> template literals: These allow <a id="_idIndexMarker260"/>parsing template literals with a function, enabling custom string interpolation and processing. They are like middleware for strings. They are useful for parsing templated HTML code as a function.</li>
    </ul>
    <p class="normal">When all these concepts are put together, observe how you can replicate a to-do list app in ArrowJS: </p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">import</span> { html, reactive } <span class="hljs-keyword">from</span> <span class="hljs-string">'@arrow-js/core'</span>
<span class="hljs-keyword">const</span> data = <span class="hljs-title">reactive</span>({
  <span class="hljs-attr">items</span>: [
    { <span class="hljs-attr">id</span>: <span class="hljs-number">17</span>, <span class="hljs-attr">task</span>: <span class="hljs-string">'Check email'</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">21</span>, <span class="hljs-attr">task</span>: <span class="hljs-string">'</span><span class="hljs-string">Get groceries'</span> },
    { <span class="hljs-attr">id</span>: <span class="hljs-number">44</span>, <span class="hljs-attr">task</span>: <span class="hljs-string">'Make dinner'</span> },
  ]
})
<span class="hljs-keyword">function</span> <span class="hljs-title">addItem</span>(<span class="hljs-params">e</span>) {
  e.<span class="hljs-title">preventDefault</span>()
  <span class="hljs-keyword">const</span> input = <span class="hljs-variable">document</span>.<span class="hljs-title">getElementById</span>(<span class="hljs-string">'new-item'</span>)
  data.<span class="hljs-property">items</span>.<span class="hljs-title">push</span>({
    <span class="hljs-attr">id</span>: <span class="hljs-title">Math</span>.<span class="hljs-title">random</span>(),
    <span class="hljs-attr">task</span>: input.<span class="hljs-property">value</span>,
  })
  input.<span class="hljs-property">value</span> = <span class="hljs-string">''</span>
}
html`
<span class="hljs-tag">&lt;</span><span class="hljs-name">ul</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-subst">${() =&gt; data.items.map(</span>
<span class="hljs-subst">      item =&gt; html`</span><span class="hljs-tag">&lt;</span><span class="hljs-name">li</span><span class="hljs-tag">&gt;</span><span class="hljs-subst">${item.task}</span><span class="hljs-tag">&lt;/</span><span class="hljs-name">li</span><span class="hljs-tag">&gt;</span>`<span class="hljs-subst">.key(item.id)</span>
<span class="hljs-subst">    )}</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">ul</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;</span><span class="hljs-name">form</span><span class="hljs-tag"> @</span><span class="hljs-attr">submit</span><span class="hljs-tag">=</span><span class="hljs-string">"</span><span class="hljs-subst">${addItem}</span><span class="hljs-string">"</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">input</span><span class="hljs-tag"> </span><span class="hljs-attr">type</span><span class="hljs-tag">=</span><span class="hljs-string">"text"</span><span class="hljs-tag"> </span><span class="hljs-attr">id</span><span class="hljs-tag">=</span><span class="hljs-string">"new-item"</span><span class="hljs-tag">&gt;</span>
  <span class="hljs-tag">&lt;</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>Add<span class="hljs-tag">&lt;/</span><span class="hljs-name">button</span><span class="hljs-tag">&gt;</span>
<span class="hljs-tag">&lt;/</span><span class="hljs-name">form</span><span class="hljs-tag">&gt;</span>`
</code></pre>
    <p class="normal">This code doesn’t<a id="_idIndexMarker261"/> require any compilation or further processing. The next solution, however, leverages similar technologies under the covers but also tackles all the big problems.</p>
    <h3 id="_idParaDest-94" class="heading-3">Qwik.js</h3>
    <p class="normal">The father of Angular, Miško Hevery, along with industry veteran Adam Bradley (jQuery Mobile, Ionic, Stencil.js) and whizbang coder Manu Almeida, created Qwik.js as a response to address the fundamental<a id="_idIndexMarker262"/> issues baked into popular SPA frameworks like Angular, React, and Vue. You can check out this <a id="_idIndexMarker263"/>framework at <a href="https://qwik.builder.io"><span class="url">https://qwik.builder.io</span></a>.</p>
    <div class="note">
      <p class="normal">Feeling adventurous? Execute:</p>
      <pre class="programlisting con"><code class="hljs-con">$ npm create qwik@latest
</code></pre>
    </div>
    <p class="normal">Qwik.js was built from the ground up to enforce a reactive coding paradigm, leveraging the signal primitive and resumability as a built-in feature to ensure that apps of any size or scale always do a full-page load under 1 second and perform 5-10x faster overall. All with a library that is ~1 kb in size.</p>
    <p class="normal">Qwik ships “batteries included” with rich<a id="_idIndexMarker264"/> user controls, a Vite dev server, testing with Vitest and Playwright, extendable styling, and server-side rendering, and it doesn’t require hydration. To understand the difference between hydration and resumability, see the following graphic:</p>
    <figure class="mediaobject"><img src="../Images/B18047_03_02.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 3.2: Hydration vs resumability. Adapted from Miško Hevery</p>
    <p class="normal">At the top, you can see the hydration steps to load a traditional SPA. Each individual box takes longer the more your <a id="_idIndexMarker265"/>application grows. However, a resumable app is downloaded as a ready-to-render HTML payload, with its state embedded, bringing the complexity from O(<img src="../Images/B20960_03_001.png" alt="" role="presentation"/>) down to O(1).</p>
    <div class="packt_tip">
      <p class="normal">If you find O(<img src="../Images/B20960_03_002.png" alt="" role="presentation"/>) intimidating, don’t worry. It’s meant to be a joke.</p>
    </div>
    <p class="normal">After the initial load, Qwik pre-fetches only the required amount of JavaScript to enable interactivity. This can mean downloading individual functions at a time. Qwik is also aggressive about lazily executing code. So, only the elements that the user interacts with come alive, keeping performance concerns in check. Naturally, there are some smart pre-fetching algorithms working in the background to make this a seamless experience.</p>
    <div class="note">
      <p class="normal">If you would like to learn more about Qwik, check out my talk on YouTube at <a href="https://www.youtube.com/watch?v=QDqp_qTa4Ww&amp;t=40s"><span class="url">https://www.youtube.com/watch?v=QDqp_qTa4Ww&amp;t=40s</span></a> and the slides at <a href="https://slides.com/doguhanuluca/intro-to-qwik"><span class="url">https://slides.com/doguhanuluca/intro-to-qwik</span></a>.</p>
    </div>
    <p class="normal">Next, let’s see what tools<a id="_idIndexMarker266"/> we can use to address these<a id="_idIndexMarker267"/> issues in Angular.</p>
    <h2 id="_idParaDest-95" class="heading-2">Angular performance solutions</h2>
    <p class="normal">There are two categories of issues at play, one regarding the initial load of the application and the second<a id="_idIndexMarker268"/> ensuring smooth rendering by keeping change detection in check.</p>
    <p class="normal">Let’s start with <strong class="keyWord">Server-Side Rendering</strong> (<strong class="keyWord">SSR</strong>).</p>
    <h3 id="_idParaDest-96" class="heading-3">Server-side rendering and hydration</h3>
    <p class="normal"><strong class="keyWord">Angular server-side rendering</strong> enables rendering the SPA, an otherwise client-side technology with code executing in the browser <a id="_idIndexMarker269"/>on a server. The server can pre-bake the initial state of a view as simple HTML and JavaScript that the browser doesn’t have <a id="_idIndexMarker270"/>to spend a lot of time interpreting. As a result, the downloaded content renders very quickly, solving delays caused by downloading and executing large amounts of JavaScript. This is especially critical in mobile or outdated devices with limited processing and bandwidth. The server can perform this task consistently regardless of user hardware.</p>
    <div class="packt_tip">
      <p class="normal">Another benefit of SSR is to facilitate<a id="_idIndexMarker271"/> web crawlers to enable <strong class="keyWord">Search Engine Optimization</strong> (<strong class="keyWord">SEO</strong>) on your website.</p>
    </div>
    <p class="normal">While the user is gawking at your landing page – since it is largely static at this point, they can only look, but not touch – Angular uses <strong class="keyWord">web workers </strong>to <a id="_idIndexMarker272"/>load the rest of the application.</p>
    <p class="normal">The most logical way to incorporate SSR into your project is at the very beginning, so you can tackle and test for configuration issues incrementally.</p>
    <p class="normal">To create a new project with SSR, execute:</p>
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$</span> npm create @angular -- --ssr
</code></pre>
    <p class="normal">or</p>
    <pre class="programlisting con"><code class="hljs-con"><span class="hljs-con-meta">$ </span>npx @angular/cli new app_name --ssr
</code></pre>
    <div class="note">
      <p class="normal">Woke up in a good mood? Try adding SSR to your existing project:</p>
      <pre class="programlisting con"><code class="hljs-con">$ npx ng add @angular/ssr
</code></pre>
    </div>
    <p class="normal">After all the assets are loaded, and your SPA is ready to be fully interactive, the app must transition from a static state to <a id="_idIndexMarker273"/>a dynamic one. This transition can be jarring. As we learned when covering Qwik, hydration is essential to seamlessly transition from a <a id="_idIndexMarker274"/>static to a dynamic state.</p>
    <div class="packt_tip">
      <p class="normal">If you’re using <code class="inlineCode">FlexLayout</code>, use <code class="inlineCode">FlexLayoutServerModule</code> to enable the framework in an SSR configuration. More details can be found at <a href="https://github.com/angular/flex-layout/wiki/Using-SSR-with-Flex-Layout"><span class="url">https://github.com/angular/flex-layout/wiki/Using-SSR-with-Flex-Layout</span></a>.</p>
    </div>
    <p class="normal">Enter stage left <strong class="keyWord">client hydration</strong>. You <a id="_idIndexMarker275"/>can enable client hydration by using its provider in your <code class="inlineCode">AppComponent</code>:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">import</span> {provideClientHydration} <span class="hljs-keyword">from</span> <span class="hljs-string">'@angular/platform-browser'</span>;
<span class="hljs-comment">// ...</span>
@<span class="hljs-title">NgModule</span>({
  <span class="hljs-comment">// ...</span>
<span class="code-highlight"><strong class="hljs-slc">  </strong><strong class="hljs-attr-slc">providers</strong><strong class="hljs-slc">: [ </strong><strong class="hljs-title-slc">provideClientHydration</strong><strong class="hljs-slc">() ],  </strong><strong class="hljs-comment-slc">// add this line</strong></span>
  <span class="hljs-attr">bootstrap</span>: [ <span class="hljs-title">AppComponent</span> ]
})
<span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title">AppModule</span> {
  <span class="hljs-comment">// ...</span>
}
</code></pre>
    <p class="normal">With client hydration, your SPA can reuse already rendered server-side DOM structures, application state, downloaded data, and other processes for a smooth transition.</p>
    <p class="normal">You can read more about using<a id="_idIndexMarker276"/> Angular SSR at <a href="https://angular.dev/guide/ssr"><span class="url">https://angular.dev/guide/ssr</span></a> and Angular hydration at <a href="https://angular.dev/guide/hydration"><span class="url">https://angular.dev/guide/hydration</span></a>.</p>
    <h3 id="_idParaDest-97" class="heading-3">App shell</h3>
    <p class="normal">An app shell is like SSR conceptually, but instead <a id="_idIndexMarker277"/>of the server rendering your page, you can pre-render a route or a page at build time. This way, you can craft a static landing experience on the landing page or when lazy loading a large feature module and then have Angular transition to an interactive state when ready.</p>
    <p class="normal">Pre-rendering is conceptually and mechanically easier to handle. However, you may have to simplify certain aspects of your landing pages for them to work with prerendering.</p>
    <div class="note">
      <p class="normal">Are you about to miss your project delivery deadline but still need a solution for loading issues? Try adding an app shell:</p>
      <pre class="programlisting con"><code class="hljs-con">$ npx ng generate app-shell
</code></pre>
    </div>
    <p class="normal">As the saying goes, try it, but your mileage may vary. Learn more about app shell at <a href="https://angular.dev/guide/hydration"><span class="url">https://angular.dev/ecosystem/service-workers/app-shell</span></a>.</p>
    <p class="normal">App shells are also useful in offline apps. Next, let’s see how service workers can help with performance.</p>
    <h3 id="_idParaDest-98" class="heading-3">Service workers</h3>
    <p class="normal">You can also leverage service workers to <a id="_idIndexMarker278"/>make your web application feel like a native application. Service <a id="_idIndexMarker279"/>workers enable <strong class="keyWord">Progressive Web Application </strong>(<strong class="keyWord">PWA</strong>) features, like offline support, push notifications, and background data syncing for web applications.</p>
    <p class="normal">Running these tasks in a background thread frees up the main thread to perform tasks related to rendering and user interactivity. This is low-hanging fruit to improve the performance of your application. Read more about service workers at <a href="https://angular.dev/ecosystem/service-workers"><span class="url">https://angular.dev/ecosystem/service-workers</span></a>.</p>
    <div class="note">
      <p class="normal">You know you want to do it. Add PWA support today:</p>
      <pre class="programlisting con"><code class="hljs-con">$ npx ng add @angular/pwa –project &lt;project-name&gt;
</code></pre>
    </div>
    <div class="packt_tip">
      <p class="normal">The technical reviewer of this book, Jurgen Van de Moere, also recommends Workbox by Google, a set of production-ready service worker libraries and tools regularly used in <a id="_idIndexMarker280"/>enterprises for complex scenarios.</p>
      <p class="normal">Read more about Workbox at <a href="https://developer.chrome.com/docs/workbox"><span class="url">https://developer.chrome.com/docs/workbox</span></a>.</p>
    </div>
    <p class="normal">Alas, it is finally time to peel to the core of the onion, change detection.</p>
    <h3 id="_idParaDest-99" class="heading-3">RxAngular</h3>
    <p class="normal">Michael Hladky and co. created RxAngular to<a id="_idIndexMarker281"/> overcome performance issues with large Angular applications. RxAngular “offers a comprehensive toolset for handling fully reactive Angular applications, focusing mainly on runtime performance and template rendering.”</p>
    <p class="normal">The following diagram details the lifecycle of an Angular change detection event:</p>
    <figure class="mediaobject"><img src="../Images/B18047_03_03.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 3.3: Default change detection in Angular. Adapted from Michael Hladky</p>
    <p class="normal">Allow me to go over it step by step:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">First, user interaction triggers an event.</li>
      <li class="numberedList">Angular then marks the element for a dirty check.</li>
      <li class="numberedList">Zone.js is utilized to <a id="_idIndexMarker282"/>transition between the Angular app state and DOM.</li>
      <li class="numberedList">The Angular engine “ticks,” triggering the execution of pending tasks.</li>
      <li class="numberedList">The change detection algorithm avoids branches that are not dirty.</li>
      <li class="numberedList">The algorithm identifies the topmost level component that must be re-rendered to react to the event triggered in <em class="italic">step 1</em>.</li>
    </ol>
    <p class="normal">Angular’s default change detection process is a computationally expensive process that can force the re-rendering of larger-than-necessary portions of the application. Angular also offers an <code class="inlineCode">OnPush</code> change detection strategy.</p>
    <figure class="mediaobject"><img src="../Images/B18047_03_04.png" alt="A diagram of a diagram  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 3.4: OnPush change detection in Angular. Adapted from Michael Hladky</p>
    <p class="normal"><code class="inlineCode">OnPush</code> disables automatic change detection until manually reactivated. We can use this strategy only to activate component sub-trees that the user interacts with, limiting the amount and scope of change detection Angular must perform. You can read more about this at <a href="https://angular.dev/best-practices/skipping-subtrees"><span class="url">https://angular.dev/best-practices/skipping-subtrees</span></a>.</p>
    <p class="normal">Finally, using RxAngular’s directives and pipes, like <code class="inlineCode">RxLet</code>, <code class="inlineCode">RxFor</code>, and <code class="inlineCode">RxIf</code>, we can trick the Angular engine to only detect<a id="_idIndexMarker283"/> changes when observables tied to these directives change.</p>
    <figure class="mediaobject"><img src="../Images/B18047_03_05.png" alt="A diagram of a diagram  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 3.5: Change detection using RxAngular’s directives. Adapted from Michael Hladky</p>
    <p class="normal">As shown in the figure above, we can ensure only the element that needs to change is updated without going through an expensive change detection process. If you already have a large Angular application where a rewrite is not an option, RxAngular may be your only option to resolve performance issues.</p>
    <div class="packt_tip">
      <p class="normal">Dive deeper into Angular performance at scale with Michael’s talk at Angular DC: <a href="https://www.youtube.com/watch?v=HTU4WYWGTIk"><span class="url">https://www.youtube.com/watch?v=HTU4WYWGTIk</span></a>.</p>
    </div>
    <p class="normal">Learn more about<a id="_idIndexMarker284"/> RxAngular at <a href="https://www.rx-angular.io"><span class="url">https://www.rx-angular.io</span></a>.</p>
    <h3 id="_idParaDest-100" class="heading-3">Angular Signals</h3>
    <p class="normal">Angular Signals can deliver the same kind of fine-grained change detection as shown in <em class="italic">Figure 3.5</em> in the <em class="italic">RxAngular</em> section. As you can imagine, this can potentially solve Angular’s most egregious performance <a id="_idIndexMarker285"/>and scaling issues. However, as of Angular 17, signals are still in partial preview, and signal-based components are expected to be delivered and become stable around Angular 19. When this happens, we’ll still need to rewrite significant portions of our applications to take advantage of the performance benefits.</p>
    <div class="packt_tip">
      <p class="normal">A pure signals-based application won’t require heavy RxJS use to enable reactivity. I predict its use will be rare, as most service and API calls can be converted into async/await-enabled promise-based calls. This would be revolutionary in making Angular very easy to learn.</p>
      <p class="normal">In the <em class="italic">Rewriting Angular Apps with NgRx/SignalStore</em> section of <em class="chapterRef">Chapter 9</em>, <em class="chapterRef">Recipes – Master/Detail, Data Tables, and NgRx</em>, I demonstrate how far you can go with signals with Angular 17.</p>
    </div>
    <p class="normal">Next, let’s talk about build issues that large applications can create.</p>
    <h2 id="_idParaDest-101" class="heading-2">Build performance</h2>
    <p class="normal">Like runtime performance issues, the codebase size can play a major role in the quality of DevEx. When more code is present in a project, building the code and running tests on it becomes slower. This lengthens<a id="_idIndexMarker286"/> the developer feedback cycle. A slow feedback cycle results in a slow development process with more bugs and fewer quality features delivered.</p>
    <p class="normal">While minimalist solutions like ArrowJS or Qwik.js handle this by requiring none to minimalist state-of-the-art tooling, existing SPA frameworks can’t do this easily, given a large install base and complicated requirements. But this doesn’t mean there aren’t great solutions.</p>
    <p class="normal">The tools described in the following sections can speed up your development process and improve DevEx.</p>
    <h3 id="_idParaDest-102" class="heading-3">Nx</h3>
    <p class="normal"><strong class="keyWord">Nx</strong> is a next-generation build system with first-class monorepo support and powerful integrations. Nx allows you to break up your application code into libraries and utilize build caching only to re-build portions of the app that need it. So, a small change doesn’t have to trigger a full build, but instead a short<a id="_idIndexMarker287"/> 30-second build and only re-running tests that are impacted. The great thing about this is that the cache can be shared remotely across servers and dev machines.</p>
    <p class="normal">Nx also offers an opinionated <a id="_idIndexMarker288"/>architecture, which is welcome for very large teams and enterprises. Nx also automates dependency updates, a critical and time-consuming maintenance task for all modern web projects.</p>
    <div class="note">
      <p class="normal">You can create a new Nx application by running:</p>
      <pre class="programlisting con"><code class="hljs-con">$ npx create-nx-workspace@latest
</code></pre>
      <p class="normal">Or you can migrate your existing apps to Nx by running:</p>
      <pre class="programlisting con"><code class="hljs-con">$ npx nx@latest init
</code></pre>
    </div>
    <p class="normal">You can learn more <a id="_idIndexMarker289"/>about Nx at <a href="https://nx.dev/"><span class="url">https://nx.dev/</span></a>.</p>
    <h3 id="_idParaDest-103" class="heading-3">esbuild</h3>
    <p class="normal"><strong class="keyWord">esbuild</strong> is an extremely fast bundler for the web. It runs 40x faster than webpack 5, which Angular currently relies on to pack up<a id="_idIndexMarker290"/> the SPA, contributing significantly to slow build times.</p>
    <p class="normal">As of Angular 17, the<a id="_idIndexMarker291"/> esbuild-based <strong class="keyWord">ES Module</strong> (<strong class="keyWord">ESM</strong>) build system is the default<a id="_idIndexMarker292"/> builder. You can read<a id="_idIndexMarker293"/> more about it at <a href="https://angular.dev/tools/cli/esbuild"><span class="url">https://angular.dev/tools/cli/esbuild</span></a>.</p>
    <div class="note">
      <p class="normal">The webpack-based legacy build system is still considered stable and fully supported.</p>
      <p class="normal">To migrate to the new build system, follow the instructions at <a href="https://angular.dev/tools/cli/esbuild#using-the-browser-esbuild-builder"><span class="url">https://angular.dev/tools/cli/esbuild#using-the-browser-esbuild-builder</span></a>.</p>
    </div>
    <p class="normal">The new esbuild-based build system also enables next-generation frontend tooling with Vite. Learn more<a id="_idIndexMarker294"/> about Vite at <a href="https://vitejs.dev/"><span class="url">https://vitejs.dev/</span></a>.</p>
    <p class="normal">You can learn more about <a id="_idIndexMarker295"/>esbuild at <a href="https://esbuild.github.io/"><span class="url">https://esbuild.github.io/</span></a>.</p>
    <h3 id="_idParaDest-104" class="heading-3">Test automation</h3>
    <p class="normal">The Karma and Jasmine tools are showing their<a id="_idIndexMarker296"/> age. Karma was never built with headless unit tests in mind. The original <strong class="keyWord">end-to-end (e2e)</strong> testing tool for Angular, Protractor, has already been <a id="_idIndexMarker297"/>deprecated and replaced by Cypress. This is covered in depth in <em class="chapterRef">Chapter 4</em>, <em class="italic">Creating a Router-First Line-of-Business App</em>. Cypress is great to work with and a great replacement for Protractor.</p>
    <p class="normal">Let’s go over a few alternatives to Karma and Jasmine for faster unit testing:</p>
    <ul>
      <li class="bulletList">Jest, <a href="https://jestjs.io"><span class="url">https://jestjs.io</span></a>, is a near drop-in replacement for Jasmine with a built-in test runner. I’ve had a great experience leveraging Jest with my CLI tools; however, Jest was never built with supporting ES modules. This results in significant compatibility issues when using CommonJS modules and ES modules together, which is often the case in any existing application. The issues were so opaque and significant I had to abandon an effort to upgrade the sample code for the book to Jest.
    <div class="note">
      <p class="normal">As of the time of publication, Angular supports Jest in preview. However, I don’t recommend that you use it.</p>
    </div></li>
    </ul>


    <ul>
      <li class="bulletList">Vitest, <a href="https://vitest.dev/"><span class="url">https://vitest.dev/</span></a>, powered by Vite, is a blazing-fast unit test framework and represents an <a id="_idIndexMarker298"/>acceptable future state. However, to seamlessly leverage Vitest, you should also use the esbuild-based build configuration that also comes with Vite.</li>
      <li class="bulletList">Cypress, <a href="https://www.cypress.io/"><span class="url">https://www.cypress.io/</span></a>, is generally known for its e2e testing capabilities. However, you can also write<a id="_idIndexMarker299"/> component tests with Cypress. Once you configure Cypress for an Angular project, any time you generate a new component, a new Cypress component test file will also be added. Cypress’s black-box approach to component testing makes it easier to write new tests, but they can’t be referred to as unit tests.</li>
    </ul>
    <p class="normal">Once (and if) all the half-dozen or more in-preview pieces of tech graduate to Angular production status, the heavy-hitting SPA framework will be ready for the future. In the meantime, don’t discount alternatives like Qwik.js for extremely performance-sensitive applications.</p>
    <p class="normal">Now that you know where the<a id="_idIndexMarker300"/> monsters are hiding, you’re ready to tackle the execution of your project. But wait, don’t start coding just yet. Having a plan in place is indispensable.</p>
    <h1 id="_idParaDest-105" class="heading-1">Planning using Kanban and GitHub projects</h1>
    <p class="normal">Having a roadmap before getting on the road is critical in reaching your destination. Similarly, building a rough plan of action before you<a id="_idIndexMarker301"/> start coding is crucial in ensuring project success. Building a plan early <a id="_idIndexMarker302"/>on enables your colleagues or clients to be aware of what you’re planning to accomplish. However, any initial plan is guaranteed to change over time.</p>
    <p class="normal">Agile software development aims to account for changing priorities and features over time. Kanban and Scrum are the two most popular methodologies that you can use to manage your project. Each methodology has a concept of a backlog and lists that capture planned, in progress, and completed work. A backlog, which contains a prioritized list of tasks, establishes a shared understanding of what needs to be worked on next. Lists that capture the status of each task act as information radiators, where stakeholders can get updates without interrupting your workflow. Whether you’re building an app for yourself or someone else, keeping a live backlog and tracking the progress of tasks pays dividends and keeps the focus on the goal you’re trying to achieve.</p>
    <p class="normal">You can leverage a GitHub project to act as a Kanban board. In an enterprise, you can use ticketing systems or tools to keep a backlog, implement the Scrum methodology, and display Kanban boards. In GitHub, issues represent your backlog. You can leverage the built-in <strong class="screenText">Projects</strong> tab to define a scope of work representing a release or a sprint to establish a Kanban board. A GitHub project directly integrates with your GitHub repository’s issues and keeps track of the status of issues via labels. This way, you can keep using the tool of your choice to interact with your repository and still effortlessly radiate information.</p>
    <p class="normal">An <strong class="keyWord">information radiator</strong> is a dynamic tool used in agile project management and software development to display critical project <a id="_idIndexMarker303"/>information in a highly visible area. Designed to promote transparency and facilitate passive communication, it ensures that team members are continuously and effortlessly informed about key aspects of the project, such as progress, goals, deadlines, and potential issues. Typically placed in a common workspace, an information radiator might take the form of a large whiteboard or digital display, showing easy-to-understand visuals like charts, graphs, or Kanban boards. Its primary function is to keep the information current and relevant, providing a real-time snapshot of the project’s status. By doing so, it enhances collaboration, helps in identifying bottlenecks quickly, and allows for prompt decision-making. The information radiator, therefore, serves as both a focal point for team interaction and a catalyst for a more engaged and informed team dynamic.</p>
    <p class="normal">In the next section, you will set up a project to achieve this goal.</p>
    <h2 id="_idParaDest-106" class="heading-2">Setting up a GitHub project</h2>
    <p class="normal">Let’s set up a GitHub project:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Navigate to your <a id="_idIndexMarker304"/>GitHub repository in your browser.</li>
      <li class="numberedList">Switch over to the <strong class="screenText">Projects</strong> tab.</li>
      <li class="numberedList">Select <strong class="screenText">New project</strong>.
    <figure class="mediaobject"><img src="../Images/B18047_03_06.png" alt="A screenshot of a computer  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 3.6: Creating a new project in GitHub</p></li>
    </ol>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="4">Provide a name in the <strong class="screenText">Project name</strong> box.</li>
      <li class="numberedList">Select the project template named <strong class="screenText">Team backlog</strong>.</li>
      <li class="numberedList">Click on <strong class="screenText">Create</strong>.</li>
    </ol>
    <p class="normal">We just created a Kanban board, a lightweight methodology to organize your work you might choose over other <a id="_idIndexMarker305"/>methodologies like Scrum. Observe your Kanban board, which should appear as follows:</p>
    <figure class="mediaobject"><img src="../Images/B18047_03_07.png" alt="A screenshot of a computer  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 3.7: The Kanban board for your project</p>
    <p class="normal">The default configuration of the board includes the following columns: </p>
    <ul>
      <li class="bulletList"><strong class="screenText">New</strong>: Should be used for adding new issues</li>
      <li class="bulletList"><strong class="screenText">Backlog</strong>: A prioritized list of tasks to work on</li>
      <li class="bulletList"><strong class="screenText">Ready</strong>: Tasks that meet the definition of ready and can be immediately worked on</li>
      <li class="bulletList"><strong class="screenText">In progress</strong>: Tasks that are in progress; using the triple-dot menu, you can set an item limit, enforcing<a id="_idIndexMarker306"/> a <strong class="keyWord">Work-in-Progress</strong> (<strong class="keyWord">WIP</strong>) limit</li>
      <li class="bulletList"><strong class="screenText">In review</strong>: Work that’s under code <a id="_idIndexMarker307"/>review, QA testing, and <strong class="keyWord">Product Owner</strong> (<strong class="keyWord">PO</strong>) approval</li>
      <li class="bulletList"><strong class="screenText">Done</strong>: Work that meets the<a id="_idIndexMarker308"/> definition of done</li>
    </ul>
    <div class="note">
      <p class="normal">The Definition of Ready defines <em class="italic">“criteria to know when a Backlog item is refined enough to start working on it”</em> and the Definition of Done defines <em class="italic">“criteria to know when a Backlog item is completed.”</em> It is critical to define these criteria as part of team norms. To learn more about running successful Kanban projects, check out this article by my colleague Nicole Spence-Goon: <a href="https://www.excella.com/insights/successful-agile-project-with-transient-teams"><span class="url">https://www.excella.com/insights/successful-agile-project-with-transient-teams</span></a>.</p>
    </div>
    <p class="normal">If you have existing GitHub issues or pull requests in your repository, you can add them to your project individually or in bulk using the <strong class="screenText">+ Add item</strong> button. You can also combine issues from different repositories.</p>
    <h2 id="_idParaDest-107" class="heading-2">Customizing the Kanban board</h2>
    <p class="normal">Your board is configured as a <a id="_idIndexMarker309"/>Kanban board with all the necessary columns out of the box. By <a id="_idIndexMarker310"/>default, issues created and <strong class="keyWord">Pull Requests</strong> (<strong class="keyWord">PRs</strong>) opened in your project will be automatically added to the board.</p>
    <p class="normal">You can do this by opening the <strong class="screenText">Workflows</strong> screen from the triple-dot menu marked as <strong class="keyWord">1</strong> in the following screenshot:</p>
    <figure class="mediaobject"><img src="../Images/B18047_03_08.png" alt="A screenshot of a computer  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 3.8: Kanban board workflows</p>
    <p class="normal">Number<strong class="screenText"> 2</strong> shows a list of the default workflows listed. You can select one and use the <strong class="screenText">Edit</strong> button, marked with <strong class="screenText">3</strong>, to change the automated behavior.</p>
    <p class="normal">GitHub projects also have <a id="_idIndexMarker311"/>a concept of milestones. You can create milestones and assign them to issues or PRs to set up a sprint or a release and track percentage completion or other stats via the <strong class="screenText">Insights</strong> screen, accessed next to the triple-dot menu, marked with number <strong class="screenText">1</strong>.</p>
    <p class="normal">You may also add a roadmap using the on <strong class="screenText">+ New View</strong> button to get a different view. The most powerful feature of GitHub projects is the integration with developer workflows. See the following PR:</p>
    <figure class="mediaobject"><img src="../Images/B18047_03_09.png" alt="A screenshot of a computer  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 3.9: Pull request with project integration</p>
    <p class="normal">Number <strong class="screenText">1</strong> shows that the PR is in the <strong class="screenText">In progress</strong> column of the <strong class="screenText">LemonMart</strong> project. Developers get glanceable information and the ability to manipulate project files within the PR. At number <strong class="screenText">2</strong>, we can<a id="_idIndexMarker312"/> see the PR is assigned to the <strong class="screenText">3rd Edition</strong> milestone, where we can see a progress bar showing percentage completion. And finally, number <strong class="screenText">3</strong> shows one or more issues that this PR can resolve.</p>
    <h2 id="_idParaDest-108" class="heading-2">Creating a prioritized backlog for your app</h2>
    <p class="normal">Get together with your team and <a id="_idIndexMarker313"/>create a backlog of issues to keep track of your progress as you implement the design of your application. When creating issues, you should focus on delivering functional iterations that bring some value to the user.</p>
    <p class="normal">Refrain from creating purely technical tasks. The technical hurdles you must clear to achieve those results are of no interest to your users or clients. Bug tickets are okay because they impact your users. However, technical tasks become part of the functional problem you’re trying to solve, so address them within that context. This way, you’ll always be ready to translate the work being done into value being delivered when approached by business leaders at your organization.</p>
    <p class="normal">As you add items to the backlog, be sure to prioritize them. The first items to be worked on go to the top and descend in order of importance. New items go into the <strong class="screenText">New</strong> column and are only added to<a id="_idIndexMarker314"/> the backlog in a grooming session so their necessity and priority can be properly assessed. With a prioritized backlog, you have your roadmap in hand, and your team is ready to start work.</p>
    <p class="normal">Ultimately, GitHub projects provide an easy-to-use GUI so that non-technical people can easily interact with GitHub issues. By allowing non-technical people to participate in the development process on GitHub, you unlock the benefits of GitHub becoming the single source of information for your entire project. Questions, answers, and discussions about features and issues are tracked as part of GitHub issues instead of being lost in emails. You can also store wiki-type documentation on GitHub. So, by centralizing all project-related information, data, conversations, and artifacts on GitHub, you are greatly simplifying the potentially complicated interaction of multiple systems that require continued maintenance at a high cost. GitHub has a very reasonable cost for private repositories and on-premises enterprise installations. If you’re sticking with open source, as we are in this chapter, all these tools are free.</p>
    <p class="normal">With a roadmap in place, let’s investigate the philosophy of how to prioritize work and execute the design and architecture of our apps.</p>
    <h1 id="_idParaDest-109" class="heading-1">The 80-20 solution</h1>
    <p class="normal">Whether we develop apps at home, for passion projects, or at the office, for work, we must remain mindful of our purpose: to deliver value. If we don’t deliver value with our passion projects, we won’t feel<a id="_idIndexMarker315"/> fulfilled or happy. If we fail to deliver value at work, we may not get paid.</p>
    <p class="normal">Delivering a modern web application is difficult. There are numerous challenges that we need to overcome to be successful:</p>
    <ul>
      <li class="bulletList">Deliver iteratively and incrementally</li>
      <li class="bulletList">Be scalable</li>
      <li class="bulletList">Serve dozens of screens and input types</li>
      <li class="bulletList">Be usable</li>
      <li class="bulletList">Be accessible</li>
      <li class="bulletList">Manage a team</li>
      <li class="bulletList">Groom a prioritized backlog</li>
      <li class="bulletList">Ensure acceptance criteria are clear, concise, and concrete</li>
    </ul>
    <p class="normal">If you’ve ever led a project or tried to implement and deliver a project on your own, you’ll have realized that there’s never enough time and resources to cover the wide variety of stakeholder, team, and technical needs on any given project. Remember that the Pareto principle, also known as the 80-20 rule, implies that we can accomplish 80% of our goals with 20% of the <a id="_idIndexMarker316"/>overall effort.</p>
    <p class="normal">If we apply the 80-20 rule to our work, we can maximize our output, quality, and happiness. Line-of-business applications are the bread and butter of our industry. Applying the 80-20 rule, we can surmise that most of us will earn most of our income by delivering such applications. Therefore, we should keep our engineering overhead to a minimum and reduce the delivery risk of our project. By limiting experimentation in production code, we create a predictable environment for our team members and only introduce changes that we had a chance to vet in proof-of-concept or small apps.</p>
    <p class="normal">Our 80-20 strategy, combined with discipline, can help us deliver the same project at the same time with more features and better quality. By treating your career as a marathon and not a series of sprints, you can find yourself in a position to deliver high-quality solutions, project after project, without feeling burned out.</p>
    <h2 id="_idParaDest-110" class="heading-2">Understanding line-of-business apps</h2>
    <p class="normal">According to Wikipedia, line-of-business applications are a <em class="italic">“set of critical computer applications perceived as vital to running an enterprise.”</em> LOB apps are what most developers end up developing, even though<a id="_idIndexMarker317"/> we may think we develop small apps or large enterprise apps. Consider the following illustration, which demonstrates the kinds of apps we might develop, placed on an axis relative to their size and scope:</p>
    <figure class="mediaobject"><img src="../Images/B18047_03_10.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 3.10: Relative size and scope of four kinds of apps</p>
    <p class="normal">From my perspective, we think about four kinds of apps when we begin developing software:</p>
    <ul>
      <li class="bulletList">Small apps</li>
      <li class="bulletList">LOB apps</li>
      <li class="bulletList">Large enterprise apps</li>
      <li class="bulletList">Billion-user-scale apps</li>
    </ul>
    <p class="normal">Billion-user-scale apps are completely niche implementations that rarely have needs that align with most apps <a id="_idIndexMarker318"/>out there. For this reason, we must classify these apps as outliers.</p>
    <p class="normal">Small apps start small. Architecturally, they’re likely to be initially under-engineered. As you add features and team members to work on a small app, at some point, you’re going to run into trouble. As your team size and feature set grow, or the overall complexity of the app increases, the architectural needs of the application grow exponentially.</p>
    <p class="normal">Once you cross the inflection point of the complexity your architecture can bear, you’re left with a costly reengineering effort to get back on track. See the following graph illustrating this idea:</p>
    <figure class="mediaobject"><img src="../Images/B18047_03_11.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 3.11: Architectural journey of a small app</p>
    <p class="normal">The area under the feature line represents under-engineering, which introduces risk to your project. The area above the feature line shows the required engineering overhead to support the features needed. In <a id="_idIndexMarker319"/>comparison, large enterprise apps start with a massive over-engineering effort, as shown in the following diagram:</p>
    <figure class="mediaobject"><img src="../Images/B18047_03_12.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 3.12: Architectural journey of a large enterprise app</p>
    <p class="normal">As time goes on and the system’s overall complexity increases, large enterprise apps can also face a similar inflection point, where the original architecture can become inadequate. With careful planning and management, you can avoid trouble and protect the significant initial investment made. Such large enterprise apps require hundreds of developers, with multiple<a id="_idIndexMarker320"/> levels of managers and architects, to execute successfully. Like billion-user-scale apps, these apps can also have niche architectural needs. In between the small apps and the large enterprise apps that we develop lie LOB apps.</p>
    <figure class="mediaobject"><img src="../Images/B18047_03_13.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 3.13: Dynamic nature of software evolution</p>
    <p class="normal">As shown in the preceding diagram, small apps can grow and morph into LOB apps, and large enterprise apps can become under-utilized as users ignore the features they never need but keep the app to serve a singular purpose as a LOB app. In either case, despite our best efforts, we ultimately deliver an inefficient solution for the problem we’re solving. None of us have a crystal ball to see the future, and planning and engineering can only do so much for us in an unpredictable business setting; we need to rely on the 80-20 rule to come up with an architecture that is flexible to change, but adequate to meet most business requirements.</p>
    <p class="normal">Router-first architecture, covered in a later section, aims to maintain optimal architectural overhead so that costly re-engineering or late-stage crunch can be avoided in the rush to deliver all required features. Let’s see how.</p>
    <div class="note">
      <p class="normal">I coined the term router-first architecture in 2018 with the first edition of this book. Since then, I’ve spoken about it at a dozen conferences and executed it on multi-million dollar<a id="_idIndexMarker321"/> projects successfully. Here’s my first presentation at the Angular DC meetup in June 2018: <a href="https://www.youtube.com/watch?v=XKuFNiV-TWg"><span class="url">https://www.youtube.com/watch?v=XKuFNiV-TWg</span></a>.</p>
    </div>
    <h2 id="_idParaDest-111" class="heading-2">Disciplined and balanced approach</h2>
    <p class="normal">We covered the <em class="italic">what</em> of software development, but we must also consider the <em class="italic">why</em>, <em class="italic">when</em>, <em class="italic">where</em>, and <em class="italic">who</em> before we can get to the <em class="italic">how</em>. We usually under-engineer our projects when we develop apps for learning or<a id="_idIndexMarker322"/> passion projects. If your passion project somehow becomes an overnight success, it becomes costly to maintain or keep adding features to your app. In this case, you will have to bear the ongoing maintenance cost or face a rewrite of your application.</p>
    <p class="normal">When we develop apps for work, we tend to be more conservative and will likely over-engineer our solution. However, if you only code for work, you will likely experiment with production-bound code. It is dangerous to experiment in a codebase with other team members. You may be introducing a new pattern without your team understanding the consequences of your choices. You’re also less likely to know the mid-to-long-term risks or benefits of the technologies you introduce.</p>
    <p class="normal">Reckless experimentation can also have a severe negative impact on your team members. In a team of senior and experienced software engineers, you can likely get away with experimenting in a moving car. However, we will likely have team members of varying backgrounds and learning styles on our teams. Some of us have computer science degrees, some of us are lone wolves, and some of us depend a bit too much on Stack Overflow. Some of us work at companies that are great at supporting professional growth, but some of us work at places that won’t give us a day to learn something new. So, when experimenting, we must consider our environment; otherwise, we can cause our colleagues to work overtime or feel helpless and frustrated.</p>
    <p class="normal">With a disciplined and balanced approach, we can reduce the number of bugs delivered, avoid costly rework, and work with a group of people moving in the same direction. We also need the right architecture, tools, and patterns/practices to deliver successfully. In summary, our approach must consider the following:</p>
    <ul>
      <li class="bulletList">The size of our app</li>
      <li class="bulletList">The reason we are developing the app</li>
      <li class="bulletList">The skill level of developers</li>
      <li class="bulletList">Iterative and incremental delivery</li>
      <li class="bulletList">The constant forward flow of features</li>
      <li class="bulletList">Cloud architecture, operational costs, and cybersecurity</li>
    </ul>
    <p class="normal">Ideally, we need to maintain optimal engineering overhead. Our architecture should support our short-term needs while being extensible, so we can pivot in different directions if our mid- or long-term needs change without having to rewrite large swathes of code. Consider the <a id="_idIndexMarker323"/>following diagram, in contrast to the ones about small and large enterprise apps in the previous section:</p>
    <figure class="mediaobject"><img src="../Images/B18047_03_14.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 3.14: Ideal architectural journey of an LOB app</p>
    <p class="normal">Router-first architecture aims to help you find the balance between your codebase’s engineering overhead, feature delivery, and flexibility. However, you are responsible for managing the discipline side of things.</p>
    <div class="note">
      <p class="normal">Shu Ha Ri is a concept that can help bring discipline to your work. It is a way of thinking that instructs you first to master the basics without worrying about the underlying theory, then master the theory, and finally be able to adapt what you mastered to your needs. However, if you skip steps 1 or 2, you will find yourself adapting the wrong thing incorrectly.</p>
    </div>
    <p class="normal">Having covered the <em class="italic">what</em>, <em class="italic">why</em>, <em class="italic">when</em>, <em class="italic">where</em>, and <em class="italic">who</em>, let’s<a id="_idIndexMarker324"/> jump into the <em class="italic">how</em> in the next section.</p>
    <h1 id="_idParaDest-112" class="heading-1">Router-first architecture</h1>
    <p class="normal">Router-first architecture is a way to:</p>
    <ul>
      <li class="bulletList"><strong class="keyWord">Enforce</strong> high-level <a id="_idIndexMarker325"/>thinking</li>
      <li class="bulletList"><strong class="keyWord">Ensure</strong> consensus on features <em class="italic">before</em> you start coding</li>
      <li class="bulletList"><strong class="keyWord">Plan</strong> for your codebase/team to grow</li>
      <li class="bulletList"><strong class="keyWord">Introduce</strong> little engineering overhead</li>
    </ul>
    <p class="normal">There are seven steps to implementing the router-first architecture:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">Develop a roadmap and scope (<em class="chapterRef">Chapter 4</em>).</li>
      <li class="numberedList">Design with lazy loading in mind (<em class="chapterRef">Chapter 4</em>).</li>
      <li class="numberedList">Implement a walking-skeleton navigation experience (<em class="chapterRef">Chapter 4</em>).</li>
      <li class="numberedList">Achieve a stateless, data-driven design (<em class="chapterRef">Chapters 4</em>-<em class="chapterRef">5</em>).</li>
      <li class="numberedList">Enforce a decoupled component architecture (<em class="chapterRef">Chapters 6-9</em>).</li>
      <li class="numberedList">Differentiate between user controls and components (<em class="chapterRef">Chapter 8</em>).</li>
      <li class="numberedList">Maximize code reuse with TypeScript and ES features (<em class="chapterRef">Chapters 5-9</em>).</li>
    </ol>
    <p class="normal">As noted previously, each step will be covered in more detail in this and coming chapters. Before we go over these steps at a high level, let’s first cover feature modules in Angular, which are important fundamental technical concepts.</p>
    <h2 id="_idParaDest-113" class="heading-2">Feature modules</h2>
    <p class="normal">In <em class="chapterRef">Chapter 1</em>, <em class="italic">Angular’s Architecture and Concepts</em>, we covered Angular’s architecture at a high level and introduced the concepts of lazy loading and routing. Feature modules are a key component in implementing lazy<a id="_idIndexMarker326"/> loading. There are two kinds of modules: the root module and the feature module. Modules are implemented by the class <code class="inlineCode">NgModule</code>. <code class="inlineCode">NgModule</code> contains all the necessary metadata to render components and inject services. Before the introduction of standalone components, a component without a module couldn’t do much. But now, a standalone component can import its dependent modules, components, and providers without needing a module.</p>
    <p class="normal">An Angular application is defined by <code class="inlineCode">NgModule</code> that sits at the root of the application. This is called the root module. Starting<a id="_idIndexMarker327"/> with Angular 17, standalone projects are enabled by default. So, instead of a root module, an <code class="inlineCode">AppConfig</code> object is created, which fulfills a similar role to the root module<a id="_idIndexMarker328"/> during the bootstrap process. The root module renders what appears in the <code class="inlineCode">&lt;app-root&gt;</code> element in your <code class="inlineCode">index.html</code> file. Locate the root module, which is interchangeable with <code class="inlineCode">AppConfig</code>, in the following diagram:</p>
    <figure class="mediaobject"><img src="../Images/B18047_03_15.png" alt="A picture containing text, diagram, plan, line  Description automatically generated"/></figure>
    <p class="packt_figref">Figure 3.15: Major architectural components of Angular</p>
    <p class="normal"><code class="inlineCode">NgModule</code> can contain many other <code class="inlineCode">NgModules</code>. An Angular app can only have one root module or none. This means <code class="inlineCode">NgModule</code> you implement is a feature module. In the preceding diagram, you can see that you can organize a group of components (<strong class="keyWord">Cmp</strong>) and services (<strong class="keyWord">Svc</strong>) into feature modules. Grouping functionality into modules allows us to organize our code into chunks, which can be separated from the initial bundle of our application.</p>
    <p class="normal">This idea of root and feature modules represents a parent/child relationship, which is a concept that extends to other functionality and frameworks. For example, note that the preceding diagram injects a root router into the root module. A root router can have child routes. Child routes can be configured to load feature modules. Similarly, NgRx has root and feature module-level stores to organize the state data of your application.</p>
    <div class="packt_tip">
      <p class="normal">Any mention of a sub-module, child module, or feature module in this book refers to the same thing: a module that is not the root module.</p>
    </div>
    <p class="normal">Feature modules and child routes allow for a separation of concerns between major components of your application. Two teams can work on two different modules without interfering with each other. This separation means that any dependency required by a feature module must be explicitly added to the imports, declarations, or providers of that module. In the case of <a id="_idIndexMarker329"/>standalone components, these imports and providers must be added to every single component. This can seem repetitive and annoying, but it is a necessary evil.</p>
    <div class="note">
      <p class="normal">As explained in <em class="chapterRef">Chapter 2</em>, <em class="italic">Forms, Observables, Signals, and Subjects</em>, services, by default, are singletons – one instance per module. However, you can remove the <code class="inlineCode">providedIn: 'root'</code> property from the <code class="inlineCode">@Injectable</code> annotation and use the service within different injection contexts. You can provide copies of a service at the feature module or component level. When doing this, be aware that if you provide the same service in multiple contexts within the same inheritance chain, e.g., in the root and a feature module or a component, you will end up having multiple instances of that service that could be injected, which breaks the expectations of the dependency injection system.</p>
    </div>
    <p class="normal">As you can appreciate, modules introduce a complicated and often unnecessary abstraction layer in most scenarios. This is the main reason Angular now generates standalone projects by default.</p>
    <p class="normal">Now, let’s review the seven steps of router-first architecture at a high level.</p>
    <h2 id="_idParaDest-114" class="heading-2">Developing a roadmap and scope</h2>
    <p class="normal">Developing a roadmap and establishing the scope of your project early on is critical to getting the high-level<a id="_idIndexMarker330"/> architecture right. Creating a backlog, wireframes, mock-ups, and interactive prototypes will help you define the map before getting on the road and capture the vision concretely. It is important to remember to use tools only when necessary. Don’t start with Photoshop when a piece of paper and a pencil will do. If stakeholders and team members understand what is being developed, it will be possible to deliver your solution iteratively and incrementally. However, don’t fall into the perfection trap. Save the tweaking and furniture rearranging until after the fundamentals are in place and agreed upon.</p>
    <div class="packt_tip">
      <p class="normal">Document every artifact you create. <em class="chapterRef">Chapter 4</em>, <em class="italic">Creating a Router-First Line-Of-Business App</em>, we cover how to leverage GitHub wikis to store your artifacts. </p>
    </div>
    <p class="normal">Later in this chapter, we will go over how to develop a roadmap and a technique to define your scope, building<a id="_idIndexMarker331"/> on the roadmap-building techniques covered in the <em class="italic">Planning using Kanban and GitHub projects</em> section.</p>
    <h2 id="_idParaDest-115" class="heading-2">Designing with lazy loading in mind</h2>
    <p class="normal">Your first paint matters a lot! According to Google Analytics data from the Angular team in 2018, 53% of mobile users<a id="_idIndexMarker332"/> abandoned a website when load times exceeded 3 seconds. During the same period, most websites were consumed on mobile devices – around 70% in the US and 90% in China. UI libraries and static assets can add significant size to your application. Since most content is consumed on mobile, it’s very important to defer the loading of non-critical assets.</p>
    <p class="normal">We defer the loading of assets by divvying up the parts of our Angular application into feature modules. This way, Angular can load only the assets necessary to render the current screen and dynamically download further resources as needed. You can start thinking about ways to divide your application into feature modules by defining the various user roles your application may use. User roles normally indicate a user’s job function, such as a manager or data-entry specialist. In technical terms, they can be thought of as a group of actions a particular user role can execute. After all, a data-entry specialist won’t ever see most of the screens a manager can, so why deliver those assets to those users and slow down their experience?</p>
    <p class="normal">A more definitive strategy to divide your application would be by business function. You can think of each job function as a sub-module of your application. Following the principle of low coupling and high cohesion, you would want to group related functionality into modules that can be lazily loaded. This way, as users execute a task within a business function, they’re not interrupted by delays. However, as the user switches from one business function to another, we can load the new module, and a slight delay would be acceptable.</p>
    <div class="note">
      <p class="normal">You can set a preloading strategy to eagerly load all modules in the background as the user interacts with your app. This would eliminate any transition delay.</p>
    </div>
    <div class="packt_tip">
      <p class="normal">For more information, see <a href="https://angular.dev/guide/ngmodules/lazy-loading#preloadingv=HTU4WYWGTIk"><span class="url">https://angular.dev/guide/ngmodules/lazy-loading#preloading</span></a>.</p>
    </div>
    <p class="normal">Lazy loading is critical in creating a scalable application architecture, allowing you to deliver high-quality and efficient <a id="_idIndexMarker333"/>products. Lazy loading is a low-hanging fruit we will tackle as a baseline design goal. It can be costly to implement lazy loading after the fact.</p>
    <div class="note">
      <p class="normal">It is also possible to lazy load individual standalone components. Standalone components do not require all the bootstrapping that an Angular application requires.</p>
      <p class="normal">You can read more about these components in detail at <a href="https://angular.io/guide/standalone-components#lazy-loading-a-standalone-component"><span class="url">https://angular.io/guide/standalone-components#lazy-loading-a-standalone-component</span></a>.</p>
    </div>
    <p class="normal">Later in this chapter, you will learn how to implement lazy loading using feature modules.</p>
    <h2 id="_idParaDest-116" class="heading-2">Implementing a walking skeleton</h2>
    <p class="normal">Configuring lazy loading can be tricky, so it is essential to nail down a walking-skeleton navigation experience early on. Implementing a clickable version of your app will help you gather feedback from <a id="_idIndexMarker334"/>users early on. That way, you’ll be able to work out fundamental workflow and integration issues quickly. Additionally, you’ll be able to establish a concrete representation of the scope of your current development effort. Developers and stakeholders alike will be able to visualize better how the product will look.</p>
    <p class="normal">A walking skeleton also sets the stage for multiple teams to work together. Multiple people can start developing different feature modules or components simultaneously without worrying about how the puzzle pieces will come together later. By the end of this chapter, you will have completed implementing the walking skeleton of the sample app LemonMart.</p>
    <h2 id="_idParaDest-117" class="heading-2">Achieve a stateless, data-driven design</h2>
    <p class="normal">As highlighted in <em class="chapterRef">Chapter 5</em>, <em class="italic">Designing Authentication and Authorization</em>, stateless design in full-stack architecture is critical to implementing a maintainable application. As covered in <em class="chapterRef">Chapter 1</em>, <em class="italic">Angular’s Architecture and Concepts</em>, and later in <em class="chapterRef">Chapter 9</em>, <em class="italic">Recipes – Master/Detail, Data Tables, and NgRx</em>, the flux pattern and NgRx make it possible to achieve an immutable state for<a id="_idIndexMarker335"/> your application. However, the flux pattern is likely to be overkill for most applications. NgRx itself leverages a lot of the core technologies present in RxJS.</p>
    <p class="normal">We will use RxJS and the reactive programming paradigm to implement a minimal, stateless, and data-driven pattern for our application. Identifying major data entities, such as invoices or people, that your users will work with will help you avoid over-engineering your application. Designing around major data entities will inform API design early on and help define the <code class="inlineCode">BehaviorSubject</code> data anchors you will use to achieve a stateless, data-driven design. That design will, in turn, ensure a decoupled component architecture, as detailed in <em class="chapterRef">Chapter 2</em>, <em class="italic">Forms, Observables, Signals, and Subjects</em>.</p>
    <p class="normal">By defining observable data anchors, you can ensure that data across various components will be kept in sync. We can implement immutable data streams by writing functional reactive code, leveraging RxJS features, and not storing state in components.</p>
    <p class="normal">We will cover how to design the data models for your application in <em class="chapterRef">Chapter 5</em>, <em class="italic">Designing Authentication and Authorization</em>, and will continue using these models in the following chapters.</p>
    <h2 id="_idParaDest-118" class="heading-2">Enforce a decoupled component architecture</h2>
    <p class="normal">As discussed in <em class="chapterRef">Chapter 1</em>, <em class="italic">Angular’s Architecture and Concepts</em>, decoupling components of your architecture is critical in ensuring a maintainable codebase. You can decouple components in Angular by leveraging <code class="inlineCode">@Input</code> and <code class="inlineCode">@Output</code> bindings and router orchestration.</p>
    <p class="normal">Bindings will help you maintain a <a id="_idIndexMarker336"/>simple hierarchy of components and avoid using dynamic templates in situations where static designs are more effective, such as creating multi-page forms.</p>
    <p class="normal">Router outlets and auxiliary paths allow you to compose your view using the router. Resolvers can help load data by consuming router parameters. Auth guards can help control access to various modules and components. Using router links, you can dynamically customize elements that a user will see in an immutable and predictable way, like the way we designed and developed data anchors in the previous step.</p>
    <p class="normal">If you ensure every component is responsible for loading its data, then you can compose components via URLs. However, overusing the router can become an anti-pattern. If a parent component logically <a id="_idIndexMarker337"/>owns a child component, then the effort to decouple them will be wasted.</p>
    <p class="normal">In <em class="chapterRef">Chapter 2</em>, <em class="italic">Forms, Observables, Signals, and Subjects</em>, you learned how to enable component interactions using <code class="inlineCode">BehaviorSubject</code> and <code class="inlineCode">Signals</code>. In <em class="chapterRef">Chapter 8</em>, <em class="italic">Recipes – Reusability, Forms, and Caching</em>, you will learn how to implement <code class="inlineCode">@Input</code> and <code class="inlineCode">@Output</code> bindings, and in the upcoming chapters, you will learn how to implement router features.</p>
    <h2 id="_idParaDest-119" class="heading-2">Differentiate between user controls and components</h2>
    <p class="normal">Another important idea is differentiating user controls from components. A user control is like a custom date input or<a id="_idIndexMarker338"/> star rater. It is often highly interactive and dynamic code that is highly coupled, convoluted, and complicated. Such controls may utilize rarely used Angular APIs, like <code class="inlineCode">NgZone</code>, <code class="inlineCode">Renderer2</code>, <code class="inlineCode">ViewContainerRef</code>, or <code class="inlineCode">DynamicComponentLoaders</code>. These highly specialized and specific APIs are out of the scope of this book.</p>
    <p class="normal">A component is more like a form with fields, which may contain simple date inputs or a star rater. Because forms encapsulate business functionality, their code must be easily read and understood. Your code should stick to Angular fundamentals so it is stable and easy to maintain, like most of the code in this book.</p>
    <p class="normal">By differentiating between user controls and components, you can make better decisions when deciding what kind of reusable code you want to make. Creating reusable code is costly. If you create the right reusable code, you can save time and resources. If you create the wrong reusable code, then you can waste a lot of time and resources.</p>
    <p class="normal">Wireframing allows you to identify reusable elements early on. User controls will help keep user interaction code separate from business logic. Well-crafted component reuse will enable you to encapsulate domain-specific behavior and share it later.</p>
    <p class="normal">It’s important to identify self-contained user controls that encapsulate unique behaviors you wish to create for your app. User controls will likely be created as directives or components with data-binding properties and tightly coupled controller logic and templates.</p>
    <p class="normal">Conversely, components leverage router lifecycle events to parse parameters and perform CRUD operations on data. Identifying these component reuses early on will create more flexible components<a id="_idIndexMarker339"/> that can be reused in multiple contexts (as orchestrated by the router), maximizing code reuse.</p>
    <p class="normal">We will cover creating reusable components and user controls in <em class="chapterRef">Chapter 8</em>, <em class="italic">Recipes – Reusability, Forms, and Caching</em>.</p>
    <h2 id="_idParaDest-120" class="heading-2">Maximize code reuse with TypeScript and ES</h2>
    <p class="normal">It’s essential to remember the underlying features of the language you work with before considering the features offered by Angular, RxJS, and all the libraries you use. There are decades of software engineering fundamentals that you can leverage to write readable and maintainable code.</p>
    <p class="normal">First and foremost is the DRY principle, which <a id="_idIndexMarker340"/>stands for don’t repeat yourself. So, don’t copy-paste code. Don’t just change a variable or two. Proactively refactor your code to make your functions stateless and reusable. In a few words: don’t repeat yourself, don’t repeat yourself, and don’t repeat yourself.</p>
    <p class="normal">Leverage object-oriented design. Move behavior to classes; if the <code class="inlineCode">person</code> class has a <code class="inlineCode">fullName</code> property, don’t re-implement the logic of assembling a full name in a dozen different places. Implement it once in the <code class="inlineCode">person</code> class. </p>
    <p class="normal">This means you will need to become familiar with hydration, essentially injecting a JSON object into a newly instantiated class and serialization using <code class="inlineCode">toJSON</code>. It is important not to abuse OOP. You should remain stateless and functional by avoiding storing state in class parameters.</p>
    <div class="note">
      <p class="normal">You can unleash the power of object-oriented design by leveraging generics, inheritance, and abstract classes. We will go over concrete examples of these techniques later in the book.</p>
    </div>
    <p class="normal">TypeScript introduces the concept of interfaces to JavaScript. Interfaces are a concept mostly reserved for statically typed languages. An interface represents an abstract notion of what an object can do without specifying implementation details. Furthermore, an interface can be used to document the shape of data. For example, you can write a partial interface of a third-party API to document the fields you’re interested in consuming. When other developers read your code, they understand the structure of the data they’re consuming without having to read the documentation on another website.</p>
    <p class="normal">Interfaces also allow you to morph the shape of your data in a well-defined manner. So, you can write a transform function to transform the shape of external data into internal data. TypeScript will catch any errors you may make. Taking this concept further, you can also use interfaces to flatten data. If the data you receive has a multi-entity relational structure, you can<a id="_idIndexMarker341"/> flatten the relationship to decouple the data design from your UI code.</p>
    <div class="note">
      <p class="normal">Don’t overly flatten your data. Arrays and simple shapes for common objects are okay, such as a <code class="inlineCode">name</code> object (with <code class="inlineCode">first</code>, <code class="inlineCode">middle</code>, <code class="inlineCode">last</code>, <code class="inlineCode">prefix</code>, and <code class="inlineCode">suffix</code> properties) or commonly used domain-specific objects.</p>
    </div>
    <p class="normal">You should also avoid using string literals in your code. Writing business logic where you compare <code class="inlineCode">'apples' !== 'Oranges'</code> results in unmaintainable code. You should leverage <code class="inlineCode">enums</code> in TypeScript, so your code isn’t subject to the spelling mistakes of coders or changing business requirements. So, <code class="inlineCode">'</code><code class="inlineCode">oranges' === Fruit.Oranges</code>.</p>
    <p class="normal">Beyond TypeScript and ECMAScript, Angular also offers helpful functions to reuse logic. Angular validators, pipes, route resolvers, and route guards allow you to share code across components and templates.</p>
    <h1 id="_idParaDest-121" class="heading-1">Summary</h1>
    <p class="normal">This chapter taught you what it takes to succeed as a technical lead or an architect. You learned about the ingredients of running a successful project. We went over why Angular is a great fit for an enterprise. Then we dove into various tools and features to consider for building a high-performance solution. You learned how to create a Kanban board and became familiar with the 80-20 rule and the router-first architecture method to tackle complicated projects.</p>
    <p class="normal">In the next chapter, you will be creating a far more complicated <strong class="keyWord">LOB</strong> application, using a router-first approach to designing and architecting scalable Angular applications with first-class authentication and authorization, user experience, and numerous recipes that cover a vast majority of requirements that you may find in LOB applications.</p>
    <h1 id="_idParaDest-122" class="heading-1">Further reading</h1>
    <ul>
      <li class="bulletList">Analog, the full-stack Angular meta-framework: <a href="https://analogjs.org/"><span class="url">https://analogjs.org/</span></a></li>
      <li class="bulletList">Manifesto for Agile Software Development: <a href="https://agilemanifesto.org"><span class="url">https://agilemanifesto.org</span></a> </li>
      <li class="bulletList">DevOps Research and Assessment (DORA) research program: <a href="https://dora.dev/"><span class="url">https://dora.dev/</span></a></li>
      <li class="bulletList">DORA capability catalog: <a href="https://dora.dev/devops-capabilities"><span class="url">https://dora.dev/devops-capabilities</span></a></li>
      <li class="bulletList">What is Scrum and how to get started, Atlassian, 2023: <a href="https://www.atlassian.com/agile/scrum"><span class="url">https://www.atlassian.com/agile/scrum</span></a></li>
      <li class="bulletList">How to Have a Successful Agile Project with Transient Teams, Nicole Spence-Goon, December 14, 2021: <a href="https://www.excella.com/insights/successful-agile-project-with-transient-teams"><span class="url">https://www.excella.com/insights/successful-agile-project-with-transient-teams</span></a></li>
      <li class="bulletList"><em class="italic">Ha, Not Ready to Ri: The Shu Ha Ri Approach to Agile Development</em>, Brian Sjoberg and Ken Furlong, July 29, 2015: <a href="https://www.excella.com/insights/ha-not-ready-to-ri-the-shu-ha-ri-approach-to-agile-development"><span class="url">https://www.excella.com/insights/ha-not-ready-to-ri-the-shu-ha-ri-approach-to-agile-development</span></a></li>
      <li class="bulletList"><em class="italic">Nx: Smart, Fast Extensible Build System: </em><a href="https://nx.dev"><span class="url">https://nx.dev</span></a></li>
      <li class="bulletList"><em class="italic">RxAngular: Performance &amp; DX: </em><a href="https://www.rx-angular.io"><span class="url">https://www.rx-angular.io</span></a></li>
      <li class="bulletList">Webpack module bundler: <a href="https://webpack.js.org/"><span class="url">https://webpack.js.org/</span></a></li>
    </ul>
    <h1 id="_idParaDest-123" class="heading-1">Questions</h1>
    <p class="normal">Answer the following questions as best as possible to ensure you’ve understood the key concepts from this chapter without googling anything. Do you know if you got all the answers right? Visit <a href="https://angularforenterprise.com/self-assessment"><span class="url">https://angularforenterprise.com/self-assessment</span></a> for more:</p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">What three things should you do to succeed as a technical lead or architect?</li>
      <li class="numberedList">What are the ingredients of a successful project?</li>
      <li class="numberedList">Why should you use Angular in your enterprise?</li>
      <li class="numberedList">What are the most important considerations for building Angular apps for your enterprise?</li>
      <li class="numberedList">What causes performance issues in web applications?</li>
      <li class="numberedList">How can we solve performance issues in large web applications?</li>
      <li class="numberedList">What is an LOB app?</li>
      <li class="numberedList">What is the Pareto principle?</li>
      <li class="numberedList">What are the main goals of the router-first architecture?</li>
    </ol>
    <h1 class="heading-1">Join our community on Discord</h1>
    <p class="normal">Join our community’s Discord space for discussions with the authors and other readers:</p>
    <p class="normal"><a href="Chapter_3.xhtml"><span class="url">https://packt.link/AngularEnterpise3e</span></a></p>
    <p class="normal"><img src="../Images/QR_Code1116411172100421421.png" alt="" role="presentation"/></p>
  </div>
</body></html>
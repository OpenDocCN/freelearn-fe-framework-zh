<html><head></head><body>
        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Creating a Login Component</h1>
                
            
            <article>
                
<p class="calibre2">In this chapter, we will build our second component. We will create a login page, which will be similar to the signup page. We will also add more functionalities to services. We will use Email/Password authentication to log in the user in. User details are already added to the Firebase database during the signup process. We will retrieve the user details from Firebase and pass them to the user profile page. We will also handle common error scenarios, as this will reinforce the concept.</p>
<p class="calibre2">The following topics will be covered in this chapter:</p>
<ul class="calibre7">
<li class="calibre8">Adding login functionalities to existing services</li>
<li class="calibre8">Reusing the domain model</li>
<li class="calibre8">Creating a login template</li>
<li class="calibre8">Error handling for login</li>
<li class="calibre8">Creating login components</li>
<li class="calibre8">Resetting password</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Adding login functionalities to existing services</h1>
                
            
            <article>
                
<p class="calibre2">In the preceding chapter, we used Email/Password authentication and also added our user to the Firebase database. We acquired basic knowledge about pushing data to Firebase. In this section, we will log the user and <span>retrieve the </span>user details from Firebase. We will add login functionalities in the authentication and user service.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Authentication service</h1>
                
            
            <article>
                
<p class="calibre2">During signup, the user is registered to Firebase. <kbd class="calibre11">AngularFireAuth</kbd> has the <kbd class="calibre11">signInWithEmailAndPassword</kbd> method to login the user. This method returns <kbd class="calibre11">firebase.Promise&lt;any&gt;</kbd>. This class has <kbd class="calibre11">then</kbd> and <kbd class="calibre11">catch</kbd> methods to handle success and failure scenarios. On success, we redirect the user to the user-profile case, and we show the error message<span> on failur</span><span>e</span>.</p>
<p class="calibre2">Considering the following methods:</p>
<ul class="calibre7">
<li class="calibre8"><strong class="calibre1">Login</strong>: This method validates the user and passes user information on successful login, as follows:</li>
</ul>
<pre class="calibre18"><span>public </span><span>login</span>(email: <span>string</span>, password: <span>string</span>): Promise&lt;<span>any</span>&gt; {<br class="title-page-name"/>  <span>return this</span>.angularFireAuth.<span>auth</span>.<span>signInWithEmailAndPassword</span>(email, password);<br class="title-page-name"/>}</pre>
<ul class="calibre7">
<li class="calibre8"><strong class="calibre1">Reset</strong>: <kbd class="calibre11">AngularFireAuth</kbd> provides an API to reset the password. Firebase provides the infrastructure for password resets, such as password email notification. We just need to call the <kbd class="calibre11">resetPassword</kbd> API in the authentication service, as follows:</li>
</ul>
<pre class="calibre18"><span>public </span><span>resetPassword</span>(email: <span>string</span>): Promise&lt;<span>any</span>&gt; {<br class="title-page-name"/>  <span>return this</span>.angularFireAuth.<span>auth</span>.<span>sendPasswordResetEmail</span>(email);<br class="title-page-name"/>}</pre>
<p class="calibre2"><span>Here's the complete <kbd class="calibre11">authentication.service.ts</kbd> </span><span>as of now:</span></p>
<pre class="calibre17"><span>import </span>{Injectable} <span>from </span><span>'@angular/core'</span>;<br class="title-page-name"/><span>import </span>{AngularFireAuth} <span>from </span><span>'angularfire2/auth'</span>;<br class="title-page-name"/><br class="title-page-name"/><span>/**<br class="title-page-name"/></span><span> * Authentication service<br class="title-page-name"/></span><span> *<br class="title-page-name"/></span><span> */<br class="title-page-name"/></span>@<span>Injectable</span>()<br class="title-page-name"/><span>export class </span>AuthenticationService {<br class="title-page-name"/><br class="title-page-name"/>  <span>/**<br class="title-page-name"/></span><span>   * Constructor<br class="title-page-name"/></span><span>   *<br class="title-page-name"/></span><span>   * </span><span>@param </span><span>{AngularFireAuth} angularFireAuth provides the <br class="title-page-name"/>     functionality related to authentication<br class="title-page-name"/></span><span>   */<br class="title-page-name"/></span><span>  </span><span>constructor</span>(<span>private </span>angularFireAuth: AngularFireAuth) {<br class="title-page-name"/>  }<br class="title-page-name"/><br class="title-page-name"/>  <span>public </span><span>signup</span>(email: <span>string</span>, password: <span>string</span>): Promise&lt;<span>any</span>&gt; {<br class="title-page-name"/>    <span>return <br class="title-page-name"/>    this</span>.angularFireAuth.<span>auth</span>.<span>createUserWithEmailAndPassword</span>(email, <br class="title-page-name"/>    password);<br class="title-page-name"/>  }<br class="title-page-name"/><br class="title-page-name"/>  <span>public </span><span>login</span>(email: <span>string</span>, password: <span>string</span>): Promise&lt;<span>any</span>&gt; {<br class="title-page-name"/>    <span>return this</span>.angularFireAuth.<span>auth</span>.<span>signInWithEmailAndPassword</span>(email, <br class="title-page-name"/>    password);<br class="title-page-name"/>  }<br class="title-page-name"/><br class="title-page-name"/>  <span>public </span><span>resetPassword</span>(email: <span>string</span>): Promise&lt;<span>any</span>&gt; {<br class="title-page-name"/>    <span>return this</span>.angularFireAuth.<span>auth</span>.<span>sendPasswordResetEmail</span>(email);<br class="title-page-name"/>  }<br class="title-page-name"/><br class="title-page-name"/><br class="title-page-name"/>}</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">User service</h1>
                
            
            <article>
                
<p class="calibre2">Here, we cover how to retrieve value from the Firebase by performing a read operation. <kbd class="calibre11">AngularFire2</kbd> has the <kbd class="calibre11">AngularFireDatabase</kbd> class, which provides the following two methods to read the data from Firebase:</p>
<ul class="calibre7">
<li class="calibre8"><kbd class="calibre11">object</kbd>: This retrieves the JSON object. It returns <kbd class="calibre11">AngularFireObject&lt;T&gt;</kbd>, which provides the <kbd class="calibre11">valueChanges</kbd> method to return the Observable. For example, if we want to get a user object from Firebase, then we use this method.</li>
<li class="calibre8"><kbd class="calibre11">list</kbd>: This retrieves an array of JSON objects. It returns <kbd class="calibre11">AngularFireList&lt;T&gt;</kbd>, which provides the <kbd class="calibre11">valueChanges</kbd> method to return the Observable with an array of objects. For example, if we want to get all the users registered in our application, then this method is handful.</li>
</ul>
<p class="calibre2"><span>Once the user types their correct credentials, then we </span>retrieve the user details using the <kbd class="calibre11">object</kbd> method of <kbd class="calibre11">AngularFireDatabase</kbd>.</p>
<p class="calibre2">The list of methods in the <kbd class="calibre11">AngularFireDatabase</kbd> class, as follows:</p>
<pre class="calibre17"><span>export declare class </span>AngularFireDatabase {<br class="title-page-name"/>    <span>app</span>: FirebaseApp;<br class="title-page-name"/>    <span>database</span>: database.Database;<br class="title-page-name"/>    <span>constructor</span>(app: FirebaseApp);<br class="title-page-name"/>    <span>list</span>&lt;T&gt;(pathOrRef: PathReference, queryFn?: QueryFn): <br class="title-page-name"/>    AngularFireList&lt;T&gt;;<br class="title-page-name"/>    <span>object</span>&lt;T&gt;(pathOrRef: PathReference): AngularFireObject&lt;T&gt;;<br class="title-page-name"/>    <span>createPushId</span>(): <span>string </span>| <span>null</span>;<br class="title-page-name"/>}</pre>
<p class="calibre2"><span>Mostly in our application we use the <kbd class="calibre11">list</kbd> and <kbd class="calibre11">object</kbd> methods of <kbd class="calibre11">AngularFireDatabase</kbd>. These methods accept the <kbd class="calibre11">pathOrRef</kbd> parameters. The <kbd class="calibre11">list</kbd> method accepts an additional <kbd class="calibre11">QueryFn</kbd> as a parameter. The objective of these parameters is as follows:</span></p>
<ul class="calibre7">
<li class="calibre8"><kbd class="calibre11">pathOrRef</kbd>: This parameter accepts the path of data in the Firebase database. As shown in the following example, to access user data we provide the path till the user <kbd class="calibre11">uid</kbd>.</li>
</ul>
<pre class="calibre18"><span>public </span><span>getUser</span>(uid: <span>string</span>): Observable&lt;User&gt; {<br class="title-page-name"/>   <span>return this</span>.fireDb.<span>object</span>&lt;User&gt;(<span>`</span>${<span>USERS_CHILD</span>}<span>/</span>${uid}<span>`</span>).<span>valueChanges</span>();<br class="title-page-name"/>}</pre>
<p class="calibre2">For example, suppose we want to retrieve user information for user id <kbd class="calibre11">qu3bXn9tTJR7j4PBp9LzBGKxHAe2</kbd>, then the path in this case is <kbd class="calibre11">/users/qu3bXn9tTJR7j4PBp9LzBGKxHAe2</kbd>:</p>
<div class="cdpaligncenter"><img src="../images/00014.jpeg" class="calibre35"/></div>
<ul class="calibre7">
<li class="calibre8"><kbd class="calibre11"><span>QueryFn</span></kbd>: This optional parameter in the <kbd class="calibre11">list</kbd> method, filters the list based on the filter criteria. For example, suppose we want the first three registered users, then we use <kbd class="calibre11">limitToFirst</kbd> query.</li>
</ul>
<p class="calibre2"><span>Here's the complete <kbd class="calibre11">user.service.ts</kbd> </span><span>as of now:</span></p>
<pre class="calibre17"><span>import </span>{Injectable} <span>from </span><span>'@angular/core'</span>;<br class="title-page-name"/><span>import </span>{AngularFireDatabase} <span>from </span><span>'angularfire2/database'</span>;<br class="title-page-name"/><span>import </span>{User} <span>from </span><span>'./user'</span>;<br class="title-page-name"/><span>import </span><span>'firebase/storage'</span>;<br class="title-page-name"/><span>import </span>{<span>USERS_CHILD</span>} <span>from </span><span>'./database-constants'</span>;<br class="title-page-name"/><span>import </span>{Observable} <span>from </span><span>'rxjs/Observable'</span>;<br class="title-page-name"/><br class="title-page-name"/><span>/**<br class="title-page-name"/></span><span> * User service<br class="title-page-name"/></span><span> *<br class="title-page-name"/></span><span> */<br class="title-page-name"/></span>@<span>Injectable</span>()<br class="title-page-name"/><span>export class </span>UserService {<br class="title-page-name"/><br class="title-page-name"/>  <span>/**<br class="title-page-name"/></span><span>   * Constructor<br class="title-page-name"/></span><span>   *<br class="title-page-name"/></span><span>   * </span><span>@param </span><span>{AngularFireDatabase} fireDb provides the functionality for <br class="title-page-name"/>     Firebase Database<br class="title-page-name"/></span><span>   */<br class="title-page-name"/></span><span>  </span><span>constructor</span>(<span>private </span>fireDb: AngularFireDatabase) {<br class="title-page-name"/>  }<br class="title-page-name"/><br class="title-page-name"/>  <span>public </span><span>addUser</span>(user: User): <span>void </span>{<br class="title-page-name"/>    <span>this</span>.fireDb.<span>object</span>(<span>`</span>${<span>USERS_CHILD</span>}<span>/</span>${user.<span>uid</span>}<span>`</span>).<span>set</span>(user);<br class="title-page-name"/>  }<br class="title-page-name"/><br class="title-page-name"/>  <span>public </span><span>getUser</span>(uid: <span>string</span>): Observable&lt;User&gt; {<br class="title-page-name"/>    <span>return this</span>.fireDb.<span>object</span>&lt;User&gt;<br class="title-page-name"/>    (<span>`</span>${<span>USERS_CHILD</span>}<span>/</span>${uid}<span>`</span>).<span>valueChanges</span>();<br class="title-page-name"/>  }<br class="title-page-name"/>}</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Reusing the domain model</h1>
                
            
            <article>
                
<p class="calibre2">Once the user is successfully logged in, we will retrieve the user object from our Firebase database. On successful log in, we get the string <kbd class="calibre11">uid</kbd> of the user and use this <kbd class="calibre11">uid</kbd> to retrieve the user details from the user's node in the Firebase database. As discussed in the preceding section, we get the data in the JSON format as follows:</p>
<pre class="calibre17">{<br class="title-page-name"/>  "email": "uttamagarwal.slg@gmail.com",<br class="title-page-name"/>  "mobile": "9972022242",<br class="title-page-name"/>  "name": "Uttam Agarwal",<br class="title-page-name"/>  "uid": "qu3bXn9tTJR7j4PBp9LzBGKxHAe2"<br class="title-page-name"/>}</pre>
<p class="calibre2">This JSON object needs to be mapped to the user object. When we retrieve the <span>JSON </span>object from Firebase using <kbd class="calibre11">AngularFireDatabase</kbd>, we provide the type object in angle brackets, <kbd class="calibre11">&lt;User&gt;</kbd> and this maps the JSON to the user object:</p>
<pre class="calibre17"><span>public </span><span>getUser</span>(uid: <span>string</span>): Observable&lt;User&gt; {<br class="title-page-name"/>  <span>return this</span>.fireDb.<span>object</span>&lt;User&gt;(<span>`</span>${<span>USERS_CHILD</span>}<span>/</span>${uid}<span>`</span>).<span>valueChanges</span>();<br class="title-page-name"/>}</pre>
<p class="calibre2">The constructor accepts all the parameters assigned to its member variable as shown in the following code; h<span>ere's the complete <kbd class="calibre11">user.ts</kbd></span><span>:</span></p>
<pre class="calibre17"><span>export class </span>User {<br class="title-page-name"/><br class="title-page-name"/>   <span>email</span>: <span>string</span>;<br class="title-page-name"/><br class="title-page-name"/>   <span>name</span>: <span>string</span>;<br class="title-page-name"/><br class="title-page-name"/>   <span>mobile</span>: <span>string</span>;<br class="title-page-name"/><br class="title-page-name"/>   <span>uid</span>: <span>string</span>;<br class="title-page-name"/><br class="title-page-name"/>   <span>constructor</span>(email: <span>string</span>,<br class="title-page-name"/>            name: <span>string</span>,<br class="title-page-name"/>            mobile: <span>string</span>,<br class="title-page-name"/>            uid: <span>string</span>) {<br class="title-page-name"/>      <span>this</span>.<span>email </span>= email;<br class="title-page-name"/>      <span>this</span>.<span>name </span>= name;<br class="title-page-name"/>      <span>this</span>.<span>mobile </span>= mobile;<br class="title-page-name"/>      <span>this</span>.<span>uid </span>= uid;<br class="title-page-name"/>   }<br class="title-page-name"/>}</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Creating a login template</h1>
                
            
            <article>
                
<p class="calibre2">A login template is the view and this part is similar to the signup template. We have reused the email and password elements of signup. It has the following three parts:</p>
<ol class="calibre13">
<li value="1" class="calibre8"><strong class="calibre1">Input form</strong>: This is a textbox and takes a user-typed value</li>
</ol>
<p class="calibre2"> </p>
<ol start="2" class="calibre13">
<li value="2" class="calibre8"><strong class="calibre1">Submit action</strong>: It triggers the <kbd class="calibre11">onLogin()</kbd> method with login form data as its parameter to the component</li>
<li value="3" class="calibre8"><strong class="calibre1">Navigation</strong>: This will be covered in detail in <a href="part0071.html#23MNU0-bb7c6bfbc452460584038b7864f000f7" class="calibre10">Chapter 4</a>, <em class="calibre16">Routing and Navigation between Components</em>, so I will not touch on this part here</li>
</ol>
<p class="calibre2"><span>The following is the complete <kbd class="calibre11">login.component.html</kbd></span><span>:</span> </p>
<pre class="calibre17"><span>&lt;</span><span>div </span><span>class=</span><span>"col-md-6 col-md-offset-3 container"</span><span>&gt;</span><br class="title-page-name"/>    <span>&lt;</span><span>h2</span><span>&gt;</span>Login<span>&lt;/</span><span>h2</span><span>&gt;</span><br class="title-page-name"/> <span>&lt;</span><span>app-error-alert </span><span>*ngIf=</span><span>"</span><span>showError</span><span>" </span><span>[errorMessage]=</span><span>"</span><span>errorMessage</span><span>"</span><span>&gt;&lt;/</span><span>app-error-alert</span><span>&gt;</span><br class="title-page-name"/>    <span>&lt;</span><span>form </span><span>name=</span><span>"form" </span><span>(ngSubmit)=</span><span>"</span><span>onLogin</span><span>(</span><span>loginFormData</span><span>)" <br class="title-page-name"/></span><span>    #loginFormData=</span><span>'ngForm'</span><span>&gt;</span><br class="title-page-name"/>        <span>&lt;</span><span>div </span><span>class=</span><span>"form-group"</span><span>&gt;</span><br class="title-page-name"/>            <span>&lt;</span><span>label </span><span>for=</span><span>"email"</span><span>&gt;</span>Email<span>&lt;/</span><span>label</span><span>&gt;</span><br class="title-page-name"/>            <span>&lt;</span><span>input </span><span>type=</span><span>"text" </span><span>class=</span><span>"form-control" </span><span>name=</span><span>"email" <br class="title-page-name"/></span><span>            (ngModel)=</span><span>"</span><span>email</span><span>" </span><span>#email=</span><span>"ngModel"<br class="title-page-name"/></span><span>                   </span><span>required<br class="title-page-name"/></span><span>                   pattern=</span><span>"^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*<br class="title-page-name"/>                           (\.\w{2,3})+$"<br class="title-page-name"/></span><span>                   </span><span>id=</span><span>"email"</span><span>/&gt;</span><br class="title-page-name"/>                 <span>&lt;</span><span>div </span><span>[hidden]=</span><span>"</span><span>email</span><span>.</span><span>valid</span><span> || </span><span>email</span><span>.</span><span>pristine</span><span>"<br class="title-page-name"/></span><span>                 </span><span>class=</span><span>"alert alert-danger"</span><span>&gt;</span><br class="title-page-name"/>                <span>&lt;</span><span>div </span><span>[hidden]=</span><span>"!</span><span>email</span><span>.</span><span>hasError</span><span>('required')"</span><span>&gt;</span>Email is <br class="title-page-name"/>                 required<span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>                <span>&lt;</span><span>div </span><span>[hidden]=</span><span>"!</span><span>email</span><span>.</span><span>hasError</span><span>('pattern')"</span><span>&gt;</span>Email format <br class="title-page-name"/>                 should be<br class="title-page-name"/>                    <span>&lt;</span><span>small</span><span>&gt;&lt;</span><span>b</span><span>&gt;</span>codingchum@gmail.com<span>&lt;/</span><span>b</span><span>&gt;&lt;/</span><span>small</span><span>&gt;</span><br class="title-page-name"/>                <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>            <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>        <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>        <span>&lt;</span><span>div </span><span>class=</span><span>"form-group"</span><span>&gt;</span><br class="title-page-name"/>            <span>&lt;</span><span>label </span><span>for=</span><span>"password"</span><span>&gt;</span>Password<span>&lt;/</span><span>label</span><span>&gt;</span><br class="title-page-name"/>            <span>&lt;</span><span>input </span><span>type=</span><span>"password" </span><span>class=</span><span>"form-control" </span><span>name=</span><span>"password" <br class="title-page-name"/></span><span>             (ngModel)=</span><span>"</span><span>password</span><span>" </span><span>#password=</span><span>"ngModel"<br class="title-page-name"/></span><span>                   </span><span>required id=</span><span>"password"</span><span>/&gt;</span><br class="title-page-name"/>            <span>&lt;</span><span>div </span><span>[hidden]=</span><span>"</span><span>password</span><span>.</span><span>valid</span><span> || </span><span>password</span><span>.</span><span>pristine</span><span>"<br class="title-page-name"/></span><span>                 </span><span>class=</span><span>"alert alert-danger"</span><span>&gt;</span><br class="title-page-name"/>                Password is required<br class="title-page-name"/>            <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>        <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>        <span>&lt;</span><span>div </span><span>class=</span><span>"form-group"</span><span>&gt;</span><br class="title-page-name"/>            <span>&lt;</span><span>button </span><span>type=</span><span>"submit" </span><span>id=</span><span>"login-btn" </span><span>class=</span><span>"btn btn-<br class="title-page-name"/>            success" </span><span>[disabled]=</span><span>"!</span><span>loginFormData</span><span>.</span><span>form</span><span>.</span><span>valid</span><span>"</span><span>&gt;<br class="title-page-name"/></span>            LOGIN<span>&lt;/</span><span>button</span><span>&gt;</span><br class="title-page-name"/>            <span>&lt;</span><span>button </span><span>routerLink=</span><span>"/app-friends-signup" </span><span>data-tag=</span><span>"signup-<br class="title-page-name"/>             tag" </span><span>routerLinkActive=</span><span>"active" <br class="title-page-name"/></span><span>             class=</span><span>"btn btn-success"</span><span>&gt;</span><br class="title-page-name"/>                SIGNUP<br class="title-page-name"/>            <span>&lt;/</span><span>button</span><span>&gt;</span><br class="title-page-name"/>        <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>    <span>&lt;/</span><span>form</span><span>&gt;</span><br class="title-page-name"/><span>&lt;/</span><span>div</span><span>&gt;</span></pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Error handling for login</h1>
                
            
            <article>
                
<p class="calibre2">As discussed in the preceding chapter, we will handle user input and server errors. In the login component, the user input error remains the same as with the signup component. In this component, we used the same in-built Angular error. This error message helps the user enter correct information.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Firebase error</h1>
                
            
            <article>
                
<p class="calibre2">Login Firebase APIs throw an error when a user logs in to a friend's application. We use the <kbd class="calibre11">signInWithEmailAndPassword()</kbd> method of <kbd class="calibre11">AngularFireAuth</kbd> to sign up the user. This API throws the following errors:</p>
<ul class="calibre7">
<li class="calibre8"><kbd class="calibre11">auth/invalid-email</kbd><span>: As the name implies, this error occurs when a user provides an invalid email address. </span></li>
<li class="calibre8"><kbd class="calibre11">auth/user-disabled</kbd><span>: This error occurs when the registered user account is disabled in Firebase. This feature is required when the registered user is not complying with the terms and conditions of the application. Then, we can show a meaningful message to the user. </span></li>
</ul>
<p class="calibre2">You can disable the user account in the following three steps:</p>
<ol class="calibre13">
<li value="1" class="calibre8">Go to Firebase.</li>
<li value="2" class="calibre8">Go to <span>DEVELOP|</span><span>Authentication</span> on the left panel.</li>
<li value="3" class="calibre8">Highlight the user on the right panel. Click on the overflow icon and then on the <span>Disable account</span> option. </li>
</ol>
<p class="calibre2"><span>Take a look at the following <span>Disable account</span> option in Firebase:</span></p>
<div class="cdpaligncenter"><img src="../images/00015.jpeg" class="calibre36"/></div>
<ul class="calibre7">
<li class="calibre8"><kbd class="calibre11">auth/user-not-found</kbd><span>: This error occurs when the user has not signed up in our application. In this case, we can direct the user to the signup page.</span></li>
<li class="calibre8"><kbd class="calibre11">auth/wrong-password</kbd><span>: This error occurs when the password is not correct. In this case, the user has two options: either provide the correct password or reset the password. </span></li>
</ul>
<p class="calibre2">The login method in the authentication service returns <kbd class="calibre11">Promise&lt;any&gt;</kbd>. We handle the error in the <kbd class="calibre11">catch</kbd> block.</p>
<div class="packt_infobox">A promise is a result of any asynchronous operation. After a success or fail operation, we use the promise object to retrieve the stored data.</div>
<p class="calibre2">We will then reuse the error alert created in <a href="part0040.html#164MG0-bb7c6bfbc452460584038b7864f000f7" class="calibre10">Chapter 2</a>, <em class="calibre16">Creating a Signup Component</em> and show the error :</p>
<pre class="calibre17"><span>onLogin</span>(loginFormData): <span>void </span>{<br class="title-page-name"/>   <span>this</span>.authService.<span>login</span>(loginFormData.<span>value</span>.<span>email</span>, <br class="title-page-name"/>   loginFormData.<span>value</span>.<span>password</span>).<span>then</span>((userInfo) =&gt; {<br class="title-page-name"/>      ...<br class="title-page-name"/>   }).<span>catch</span>((error) =&gt; {<br class="title-page-name"/>      <span>this</span>.<span>errorMessage </span>= error.<span>message</span>;<br class="title-page-name"/>      <span>this</span>.<span>showError </span>= <span>true</span>;<br class="title-page-name"/>   });<br class="title-page-name"/>}</pre>
<p class="calibre2">When a user provides a wrong password, the customized error message will be shown as follows:</p>
<div class="cdpaligncenter"><img src="../images/00016.jpeg" class="calibre37"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Creating a login component</h1>
                
            
            <article>
                
<p class="calibre2">The login component handles the user interaction with the UI. It is injected with three services to perform various actions:</p>
<ul class="calibre7">
<li class="calibre8"><strong class="calibre1">Authentication service</strong>: It provides the login API for signing in following the registered user.</li>
<li class="calibre8"><strong class="calibre1">User service</strong>: It provides a method to retrieve the user details from the Firebase database.</li>
<li class="calibre8"><strong class="calibre1">Router</strong>: This service is required to route to different pages in the application. In the login component, we will use this service to route the user to the signup page. This will be covered in more detail in the next chapter.</li>
</ul>
<p class="calibre2">Services are injected in the <kbd class="calibre11">constructor</kbd> of the login component, as follows:</p>
<pre class="calibre17"><span>constructor</span>(<br class="title-page-name"/>    <span>private </span>userService: UserService,<br class="title-page-name"/>    <span>private </span>router: Router,<br class="title-page-name"/>    <span>private </span>authService: AuthenticationService<br class="title-page-name"/>) {}</pre>
<p class="calibre2"><span>The login component</span> also handles user click events. When the user clicks on the <span>LOGIN</span> button, the <kbd class="calibre11">onLogin</kbd> method is called. This method accepts login form data as a parameter, that has user-typed data. We retrieve the email and password as <kbd class="calibre11">loginFormData.value.email</kbd> and <kbd class="calibre11">loginFormData.<span>value</span>.password</kbd><span>. This data is passed to the authentication service for login. On successful log in, we get the <kbd class="calibre11">uid</kbd> of the user and then use this <kbd class="calibre11">uid</kbd> to retrieve the user details from our Firebase database. We also cache these user details in User Service for future reference in other pages:</span></p>
<pre class="calibre17"><span>onLogin</span>(loginFormData): <span>void </span>{<br class="title-page-name"/>   <span>this</span>.authService.<span>login</span>(loginFormData.<span>value</span>.<span>email</span>, <br class="title-page-name"/>   loginFormData.<span>value</span>.<span>password</span>).<span>then</span>((userInfo) =&gt; {<br class="title-page-name"/>      <span>// Login user<br class="title-page-name"/></span><span>      </span><span>const </span><span>uid</span>: <span>string </span>= userInfo.<span>uid</span>;<br class="title-page-name"/>      <span>this</span>.<span>getUserInfo</span>(<span>uid</span>);<br class="title-page-name"/>   }).<span>catch</span>((error) =&gt; {<br class="title-page-name"/>      ...<br class="title-page-name"/>   });<br class="title-page-name"/>}<br class="title-page-name"/><br class="title-page-name"/><span>private </span><span>getUserInfo</span>(uid: <span>string</span>) {<br class="title-page-name"/>   <span>this</span>.userService.<span>getUser</span>(uid).<span>subscribe</span>(snapshot =&gt; {<br class="title-page-name"/>      <span>this</span>.<span>user </span>= snapshot;<br class="title-page-name"/>   });<br class="title-page-name"/>}<br class="title-page-name"/><br class="title-page-name"/></pre>
<p class="calibre2">Finally, we saw how to log in as a registered user. Now, the only part missing is password recovery, which we will cover in the next section.</p>
<p class="calibre2"><span>Here's the complete <kbd class="calibre11">login.component.ts</kbd> </span><span>as of now:</span> </p>
<pre class="calibre17"><span>import </span>{Component} <span>from </span><span>'@angular/core'</span>;<br class="title-page-name"/><span>import </span>{User} <span>from </span><span>'../../services/user'</span>;<br class="title-page-name"/><span>import </span>{Router} <span>from </span><span>'@angular/router'</span>;<br class="title-page-name"/><span>import </span>{AuthenticationService} <span>from </span><span>'../../services/authentication.service'</span>;<br class="title-page-name"/><span>import </span>{UserService} <span>from </span><span>'../../services/user.service'</span>;<br class="title-page-name"/><span>import </span>{AngularFireAuth} <span>from </span><span>'angularfire2/auth'</span>;<br class="title-page-name"/><br class="title-page-name"/>@<span>Component</span>({<br class="title-page-name"/>  <span>selector</span>: <span>'app-friends-login'</span>,<br class="title-page-name"/>  <span>styleUrls</span>: [<span>'login.component.scss'</span>],<br class="title-page-name"/>  <span>templateUrl</span>: <span>'login.component.html'</span>,<br class="title-page-name"/>})<br class="title-page-name"/><span>export class </span>LoginComponent {<br class="title-page-name"/><br class="title-page-name"/>  <span>errorMessage</span>: <span>string</span>;<br class="title-page-name"/><br class="title-page-name"/>  <span>showError</span>: <span>boolean</span>;<br class="title-page-name"/><br class="title-page-name"/>  <span>private </span><span>user</span>: User;<br class="title-page-name"/><br class="title-page-name"/>  <span>constructor</span>(<span>private </span>userService: UserService,<br class="title-page-name"/>              <span>private </span>router: Router,<br class="title-page-name"/>              <span>private </span>authService: AuthenticationService,<br class="title-page-name"/>              <span>private </span>angularFireAuth: AngularFireAuth) {<br class="title-page-name"/>    <span>this</span>.angularFireAuth.<span>auth</span>.<span>onAuthStateChanged</span>(user =&gt; {<br class="title-page-name"/>      <span>if </span>(user) {<br class="title-page-name"/>        <span>this</span>.<span>getUserInfo</span>(user.<span>uid</span>);<br class="title-page-name"/>      }<br class="title-page-name"/>    });<br class="title-page-name"/>  }<br class="title-page-name"/><br class="title-page-name"/>  <span>onLogin</span>(loginFormData): <span>void </span>{<br class="title-page-name"/>    <span>this</span>.authService.<span>login</span>(loginFormData.<span>value</span>.<span>email</span>, <br class="title-page-name"/>    loginFormData.<span>value</span>.<span>password</span>).<span>then</span>((user) =&gt; {<br class="title-page-name"/>      <span>// Login user<br class="title-page-name"/></span><span>      </span><span>const </span><span>uid</span>: <span>string </span>= user.<span>uid</span>;<br class="title-page-name"/>      <span>this</span>.<span>getUserInfo</span>(<span>uid</span>);<br class="title-page-name"/>    }).<span>catch</span>((error) =&gt; {<br class="title-page-name"/>      <span>this</span>.<span>errorMessage </span>= error.<span>message</span>;<br class="title-page-name"/>      <span>this</span>.<span>showError </span>= <span>true</span>;<br class="title-page-name"/>    });<br class="title-page-name"/>  }<br class="title-page-name"/><br class="title-page-name"/>  <span>private </span><span>getUserInfo</span>(uid: <span>string</span>) {<br class="title-page-name"/>    <span>this</span>.userService.<span>getUser</span>(uid).<span>subscribe</span>(snapshot =&gt; {<br class="title-page-name"/>      <span>this</span>.<span>user </span>= snapshot;<br class="title-page-name"/>    });<br class="title-page-name"/>  }<br class="title-page-name"/>}</pre>
<p class="calibre2">Finally we register <kbd class="calibre11">LoginComponent</kbd> in authentication routing modules:</p>
<pre class="calibre17">{<span>path</span>: <span>'app-friends-login'</span>, <span>component</span>: LoginComponent}</pre>
<p class="calibre2">So paste the URL, <kbd class="calibre11">http://localhost:4200/app-friends-login</kbd> in the browser and our login component looks like the following:</p>
<div class="cdpaligncenter"><img src="../images/00017.jpeg" class="calibre38"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Resetting the password</h1>
                
            
            <article>
                
<p class="calibre2">It is good to provide a password recovery option in our application and this process increases the usability of our application. The excellent thing is that Firebase provides all the infrastructure required to perform this action. We will add this feature in our application step by step.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Adding modal template</h1>
                
            
            <article>
                
<p class="calibre2">The first step in the password a reset action is to take a user email address, and we will use a modal in this scenario. A modal is a popup/dialog that appears on top of the current page view. We will use a modal to display the popup to take the user email address.</p>
<p class="calibre2"><strong class="calibre1">Adding the modal template in the login html</strong>: We have modified the <kbd class="calibre11">login.component.html</kbd> file to add the <span>Reset password</span> button, as shown in the following code:</p>
<pre class="calibre17"><span>&lt;</span><span>div </span><span>id=</span><span>"password_reset" </span><span>class=</span><span>"modal fade" </span><span>role=</span><span>"dialog"</span><span>&gt;</span><br class="title-page-name"/>    <span>&lt;</span><span>div </span><span>class=</span><span>"modal-dialog modal-sm"</span><span>&gt;</span><br class="title-page-name"/>        <span>&lt;</span><span>form </span><span>name=</span><span>"form" </span><span>(ngSubmit)=</span><span>"</span><span>onReset</span><span>(</span><span>resetFormData</span><span>)" <br class="title-page-name"/></span><span>         #resetFormData=</span><span>'ngForm'</span><span>&gt;</span><br class="title-page-name"/>            <span>&lt;</span><span>div </span><span>class=</span><span>"modal-content"</span><span>&gt;</span><br class="title-page-name"/>                <span>&lt;</span><span>div </span><span>class=</span><span>"modal-header"</span><span>&gt;</span><br class="title-page-name"/>                  <span>&lt;</span><span>h4 </span><span>class=</span><span>"modal-title"</span><span>&gt;</span>Forgot Password?<span>&lt;/</span><span>h4</span><span>&gt;</span><br class="title-page-name"/>                  <span>&lt;</span><span>button </span><span>type=</span><span>"button" </span><span>class=</span><span>"close" </span><span>data-<br class="title-page-name"/>                   dismiss=</span><span>"modal"</span><span>&gt;</span><span>&amp;times;</span><span>&lt;/</span><span>button</span><span>&gt;</span><br class="title-page-name"/>                <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>                <span>&lt;</span><span>div </span><span>class=</span><span>"modal-body"</span><span>&gt;</span><br class="title-page-name"/>                    <span>&lt;</span><span>p</span><span>&gt;</span>Please enter your registered email to sent you  <br class="title-page-name"/>                      the password reset instructions.<span>&lt;/</span><span>p</span><span>&gt;</span><br class="title-page-name"/><br class="title-page-name"/>                    <span>&lt;</span><span>div </span><span>class=</span><span>"form-group"</span><span>&gt;</span><br class="title-page-name"/>                        <span>&lt;</span><span>label </span><span>for=</span><span>"reset_email"</span><span>&gt;</span>Email<span>&lt;/</span><span>label</span><span>&gt;</span><br class="title-page-name"/>                        <span>&lt;</span><span>input </span><span>type=</span><span>"text" </span><span>class=</span><span>"form-control" <br class="title-page-name"/></span><span>                         name=</span><span>"email" </span><span>(ngModel)=</span><span>"</span><span>email</span><span>"              <br class="title-page-name"/></span><span>                         #email=</span><span>"ngModel"<br class="title-page-name"/></span><span>                               </span><span>required<br class="title-page-name"/></span><span>                               pattern=</span><span>"^\w+([\.-]?\w+)*@\w+([\.-]?<br class="title-page-name"/>                               \w+)*(\.\w{2,3})+$"<br class="title-page-name"/></span><span>                               </span><span>id=</span><span>"reset_email"</span><span>/&gt;</span><br class="title-page-name"/>                    <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>                <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>                <span>&lt;</span><span>div </span><span>class=</span><span>"modal-footer form-group"</span><span>&gt;</span><br class="title-page-name"/>                    <span>&lt;</span><span>button </span><span>type=</span><span>"submit" </span><span>class=</span><span>"btn btn-default" <br class="title-page-name"/></span><span>                     [disabled]=</span><span>"!</span><span>resetFormData</span><span>.</span><span>form</span><span>.</span><span>valid</span><span>"<br class="title-page-name"/></span><span>                    </span><span>&gt;</span>Reset<br class="title-page-name"/>                    <span>&lt;/</span><span>button</span><span>&gt;</span><br class="title-page-name"/>                    <span>&lt;</span><span>button </span><span>type=</span><span>"button" </span><span>class=</span><span>"btn btn-default" </span><span>data-<br class="title-page-name"/>                     dismiss=</span><span>"modal"</span><span>&gt;</span>Close<span>&lt;/</span><span>button</span><span>&gt;</span><br class="title-page-name"/>                <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>            <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>        <span>&lt;/</span><span>form</span><span>&gt;</span><br class="title-page-name"/>    <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/><span>&lt;/</span><span>div</span><span>&gt;</span></pre>
<p class="mce-root1">When the user clicks on <span>Reset Password</span>, the following modal appears:</p>
<div class="cdpaligncenter"><img src="../images/00018.jpeg" class="calibre39"/></div>
<p class="mce-root1"><span>Here's the complete <kbd class="calibre11">login.component.html</kbd> </span><span>as of now:</span><span> </span></p>
<pre class="calibre17"><span>&lt;</span><span>div </span><span>class=</span><span>"col-md-6 col-md-offset-3 container"</span><span>&gt;</span><br class="title-page-name"/>    <span>&lt;</span><span>h2</span><span>&gt;</span>Login<span>&lt;/</span><span>h2</span><span>&gt;</span><br class="title-page-name"/> <span>&lt;</span><span>app-error-alert </span><span>*ngIf=</span><span>"</span><span>showError</span><span>" </span><span>[errorMessage]=</span><span>"</span><span>errorMessage</span><span>"</span><span>&gt;&lt;/</span><span>app-error-alert</span><span>&gt;</span><br class="title-page-name"/>    <span>&lt;</span><span>form </span><span>name=</span><span>"form" </span><span>(ngSubmit)=</span><span>"</span><span>onLogin</span><span>(</span><span>loginFormData</span><span>)" <br class="title-page-name"/></span><span>     #loginFormData=</span><span>'ngForm'</span><span>&gt;</span><br class="title-page-name"/>        <span>&lt;</span><span>div </span><span>class=</span><span>"form-group"</span><span>&gt;</span><br class="title-page-name"/>            <span>&lt;</span><span>label </span><span>for=</span><span>"email"</span><span>&gt;</span>Email<span>&lt;/</span><span>label</span><span>&gt;</span><br class="title-page-name"/>            <span>&lt;</span><span>input </span><span>type=</span><span>"text" </span><span>class=</span><span>"form-control" </span><span>name=</span><span>"email" <br class="title-page-name"/></span><span>             (ngModel)=</span><span>"</span><span>email</span><span>" </span><span>#email=</span><span>"ngModel"<br class="title-page-name"/></span><span>                   </span><span>required<br class="title-page-name"/></span><span>                   pattern=</span><span>"^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*<br class="title-page-name"/>                   (\.\w{2,3})+$"<br class="title-page-name"/></span><span>                   </span><span>id=</span><span>"email"</span><span>/&gt;</span><br class="title-page-name"/>            <span>&lt;</span><span>div </span><span>[hidden]=</span><span>"</span><span>email</span><span>.</span><span>valid</span><span> || </span><span>email</span><span>.</span><span>pristine</span><span>"<br class="title-page-name"/></span><span>                 </span><span>class=</span><span>"alert alert-danger"</span><span>&gt;</span><br class="title-page-name"/>                <span>&lt;</span><span>div </span><span>[hidden]=</span><span>"!</span><span>email</span><span>.</span><span>hasError</span><span>('required')"</span><span>&gt;</span>Email is <br class="title-page-name"/>                 required<span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>                <span>&lt;</span><span>div </span><span>[hidden]=</span><span>"!</span><span>email</span><span>.</span><span>hasError</span><span>('pattern')"</span><span>&gt;</span>Email format <br class="title-page-name"/>                should be<br class="title-page-name"/>                    <span>&lt;</span><span>small</span><span>&gt;&lt;</span><span>b</span><span>&gt;</span>codingchum@gmail.com<span>&lt;/</span><span>b</span><span>&gt;&lt;/</span><span>small</span><span>&gt;</span><br class="title-page-name"/>                <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>            <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>        <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>        <span>&lt;</span><span>div </span><span>class=</span><span>"form-group"</span><span>&gt;</span><br class="title-page-name"/>            <span>&lt;</span><span>label </span><span>for=</span><span>"password"</span><span>&gt;</span>Password<span>&lt;/</span><span>label</span><span>&gt;</span><br class="title-page-name"/>            <span>&lt;</span><span>input </span><span>type=</span><span>"password" </span><span>class=</span><span>"form-control" </span><span>name=</span><span>"password" <br class="title-page-name"/></span><span>             (ngModel)=</span><span>"</span><span>password</span><span>" </span><span>#password=</span><span>"ngModel"<br class="title-page-name"/></span><span>                   </span><span>required id=</span><span>"password"</span><span>/&gt;</span><br class="title-page-name"/>            <span>&lt;</span><span>div </span><span>[hidden]=</span><span>"</span><span>password</span><span>.</span><span>valid</span><span> || </span><span>password</span><span>.</span><span>pristine</span><span>"<br class="title-page-name"/></span><span>                 </span><span>class=</span><span>"alert alert-danger"</span><span>&gt;</span><br class="title-page-name"/>                Password is required<br class="title-page-name"/>            <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>        <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>        <span>&lt;</span><span>div </span><span>class=</span><span>"form-group"</span><span>&gt;</span><br class="title-page-name"/>            <span>&lt;</span><span>button </span><span>type=</span><span>"submit" </span><span>id=</span><span>"login-btn" </span><span>class=</span><span>"btn btn-<br class="title-page-name"/>             success" </span><span>[disabled]=</span><span>"!</span><span>loginFormData</span><span>.</span><span>form</span><span>.</span><span>valid</span><span>"</span><span>&gt;<br class="title-page-name"/></span>             LOGIN<span>&lt;/</span><span>button</span><span>&gt;</span><br class="title-page-name"/>            <span>&lt;</span><span>button </span><span>routerLink=</span><span>"/app-friends-signup" </span><span>data-tag=</span><span>"signup-<br class="title-page-name"/>             tag" </span><span>routerLinkActive=</span><span>"active" </span><span>class=</span><span>"btn btn-success"</span><span>&gt;</span><br class="title-page-name"/>                SIGNUP<br class="title-page-name"/>            <span>&lt;/</span><span>button</span><span>&gt;</span><br class="title-page-name"/>        <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>    <span>&lt;/</span><span>form</span><span>&gt;</span><br class="title-page-name"/>    <span>&lt;</span><span>button </span><span>type=</span><span>"button" </span><span>data-tag=</span><span>"password-reset-tag" </span><span>class=</span><span>"btn btn-<br class="title-page-name"/>     info" </span><span>data-toggle=</span><span>"modal" </span><span>data-target=</span><span>"#password_reset"</span><span>&gt;<br class="title-page-name"/></span>     Reset Password<br class="title-page-name"/>    <span>&lt;/</span><span>button</span><span>&gt;</span><br class="title-page-name"/><span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/><span>&lt;</span><span>div </span><span>id=</span><span>"password_reset" </span><span>class=</span><span>"modal fade" </span><span>role=</span><span>"dialog"</span><span>&gt;</span><br class="title-page-name"/>    <span>&lt;</span><span>div </span><span>class=</span><span>"modal-dialog modal-sm"</span><span>&gt;</span><br class="title-page-name"/>        <span>&lt;</span><span>form </span><span>name=</span><span>"form" </span><span>(ngSubmit)=</span><span>"</span><span>onReset</span><span>(</span><span>resetFormData</span><span>)" <br class="title-page-name"/></span><span>         #resetFormData=</span><span>'ngForm'</span><span>&gt;</span><br class="title-page-name"/>            <span>&lt;</span><span>div </span><span>class=</span><span>"modal-content"</span><span>&gt;</span><br class="title-page-name"/>                <span>&lt;</span><span>div </span><span>class=</span><span>"modal-header"</span><span>&gt;</span><br class="title-page-name"/>                  <span>&lt;</span><span>h4 </span><span>class=</span><span>"modal-title"</span><span>&gt;</span>Forgot Password?<span>&lt;/</span><span>h4</span><span>&gt;</span><br class="title-page-name"/>                  <span>&lt;</span><span>button </span><span>type=</span><span>"button" </span><span>class=</span><span>"close" </span><span>data-<br class="title-page-name"/>                   dismiss=</span><span>"modal"</span><span>&gt;</span><span>&amp;times;</span><span>&lt;/</span><span>button</span><span>&gt;</span><br class="title-page-name"/>                <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>                <span>&lt;</span><span>div </span><span>class=</span><span>"modal-body"</span><span>&gt;</span><br class="title-page-name"/>                    <span>&lt;</span><span>p</span><span>&gt;</span>Please enter your registered email to sent you <br class="title-page-name"/>                      the password reset instructions.<span>&lt;/</span><span>p</span><span>&gt;</span><br class="title-page-name"/><br class="title-page-name"/>                    <span>&lt;</span><span>div </span><span>class=</span><span>"form-group"</span><span>&gt;</span><br class="title-page-name"/>                        <span>&lt;</span><span>label </span><span>for=</span><span>"reset_email"</span><span>&gt;</span>Email<span>&lt;/</span><span>label</span><span>&gt;</span><br class="title-page-name"/>                        <span>&lt;</span><span>input </span><span>type=</span><span>"text" </span><span>class=</span><span>"form-control" <br class="title-page-name"/></span><span>                         name=</span><span>"email" </span><span>(ngModel)=</span><span>"</span><span>email</span><span>" <br class="title-page-name"/></span><span>                         #email=</span><span>"ngModel"<br class="title-page-name"/></span><span>                               </span><span>required<br class="title-page-name"/></span><span>                               pattern=</span><span>"^\w+([\.-]?\w+)*@\w+([\.-]?<br class="title-page-name"/>                               \w+)*(\.\w{2,3})+$"<br class="title-page-name"/></span><span>                               </span><span>id=</span><span>"reset_email"</span><span>/&gt;</span><br class="title-page-name"/>                    <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>                <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>                <span>&lt;</span><span>div </span><span>class=</span><span>"modal-footer form-group"</span><span>&gt;</span><br class="title-page-name"/>                    <span>&lt;</span><span>button </span><span>type=</span><span>"submit" </span><span>class=</span><span>"btn btn-default" <br class="title-page-name"/></span><span>                     [disabled]=</span><span>"!</span><span>resetFormData</span><span>.</span><span>form</span><span>.</span><span>valid</span><span>"<br class="title-page-name"/></span><span>                    </span><span>&gt;</span>Reset<br class="title-page-name"/>                    <span>&lt;/</span><span>button</span><span>&gt;</span><br class="title-page-name"/>                    <span>&lt;</span><span>button </span><span>type=</span><span>"button" </span><span>class=</span><span>"btn btn-default" </span><span>data-<br class="title-page-name"/>                     dismiss=</span><span>"modal"</span><span>&gt;</span>Close<span>&lt;/</span><span>button</span><span>&gt;</span><br class="title-page-name"/>                <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>            <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/>        <span>&lt;/</span><span>form</span><span>&gt;</span><br class="title-page-name"/>    <span>&lt;/</span><span>div</span><span>&gt;</span><br class="title-page-name"/><span>&lt;/</span><span>div</span><span>&gt;</span></pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Adding the onReset() functionality</h1>
                
            
            <article>
                
<p class="calibre2">The next step is to add reset method in the login component. The <kbd class="calibre11">onReset()</kbd> method in the login component resets the password and sends the reset instruction to the registered email. This email contains the reset link; when we click on the link, it opens another browser tab with an alert dialog to provide the new password.</p>
<p class="calibre2">We add  the <kbd class="calibre11">onReset()</kbd> method in the login component as shown here:</p>
<pre class="calibre17"><span>onReset</span>(resetFormData): <span>void </span>{<br class="title-page-name"/>  <span>this</span>.authService.<span>resetPassword</span>(resetFormData.<span>value</span>.<span>email</span>).<span>then</span>(() =&gt;   <br class="title-page-name"/>  {<br class="title-page-name"/>    <span>alert</span>(<span>'Reset instruction sent to your mail'</span>);<br class="title-page-name"/>  }).<span>catch</span>((error) =&gt; {<br class="title-page-name"/>    <span>this</span>.<span>errorMessage </span>= error.<span>message</span>;<br class="title-page-name"/>    <span>this</span>.<span>showError </span>= <span>true</span>;<br class="title-page-name"/>  });<br class="title-page-name"/>}</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Editing the password-reset template in Firebase</h1>
                
            
            <article>
                
<p class="calibre2">Firebase provides the option to change the template for the email. We can customize the email body. In this application, we are using the default template, even though you can change it through this process:</p>
<ol class="calibre13">
<li value="1" class="calibre8">Go to Firebase authentication</li>
<li value="2" class="calibre8">On the right panel, click on the <span>TEMPLATES</span> tab</li>
<li value="3" class="calibre8">Click on the <span>Password reset</span> option on the left panel</li>
<li value="4" class="calibre8">Click on the pencil icon to edit it</li>
</ol>
<p class="calibre2">Consider the following password reset template in Firebase:</p>
<div class="cdpaligncenter"><img src="../images/00019.jpeg" class="calibre40"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    </header><h1 class="header-title" id="calibre_pb_0">Summary</h1>
                
            
            <article>
                
<p class="calibre2">In this chapter, we implemented the login component and enhanced the authentication and user services. The login template and component look similar to the sign-in template and component. We then implemented password reset features in our application. <span>Firebase provides the ingredient to implement reset password functionality. We also implemented our first modal in our application.</span></p>
<p class="calibre2">In the next chapter, we will be covering navigation flow between different components. We will also add Angular guard to restrict or enable navigation to a component based on a guard condition.</p>


            </article>

            
        </section>
    </body></html>
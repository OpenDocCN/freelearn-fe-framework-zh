<html><head></head><body>
<div id="page" style="height:0pt"/><div class="book" title="Chapter&#xA0;5.&#xA0;Component Life cycle and Newer ECMAScript in React"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch05" class="calibre1"/>Chapter 5. Component Life cycle and Newer ECMAScript in React</h1></div></div></div><p class="calibre7">So far, we have explored React component properties and how we need to initialize, update, and change the component's state(s) for interactive applications. Let's now explore the lifecycle of such a React component in this chapter. We will also dig into future ECMAScript syntax and a few changes that the React community also used from version 0.13.0. For this, we will review some ES6 and ES7 features within the React library.</p><p class="calibre7">While creating any React component by calling <code class="literal">React.createClass()</code>, we need to always have a render method. This render method returns a description of the DOM. React has a performance edge in our applications because React maintains a fast in-memory representation of the DOM and never directly interacts with the actual DOM. Thus, when the render method returns the description of the DOM, React can compare the difference between the actual DOM and the in-memory representation, and, based on the difference(s), re-renders the view accordingly.</p><p class="calibre7">In this chapter, we will cover the following topics:</p><div class="book"><ul class="itemizedlist"><li class="listitem">React component lifecycle</li><li class="listitem">Using React with ECMAScript</li></ul></div></div>

<div class="book" title="Chapter&#xA0;5.&#xA0;Component Life cycle and Newer ECMAScript in React">
<div class="book" title="React component lifecycle"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_1"><a id="ch05lvl1sec26" class="calibre1"/>React component lifecycle</h1></div></div></div><p class="calibre7">As per<a id="id165" class="calibre1"/> Facebook's React documentation from <a class="calibre1" href="http://facebook.github.io/react/docs/working-with-the-browser.html">http://facebook.github.io/react/docs/working-with-the-browser.html</a>, the <a id="id166" class="calibre1"/>React component lifecycle can be broadly classified into three categories as follows:</p><div class="blockquote"><blockquote class="blockquote1"><p class="calibre23"><span class="strong"><em class="calibre12">"<span class="strong"><strong class="calibre8">Mounting</strong></span><span class="strong"><strong class="calibre8">:</strong></span> A component is being inserted into the DOM.</em></span><a id="id167" class="calibre1"/></p><p class="calibre23"><span class="strong"><em class="calibre12"><span class="strong"><strong class="calibre8">Updating</strong></span><span class="strong"><strong class="calibre8">:</strong></span> A component is being re-rendered to determine if the DOM should be updated.</em></span><a id="id168" class="calibre1"/></p><p class="calibre23"><span class="strong"><em class="calibre12"><span class="strong"><strong class="calibre8">Unmounting:</strong></span> A component is being removed from the DOM.<span class="strong"><strong class="calibre8">"</strong></span></em></span><a id="id169" class="calibre1"/></p></blockquote></div><p class="calibre7">React<a id="id170" class="calibre1"/> provides lifecycle methods that you can specify to hook into this process. We provide <code class="literal">will</code> methods, which are called right before something happens, and <code class="literal">did</code> methods which are called right after something happens.</p></div></div>

<div class="book" title="Chapter&#xA0;5.&#xA0;Component Life cycle and Newer ECMAScript in React">
<div class="book" title="React component lifecycle">
<div class="book" title="Mounting category"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch05lvl2sec41" class="calibre1"/>Mounting category</h2></div></div></div><p class="calibre7"><span class="strong"><strong class="calibre8">Mounting</strong></span> is <a id="id171" class="calibre1"/>the process of publishing the virtual representation of a component into the final UI representation (for example, DOM or native components). In a browser, it would mean publishing a React element<a id="id172" class="calibre1"/> into an actual DOM element in the DOM tree.</p><div class="informaltable"><table border="1" class="calibre13"><colgroup class="calibre14"><col class="calibre15"/><col class="calibre15"/></colgroup><thead class="calibre16"><tr class="calibre17"><th valign="bottom" class="calibre18">
<p class="calibre19">Method Name</p>
</th><th valign="bottom" class="calibre18">
<p class="calibre19">Method Function</p>
</th></tr></thead><tbody class="calibre20"><tr class="calibre17"><td valign="top" class="calibre21">
<p class="calibre19"><code class="literal1">getInitialState()</code></p>
</td><td valign="top" class="calibre21">
<p class="calibre19">This method is invoked before the component is mounted.</p>
<p class="calibre19">In the case of stateful components, this method returns the initial state data.</p>
</td></tr><tr class="calibre17"><td valign="top" class="calibre21">
<p class="calibre19"><code class="literal1">componentWillMount()</code></p>
</td><td valign="top" class="calibre21">
<p class="calibre19">This method is called just before React mounts the component in the DOM.</p>
</td></tr><tr class="calibre17"><td valign="top" class="calibre21">
<p class="calibre19"><code class="literal1">componentDidMount()</code></p>
</td><td valign="top" class="calibre21">
<p class="calibre19">This method is called immediately after mounting occurs. The initialization process  that DOM nodes requires should go within this method.</p>
</td></tr></tbody></table></div><p class="calibre7">Like in the previous chapters, most of the code in the <code class="literal">index.html</code> is the same. We will only be replacing the contents of the JavaScript file.</p><p class="calibre7">The code of <code class="literal">index.html</code> will become as follows:</p><div class="informaltable"><pre class="programlisting">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.0-rc1/react.min.js"&gt;&lt;/script&gt;
&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.13.3/JSXTransformer.js"&gt;&lt;/script&gt;
  &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.0-rc1/react-dom.js"&gt;&lt;/script&gt;
  &lt;meta charset="utf-8"&gt;
  &lt;title&gt;My React App&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div id="app"&gt;&lt;/div&gt;
    &lt;script type="text/jsx", src="index.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre></div><p class="calibre7">Let's illustrate the<a id="id173" class="calibre1"/> lifecycle method,  using a code snippet. Place the following code in the <code class="literal">index.js</code> file:</p><div class="informaltable"><pre class="programlisting">var MyButton = React.createClass({
        getInitialState: function(){
            return {value: 11} 
        },
        addOnClick: function(){
            this.setState({value: this.state.value +  2}); 
        },
        render: function(){
            console.log("myButton React component is rendering"); 
        return &lt;button onClick={this.addOnClick}&gt;{this.state.value}&lt;/button&gt; 
        } 
}); 
ReactDOM.render(&lt;MyButton /&gt;, document.getElementById('myComponent'));</pre></div><p class="calibre7">Initially, we can see the value of <code class="literal">myButton</code> set to <span class="strong"><strong class="calibre8">11</strong></span>:</p><div class="mediaobject"><img src="../images/00023.jpeg" alt="Mounting category" class="calibre9"/></div><p class="calibre10"> </p><p class="calibre7">The value <a id="id174" class="calibre1"/>of <code class="literal">myButton</code> increases by two when the <code class="literal">onClick(addOnClick)</code> event occurs. Thus, the value of state changes.</p><div class="mediaobject"><img src="../images/00024.jpeg" alt="Mounting category" class="calibre9"/><div class="caption"><p class="calibre25">Value of <code class="literal">myButton</code> increases by two when the <code class="literal">onClick</code> event occurs</p></div></div><p class="calibre10"> </p><p class="calibre7">If we<a id="id175" class="calibre1"/> add the <code class="literal">componentWillMount</code> method to the preceding code, we will be able to see that the React component is only mounted in the DOM once, but is rendered each time we click on the button.</p><div class="informaltable"><pre class="programlisting">
<span class="strong"><strong class="calibre8">        componentWillMount: function(){</strong></span>
<span class="strong"><strong class="calibre8">        console.log('MyButton component is mounting');</strong></span>
<span class="strong"><strong class="calibre8">        },</strong></span>
</pre></div><p class="calibre7">The screenshot of the app component mounting on the DOM shows in the console, <span class="strong"><strong class="calibre8">MyButton component is mounting</strong></span>.</p><div class="mediaobject"><img src="../images/00025.jpeg" alt="Mounting category" class="calibre9"/><div class="caption"><p class="calibre25">Screenshot of app component mounting on the DOM</p></div></div><p class="calibre10"> </p><p class="calibre7">Let's implement the last mounting method, <code class="literal">componentDidMount</code>, which is called after the <a id="id176" class="calibre1"/>component is mounted. As you can see in the next screenshot, the console shows the component has been mounted once but the component is rendered the number of times we click on the button, four times in this case: <code class="literal">11 + (2*4) =19</code>.</p><div class="informaltable"><pre class="programlisting">
<span class="strong"><strong class="calibre8">        componentDidMount: function(){</strong></span>
<span class="strong"><strong class="calibre8">        console.log('MyButton component is mounted');</strong></span>
<span class="strong"><strong class="calibre8">        },</strong></span>
</pre></div><p class="calibre7">The screenshot shows methods where mounting and mounted on the DOM is called once, though rendering happens. Thus, after the <code class="literal">componentDidMount</code> method is executed, in the console we can see the output <span class="strong"><strong class="calibre8">MyButton component is mounted</strong></span>.</p><div class="mediaobject"><img src="../images/00026.jpeg" alt="Mounting category" class="calibre9"/><div class="caption"><p class="calibre25">Screenshot of methods where mounting and mounted on the DOM is called once, though rendering happens</p></div></div><p class="calibre10"> </p></div></div></div>

<div class="book" title="Chapter&#xA0;5.&#xA0;Component Life cycle and Newer ECMAScript in React">
<div class="book" title="React component lifecycle">
<div class="book" title="Updating category"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_3"><a id="ch05lvl2sec42" class="calibre1"/>Updating category</h2></div></div></div><p class="calibre7">The <a id="id177" class="calibre1"/>React component lifecycle allows updating components at runtime. This can be done using the following methods:</p><div class="informaltable"><table border="1" class="calibre13"><colgroup class="calibre14"><col class="calibre15"/><col class="calibre15"/></colgroup><thead class="calibre16"><tr class="calibre17"><th valign="bottom" class="calibre18">
<p class="calibre19">Method Name</p>
</th><th valign="bottom" class="calibre18">
<p class="calibre19">Method Function</p>
</th></tr></thead><tbody class="calibre20"><tr class="calibre17"><td valign="top" class="calibre21">
<p class="calibre19"><code class="literal1">componentWillReceiveProps(object nextProps)</code></p>
</td><td valign="top" class="calibre21">
<p class="calibre19">This method is invoked when a mounted React<a id="id178" class="ulink"/> component receives new properties (props). This means you can use it to compare between <code class="literal1">this.props</code>, the current set of properties, and <code class="literal1">nextProps</code>, the new property values. There is no similar method like <code class="literal1">componentWillReceiveState</code>. Thus, an incoming property transition may cause a state change, but an incoming state may not cause a property change.  If we want to perform some operation in response to a state change, we would need to use the method <code class="literal1">componentWillUpdate</code>.</p>
<p class="calibre19">Thus, the component's property changes will be rendered in the updated view without re-rendering the view.</p>
</td></tr><tr class="calibre17"><td valign="top" class="calibre21">
<p class="calibre19"><code class="literal1">shouldComponentUpdate(object nextProps, object nextState)</code></p>
</td><td valign="top" class="calibre21">
<p class="calibre19">This method is invoked when a component requires an update in the DOM.</p>
<p class="calibre19">The return type is boolean (<code class="literal1">true</code>/<code class="literal1">false</code>).</p>
<p class="calibre19">It returns <code class="literal1">false</code> when there is no change in the props and/or state, which will prevent <code class="literal1">componentWillUpdate</code> and <code class="literal1">componentDidUpdate</code> from being called.</p>
</td></tr><tr class="calibre17"><td valign="top" class="calibre21">
<p class="calibre19"><code class="literal1">componentWillUpdate(object nextProps, object nextState)</code></p>
</td><td valign="top" class="calibre21">
<p class="calibre19">As the name suggests, this method is invoked immediately before updating occurs, but not in the first render call.</p>
<p class="calibre19"><code class="literal1">this.setState()</code> cannot be called within this lifecycle method. To update a state in response to a property change, use <code class="literal1">componentWillReceiveProps</code> instead.</p>
</td></tr><tr class="calibre17"><td valign="top" class="calibre21">
<p class="calibre19"><code class="literal1">componentDidUpdate(object prevProps, object prevState)</code></p>
</td><td valign="top" class="calibre21">
<p class="calibre19">This is invoked immediately after updating occurs in the DOM and not during the initial <code class="literal1">render()</code> call.</p>
</td></tr></tbody></table></div><p class="calibre7">Let's add the preceding methods in our code:</p><div class="informaltable"><pre class="programlisting">//Updating lifecycle methods 
<span class="strong"><strong class="calibre8">        shouldComponentUpdate: function() {</strong></span>
        console.log('ShouldComponentUpdate');
            return true;
          },
<span class="strong"><strong class="calibre8">        componentWillReceiveProps: function(nextProps) {</strong></span>
            console.log('ComponentWillRecieveProps invoked');
         },
<span class="strong"><strong class="calibre8">        componentWillUpdate: function() {</strong></span>
            console.log('ComponentWillUpdate invoked');
        },
<span class="strong"><strong class="calibre8">        componentDidUpdate: function() {</strong></span>
            console.log('ComponentDidUpdate invoked');
        },</pre></div><p class="calibre7">Execute<a id="id179" class="calibre1"/> the preceding code to see the following output. We can see the various lifecycle events of the React component and the corresponding output they give in the console.</p><div class="mediaobject"><img src="../images/00027.jpeg" alt="Updating category" class="calibre9"/><div class="caption"><p class="calibre25">Screenshot of component being updated</p></div></div><p class="calibre10"> </p></div></div></div>

<div class="book" title="Chapter&#xA0;5.&#xA0;Component Life cycle and Newer ECMAScript in React">
<div class="book" title="React component lifecycle">
<div class="book" title="Unmounting category"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_4"><a id="ch05lvl2sec43" class="calibre1"/>Unmounting category</h2></div></div></div><p class="calibre7"><code class="literal">componentWillUnmount()</code> is invoked immediately before a component is unmounted and destroyed. You <a id="id180" class="calibre1"/>should perform any necessary cleanup here.</p><div class="informaltable"><pre class="programlisting">        componentWillUnmount: function(){
<span class="strong"><strong class="calibre8">        console.log('Umounting MyButton component');</strong></span>
<span class="strong"><strong class="calibre8">        }</strong></span>
</pre></div><p class="calibre7">Here's the complete example encompassing all the lifecycle methods of a React component. The <code class="literal">index.html</code> is the same as the preceding.</p><p class="calibre7">The code of <code class="literal">index.html</code>:</p><div class="informaltable"><pre class="programlisting">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.0-rc1/react.min.js"&gt;&lt;/script&gt;
&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.13.3/JSXTransformer.js"&gt;&lt;/script&gt;
  &lt;script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.0-rc1/react-dom.js"&gt;&lt;/script&gt;
  &lt;meta charset="utf-8"&gt;
  &lt;title&gt;My React App&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div id="app"&gt;&lt;/div&gt;
    &lt;script type="text/jsx", src="index.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre></div><p class="calibre7">Here is the corresponding <code class="literal">index.js</code> code:</p><div class="informaltable"><pre class="programlisting">var MyButton = React.createClass({
    getDefaultProps: function() {
        console.log('GetDefaultProps is invoked');
        return {id: 1};
    },
    getInitialState: function(){
        return {value: 11}
    },
    addOnClick: function(){
        this.setState({value: this.state.value +  2});
    },
    componentWillMount: function(){
        console.log('MyButton component is mounting');
    },
    render: function(){
        console.log("myButton React component is rendering");
        return ( &lt;div&gt;
        &lt;button&gt;{this.props.id}&lt;/button&gt;
        &lt;button onClick={this.addOnClick}&gt;{this.state.value}&lt;/button&gt;
        &lt;/div&gt;);
        },
        componentDidMount: function(){
        console.log('MyButton component is mounted');
        },

//Updating lifecycle methods
    shouldComponentUpdate: function() {
        console.log('ShouldComponentUpdate');
        return true;
    },
    componentWillReceiveProps: function(nextProps) {
        console.log('ComponentWillRecieveProps invoked');
    },  
    componentWillUpdate: function() {
        console.log('ComponentWillUpdate invoked');
    },  
    componentDidUpdate: function() {
        console.log('ComponentDidUpdate invoked');
    },

//Unmounting Lifecycle Methods
    componentWillUnmount: function(){
        console.log('Umounting MyButton component');
    }

});

var ComponentApp = React.createClass({
    mount: function(){
        ReactDOM.render(&lt;MyButton /&gt;, document.getElementById('myApp'));
    },
    unmount: function(){
          ReactDOM.unmountComponentAtNode(document.getElementById('myApp'));
        },
    render: function(){
        return (
        &lt;div&gt;
        &lt;button onClick={this.mount}&gt;Mount&lt;/button&gt;
        &lt;button onClick={this.unmount}&gt;Unmount&lt;/button&gt;
        &lt;div id="myApp"&gt;&lt;/div&gt;
        &lt;/div&gt;
        );
    }
});

ReactDOM.render(&lt;ComponentApp /&gt;, document.getElementById('app'));</pre></div><p class="calibre7">Observe <a id="id181" class="calibre1"/>the following:</p><div class="book"><ul class="itemizedlist"><li class="listitem">After executing the preceding code, we will be able to see two buttons as <span class="strong"><strong class="calibre8">Mount</strong></span> and <span class="strong"><strong class="calibre8">Unmount</strong></span></li><li class="listitem">The initial value of the component is set to <span class="strong"><strong class="calibre8">11</strong></span></li><li class="listitem"><code class="literal">onClick</code> on the React component; its value is increased by a value of two</li><li class="listitem">While clicking on the <span class="strong"><strong class="calibre8">Mount</strong></span>, the lifecycle methods of the React component is called</li><li class="listitem">For each of these lifecycle methods, we can see an output in the console<div class="mediaobject"><img src="../images/00028.jpeg" alt="Unmounting category" class="calibre9"/><div class="caption"><p class="calibre25">Screenshot of unmouting the component from the DOM</p></div></div><p class="calibre26"> </p></li></ul></div><div class="informaltable" title="Note"><h3 class="title2"><a id="note17" class="calibre1"/>Note</h3><p class="calibre7">Note: Mounted composite components support the method <code class="literal">component.forceUpdate()</code>. This method can be invoked on any mounted component, in case of some changes in the deeper aspect of the component, without using <code class="literal">this.setState()</code>.</p></div><p class="calibre7">Our <a id="id182" class="calibre1"/>React component's lifecycles are shown next. The lifecycles are highlighted in the right portion of the developer tool:</p><div class="mediaobject"><img src="../images/00029.jpeg" alt="Unmounting category" class="calibre9"/><div class="caption"><p class="calibre25">Screenshot showing the React component's lifecycle, as highlighted in the right portion of the developer tool</p></div></div><p class="calibre10"> </p></div></div></div>

<div id="page" style="height:0pt"/><div class="book" title="Other ES (ECMAScript) versions in React"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch05lvl1sec27" class="calibre1"/>Other ES (ECMAScript) versions in React</h1></div></div></div><p class="calibre7">In the <a id="id183" class="calibre1"/>second half of this chapter, we will explore how React supports newer versions of ECMAScript. Until now, we have explored the different lifecycle methods in a React component. In this section of the chapter, we will dig into something different: how changes in the new version of ECMAScript have been adopted by React.</p></div>

<div class="book" title="Other ES (ECMAScript) versions in React">
<div class="book" title="ES6"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_1"><a id="ch05lvl2sec44" class="calibre1"/>ES6</h2></div></div></div><p class="calibre7"><span class="strong"><strong class="calibre8">ES6</strong></span> is the <a id="id184" class="calibre1"/>current version of the ECMAScript Language Specification Standard. Further details about the changes and the new things <a id="id185" class="calibre1"/>incorporated can be found on the Mozilla Development Network site: <a class="calibre1" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/New_in_JavaScript/ECMAScript_6_support_in_Mozilla">https://developer.mozilla.org/en-US/docs/Web/JavaScript/New_in_JavaScript/ECMAScript_6_support_in_Mozilla</a></p><p class="calibre7">Complete documentation for ES6 is beyond the scope of this book.</p><p class="calibre7">According to the Facebook documentation:</p><p class="calibre7">Starting with React 0.13.0 a transpiler allows us to use ES6 classes. JavaScript originally didn't have a built-in class system. The developer team wanted class creation using the idiomatic JavaScript style. Therefore instead of <code class="literal">React.createClass</code> the developer team has introduced a component. You can use the transpiler they ship with <code class="literal">react-tools</code> by making use of the harmony option and setting it to <code class="literal">true</code> as follows:</p><div class="informaltable"><pre class="programlisting">jsx –harmony</pre></div><p class="calibre7">By looking <a id="id186" class="calibre1"/>through <a class="calibre1" href="https://www.npmjs.com/package/react-tools">https://www.npmjs.com/package/react-tools</a>, you can find details of the different options you can pass with the JSX Transformer.<code class="literal"> --harmony</code> turns on JS transformations such as ES6 classes and so on.</p><p class="calibre7">Thus, ES6 syntax will be transformed into ES5 compatible syntaxes.</p><div class="informaltable" title="Note"><h3 class="title2"><a id="note18" class="calibre1"/>Note</h3><p class="calibre7"><span class="strong"><strong class="calibre8">Transpiling</strong></span> is a <a id="id187" class="calibre1"/>method for taking source code written in one language and transforming it into another language that has a similar level of abstraction.</p><p class="calibre7">When TypeScript is compiled and is transformed by the compiler into JavaScript, it has very similar levels of abstraction. Hence, it is called transpiling.</p></div><p class="calibre7">Here, React classes are defined as a plain JavaScript class. Let's go through the following code from their documentation with some modifications and explanations.</p><p class="calibre7">Code within <code class="literal">index.html</code>:</p><div class="informaltable"><pre class="programlisting">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.0-rc1/react.js"&gt;&lt;/script&gt;
&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.0-rc1/react-dom.js"&gt;&lt;/script&gt;
&lt;script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.13.3/JSXTransformer.js"&gt;&lt;/script&gt;
  &lt;meta charset="utf-8"&gt;
  &lt;title&gt;React ES6&lt;/title&gt;
  &lt;h1&gt;ok&lt;/h1&gt;
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id="react-content"&gt;&lt;/div&gt;
<span class="strong"><strong class="calibre8">    &lt;script type="text/jsx;harmony=true" src="index.js"&gt;&lt;/script&gt;</strong></span>
&lt;/html&gt;</pre></div><p class="calibre7">The <a id="id188" class="calibre1"/>highlighted line with the argument as <code class="literal">harmony=true</code> ensures that the jsx syntax with ES6 code should be transpiled into JavaScript using ES5 syntax.</p><p class="calibre7">Code within <code class="literal">index.js</code>:</p><div class="informaltable"><pre class="programlisting">//line 1
class Es6Component extends React.Component {

//line 2
render() {

  return &lt;div onClick={this._handleClick}&gt;Hi There, I am learning ES6 in React.&lt;/div&gt;;

}

_handleClick() {

  console.log("hi");

}

}

ReactDOM.render(&lt;Es6Component /&gt;, document.getElementById('react-content '));</pre></div><p class="calibre7">Explanation:</p><div class="book"><ul class="itemizedlist"><li class="listitem">Line 1: Declaring the React component <code class="literal">ES6Component</code>, which extends from <code class="literal">React.Component</code> instead of <code class="literal">React.createClass</code></li><li class="listitem">Line 2: The render function call syntax is different. Before, it was<div class="informaltable"><pre class="programlisting">render: function()</pre></div></li></ul></div><p class="calibre7">Here is a screenshot demonstrating it:</p><div class="mediaobject"><img src="../images/00030.jpeg" alt="ES6" class="calibre9"/><div class="caption"><p class="calibre25">Screenshot of the React component using ES6</p></div></div><p class="calibre10"> </p><p class="calibre7">Instead of <code class="literal">getInitialState</code> in <code class="literal">React.createClass</code>, using ES6 the new constructor has<a id="id189" class="calibre1"/> the new own state property in <code class="literal">React.Component</code>, which is exported.</p><div class="informaltable"><pre class="programlisting">export class Counter extends React.Component

/* The constructor of the newly created React class, Counter. There are the following things to be noted:call to super(props)And instead of calling getInitialState() ifecycle method, React team used the instance property called this.state() */

constructor(props) {super(props);
    this.state = {count: props.initialCount};
  }

  tick() {
    this.setState({count: this.state.count + 1});
  }

  render() {
    return (
      &lt;div onClick={this.tick.bind(this)}&gt;
        Clicks: {this.state.count}
      &lt;/div&gt;
    );
  }
}

/* For validation and default values purposes propTypes and defaultProps are inbuilt within React's component. Here the propTypes and defaultProps are defined as properties on the constructor instead within the the class body. */

// Declares the React's class Counter property types as number
Counter.propTypes = { initialCount: React.PropTypes.number };

/* sets the defaultProps for the Counter React class as initialCount being 0. These values are passed as super(props)*/
Counter.defaultProps = { initialCount: 0 };</pre></div><div class="mediaobject"><img src="../images/00031.jpeg" alt="ES6" class="calibre9"/><div class="caption"><p class="calibre25">Screenshot of the React component using ES6</p></div></div><p class="calibre10"> </p><p class="calibre7">Another<a id="id190" class="calibre1"/> feature of React using ES6 is No Autobinding.</p><p class="calibre7">As with ES6 classes, which do not automatically bind to the instance, we need to use bind.(this) <span class="strong"><strong class="calibre8">OR</strong></span> use the  arrow sign (<code class="literal">=&gt;</code>) explicitly in ES6.</p><p class="calibre7">Following these ES6 syntaxes, we can rewrite our sample app from Chapter XX, which lists the user's likes in Facebook. Just as before, if the user clicks on the liked-page name, the string <span class="strong"><strong class="calibre8">I Liked it</strong></span> will be updated on the page.</p><p class="calibre7">The changes<a id="id191" class="calibre1"/> as per the new ES6 syntaxes are highlighted next:</p><div class="informaltable"><pre class="programlisting">use 'strict';
function checkLoginStatusAndLoadUserLikes() {

  FB.getLoginStatus(function(response) {
    if (response.status === 'connected') {
      loadUserAndLikes();
    } else {
      loginAndLoadUserLikes();
    }
  });
}

function loginAndLoadUserLikes() {
  FB.login(function(response) {
    loadUserAndLikes();
  }, {scope: 'user_likes'});
}

//var UserDetails = React.createClass({

class UserDetails extends React.component {
  render() {
    return (
      &lt;section id="user-details"&gt;
        &lt;a href={this.props.userDetails.link} target="__blank"&gt;
          {this.props.userDetails.name}
        &lt;/a&gt;
        {' | '}
        &lt;a href="#" onClick={this.handleLogout}&gt;Logout&lt;/a&gt;
      &lt;/section&gt;
    )
  },

<span class="strong"><strong class="calibre8">  handleLogout: function () {</strong></span>
<span class="strong"><strong class="calibre8">    FB.logout(function () {</strong></span>
<span class="strong"><strong class="calibre8">      alert("You're logged out, refresh the page in order to login again.");</strong></span>
<span class="strong"><strong class="calibre8">    });</strong></span>
<span class="strong"><strong class="calibre8">  }</strong></span>
<span class="strong"><strong class="calibre8">});</strong></span>

function loadUserAndLikes () {
  FB.api('/me', function (userResponse) {
    ReactDOM.render(&lt;UserDetails userDetails={userResponse} /&gt;, document.getElementById('user'));

    var fields = { fields: 'category,name,picture.type(normal)' };
    FB.api('/me/likes', fields, function (likesResponse) {
      React.render(&lt;UserLikesList list={likesResponse.data} /&gt;, document.getElementById('main'));
    });
  });
}

//var UserLikesList = React.createClass({
<span class="strong"><strong class="calibre8">class UserLikesList extends React.Component {</strong></span>
<span class="strong"><strong class="calibre8">  render() {</strong></span>
<span class="strong"><strong class="calibre8">    let items = this.props.list.map(function (likeObject) {</strong></span>
<span class="strong"><strong class="calibre8">      return &lt;UserLikeItem data={likeObject} /&gt;;</strong></span>
<span class="strong"><strong class="calibre8">    });</strong></span>

    return (
      &lt;ul id="user-likes-list"&gt;
        {items}
      &lt;/ul&gt;
    );
  }
//});

}

//var UserLikeItem = React.createClass({

<span class="strong"><strong class="calibre8">class UserLikeItem extends React.createComponent {</strong></span>

 //getInitialState: function() {
   // return {data_name: this.props.data.name};
  //},
<span class="strong"><strong class="calibre8">  handleClick(){</strong></span>
<span class="strong"><strong class="calibre8">     this.setState({</strong></span>
<span class="strong"><strong class="calibre8">    data_name: 'I liked it'})</strong></span>
<span class="strong"><strong class="calibre8">    },</strong></span>

  render() {
    let props_data = this.props.data;

    return (
      &lt;div onClick={this.handleClick}&gt;
        &lt;img src={props_data.picture.data.url} title={props_data.name} /&gt;

        &lt;h1&gt; Name:{this.state.data_name} &lt;/h1&gt;
	&lt;h2&gt;Category &lt;small&gt;{props_data.category}&lt;/small&gt;&lt;/h2&gt;
      &lt;/div&gt;
    );
  }
}</pre></div><div class="informaltable" title="Note"><h3 class="title2"><a id="note19" class="calibre1"/>Note</h3><p class="calibre7"><code class="literal">let</code> is used instead of <code class="literal">var</code> to declare a variable in a local scope.</p></div><p class="calibre7">The <a id="id192" class="calibre1"/>output remains the same, as per the next screenshot:</p><div class="mediaobject"><img src="../images/00032.jpeg" alt="ES6" class="calibre9"/><div class="caption"><p class="calibre25">Screenshot of the React app, fetching the user's liked pages, using ES6 syntaxes</p></div></div><p class="calibre10"> </p><div class="informaltable" title="Note"><h3 class="title2"><a id="note20" class="calibre1"/>Note</h3><p class="calibre7">Note: ES6 does not support mixins. Mixins will be covered later in this book in <a class="calibre1" title="Chapter 7. Making Your Component Reusable" href="part0044_split_000.html#page">Chapter 7</a>, <span class="strong"><em class="calibre12">Making your Component Reusable</em></span>, in more detail. Mixins are used to write reusable codes in React applications.</p></div></div></div>

<div class="book" title="Other ES (ECMAScript) versions in React">
<div class="book" title="ES7"><div class="book"><div class="book"><div class="book"><h2 class="title1" id="calibre_pb_2"><a id="ch05lvl2sec45" class="calibre1"/>ES7</h2></div></div></div><p class="calibre7">ECMAScript7 is one step beyond ES6. Even before ES6 was finalized, new features started to <a id="id193" class="calibre1"/>be proposed. Please view the experimental <a id="id194" class="calibre1"/>and stabilized feature list at the following URL:</p><p class="calibre7"><a class="calibre1" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/New_in_JavaScript/ECMAScript_7_support_in_Mozilla">https://developer.mozilla.org/en-US/docs/Web/JavaScript/New_in_JavaScript/ECMAScript_7_support_in_Mozilla</a></p><p class="calibre7">Keeping ES7 in mind, the React developer community presented us with some syntactic sugar to the existing React class code. In the future version of JavaScript (ES7), there can be more declarative syntax for property initialization, as this would be a more idiomatic way of expressing. Here's a quick example:</p><div class="informaltable"><pre class="programlisting">// Future Version
<span class="strong"><strong class="calibre8">export class Counter extends React.Component {</strong></span>
<span class="strong"><strong class="calibre8">  static propTypes = { initialCount: React.PropTypes.number };</strong></span>
<span class="strong"><strong class="calibre8">  static defaultProps = { initialCount: 0 };</strong></span>
<span class="strong"><strong class="calibre8">  state = { count: this.props.initialCount };</strong></span>
  //constructor
// render method
    );
  }
}</pre></div></div></div>
<div class="book" title="Summary"><div class="book"><div class="book"><div class="book"><h1 class="title" id="calibre_pb_0"><a id="ch05lvl1sec28" class="calibre1"/>Summary</h1></div></div></div><p class="calibre7">In this chapter, we have gone through the lifecycle of a typical React component, the various phases it undergoes, and how React renders the view based on the diff-ing algorithm (that is, calculating the deltas between the virtual DOM and the actual DOM).</p><p class="calibre7">In the second part of the chapter, we explored the future of ECMAScript and how React.js already supports it. For this, we have used sample code examples from Facebook's documentation.</p><p class="calibre7">In the next chapter, we will discuss React's reusable components known as mixins. We will also explore how we can add validations in a React-based application. Validations are required for apps that accept user input. User inputs should be validated before being sent to the server, to prevent malicious or invalid content from being sent.</p></div></body></html>
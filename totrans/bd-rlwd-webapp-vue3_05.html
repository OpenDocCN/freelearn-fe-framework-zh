<html><head></head><body>
<div id="_idContainer049">
<h1 class="chapter-number" id="_idParaDest-86"><a id="_idTextAnchor130"/><span class="koboSpan" id="kobo.1.1">5</span></h1>
<h1 id="_idParaDest-87"><a id="_idTextAnchor131"/><span class="koboSpan" id="kobo.2.1">Building a Recipe App with Vuetify</span></h1>
<p><span class="koboSpan" id="kobo.3.1">In this chapter, we’ll leverage the power of a third-party component library to quickly scaffold out a user interface and explore the powers and usage of a store in the context of an app. </span><span class="koboSpan" id="kobo.3.2">We will build a meal planner where a user can browse recipes to add them to a weekly calendar. </span><span class="koboSpan" id="kobo.3.3">The state of the week planner will be stored on the user’s machine to make sure it’s available on </span><span class="No-Break"><span class="koboSpan" id="kobo.4.1">returning visits.</span></span></p>
<p><span class="koboSpan" id="kobo.5.1">In this chapter, we’ll cover the </span><span class="No-Break"><span class="koboSpan" id="kobo.6.1">following topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.7.1">Applying and customizing Vuetify to scaffold </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">out views</span></span></li>
<li><span class="koboSpan" id="kobo.9.1">Speeding up development using a </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">component library</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.11.1">Refactoring strategies</span></span></li>
<li><span class="No-Break"><span class="koboSpan" id="kobo.12.1">Understanding state</span></span></li>
<li><span class="koboSpan" id="kobo.13.1">The usefulness of structuring stores </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">using Pinia</span></span></li>
</ul>
<h1 id="_idParaDest-88"><a id="_idTextAnchor132"/><span class="koboSpan" id="kobo.15.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.16.1">We’ll be using </span><strong class="bold"><span class="koboSpan" id="kobo.17.1">Vuetify</span></strong><span class="koboSpan" id="kobo.18.1"> (</span><a href="https://vuetifyjs.com/en/"><span class="koboSpan" id="kobo.19.1">https://vuetifyjs.com/en/</span></a><span class="koboSpan" id="kobo.20.1">) in this chapter, a popular component library for Vue.js 3 applications. </span><span class="koboSpan" id="kobo.20.2">We also need to register for an API key at </span><a href="https://spoonacular.com/"><span class="koboSpan" id="kobo.21.1">https://spoonacular.com/</span></a><span class="koboSpan" id="kobo.22.1"> to retrieve </span><span class="No-Break"><span class="koboSpan" id="kobo.23.1">recipe data.</span></span></p>
<p><span class="koboSpan" id="kobo.24.1">To manage our applications’ state, we’ll use </span><strong class="bold"><span class="koboSpan" id="kobo.25.1">Pinia</span></strong><span class="koboSpan" id="kobo.26.1"> (</span><a href="https://pinia.vuejs.org/"><span class="koboSpan" id="kobo.27.1">https://pinia.vuejs.org/</span></a><span class="koboSpan" id="kobo.28.1">). </span><span class="koboSpan" id="kobo.28.2">We’ll use a composable from </span><strong class="bold"><span class="koboSpan" id="kobo.29.1">VueUse</span></strong><span class="koboSpan" id="kobo.30.1"> (</span><a href="https://vueuse.org/"><span class="koboSpan" id="kobo.31.1">https://vueuse.org/</span></a><span class="koboSpan" id="kobo.32.1">) to leverage </span><strong class="source-inline"><span class="koboSpan" id="kobo.33.1">localStorage</span></strong><span class="koboSpan" id="kobo.34.1"> in </span><span class="No-Break"><span class="koboSpan" id="kobo.35.1">our app.</span></span></p>
<p><span class="koboSpan" id="kobo.36.1">The code for this chapter can be found in this book’s GitHub </span><span class="No-Break"><span class="koboSpan" id="kobo.37.1">repository: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/tree/main/05.mealplanner"><span class="No-Break"><span class="koboSpan" id="kobo.38.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/tree/main/05.mealplanner</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.39.1">.</span></span></p>
<h1 id="_idParaDest-89"><a id="_idTextAnchor133"/><span class="koboSpan" id="kobo.40.1">A new Vue project</span></h1>
<p><span class="koboSpan" id="kobo.41.1">We’re </span><a id="_idIndexMarker188"/><span class="koboSpan" id="kobo.42.1">ready </span><a id="_idIndexMarker189"/><span class="koboSpan" id="kobo.43.1">to initialize a new project, but we’ll use the Vuetify installer this time. </span><span class="koboSpan" id="kobo.43.2">Vuetify is a wrapper around the Vue installer, with presets for common Vuetify project configurations. </span><span class="koboSpan" id="kobo.43.3">In the CLI, type the following command to proceed to the next steps of the </span><span class="No-Break"><span class="koboSpan" id="kobo.44.1">installer wizard:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.45.1">
npm create vuetify</span></pre> <p><span class="koboSpan" id="kobo.46.1">Now, do </span><span class="No-Break"><span class="koboSpan" id="kobo.47.1">the following:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.48.1">Choose </span><strong class="source-inline"><span class="koboSpan" id="kobo.49.1">vue-meal-planner</span></strong><span class="koboSpan" id="kobo.50.1"> as the </span><span class="No-Break"><span class="koboSpan" id="kobo.51.1">project’s name.</span></span></li>
<li><span class="koboSpan" id="kobo.52.1">Use the </span><strong class="bold"><span class="koboSpan" id="kobo.53.1">Base</span></strong><span class="koboSpan" id="kobo.54.1"> (Vuetify, </span><span class="No-Break"><span class="koboSpan" id="kobo.55.1">VueRouter) installation.</span></span></li>
<li><span class="koboSpan" id="kobo.56.1">Select </span><strong class="bold"><span class="koboSpan" id="kobo.57.1">TypeScript</span></strong><span class="koboSpan" id="kobo.58.1"> using the </span><span class="No-Break"><span class="koboSpan" id="kobo.59.1">arrow keys.</span></span></li>
<li><span class="koboSpan" id="kobo.60.1">Select the </span><strong class="bold"><span class="koboSpan" id="kobo.61.1">npm</span></strong><span class="koboSpan" id="kobo.62.1"> option to install </span><span class="No-Break"><span class="koboSpan" id="kobo.63.1">the dependencies.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.64.1">If you navigate to the new projects folder, you can run the local development server with </span><strong class="source-inline"><span class="koboSpan" id="kobo.65.1">npm run dev</span></strong><span class="koboSpan" id="kobo.66.1">. </span><span class="koboSpan" id="kobo.66.2">The result should look very similar to what’s shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.67.1">Figure 5</span></em></span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.68.1">.1</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.69.1">:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer047">
<span class="koboSpan" id="kobo.70.1"><img alt="Figure 5.1 – The initialized Vuetify application" src="image/B19563_05_01.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.71.1">Figure 5.1 – The initialized Vuetify application</span></p>
<p><span class="koboSpan" id="kobo.72.1">Before we</span><a id="_idIndexMarker190"/><span class="koboSpan" id="kobo.73.1"> continue, we also need an API key to make the example a bit closer to reality. </span><span class="koboSpan" id="kobo.73.2">This will also allow us to search for actual recipes. </span><span class="koboSpan" id="kobo.73.3">To register at</span><a id="_idIndexMarker191"/><span class="koboSpan" id="kobo.74.1"> Spoonacular, you</span><a id="_idIndexMarker192"/><span class="koboSpan" id="kobo.75.1"> can follow </span><span class="No-Break"><span class="koboSpan" id="kobo.76.1">these steps:</span></span></p>
<ol>
<li><span class="No-Break"><span class="koboSpan" id="kobo.77.1">Visit </span></span><a href="https://spoonacular.com/"><span class="No-Break"><span class="koboSpan" id="kobo.78.1">https://spoonacular.com/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.79.1">.</span></span></li>
<li><span class="koboSpan" id="kobo.80.1">Navigate to the </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.81.1">Food</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.82.1"> API.</span></span></li>
<li><span class="koboSpan" id="kobo.83.1">Sign up via </span><strong class="bold"><span class="koboSpan" id="kobo.84.1">Email</span></strong><span class="koboSpan" id="kobo.85.1"> and choose </span><span class="No-Break"><span class="koboSpan" id="kobo.86.1">a password.</span></span></li>
<li><span class="koboSpan" id="kobo.87.1">Confirm your email address to complete the </span><span class="No-Break"><span class="koboSpan" id="kobo.88.1">registration process.</span></span></li>
<li><span class="koboSpan" id="kobo.89.1">After logging in, go to </span><strong class="bold"><span class="koboSpan" id="kobo.90.1">Profile</span></strong><span class="koboSpan" id="kobo.91.1"> to reveal the </span><span class="No-Break"><span class="koboSpan" id="kobo.92.1">API key.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.93.1">Create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.94.1">.env</span></strong><span class="koboSpan" id="kobo.95.1"> file in the root of your project and add the </span><span class="No-Break"><span class="koboSpan" id="kobo.96.1">following line:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.97.1">
VITE_APP_SPOONACULAR_API=Replace this with the key</span></pre> <p><span class="koboSpan" id="kobo.98.1">We are now ready to create a meal </span><span class="No-Break"><span class="koboSpan" id="kobo.99.1">planner applicati</span><a id="_idTextAnchor134"/><span class="koboSpan" id="kobo.100.1">on.</span></span></p>
<h1 id="_idParaDest-90"><a id="_idTextAnchor135"/><span class="koboSpan" id="kobo.101.1">Let’s get cooking</span></h1>
<p><span class="koboSpan" id="kobo.102.1">First, we’ll </span><a id="_idIndexMarker193"/><span class="koboSpan" id="kobo.103.1">make sure we have a decent boilerplate project to begin with and start by replacing the contents of </span><strong class="source-inline"><span class="koboSpan" id="kobo.104.1">App.vue</span></strong><span class="koboSpan" id="kobo.105.1"> with </span><span class="No-Break"><span class="koboSpan" id="kobo.106.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.107.1">
&lt;script setup lang="ts"&gt;&lt;/script&gt;
&lt;template&gt;
  &lt;v-layout&gt;
    &lt;v-container class="main"&gt;
      &lt;main&gt;
        &lt;router-view /&gt;
      &lt;/main&gt;
    &lt;/v-container&gt;
    &lt;v-footer app&gt;&lt;span class="text-light-green"&gt;My Meal Planner&lt;/span&gt;&amp;nbsp;- &amp;copy; {{ new Date().getFullYear() }}&lt;/v-footer&gt;
  &lt;/v-layout&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.108.1">We’ll expand on this later. </span><span class="koboSpan" id="kobo.108.2">Note that in the generated Vue component, the order of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.109.1">&lt;template&gt;</span></strong><span class="koboSpan" id="kobo.110.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.111.1">&lt;script&gt;</span></strong><span class="koboSpan" id="kobo.112.1"> tags is different. </span><span class="koboSpan" id="kobo.112.2">I prefer starting with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.113.1">&lt;script&gt;</span></strong><span class="koboSpan" id="kobo.114.1"> tag because that holds the logic that ties to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.115.1">&lt;template&gt;</span></strong><span class="koboSpan" id="kobo.116.1"> tag, but both </span><span class="No-Break"><span class="koboSpan" id="kobo.117.1">are valid:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer048">
<span class="koboSpan" id="kobo.118.1"><img alt="Figure 5.2 – The template and script tag have a different order than in our examples" src="image/B19563_05_02.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.119.1">Figure 5.2 – The template and script tag have a different order than in our examples</span></p>
<p><span class="koboSpan" id="kobo.120.1">On the home</span><a id="_idIndexMarker194"/><span class="koboSpan" id="kobo.121.1"> view, we will build our meal planner as a representation of the upcoming 7 days. </span><span class="koboSpan" id="kobo.121.2">First, we’ll start with a component that can render several days based on a </span><span class="No-Break"><span class="koboSpan" id="kobo.122.1">given date.</span></span></p>
<p><span class="koboSpan" id="kobo.123.1">We’ll create a component in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.124.1">components</span></strong><span class="koboSpan" id="kobo.125.1"> folder called </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.126.1">CalendarDays.vue</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.127.1">: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/05.mealplanner/.notes/5.1-CalendarDays.vue"><span class="No-Break"><span class="koboSpan" id="kobo.128.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/05.mealplanner/.notes/5.1-CalendarDays.vue</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.129.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.130.1">First, let’s take a look at the </span><strong class="source-inline"><span class="koboSpan" id="kobo.131.1">script</span></strong><span class="koboSpan" id="kobo.132.1"> tag. </span><span class="koboSpan" id="kobo.132.2">It accepts props so that it can execute the </span><strong class="source-inline"><span class="koboSpan" id="kobo.133.1">generateCards</span></strong><span class="koboSpan" id="kobo.134.1"> function, which generates an array of </span><em class="italic"><span class="koboSpan" id="kobo.135.1">cards</span></em><span class="koboSpan" id="kobo.136.1"> with a </span><strong class="source-inline"><span class="koboSpan" id="kobo.137.1">date</span></strong><span class="koboSpan" id="kobo.138.1"> property for each card. </span><span class="koboSpan" id="kobo.138.2">We’ve added the following content just to have something to show in </span><span class="No-Break"><span class="koboSpan" id="kobo.139.1">the template:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.140.1">
&lt;template&gt;  &lt;v-table&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th class="text-left"&gt;Upcoming days&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
      &lt;tr v-for="card in cards" :key="card.date.toString()"&gt;
        &lt;td class="py-4"&gt;
          {{ card.content }}
        &lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
  &lt;/v-table&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.141.1">In the template, we’re using the Vuetify </span><strong class="source-inline"><span class="koboSpan" id="kobo.142.1">table</span></strong><span class="koboSpan" id="kobo.143.1"> component to render a table. </span><span class="koboSpan" id="kobo.143.2">The Vuetify components are prefixed with the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.144.1">v-</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.145.1"> identifier.</span></span></p>
<p><span class="koboSpan" id="kobo.146.1">We render the</span><a id="_idIndexMarker195"/><span class="koboSpan" id="kobo.147.1"> table rows using the generated entries from the cards array. </span><span class="koboSpan" id="kobo.147.2">We’ll expose the component to the view by creating a </span><strong class="source-inline"><span class="koboSpan" id="kobo.148.1">MealPlanner.vue</span></strong><span class="koboSpan" id="kobo.149.1"> component where we import </span><span class="No-Break"><span class="koboSpan" id="kobo.150.1">our component:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.151.1">
&lt;script setup  lang="ts"&gt;import CalendarDays from './CalendarDays.vue';
&lt;/script&gt;
&lt;template&gt;
    &lt;calendar-days :date="new Date()" :days="7" /&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.152.1">We’re not doing anything special here other than instantiating the </span><strong class="source-inline"><span class="koboSpan" id="kobo.153.1">CalendarDays</span></strong><span class="koboSpan" id="kobo.154.1"> component with our desired number of plannable days. </span><span class="koboSpan" id="kobo.154.2">While we’re in this folder, we can delete </span><strong class="source-inline"><span class="koboSpan" id="kobo.155.1">HelloWorld.vue</span></strong><span class="koboSpan" id="kobo.156.1">, and replace the reference in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.157.1">views\Home.vue</span></strong><span class="koboSpan" id="kobo.158.1"> component so that our application shows </span><strong class="source-inline"><span class="koboSpan" id="kobo.159.1">MealPlanner</span></strong><span class="koboSpan" id="kobo.160.1"> on the </span><span class="No-Break"><span class="koboSpan" id="kobo.161.1">home page.</span></span></p>
<p><span class="koboSpan" id="kobo.162.1">Let’s improve it by showing formatted dates. </span><span class="koboSpan" id="kobo.162.2">We’ll create a small composable for this in a to-be-created </span><strong class="source-inline"><span class="koboSpan" id="kobo.163.1">composables</span></strong><span class="koboSpan" id="kobo.164.1"> folder. </span><span class="koboSpan" id="kobo.164.2">Let’s call the </span><span class="No-Break"><span class="koboSpan" id="kobo.165.1">file </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.166.1">formatters.ts</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.167.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.168.1">
const getOrdinalSuffix = (day: number): string =&gt; {    const suffixes = ["th", "st", "nd", "rd"];
    const remainder = day % 100;
    return suffixes[(remainder - 20) % 10] || suffixes[remainder] || suffixes[0];
};
export const useFormatDate = (date: Date): string =&gt; {
    const day = date.getDate();
    const month = date.toLocaleString("default", { month: "long" });
    const ordinal = getOrdinalSuffix(day);
    return ${day}${ordinal} of ${month};
};</span></pre>
<p><span class="koboSpan" id="kobo.169.1">Here, we’re </span><a id="_idIndexMarker196"/><span class="koboSpan" id="kobo.170.1">just adding some clever code that spells out the first, second, or third suffixes based on the given date. </span><span class="koboSpan" id="kobo.170.2">We’re leveraging bits of the browser’s built-in APIs, but with a bit of extra formatting. </span><span class="koboSpan" id="kobo.170.3">We can now print out the dates in a readable format for our generated cards, but we’ll get to that in </span><span class="No-Break"><span class="koboSpan" id="kobo.171.1">a moment.</span></span></p>
<p><span class="koboSpan" id="kobo.172.1">Let’s also create a composable to help us interact with the Spoonacular API. </span><span class="koboSpan" id="kobo.172.2">We’ll create a file called </span><strong class="source-inline"><span class="koboSpan" id="kobo.173.1">recipeApi.ts</span></strong><span class="koboSpan" id="kobo.174.1"> in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.175.1">composables</span></strong><span class="koboSpan" id="kobo.176.1"> folder. </span><span class="koboSpan" id="kobo.176.2">The contents should be familiar and resemble the functions we used in the previous </span><span class="No-Break"><span class="koboSpan" id="kobo.177.1">chapter: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/05.mealplanner/.notes/5.2-recipeApi.ts"><span class="No-Break"><span class="koboSpan" id="kobo.178.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/05.mealplanner/.notes/5.2-recipeApi.ts</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.179.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.180.1">With the default installation of Vuetify, we ended up with a default </span><strong class="source-inline"><span class="koboSpan" id="kobo.181.1">AppBar.vue</span></strong><span class="koboSpan" id="kobo.182.1">  component in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.183.1">src/layouts/default</span></strong><span class="koboSpan" id="kobo.184.1"> folder. </span><span class="koboSpan" id="kobo.184.2">Let’s modify it so that it fits the purpose of </span><span class="No-Break"><span class="koboSpan" id="kobo.185.1">the app:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.186.1">
&lt;template&gt;  &lt;v-app-bar flat&gt;
    &lt;v-app-bar-title&gt;
      </span><strong class="bold"><span class="koboSpan" id="kobo.187.1">&lt;v-icon icon="mdi-silverware-fork-knife" /&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.188.1">      Meal planner</span></strong><span class="koboSpan" id="kobo.189.1">
    &lt;/v-app-bar-title&gt;
  &lt;/v-app-bar&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.190.1">The Vuetify components make it relatively easy to build an app with sensible defaults. </span><span class="koboSpan" id="kobo.190.2">In the next section, we will learn how to quickly expand our application using the </span><span class="No-Break"><span class="koboSpan" id="kobo.191.1">available components.</span></span></p>
<h1 id="_idParaDest-91"><a id="_idTextAnchor136"/><span class="koboSpan" id="kobo.192.1">Quick development with Vuetify</span></h1>
<p><span class="koboSpan" id="kobo.193.1">The</span><a id="_idIndexMarker197"/><span class="koboSpan" id="kobo.194.1"> app we’ve built so far isn’t much use to us yet. </span><span class="koboSpan" id="kobo.194.2">Let’s turn this into a working meal planner! </span><span class="koboSpan" id="kobo.194.3">Since we are going to want to</span><a id="_idIndexMarker198"/><span class="koboSpan" id="kobo.195.1"> abstract and compartmentalize, we’ll start by splitting some of the code of the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.196.1">CalendarDays.vue</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.197.1"> component.</span></span></p>
<p><span class="koboSpan" id="kobo.198.1">First, we’ll create a new component, called </span><strong class="source-inline"><span class="koboSpan" id="kobo.199.1">CalendarCard.vue</span></strong><span class="koboSpan" id="kobo.200.1">. </span><span class="koboSpan" id="kobo.200.2">We will use this to represent a calendar item and use the date formatter </span><span class="No-Break"><span class="koboSpan" id="kobo.201.1">we’ve created:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.202.1">
&lt;script setup lang="ts"&gt;import { useFormatDate } from "@/composables/formatters";
interface Card {
  date: Date;
}
const props = defineProps&lt;{
  card: Card;
}&gt;();
&lt;/script&gt;
&lt;template&gt;
  &lt;v-sheet class="d-flex justify-space-between"&gt;
    &lt;v-sheet class="ma-2 pa-2"&gt;
      &lt;h2 class="text-h2"&gt;{{ useFormatDate(card.date) }}&lt;/h2&gt;
    &lt;/v-sheet&gt;
  &lt;/v-sheet&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.203.1">In </span><strong class="source-inline"><span class="koboSpan" id="kobo.204.1">CalendarDays.vue</span></strong><span class="koboSpan" id="kobo.205.1">, we can</span><a id="_idIndexMarker199"/><span class="koboSpan" id="kobo.206.1"> replace the inline representation by importing our newly </span><a id="_idIndexMarker200"/><span class="koboSpan" id="kobo.207.1">created </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.208.1">CalendarCard</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.209.1"> component:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.210.1">
&lt;script setup lang="ts"&gt;import { ref } from "vue";
</span><strong class="bold"><span class="koboSpan" id="kobo.211.1">import CalendarCard from "@/components/CalendarCard.vue";</span></strong><span class="koboSpan" id="kobo.212.1">
// …abbreviated</span></pre>
<p><span class="koboSpan" id="kobo.213.1">Then, we’ll add the component to </span><span class="No-Break"><span class="koboSpan" id="kobo.214.1">the template:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.215.1">
&lt;template&gt;  &lt;v-table&gt;
    // … abbreviated
    &lt;tbody&gt;
      &lt;tr v-for="card in cards" :key="card.date.toString()"&gt;
        &lt;td class="py-4"&gt;
          </span><strong class="bold"><span class="koboSpan" id="kobo.216.1">&lt;calendar-card :card="card" /&gt;</span></strong><span class="koboSpan" id="kobo.217.1">
        &lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
  &lt;/v-table&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.218.1">We also need to add a new route that will be able to display all planned recipes. </span><span class="koboSpan" id="kobo.218.2">We’ll add the recipes later. </span><span class="koboSpan" id="kobo.218.3">First, we’ll create a table to display recipes. </span><span class="koboSpan" id="kobo.218.4">We’ll feed it recipes via a prop from </span><span class="No-Break"><span class="koboSpan" id="kobo.219.1">another component.</span></span></p>
<p><span class="koboSpan" id="kobo.220.1">Let’s create </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.221.1">RecipeTable.vue</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.222.1">: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/05.mealplanner/.notes/5.3-RecipeTable.vue"><span class="No-Break"><span class="koboSpan" id="kobo.223.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/05.mealplanner/.notes/5.3-RecipeTable.vue</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.224.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.225.1">We’re </span><a id="_idIndexMarker201"/><span class="koboSpan" id="kobo.226.1">using the Vuetify components to create a table representation of the list of recipes that will be provided in the property. </span><span class="koboSpan" id="kobo.226.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.227.1">openPreview</span></strong><span class="koboSpan" id="kobo.228.1"> function (</span><em class="italic"><span class="koboSpan" id="kobo.229.1">lines 2, 14-16, and 34</span></em><span class="koboSpan" id="kobo.230.1">) is one of the features </span><a id="_idIndexMarker202"/><span class="koboSpan" id="kobo.231.1">that the table will support in the future. </span><span class="koboSpan" id="kobo.231.2">When we’re implementing this, we will make sure that the emitted event will be picked up by the parent component. </span><span class="koboSpan" id="kobo.231.3">Let’s quickly build the </span><span class="No-Break"><span class="koboSpan" id="kobo.232.1">parent component.</span></span></p>
<p><span class="koboSpan" id="kobo.233.1">Let’s create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.234.1">RecipesList.vue</span></strong><span class="koboSpan" id="kobo.235.1"> component. </span><span class="koboSpan" id="kobo.235.2">It will feature the table for displaying past and future recipes, using Vuetify </span><span class="No-Break"><span class="koboSpan" id="kobo.236.1">components: </span></span><a href="https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/05.mealplanner/.notes/5.4-RecipesList.vue"><span class="No-Break"><span class="koboSpan" id="kobo.237.1">https://github.com/PacktPublishing/Building-Real-world-Web-Applications-with-Vue.js-3/blob/main/05.mealplanner/.notes/5.4-RecipesList.vue</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.238.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.239.1">I’ve added a little bit of code to generate some mock data (</span><em class="italic"><span class="koboSpan" id="kobo.240.1">lines 12-24</span></em><span class="koboSpan" id="kobo.241.1">). </span><span class="koboSpan" id="kobo.241.2">It can sometimes be helpful to focus on the template, and in those cases, it’s helpful to be able to have granular control over the data and support multiple scenarios. </span><span class="koboSpan" id="kobo.241.3">When writing the unit tests to match this file, you could even reuse </span><span class="No-Break"><span class="koboSpan" id="kobo.242.1">this code!</span></span></p>
<p><span class="koboSpan" id="kobo.243.1">The other part is how we’re listening to the event that gets emitted from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.244.1">RecipeTable</span></strong><span class="koboSpan" id="kobo.245.1"> component (</span><em class="italic"><span class="koboSpan" id="kobo.246.1">lines 69 and 76</span></em><span class="koboSpan" id="kobo.247.1">). </span><span class="koboSpan" id="kobo.247.2">We trigger the </span><strong class="source-inline"><span class="koboSpan" id="kobo.248.1">openPreview</span></strong><span class="koboSpan" id="kobo.249.1"> function (</span><em class="italic"><span class="koboSpan" id="kobo.250.1">lines 26-28</span></em><span class="koboSpan" id="kobo.251.1">) on the click event. </span><span class="koboSpan" id="kobo.251.2">We’ll also need a view and a route to be able to navigate to </span><span class="No-Break"><span class="koboSpan" id="kobo.252.1">these components.</span></span></p>
<p><span class="koboSpan" id="kobo.253.1">Let’s create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.254.1">RecipeView.vue</span></strong><span class="koboSpan" id="kobo.255.1"> component in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.256.1">src/views</span></strong><span class="koboSpan" id="kobo.257.1"> folder that simply loads </span><span class="No-Break"><span class="koboSpan" id="kobo.258.1">our component:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.259.1">
&lt;script setup lang="ts"&gt;import RecipesList from "@/components/RecipesList.vue";
&lt;/script&gt;
&lt;template&gt;
  &lt;RecipesList /&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.260.1">Next, we’ll expand the</span><a id="_idIndexMarker203"/><span class="koboSpan" id="kobo.261.1"> route configuration, which</span><a id="_idIndexMarker204"/><span class="koboSpan" id="kobo.262.1"> Vuetify generated for us </span><span class="No-Break"><span class="koboSpan" id="kobo.263.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.264.1">src/router/index.ts</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.265.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.266.1">
import { createRouter, createWebHistory } from 'vue-router'const routes = [
  {
    path: '/',
    component: () =&gt; import('@/layouts/default/Default.vue'),
    children: [
      {
        path: '',
        name: 'Home',
        component: () =&gt; import(/* webpackChunkName: "home" */ '@/views/Home.vue'),
      },
</span><strong class="bold"><span class="koboSpan" id="kobo.267.1">      {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.268.1">        path: 'recipes',</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.269.1">        name: 'Recipes',</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.270.1">        component: () =&gt; import('@/views/RecipesView.vue')</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.271.1">      },</span></strong><span class="koboSpan" id="kobo.272.1">
    ],
  },
]
// …abbreviated</span></pre>
<p><span class="koboSpan" id="kobo.273.1">Finally, we </span><a id="_idIndexMarker205"/><span class="koboSpan" id="kobo.274.1">can </span><a id="_idIndexMarker206"/><span class="No-Break"><span class="koboSpan" id="kobo.275.1">update </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.276.1">src/layouts/default/AppBar.vue</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.277.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.278.1">
&lt;template&gt;  &lt;v-app-bar flat&gt;
</span><strong class="bold"><span class="koboSpan" id="kobo.279.1">    &lt;v-btn id="hamburger-activator" icon="mdi-menu"&gt; &lt;/v-btn&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.280.1">    &lt;v-menu activator="#hamburger-activator"&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.281.1">      &lt;v-list&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.282.1">        &lt;v-list-item&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.283.1">          &lt;v-btn flat block&gt;&lt;router-link to="/"&gt;Home&lt;/router-link&gt;&lt;/v-btn&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.284.1">          &lt;v-btn flat block</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.285.1">            &gt;&lt;router-link to="/recipes"&gt;Recipes&lt;/router-link&gt;&lt;/v-btn</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.286.1">          &gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.287.1">        &lt;/v-list-item&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.288.1">      &lt;/v-list&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.289.1">    &lt;/v-menu&gt;</span></strong><span class="koboSpan" id="kobo.290.1">
    &lt;v-app-bar-title&gt;
      &lt;v-icon icon="mdi-silverware-fork-knife" /&gt;
      Meal planner
    &lt;/v-app-bar-title&gt;
  &lt;/v-app-bar&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.291.1">With these lines of code, we’ve added a hamburger menu with a toggle. </span><span class="koboSpan" id="kobo.291.2">It just works! </span><span class="koboSpan" id="kobo.291.3">This is a very powerful feature of using a component library: it not only provides styled components but also provides commonly used patterns </span><span class="No-Break"><span class="koboSpan" id="kobo.292.1">for interaction.</span></span></p>
<p><span class="koboSpan" id="kobo.293.1">I highly</span><a id="_idIndexMarker207"/><span class="koboSpan" id="kobo.294.1"> recommend checking out the Vuetify </span><a id="_idIndexMarker208"/><span class="koboSpan" id="kobo.295.1">documentation as it provides an extensive list of the available components and examples of how to use them. </span><span class="koboSpan" id="kobo.295.2">In the app we’re building, we’re only touching lightly upon the usage of the component library, but you also have the option of optimizing the components so that they fit a more specific goal </span><span class="No-Break"><span class="koboSpan" id="kobo.296.1">or purpose.</span></span></p>
<p><span class="koboSpan" id="kobo.297.1">We can now navigate to two different views and build a limited version of the final app. </span><span class="koboSpan" id="kobo.297.2">In the next section, we’ll connect the Spoonacular r</span><a id="_idTextAnchor137"/><span class="koboSpan" id="kobo.298.1">ecipes to </span><span class="No-Break"><span class="koboSpan" id="kobo.299.1">our app!</span></span></p>
<h1 id="_idParaDest-92"><a id="_idTextAnchor138"/><span class="koboSpan" id="kobo.300.1">Connecting the recipes to our app</span></h1>
<p><span class="koboSpan" id="kobo.301.1">In this</span><a id="_idIndexMarker209"/><span class="koboSpan" id="kobo.302.1"> section, we’ll connect the API to our app, which allows users to start planning meals for upcoming days. </span><span class="koboSpan" id="kobo.302.2">We’ll explore patterns to interact with an app using the </span><a id="_idTextAnchor139"/><span class="No-Break"><span class="koboSpan" id="kobo.303.1">Vuetify components.</span></span></p>
<h2 id="_idParaDest-93"><a id="_idTextAnchor140"/><span class="koboSpan" id="kobo.304.1">A bit of additional setup</span></h2>
<p><span class="koboSpan" id="kobo.305.1">Because we are </span><a id="_idIndexMarker210"/><span class="koboSpan" id="kobo.306.1">going to deal with asynchronous data, we’ll add some helper components. </span><span class="koboSpan" id="kobo.306.2">First, we’ll create an </span><strong class="source-inline"><span class="koboSpan" id="kobo.307.1">AppLoader.vue</span></strong><span class="koboSpan" id="kobo.308.1"> component in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.309.1">src/components</span></strong><span class="koboSpan" id="kobo.310.1"> folder, which acts as a </span><span class="No-Break"><span class="koboSpan" id="kobo.311.1">loading indicator:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.312.1">
&lt;template&gt;  &lt;v-container class="fill-height" fluid&gt;
    &lt;v-row align="center" justify="center"&gt;
      &lt;v-col cols="12" sm="8" md="4"&gt;
        &lt;div class="text-center my-8"&gt;
          &lt;v-progress-circular
            indeterminate
            color="light-blue"
            :size="80"
            :width="10"
          &gt;&lt;/v-progress-circular&gt;
        &lt;/div&gt;
      &lt;/v-col&gt;
    &lt;/v-row&gt;
  &lt;/v-container&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.313.1">And while </span><a id="_idIndexMarker211"/><span class="koboSpan" id="kobo.314.1">we’re at it, we can also add a dedicated component to handle our links. </span><span class="koboSpan" id="kobo.314.2">We’ll name </span><span class="No-Break"><span class="koboSpan" id="kobo.315.1">it </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.316.1">AppLink.vue</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.317.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.318.1">
&lt;script setup lang="ts"&gt;const props = defineProps({
  to: {
    type: String,
    required: true,
  },
});
&lt;/script&gt;
&lt;template&gt;
    &lt;router-link :to="to" class="text-light-blue"&gt;
        &lt;slot&gt;&lt;/slot&gt;
    &lt;/router-link&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.319.1">We can insert </span><strong class="source-inline"><span class="koboSpan" id="kobo.320.1">AppLink</span></strong><span class="koboSpan" id="kobo.321.1"> into </span><strong class="source-inline"><span class="koboSpan" id="kobo.322.1">AppBar.vue</span></strong><span class="koboSpan" id="kobo.323.1"> immediately by replacing </span><strong class="source-inline"><span class="koboSpan" id="kobo.324.1">router-link</span></strong><span class="koboSpan" id="kobo.325.1"> with our new component. </span><span class="koboSpan" id="kobo.325.2">This component adds style across our applications’ links. </span><span class="koboSpan" id="kobo.325.3">Note that we’re keeping the markup deliberately close to the </span><span class="No-Break"><span class="koboSpan" id="kobo.326.1">original </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.327.1">router-link</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.328.1">:</span></span></p>
<pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.329.1">&lt;script setup lang="ts"&gt;</span></strong><strong class="bold"><span class="koboSpan" id="kobo.330.1">import AppLink from '@/components/AppLink.vue';</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.331.1">&lt;/script&gt;</span></strong><span class="koboSpan" id="kobo.332.1">
&lt;template&gt;
  &lt;v-app-bar flat&gt;
    &lt;v-btn id="hamburger-activator" icon="mdi-menu"&gt; &lt;/v-btn&gt;
    &lt;v-menu activator="#hamburger-activator"&gt;
      &lt;v-list&gt;
        &lt;v-list-item&gt;
          &lt;v-btn flat block&gt;</span><strong class="bold"><span class="koboSpan" id="kobo.333.1">&lt;app-link to="/"&gt;</span></strong><span class="koboSpan" id="kobo.334.1">Home</span><strong class="bold"><span class="koboSpan" id="kobo.335.1">&lt;/app-link&gt;</span></strong><span class="koboSpan" id="kobo.336.1">&lt;/v-btn&gt;
          &lt;v-btn flat block
            &gt;</span><strong class="bold"><span class="koboSpan" id="kobo.337.1">&lt;app-link to="/recipes"&gt;</span></strong><span class="koboSpan" id="kobo.338.1">Recipes</span><strong class="bold"><span class="koboSpan" id="kobo.339.1">&lt;/app-link&gt;</span></strong><span class="koboSpan" id="kobo.340.1">&lt;/v-btn
          &gt;
        &lt;/v-list-item&gt;
      &lt;/v-list&gt;
    &lt;/v-menu&gt;
&lt;!-- ... </span><span class="koboSpan" id="kobo.340.2">abbreviated -–&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.341.1">Now that we </span><a id="_idIndexMarker212"/><span class="koboSpan" id="kobo.342.1">can navigate, let’s continue by exposing the data from the AP</span><a id="_idTextAnchor141"/><span class="koboSpan" id="kobo.343.1">I in </span><span class="No-Break"><span class="koboSpan" id="kobo.344.1">our application.</span></span></p>
<h2 id="_idParaDest-94"><a id="_idTextAnchor142"/><span class="koboSpan" id="kobo.345.1">Our API connection</span></h2>
<p><span class="koboSpan" id="kobo.346.1">We’ll </span><a id="_idIndexMarker213"/><span class="koboSpan" id="kobo.347.1">now focus on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.348.1">CalendarCard.vue</span></strong><span class="koboSpan" id="kobo.349.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.350.1">CalendarDays.vue</span></strong><span class="koboSpan" id="kobo.351.1"> components. </span><span class="koboSpan" id="kobo.351.2">We’ll add functionalities to search for a recipe and add it to a day, view it, and </span><span class="No-Break"><span class="koboSpan" id="kobo.352.1">remove it.</span></span></p>
<p><span class="koboSpan" id="kobo.353.1">We’ll start in </span><strong class="source-inline"><span class="koboSpan" id="kobo.354.1">CalendarCard.vue</span></strong><span class="koboSpan" id="kobo.355.1"> by adding an event to signal that a user selected a </span><span class="No-Break"><span class="koboSpan" id="kobo.356.1">certain </span></span><span class="No-Break"><a id="_idIndexMarker214"/></span><span class="No-Break"><span class="koboSpan" id="kobo.357.1">date:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.358.1">
&lt;script setup lang="ts"&gt;import { useFormatDate } from "@/composables/formatters";
</span><strong class="bold"><span class="koboSpan" id="kobo.359.1">const emits = defineEmits(["daySelected"]);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.360.1">const addRecipeToDay = (card: Card): void =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.361.1">  emits("daySelected", card);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.362.1">}</span></strong><span class="koboSpan" id="kobo.363.1">
interface Card {
  date: Date;
}
const props = defineProps&lt;{
  card: Card;
}&gt;();
&lt;/script&gt;
&lt;template&gt;
  &lt;v-sheet class="d-flex justify-space-between"&gt;
    &lt;v-sheet class="ma-2 pa-2"&gt;
      &lt;h2 class="text-h2"&gt;{{ useFormatDate(card.date) }}&lt;/h2&gt;
    &lt;/v-sheet&gt;
</span><strong class="bold"><span class="koboSpan" id="kobo.364.1">    &lt;v-sheet class="ma-2 pa-2"&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.365.1">      &lt;v-btn text @click="addRecipeToDay(card)" icon="mdi-plus"&gt;&lt;/v-btn&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.366.1">    &lt;/v-sheet&gt;</span></strong><span class="koboSpan" id="kobo.367.1">
  &lt;/v-sheet&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.368.1">In the user</span><a id="_idIndexMarker215"/><span class="koboSpan" id="kobo.369.1"> interface, we’ve added a button that emits the current card when it’s clicked. </span><span class="koboSpan" id="kobo.369.2">Now, let’s modify </span><strong class="source-inline"><span class="koboSpan" id="kobo.370.1">CalendarDays.vue</span></strong><span class="koboSpan" id="kobo.371.1"> so that it picks up this event and shows a dialog to search </span><span class="No-Break"><span class="koboSpan" id="kobo.372.1">for recipes:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.373.1">
&lt;script setup lang="ts"&gt;import { ref } from "vue";
</span><strong class="bold"><span class="koboSpan" id="kobo.374.1">import type { Ref } from "vue";</span></strong><span class="koboSpan" id="kobo.375.1">
import CalendarCard from "@/components/CalendarCard.vue";
const props = defineProps({
  date: {
    type: Date,
    required: true,
  },
  days: {
    type: Number,
    required: false,
    default: 7,
  },
});
interface Card {
  date: Date;
  content: string;
}
const generateCards = (startDate: Date, numberOfDays: number): Card[] =&gt; {
  const cards: Card[] = [];
  const currentDate = new Date(startDate);
  for (let i = 0; i &lt; numberOfDays; i++) {
    const date = new Date(currentDate.getTime());
    const content = Card ${i + 1};
    cards.push({ date, content });
    currentDate.setDate(currentDate.getDate() + 1);
  }
  return cards;
};
const cards = ref&lt;Card[]&gt;(generateCards(props.date, props.days));
</span><strong class="bold"><span class="koboSpan" id="kobo.376.1">const dialogVisible: Ref&lt;boolean&gt; = ref(false);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.377.1">const dateSelected: Ref&lt;Date | null&gt; = ref(null);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.378.1">const recipeDialogOpen = (card: Card): void =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.379.1">  dateSelected.value = card.date;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.380.1">  dialogVisible.value = true;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.381.1">};</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.382.1">const recipeDialogClose = (): void =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.383.1">  dateSelected.value = null;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.384.1">  dialogVisible.value = false;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.385.1">};</span></strong><span class="koboSpan" id="kobo.386.1">
&lt;/script&gt;
&lt;template&gt;
  &lt;v-table&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th class="text-left"&gt;Upcoming days&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
      &lt;tr v-for="card in cards" :key="card.date.toString()"&gt;
        &lt;td class="py-4"&gt;
          &lt;calendar-card :card="card"</span><strong class="bold"><span class="koboSpan" id="kobo.387.1"> @daySelected="recipeDialogOpen"</span></strong><span class="koboSpan" id="kobo.388.1"> /&gt;
        &lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
  &lt;/v-table&gt;
</span><strong class="bold"><span class="koboSpan" id="kobo.389.1">  &lt;v-dialog v-model="dialogVisible" scrollable&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.390.1">    &lt;v-card&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.391.1">      &lt;v-card-title&gt; Search for a recipe to add to this day &lt;/v-card-title&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.392.1">      &lt;v-card-actions&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.393.1">        &lt;v-btn color="primary" block @click="recipeDialogClose"</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.394.1">          &gt;Close Dialog&lt;/v-btn</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.395.1">        &gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.396.1">      &lt;/v-card-actions&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.397.1">    &lt;/v-card&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.398.1">  &lt;/v-dialog&gt;</span></strong><span class="koboSpan" id="kobo.399.1">
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.400.1">In the updated </span><a id="_idIndexMarker216"/><span class="koboSpan" id="kobo.401.1">code, we’re storing the state of the dialog in a newly created variable and using a component provided by Vuetify to open a dialog, where we can also close and restore the variable</span><a id="_idTextAnchor143"/><span class="koboSpan" id="kobo.402.1">s to their </span><span class="No-Break"><span class="koboSpan" id="kobo.403.1">initial values.</span></span></p>
<h2 id="_idParaDest-95"><a id="_idTextAnchor144"/><span class="koboSpan" id="kobo.404.1">Selecting a recipe</span></h2>
<p><span class="koboSpan" id="kobo.405.1">Next, we’ll</span><a id="_idIndexMarker217"/><span class="koboSpan" id="kobo.406.1"> build a small search component to display in the dialog. </span><span class="koboSpan" id="kobo.406.2">This will allow users to search for a recipe. </span><span class="koboSpan" id="kobo.406.3">When selected, we’ll pass the details of the recipe to the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.407.1">CalendarDays.vue</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.408.1"> component.</span></span></p>
<p><span class="koboSpan" id="kobo.409.1">Create a file </span><span class="No-Break"><span class="koboSpan" id="kobo.410.1">called </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.411.1">RecipeSearch.vue</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.412.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.413.1">
&lt;script setup lang="ts"&gt;import { ref, watch } from "vue";
import type { Ref } from "vue";
import { useRecipeSearch } from "@/composables/recipeApi";
import type { RecipeResults } from "@/types/spoonacular";
</span><strong class="bold"><span class="koboSpan" id="kobo.414.1">const emits = defineEmits(["recipeSelected"]);</span></strong><span class="koboSpan" id="kobo.415.1">
const searchQuery: Ref&lt;string&gt; = ref("");
const searchResults: Ref&lt;RecipeResults[] | []&gt; = ref([]);
</span><strong class="bold"><span class="koboSpan" id="kobo.416.1">const getSearchResults = async () =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.417.1">  const result = await useRecipeSearch(searchQuery.value);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.418.1">  searchResults.value = result.results;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.419.1">};</span></strong><span class="koboSpan" id="kobo.420.1">
let timeout: ReturnType&lt;typeof setTimeout&gt;;
const debouncedSearch = (): void =&gt; {
  clearTimeout(timeout);
  timeout = setTimeout(async () =&gt; {
    getSearchResults();
  }, 500);
};
watch(searchQuery, (): void =&gt; {
  debouncedSearch();
});
</span><strong class="bold"><span class="koboSpan" id="kobo.421.1">const recipeSelected = (result: RecipeResults): void =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.422.1">  emits("recipeSelected", result);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.423.1">};</span></strong><span class="koboSpan" id="kobo.424.1">
&lt;/script&gt;
&lt;template&gt;
  &lt;v-car flat&gt;
    &lt;v-card-text&gt;
      &lt;v-text-field v-model="searchQuery" label="Search"&gt;&lt;/v-text-field&gt;
    &lt;/v-card-text&gt;
    &lt;v-divider&gt;&lt;/v-divider&gt;
    &lt;v-list v-if="searchResults"&gt;
      &lt;v-list-item v-for="(result, index) in searchResults" :key="index"&gt;
        &lt;v-list-item-title @click="</span><strong class="bold"><span class="koboSpan" id="kobo.425.1">recipeSelected(result)</span></strong><span class="koboSpan" id="kobo.426.1">" class="list-item"&gt;{{
          result.title
        }}&lt;/v-list-item-title&gt;
      &lt;/v-list-item&gt;
    &lt;/v-list&gt;
  &lt;/v-car&gt;
&lt;/template&gt;
&lt;style scoped&gt;
.list-item {
  cursor: pointer;
}
.list-item:hover,
.list-item:active {
  text-decoration: underline;
}
&lt;/style&gt;</span></pre>
<p><span class="koboSpan" id="kobo.427.1">We’re </span><a id="_idIndexMarker218"/><span class="koboSpan" id="kobo.428.1">making use of a debounced watcher, the same as with the Marvel search component. </span><span class="koboSpan" id="kobo.428.2">We can use the composable to retrieve the results based on a simple text-based search query and display the results in </span><span class="No-Break"><span class="koboSpan" id="kobo.429.1">a list.</span></span></p>
<p><span class="koboSpan" id="kobo.430.1">When a user clicks on a list item, we’ll emit the event and send the corresponding recipe as context to the </span><span class="No-Break"><span class="koboSpan" id="kobo.431.1">parent component.</span></span></p>
<p><span class="koboSpan" id="kobo.432.1">Let’s implement the addition and </span><a id="_idTextAnchor145"/><span class="koboSpan" id="kobo.433.1">removal of recipes on </span><span class="No-Break"><span class="koboSpan" id="kobo.434.1">a day!</span></span></p>
<h2 id="_idParaDest-96"><a id="_idTextAnchor146"/><span class="koboSpan" id="kobo.435.1">Adding and removing a meal</span></h2>
<p><span class="koboSpan" id="kobo.436.1">Implementing</span><a id="_idIndexMarker219"/><span class="koboSpan" id="kobo.437.1"> the search functionality is now very easy! </span><span class="koboSpan" id="kobo.437.2">We can import the component in the setup tag and then place the components’ tags in the template. </span><span class="koboSpan" id="kobo.437.3">We do have to add a listener since we’re emitting an event on the </span><span class="No-Break"><span class="koboSpan" id="kobo.438.1">search component.</span></span></p>
<p><span class="koboSpan" id="kobo.439.1">Let’s take </span><span class="No-Break"><span class="koboSpan" id="kobo.440.1">a look:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.441.1">
&lt;script setup lang="ts"&gt;import { ref } from "vue";
import type { Ref } from "vue";
</span><strong class="bold"><span class="koboSpan" id="kobo.442.1">import type { RecipeResults } from "@/types/spoonacular";</span></strong><span class="koboSpan" id="kobo.443.1">
import CalendarCard from "@/components/CalendarCard.vue";
</span><strong class="bold"><span class="koboSpan" id="kobo.444.1">import RecipeSearch from "@/components/RecipeSearch.vue";</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.445.1">interface Today {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.446.1">  id: number;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.447.1">  title: string;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.448.1">  readyInMinutes: number;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.449.1">}</span></strong><span class="koboSpan" id="kobo.450.1">
interface Card {
  date: Date;
  content: string;
</span><strong class="bold"><span class="koboSpan" id="kobo.451.1">  today: Today[];</span></strong><span class="koboSpan" id="kobo.452.1">
}
// …abbreviated
</span><strong class="bold"><span class="koboSpan" id="kobo.453.1">const insertRecipeOnDay = (recipe: RecipeResults): void =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.454.1">  if (dateSelected.value) {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.455.1">    cards.value = cards.value.map((card) =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.456.1">      if (card.date.getTime() === dateSelected.value?.getTime()) {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.457.1">        return { ...card, today: [...card.today, recipe] };</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.458.1">      }</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.459.1">      return card;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.460.1">    });</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.461.1">    recipeDialogClose();</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.462.1">  }</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.463.1">};</span></strong><span class="koboSpan" id="kobo.464.1">
&lt;/script&gt;
&lt;template&gt;
  &lt;v-table&gt;
    &lt;!-- abbreviated --&gt;
  &lt;/v-table&gt;
  &lt;v-dialog v-model="dialogVisible" scrollable&gt;
    &lt;v-card&gt;
      &lt;v-card-title&gt; Search for a recipe to add to this day &lt;/v-card-title&gt;
      </span><strong class="bold"><span class="koboSpan" id="kobo.465.1">&lt;recipe-search @recipeSelected="insertRecipeOnDay" /&gt;</span></strong><span class="koboSpan" id="kobo.466.1">
      &lt;v-card-actions&gt;
        &lt;v-btn color="primary" block @click="recipeDialogClose"
          &gt;Close Dialog&lt;/v-btn
        &gt;
      &lt;/v-card-actions&gt;
    &lt;/v-card&gt;
  &lt;/v-dialog&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.467.1">With that, we’ve added the </span><strong class="source-inline"><span class="koboSpan" id="kobo.468.1">recipe-search</span></strong><span class="koboSpan" id="kobo.469.1"> component to the page. </span><span class="koboSpan" id="kobo.469.2">With the </span><strong class="source-inline"><span class="koboSpan" id="kobo.470.1">insertRecipeOnDay</span></strong><span class="koboSpan" id="kobo.471.1"> function, we can modify our cards collection by adding the selected recipe (which was emitted through the search component) and adding it to a new property on a </span><span class="No-Break"><span class="koboSpan" id="kobo.472.1">card: today.</span></span></p>
<p><span class="koboSpan" id="kobo.473.1">Before we display </span><a id="_idIndexMarker220"/><span class="koboSpan" id="kobo.474.1">recipes for a day, let’s also add a method for removing a recipe on a day based on a recipe ID and the date (this way, we can support multiple recipes on one day and similar recipes across multiple days). </span><span class="koboSpan" id="kobo.474.2">We can add the following function to the </span><span class="No-Break"><span class="koboSpan" id="kobo.475.1">script tag:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.476.1">
const removeRecipeFromDay = (recipe: { id: number }, date: Date): void =&gt; {  cards.value = cards.value.map((card) =&gt; {
    if (card.date.getTime() === date.getTime()) {
      return {
        ...card,
        today: card.today.filter((today) =&gt; today.id !== recipe.id),
      };
    }
    return card;
  });
};</span></pre>
<p><span class="koboSpan" id="kobo.477.1">This function simply modifies the </span><strong class="source-inline"><span class="koboSpan" id="kobo.478.1">today</span></strong><span class="koboSpan" id="kobo.479.1"> collection by filtering out any recipe that matches the given ID and date. </span><span class="koboSpan" id="kobo.479.2">In the template, we’ll add a listener for an event on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.480.1">CalenderCard.vue</span></strong><span class="koboSpan" id="kobo.481.1"> component, </span><span class="No-Break"><span class="koboSpan" id="kobo.482.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.483.1">
&lt;calendar-card :card="card" @daySelected="recipeDialogOpen" </span><strong class="bold"><span class="koboSpan" id="kobo.484.1">@recipeRemoved="removeRecipeFromDay"</span></strong><span class="koboSpan" id="kobo.485.1"> /&gt;</span></pre> <p><span class="koboSpan" id="kobo.486.1">Now, let’s update the </span><strong class="source-inline"><span class="koboSpan" id="kobo.487.1">CalendarCard.vue</span></strong><span class="koboSpan" id="kobo.488.1"> component so that it shows the recipes for a day and then add the option to </span><span class="No-Break"><span class="koboSpan" id="kobo.489.1">remove them:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.490.1">
&lt;script setup lang="ts"&gt;import { useFormatDate } from "@/composables/formatters";
</span><strong class="bold"><span class="koboSpan" id="kobo.491.1">import AppLink from "./AppLink.vue";</span></strong><span class="koboSpan" id="kobo.492.1">
const emits = defineEmits(["daySelected"</span><strong class="bold"><span class="koboSpan" id="kobo.493.1">, "recipeRemoved"</span></strong><span class="koboSpan" id="kobo.494.1">]);
const addRecipeToDay = (card: Card): void =&gt; {
  emits("daySelected", card);
}
</span><strong class="bold"><span class="koboSpan" id="kobo.495.1">const recipeRemoved = (recipe: Today, date: Date): void =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.496.1">  emits("recipeRemoved", recipe, date);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.497.1">}</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.498.1">interface Today {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.499.1">  id: number;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.500.1">  title: string;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.501.1">  readyInMinutes: number;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.502.1">}</span></strong><span class="koboSpan" id="kobo.503.1">
interface Card {
  date: Date;
</span><strong class="bold"><span class="koboSpan" id="kobo.504.1">  today: Today[];</span></strong><span class="koboSpan" id="kobo.505.1">
}
const props = defineProps&lt;{
  card: Card;
}&gt;();
&lt;/script&gt;
&lt;template&gt;
  &lt;v-sheet class="d-flex justify-space-between"&gt;
    &lt;v-sheet class="ma-2 pa-2"&gt;
      &lt;h2 class="text-h2"&gt;{{ useFormatDate(card.date) }}&lt;/h2&gt;
    &lt;/v-sheet&gt;
    &lt;v-sheet class="ma-2 pa-2"&gt;
      &lt;v-btn text @click="addRecipeToDay(card)" icon="mdi-plus"&gt;&lt;/v-btn&gt;
    &lt;/v-sheet&gt;
  &lt;/v-sheet&gt;
</span><strong class="bold"><span class="koboSpan" id="kobo.506.1">  &lt;v-col&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.507.1">    &lt;v-card v-for="today in card.today" :key="today.id" class="my-4"&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.508.1">      &lt;v-card-title&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.509.1">        &lt;app-link :to="/recipe/${today.id}"&gt;{{ today.title }}&lt;/app-link&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.510.1">      &lt;/v-card-title&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.511.1">      &lt;v-card-text&gt;{{ today.readyInMinutes }} minutes&lt;/v-card-text&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.512.1">      &lt;v-card-actions&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.513.1">        &lt;v-spacer&gt;&lt;/v-spacer&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.514.1">        &lt;v-btn</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.515.1">          text</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.516.1">          icon="mdi-trash-can-outline"</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.517.1">          @click="recipeRemoved(today, card.date)"</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.518.1">        &gt;&lt;/v-btn&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.519.1">      &lt;/v-card-actions&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.520.1">    &lt;/v-card&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.521.1">  &lt;/v-col&gt;</span></strong><span class="koboSpan" id="kobo.522.1">
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.523.1">In the template, we’ve </span><a id="_idIndexMarker221"/><span class="koboSpan" id="kobo.524.1">just added an emitter to emit the </span><strong class="source-inline"><span class="koboSpan" id="kobo.525.1">recipeRemoved</span></strong><span class="koboSpan" id="kobo.526.1"> event that provides the recipe and date as context. </span><span class="koboSpan" id="kobo.526.2">Here, we use Vuetify components to create a repeating card layout to show any recipes that are added for </span><span class="No-Break"><span class="koboSpan" id="kobo.527.1">that day.</span></span></p>
<p><span class="koboSpan" id="kobo.528.1">As you can see, we also provide a link to the details page of the recipe, so we need to build one! </span><span class="koboSpan" id="kobo.528.2">But before we do that, let’s take a look at our app at this point. </span><span class="koboSpan" id="kobo.528.3">You should be able to use the app interface to show several upcoming days. </span><span class="koboSpan" id="kobo.528.4">When selecting a date, we can search for a recipe using the Spoonacular API and add one or more recipes to our meal planner. </span><span class="koboSpan" id="kobo.528.5">We can also remove recipes from our </span><span class="No-Break"><span class="koboSpan" id="kobo.529.1">meal planner.</span></span></p>
<p><span class="koboSpan" id="kobo.530.1">We are not saving </span><a id="_idIndexMarker222"/><span class="koboSpan" id="kobo.531.1">anything yet, which means that refreshing the browser or navigating to a different page empties the meal planner! </span><span class="koboSpan" id="kobo.531.2">That’s something we will work on in the next chapter, but before we do that, we must add the cooking instructions to a </span><span class="No-Break"><span class="koboSpan" id="kobo.532.1">separate route.</span></span></p>
<p><span class="koboSpan" id="kobo.533.1">Let’s create a </span><strong class="source-inline"><span class="koboSpan" id="kobo.534.1">CookingInstructions.vue</span></strong><span class="koboSpan" id="kobo.535.1"> component in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.536.1">components</span></strong><span class="koboSpan" id="kobo.537.1"> folder with the </span><span class="No-Break"><span class="koboSpan" id="kobo.538.1">following contents:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.539.1">
&lt;script setup lang="ts"&gt;import { ref, onMounted } from "vue";
import type { Ref } from "vue";
import type { Recipe } from "@/types/spoonacular";
import { useRecipeInformation } from "@/composables/recipeApi";
import AppLoader from "./AppLoader.vue";
const props = defineProps({
  id: {
    type: Number,
    required: true,
  },
  activePanel: {
    type: Number,
    default: 0,
  },
});
const recipe: Ref&lt;Recipe | null&gt; = ref(null);
const getRecipeDetails = async (id: number): Promise&lt;void&gt; =&gt; {
  const data = (await useRecipeInformation(id.toString())) as Recipe;
  recipe.value = data;
};
const panel = ref&lt;number | null&gt;(1);
onMounted(() =&gt; {
  getRecipeDetails(props.activePanel);
});
&lt;/script&gt;
&lt;template&gt;
  &lt;AppLoader v-if="!recipe" /&gt;
  &lt;v-container v-else fluid&gt;
    &lt;v-col&gt;
      &lt;v-img height="200" :src="recipe.image" cover v-if="recipe.image" /&gt;
      &lt;h1 class="text-h3 ma-4"&gt;{{ recipe.title }}&lt;/h1&gt;
      &lt;v-chip
        class="ma-2 my-4"
        color="primary"
        :key="cuisine"
        v-for="cuisine in recipe.cuisines"
      &gt;
        {{ cuisine }}
      &lt;/v-chip&gt;
      &lt;v-expansion-panels variant="accordion" v-model="panel"&gt;
        &lt;v-expansion-panel&gt;
          &lt;v-expansion-panel-title class="text-h5"
            &gt;Summary&lt;/v-expansion-panel-title
          &gt;
          &lt;v-expansion-panel-text&gt;
            &lt;div v-html="recipe.summary" class="text-body-1"&gt;&lt;/div&gt;
          &lt;/v-expansion-panel-text&gt;
        &lt;/v-expansion-panel&gt;
        &lt;v-expansion-panel&gt;
          &lt;v-expansion-panel-title class="text-h5"
            &gt;Instructions&lt;/v-expansion-panel-title
          &gt;
          &lt;v-expansion-panel-text&gt;
            &lt;div v-html="recipe.instructions" class="text-body-1"&gt;&lt;/div&gt;
          &lt;/v-expansion-panel-text&gt;
        &lt;/v-expansion-panel&gt;
      &lt;/v-expansion-panels&gt;
    &lt;/v-col&gt;
  &lt;/v-container&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.540.1">Note that we are </span><a id="_idIndexMarker223"/><span class="koboSpan" id="kobo.541.1">using our </span><strong class="source-inline"><span class="koboSpan" id="kobo.542.1">AppLoader</span></strong><span class="koboSpan" id="kobo.543.1"> component because the contents will come directly from the API. </span><span class="koboSpan" id="kobo.543.2">Other than that, most of the layout uses Vuetify components to display the details coming from </span><span class="No-Break"><span class="koboSpan" id="kobo.544.1">the endpoint.</span></span></p>
<p><span class="koboSpan" id="kobo.545.1">Next, we’ll create the view to load this component. </span><span class="koboSpan" id="kobo.545.2">In the </span><strong class="source-inline"><span class="koboSpan" id="kobo.546.1">views</span></strong><span class="koboSpan" id="kobo.547.1"> folder, we’ll create a </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.548.1">RecipeView.vue</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.549.1"> file:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.550.1">
&lt;script setup lang="ts"&gt;import { useRouter } from "vue-router";
import CookingInstructions from "@/components/CookingInstructions.vue";
const router = useRouter();
const recipeId = Number(router.currentRoute.value.params.id);
&lt;/script&gt;
&lt;template&gt;
  &lt;cooking-instructions :id="recipeId" :active-panel="1" /&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.551.1">Let’s add it to </span><a id="_idIndexMarker224"/><span class="koboSpan" id="kobo.552.1">the router (</span><strong class="source-inline"><span class="koboSpan" id="kobo.553.1">src/router/index.ts</span></strong><span class="koboSpan" id="kobo.554.1">) with a new entry, using </span><strong class="source-inline"><span class="koboSpan" id="kobo.555.1">id</span></strong><span class="koboSpan" id="kobo.556.1"> as </span><span class="No-Break"><span class="koboSpan" id="kobo.557.1">a parameter:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.558.1">
import { createRouter, createWebHistory } from 'vue-router'const routes = [
  {
    path: '/',
    component: () =&gt; import('@/layouts/default/Default.vue'),
    children: [
      {
        path: '',
        name: 'Home',
        // route level code-splitting
        // this generates a separate chunk (about.[hash].js) for this route
        // which is lazy-loaded when the route is visited.
</span><span class="koboSpan" id="kobo.558.2">        component: () =&gt; import(/* webpackChunkName: "home" */ '@/views/Home.vue'),
      },
      {
        path: 'recipes',
        name: 'recipes',
        component: () =&gt; import('@/views/RecipesView.vue')
      },
</span><strong class="bold"><span class="koboSpan" id="kobo.559.1">      {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.560.1">        path: '/recipe/:id',</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.561.1">        name: 'recipe',</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.562.1">        component: () =&gt; import('../views/RecipeView.vue')</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.563.1">      }</span></strong><span class="koboSpan" id="kobo.564.1">
    ],
  },
]
const router = createRouter({
  history: createWebHistory(process.env.BASE_URL),
  routes,
})
export default router</span></pre>
<p><span class="koboSpan" id="kobo.565.1">That’s it for this </span><a id="_idIndexMarker225"/><span class="koboSpan" id="kobo.566.1">section. </span><span class="koboSpan" id="kobo.566.2">While we have some functionality, it isn’t usable because our data is not persistent. </span><span class="koboSpan" id="kobo.566.3">We need to build a stateful application. </span><span class="koboSpan" id="kobo.566.4">And since managing state can be tedious to do by hand, we’ll make use of Pinia to help us </span><span class="No-Break"><span class="koboSpan" id="kobo.567.1">with that!</span></span></p>
<p><span class="koboSpan" id="kobo.568.1">You may have noticed that, by using Vuetify components, we have less logic in our application to deal with the state of the user interface. </span><span class="koboSpan" id="kobo.568.2">Our </span><strong class="source-inline"><span class="koboSpan" id="kobo.569.1">script</span></strong><span class="koboSpan" id="kobo.570.1"> tags now contain mostly functions that are tied to the features of </span><span class="No-Break"><span class="koboSpan" id="kobo.571.1">the application.</span></span></p>
<p><span class="koboSpan" id="kobo.572.1">This is one of the benefits of using a component library in your application: you can focus on the specific features rather than on building i</span><a id="_idTextAnchor147"/><span class="koboSpan" id="kobo.573.1">nteractive user </span><span class="No-Break"><span class="koboSpan" id="kobo.574.1">interface elements.</span></span></p>
<h1 id="_idParaDest-97"><a id="_idTextAnchor148"/><span class="koboSpan" id="kobo.575.1">Using Pinia for state management</span></h1>
<p><span class="koboSpan" id="kobo.576.1">In this section, we’ll</span><a id="_idIndexMarker226"/><span class="koboSpan" id="kobo.577.1"> focus on</span><a id="_idIndexMarker227"/><span class="koboSpan" id="kobo.578.1"> making our application stateful using Pinia. </span><span class="koboSpan" id="kobo.578.2">This means we will have to refactor existing code, optimize certain flows, and</span><a id="_idTextAnchor149"/><span class="koboSpan" id="kobo.579.1"> add new features to </span><span class="No-Break"><span class="koboSpan" id="kobo.580.1">our application.</span></span></p>
<h2 id="_idParaDest-98"><a id="_idTextAnchor150"/><span class="koboSpan" id="kobo.581.1">Stateful applications</span></h2>
<p><span class="koboSpan" id="kobo.582.1">We use the term </span><em class="italic"><span class="koboSpan" id="kobo.583.1">stateful applications</span></em><span class="koboSpan" id="kobo.584.1"> to </span><a id="_idIndexMarker228"/><span class="koboSpan" id="kobo.585.1">describe applications that can use, save, and persist data for a certain amount of time. </span><span class="koboSpan" id="kobo.585.2">A state can be temporary (while a session lasts) or of a more permanent nature when stored in </span><span class="No-Break"><span class="koboSpan" id="kobo.586.1">a database.</span></span></p>
<p><span class="koboSpan" id="kobo.587.1">The state is contextual to the current user and is typically not shared between users. </span><span class="koboSpan" id="kobo.587.2">In short, it is representative of the current user's sta</span><a id="_idTextAnchor151"/><span class="koboSpan" id="kobo.588.1">te of interacting with </span><span class="No-Break"><span class="koboSpan" id="kobo.589.1">an application.</span></span></p>
<h2 id="_idParaDest-99"><a id="_idTextAnchor152"/><span class="koboSpan" id="kobo.590.1">Adding Pinia</span></h2>
<p><strong class="bold"><span class="koboSpan" id="kobo.591.1">Pinia</span></strong><span class="koboSpan" id="kobo.592.1"> is a </span><a id="_idIndexMarker229"/><span class="koboSpan" id="kobo.593.1">framework </span><a id="_idIndexMarker230"/><span class="koboSpan" id="kobo.594.1">for managing states</span><a id="_idIndexMarker231"/><span class="koboSpan" id="kobo.595.1"> of applications built using Vue.js 3. </span><span class="koboSpan" id="kobo.595.2">It aims to facilitate sharing and interacting with a state or store by leveraging composables and </span><span class="No-Break"><span class="koboSpan" id="kobo.596.1">simple syntax.</span></span></p>
<p><span class="koboSpan" id="kobo.597.1">Let’s add Pinia to our project by installing it using the </span><span class="No-Break"><span class="koboSpan" id="kobo.598.1">command line:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.599.1">
npm install pinia</span></pre> <p><span class="koboSpan" id="kobo.600.1">Next, we need to </span><a id="_idIndexMarker232"/><span class="koboSpan" id="kobo.601.1">create our Pinia instance and pass it to the app as a plugin. </span><span class="koboSpan" id="kobo.601.2">Open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.602.1">main.ts</span></strong><span class="koboSpan" id="kobo.603.1"> file</span><a id="_idIndexMarker233"/><span class="koboSpan" id="kobo.604.1"> to make the </span><span class="No-Break"><span class="koboSpan" id="kobo.605.1">following changes:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.606.1">
/** * main.ts
 *
 * Bootstraps Vuetify and other plugins then mounts the App
 */
// Components
import App from './App.vue'
</span><strong class="bold"><span class="koboSpan" id="kobo.607.1">// Pinia</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.608.1">import { createPinia } from 'pinia'</span></strong><span class="koboSpan" id="kobo.609.1">
// Composables
import { createApp } from 'vue'
// Plugins
import { registerPlugins } from '@/plugins'
</span><strong class="bold"><span class="koboSpan" id="kobo.610.1">const pinia = createPinia()</span></strong><span class="koboSpan" id="kobo.611.1">
const app = createApp(App)
registerPlugins(app)
</span><strong class="bold"><span class="koboSpan" id="kobo.612.1">app.use(pinia)</span></strong><span class="koboSpan" id="kobo.613.1">
app.mount('#app')</span></pre>
<p><span class="koboSpan" id="kobo.614.1">That’s it! </span><span class="koboSpan" id="kobo.614.2">We</span><a id="_idIndexMarker234"/><span class="koboSpan" id="kobo.615.1"> can now cre</span><a id="_idTextAnchor153"/><span class="koboSpan" id="kobo.616.1">ate our stores and make</span><a id="_idIndexMarker235"/><span class="koboSpan" id="kobo.617.1"> our app </span><span class="No-Break"><span class="koboSpan" id="kobo.618.1">even better.</span></span></p>
<h2 id="_idParaDest-100"><a id="_idTextAnchor154"/><span class="koboSpan" id="kobo.619.1">The first store</span></h2>
<p><span class="koboSpan" id="kobo.620.1">We’ll start</span><a id="_idIndexMarker236"/><span class="koboSpan" id="kobo.621.1"> with something small. </span><span class="koboSpan" id="kobo.621.2">If you’ve opened the cooking instructions for a recipe, you may have noticed the loading indicator. </span><span class="koboSpan" id="kobo.621.3">That’s because the data is coming from an external API. </span><span class="koboSpan" id="kobo.621.4">If you refresh the page, you will notice that you have to wait for data to load again. </span><span class="koboSpan" id="kobo.621.5">You can see it in the </span><strong class="bold"><span class="koboSpan" id="kobo.622.1">Network</span></strong><span class="koboSpan" id="kobo.623.1"> tab of your developer tools as well. </span><span class="koboSpan" id="kobo.623.2">We can use a store to at least cache requests once they’ve been resolved, to prevent additional requests to the same resource and improve the performance of </span><span class="No-Break"><span class="koboSpan" id="kobo.624.1">the app.</span></span></p>
<p><span class="koboSpan" id="kobo.625.1">For stores, we’ll create a folder called </span><strong class="source-inline"><span class="koboSpan" id="kobo.626.1">stores</span></strong><span class="koboSpan" id="kobo.627.1"> in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.628.1">src</span></strong><span class="koboSpan" id="kobo.629.1"> folder. </span><span class="koboSpan" id="kobo.629.2">Let’s add a </span><strong class="source-inline"><span class="koboSpan" id="kobo.630.1">cache</span></strong><span class="koboSpan" id="kobo.631.1"> folder and create an </span><strong class="source-inline"><span class="koboSpan" id="kobo.632.1">index.ts</span></strong><span class="koboSpan" id="kobo.633.1"> file. </span><span class="koboSpan" id="kobo.633.2">In this file, we’ll use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.634.1">defineStore</span></strong><span class="koboSpan" id="kobo.635.1"> method to create a store called </span><strong class="source-inline"><span class="koboSpan" id="kobo.636.1">cache</span></strong><span class="koboSpan" id="kobo.637.1"> (the names need to </span><span class="No-Break"><span class="koboSpan" id="kobo.638.1">be unique):</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.639.1">
import { defineStore } from "pinia";export const useCacheStore = defineStore('cache', () =&gt; {
    return { }
});</span></pre>
<p><span class="koboSpan" id="kobo.640.1">This is how you define any store – we use composable use notation. </span><span class="koboSpan" id="kobo.640.2">The composable consists of a (now empty) object that we will complement with the functions we want to expose. </span><span class="koboSpan" id="kobo.640.3">We need a function to cache data and one to return cached data, which will look </span><span class="No-Break"><span class="koboSpan" id="kobo.641.1">like this:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.642.1">
import { defineStore } from "pinia";export const useCacheStore = defineStore('cache', () =&gt; {
</span><strong class="bold"><span class="koboSpan" id="kobo.643.1">    const cachedData = (): void =&gt; {}</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.644.1">    const cacheData = (): void =&gt; {}</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.645.1">    return { cachedData, cacheData }</span></strong><span class="koboSpan" id="kobo.646.1">
});</span></pre>
<p><span class="koboSpan" id="kobo.647.1">We can define </span><a id="_idIndexMarker237"/><span class="koboSpan" id="kobo.648.1">functions and choose which functions we want to return. </span><span class="koboSpan" id="kobo.648.2">In this case, we’ll return both of </span><span class="No-Break"><span class="koboSpan" id="kobo.649.1">the functions.</span></span></p>
<p><span class="koboSpan" id="kobo.650.1">In our store, we can use native functions from Vue, such as </span><strong class="source-inline"><span class="koboSpan" id="kobo.651.1">reactivity</span></strong><span class="koboSpan" id="kobo.652.1">! </span><span class="koboSpan" id="kobo.652.2">We’ll define a constant named </span><strong class="source-inline"><span class="koboSpan" id="kobo.653.1">cache</span></strong><span class="koboSpan" id="kobo.654.1"> and, using both of our functions, read from the cache or add data to </span><span class="No-Break"><span class="koboSpan" id="kobo.655.1">the cache:</span></span></p>
<pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.656.1">import { ref } from "vue";</span></strong><span class="koboSpan" id="kobo.657.1">import { defineStore } from "pinia";
export const useCacheStore = defineStore('cache', () =&gt; {
 </span><strong class="bold"><span class="koboSpan" id="kobo.658.1">   const cache = ref&lt;any&gt;([]);</span></strong><span class="koboSpan" id="kobo.659.1">
    const cachedData = (</span><strong class="bold"><span class="koboSpan" id="kobo.660.1">key: string</span></strong><span class="koboSpan" id="kobo.661.1">)</span><strong class="bold"><span class="koboSpan" id="kobo.662.1">: any</span></strong><span class="koboSpan" id="kobo.663.1"> =&gt; {
</span><strong class="bold"><span class="koboSpan" id="kobo.664.1">        try {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.665.1">            return cache.value[key]</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.666.1">        } catch (e) {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.667.1">            return undefined;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.668.1">        }</span></strong><span class="koboSpan" id="kobo.669.1">
    }
    const cacheData = (</span><strong class="bold"><span class="koboSpan" id="kobo.670.1">key: string, data: any</span></strong><span class="koboSpan" id="kobo.671.1">): void =&gt; {
</span><strong class="bold"><span class="koboSpan" id="kobo.672.1">        cache.value[key] = data</span></strong><span class="koboSpan" id="kobo.673.1">
    }
    return { cachedData, cacheData }
});</span></pre>
<p><span class="koboSpan" id="kobo.674.1">Now, this is a </span><a id="_idIndexMarker238"/><span class="koboSpan" id="kobo.675.1">very simplistic design, but for our purposes, it works. </span><span class="koboSpan" id="kobo.675.2">Let’s see how we can implement this in our </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.676.1">CookingInstructions.vue</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.677.1"> component.</span></span></p>
<p><span class="koboSpan" id="kobo.678.1">In our </span><strong class="source-inline"><span class="koboSpan" id="kobo.679.1">script</span></strong><span class="koboSpan" id="kobo.680.1"> tag, we need to import the cache store and initialize the store on a </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.681.1">store</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.682.1"> constant:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.683.1">
import { useCacheStore } from "@/stores/cache";const store = useCacheStore();</span></pre>
<p><span class="koboSpan" id="kobo.684.1">That’s all we need to do to use the methods in our store. </span><span class="koboSpan" id="kobo.684.2">Now, we’ll modify the </span><strong class="source-inline"><span class="koboSpan" id="kobo.685.1">getRecipeDetails</span></strong><span class="koboSpan" id="kobo.686.1"> function so that it only uses the external API if no data is found on the cache by the unique key </span><span class="No-Break"><span class="koboSpan" id="kobo.687.1">per response:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.688.1">
&lt;script setup lang="ts"&gt;import { ref, onMounted } from "vue";
import type { Ref } from "vue";
import type { Recipe } from "@/types/spoonacular";
import { useRecipeInformation } from "@/composables/recipeApi";
import AppLoader from "./AppLoader.vue";
</span><strong class="bold"><span class="koboSpan" id="kobo.689.1">import { useCacheStore } from "@/stores/cache";</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.690.1">const store = useCacheStore();</span></strong><span class="koboSpan" id="kobo.691.1">
const props = defineProps({
  id: {
    type: Number,
    required: true,
  },
});
const recipe: Ref&lt;Recipe | null&gt; = ref(null);
const getRecipeDetails = async (id: number): Promise&lt;void&gt; =&gt; {
</span><strong class="bold"><span class="koboSpan" id="kobo.692.1">  const cacheKey = recipe-details-${props.id};</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.693.1">  if (store.cachedData(cacheKey)) {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.694.1">    recipe.value = store.cachedData(cacheKey) as Recipe;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.695.1">  } else {</span></strong><span class="koboSpan" id="kobo.696.1">
    const data = (await useRecipeInformation(id.toString())) as Recipe;
</span><strong class="bold"><span class="koboSpan" id="kobo.697.1">    store.cacheData(cacheKey, data);</span></strong><span class="koboSpan" id="kobo.698.1">
    recipe.value = data;
</span><strong class="bold"><span class="koboSpan" id="kobo.699.1">  }</span></strong><span class="koboSpan" id="kobo.700.1">
};
const panel = ref&lt;number | null&gt;(1);
onMounted(() =&gt; {
  getRecipeDetails(props.id);
});
&lt;/script&gt;</span></pre>
<p><span class="koboSpan" id="kobo.701.1">The cache is </span><a id="_idIndexMarker239"/><span class="koboSpan" id="kobo.702.1">not stored on the user’s machine but stored in the session of the Vue application. </span><span class="koboSpan" id="kobo.702.2">On refresh, the data will be lost, but when navigating backward or forward in the app, the cache will be available. </span><span class="koboSpan" id="kobo.702.3">When the data is stored on a unique identifier, and using the store, we can reach the contents of the store from anywhere within the </span><span class="No-Break"><span class="koboSpan" id="kobo.703.1">Vue.js application.</span></span></p>
<p><span class="koboSpan" id="kobo.704.1">Do you remember the incomplete features of the meal planner? </span><span class="koboSpan" id="kobo.704.2">Let’s build a sto</span><a id="_idTextAnchor155"/><span class="koboSpan" id="kobo.705.1">re to centralize the way we manage </span><span class="No-Break"><span class="koboSpan" id="kobo.706.1">those recipes.</span></span></p>
<h2 id="_idParaDest-101"><a id="_idTextAnchor156"/><span class="koboSpan" id="kobo.707.1">The meal planner store</span></h2>
<p><span class="koboSpan" id="kobo.708.1">In this </span><a id="_idIndexMarker240"/><span class="koboSpan" id="kobo.709.1">section, we’ll create a dedicated store for our meal planner capabilities. </span><span class="koboSpan" id="kobo.709.2">So, create a folder called </span><strong class="source-inline"><span class="koboSpan" id="kobo.710.1">planner</span></strong><span class="koboSpan" id="kobo.711.1"> in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.712.1">stores</span></strong><span class="koboSpan" id="kobo.713.1"> folder and create an </span><strong class="source-inline"><span class="koboSpan" id="kobo.714.1">index.ts</span></strong><span class="koboSpan" id="kobo.715.1"> file where we’ll define </span><span class="No-Break"><span class="koboSpan" id="kobo.716.1">our store:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.717.1">
import { defineStore } from "pinia";export const usePlannerStore = defineStore('planner', () =&gt; {
})</span></pre>
<p><span class="koboSpan" id="kobo.718.1">We’re going to add some functions to interact with recipes. </span><span class="koboSpan" id="kobo.718.2">In this case, we would like persistence so that the information is stored for longer periods. </span><span class="koboSpan" id="kobo.718.3">We’ll use the </span><strong class="source-inline"><span class="koboSpan" id="kobo.719.1">useLocalStorage</span></strong><span class="koboSpan" id="kobo.720.1"> composable from </span><strong class="source-inline"><span class="koboSpan" id="kobo.721.1">VueUse</span></strong><span class="koboSpan" id="kobo.722.1"> by installing the dependency in </span><span class="No-Break"><span class="koboSpan" id="kobo.723.1">our project:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.724.1">
npm install @vueuse/core</span></pre> <p><span class="koboSpan" id="kobo.725.1">We want our planner to be persistent (and reactive), so let’s add that </span><span class="No-Break"><span class="koboSpan" id="kobo.726.1">functionality first:</span></span></p>
<pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.727.1">import { ref } from "vue";</span></strong><span class="koboSpan" id="kobo.728.1">import { defineStore } from "pinia";
</span><strong class="bold"><span class="koboSpan" id="kobo.729.1">import { useLocalStorage } from "@vueuse/core"</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.730.1">interface Recipe {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.731.1">    id: number;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.732.1">    date: Date;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.733.1">}</span></strong><span class="koboSpan" id="kobo.734.1">
export const usePlannerStore = defineStore('planner', () =&gt; {
</span><strong class="bold"><span class="koboSpan" id="kobo.735.1">    const recipes = ref&lt;Recipe[] | any&gt;(useLocalStorage('planner', []));</span></strong><span class="koboSpan" id="kobo.736.1">
    return { </span><strong class="bold"><span class="koboSpan" id="kobo.737.1">recipes</span></strong><span class="koboSpan" id="kobo.738.1"> }
})</span></pre>
<p><span class="koboSpan" id="kobo.739.1">When</span><a id="_idIndexMarker241"/><span class="koboSpan" id="kobo.740.1"> using the store, we can access the recipes from anywhere by accessing the store and requesting the recipes. </span><span class="koboSpan" id="kobo.740.2">We’ll add two more methods, for adding and </span><span class="No-Break"><span class="koboSpan" id="kobo.741.1">removing recipes:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.742.1">
import { ref } from "vue";import { defineStore } from "pinia";
import { useLocalStorage } from "@vueuse/core"
interface Recipe {
    id: number;
    date: Date;
}
export const usePlannerStore = defineStore('planner', () =&gt; {
    const recipes = ref&lt;Recipe[] | any&gt;(useLocalStorage('planner', []));
</span><strong class="bold"><span class="koboSpan" id="kobo.743.1">    const addRecipe = (recipe: Recipe) =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.744.1">        recipes.value.push(recipe)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.745.1">    }</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.746.1">    const removeRecipeByIdDate = (options: { id: number, date: Date }) =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.747.1">        const { id, date } = options;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.748.1">        const recipeIndex: number = recipes.value.findIndex((recipe: Recipe) =&gt; recipe.id === id &amp;&amp; new Date(recipe.date).setHours(0, 0, 0, 0) === new Date(date).setHours(0, 0, 0, 0))</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.749.1">        recipes.value.splice(recipeIndex, 1)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.750.1">    }</span></strong><span class="koboSpan" id="kobo.751.1">
    return { recipes</span><strong class="bold"><span class="koboSpan" id="kobo.752.1">, addRecipe, removeRecipeByIdDate</span></strong><span class="koboSpan" id="kobo.753.1"> }
})</span></pre>
<p><span class="koboSpan" id="kobo.754.1">With this in </span><a id="_idIndexMarker242"/><span class="koboSpan" id="kobo.755.1">place, we can retrieve the recipes in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.756.1">MealPlanner.vue</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.757.1"> file:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.758.1">
&lt;script setup lang="ts"&gt;</span><strong class="bold"><span class="koboSpan" id="kobo.759.1">import { storeToRefs } from "pinia";</span></strong><span class="koboSpan" id="kobo.760.1">
import CalendarDays from "./CalendarDays.vue";
</span><strong class="bold"><span class="koboSpan" id="kobo.761.1">import { usePlannerStore } from "@/stores/planner";</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.762.1">const store = usePlannerStore();</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.763.1">const { recipes } = storeToRefs(store);</span></strong><span class="koboSpan" id="kobo.764.1">
&lt;/script&gt;
&lt;template&gt;
  &lt;calendar-days
    :date="new Date()"
    :days="7"
   </span><strong class="bold"><span class="koboSpan" id="kobo.765.1"> :recipes="recipes"</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.766.1">    :key="recipes-${recipes.length}"</span></strong><span class="koboSpan" id="kobo.767.1">
  /&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.768.1">Using </span><strong class="source-inline"><span class="koboSpan" id="kobo.769.1">storeToRefs</span></strong><span class="koboSpan" id="kobo.770.1"> from </span><a id="_idIndexMarker243"/><span class="koboSpan" id="kobo.771.1">Pinia ensures that the values from our store are automatically converted into reactive properties! </span><span class="koboSpan" id="kobo.771.2">We’re passing the recipes down to </span><strong class="source-inline"><span class="koboSpan" id="kobo.772.1">CalendarDays.vue</span></strong><span class="koboSpan" id="kobo.773.1">, so let’s continue with </span><span class="No-Break"><span class="koboSpan" id="kobo.774.1">the implementation.</span></span></p>
<p><span class="koboSpan" id="kobo.775.1">Now, in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.776.1">CalendarDays.vue</span></strong><span class="koboSpan" id="kobo.777.1"> component, we’re receiving the recipes as a property, but we’ll also make sure we can add and remove recipes from the planner. </span><span class="koboSpan" id="kobo.777.2">First, we’ll focus on processing the recipes by adding the property definition and updating the </span><strong class="source-inline"><span class="koboSpan" id="kobo.778.1">generateCards</span></strong><span class="koboSpan" id="kobo.779.1"> function, where we’ll map the recipes to each </span><span class="No-Break"><span class="koboSpan" id="kobo.780.1">generated day:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.781.1">
const props = defineProps({  date: {
    type: Date,
    required: true,
  },
  days: {
    type: Number,
    required: false,
    default: 7,
  },
</span><strong class="bold"><span class="koboSpan" id="kobo.782.1">  recipes: {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.783.1">    type: Array,</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.784.1">    required: false,</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.785.1">    value: [],</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.786.1">  },</span></strong><span class="koboSpan" id="kobo.787.1">
});
const generateCards = (startDate: Date, numberOfDays: number): Card[] =&gt; {
  const cards: Card[] = [];
  const currentDate = new Date(startDate);
  for (let i = 0; i &lt; numberOfDays; i++) {
    const date = new Date(currentDate.getTime());
    const content = Card ${i + 1};
</span><strong class="bold"><span class="koboSpan" id="kobo.788.1">    const recipesThisDay = props.recipes?.filter((recipe: any) =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.789.1">      const recipeDate = new Date(recipe.date).setHours(0, 0, 0, 0);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.790.1">      return recipeDate === date.setHours(0, 0, 0, 0);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.791.1">    }) as Today[];</span></strong><span class="koboSpan" id="kobo.792.1">
    cards.push({ date, content, today: </span><strong class="bold"><span class="koboSpan" id="kobo.793.1">recipesThisDay</span></strong><span class="koboSpan" id="kobo.794.1"> });
    currentDate.setDate(currentDate.getDate() + 1);
  }
  return cards;
};</span></pre>
<p><span class="koboSpan" id="kobo.795.1">We can’t see</span><a id="_idIndexMarker244"/><span class="koboSpan" id="kobo.796.1"> it in action yet because we have no means of adding recipes to our store. </span><span class="koboSpan" id="kobo.796.2">Let’s add the store to the component and modify the </span><strong class="source-inline"><span class="koboSpan" id="kobo.797.1">insertRecipeOnDay</span></strong><span class="koboSpan" id="kobo.798.1"> function so that we can save the recipes in our </span><span class="No-Break"><span class="koboSpan" id="kobo.799.1">planner store:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.800.1">
const insertRecipeOnDay = (recipe: RecipeResults): void =&gt; {  if (dateSelected.value) {
</span><strong class="bold"><span class="koboSpan" id="kobo.801.1">    store.addRecipe({ ...recipe, date: dateSelected.value });</span></strong><span class="koboSpan" id="kobo.802.1">
    recipeDialogClose();
  }
};</span></pre>
<p><span class="koboSpan" id="kobo.803.1">If you open the app and add a recipe to a date, it gets added just as before, with the difference that on refresh, the item </span><span class="No-Break"><span class="koboSpan" id="kobo.804.1">is preserved!</span></span></p>
<p><span class="koboSpan" id="kobo.805.1">Now, we can do something nifty using our cache store: we can preload the data to the cache to speed up the user experience when opening the cooking instructions after adding them. </span><span class="koboSpan" id="kobo.805.2">With our stores combined, it’s just a couple </span><span class="No-Break"><span class="koboSpan" id="kobo.806.1">of lines.</span></span></p>
<p><span class="koboSpan" id="kobo.807.1">We’ll import the cache store and, using the predetermined key, load the information and write it to the cache store. </span><span class="koboSpan" id="kobo.807.2">I tend to move the store references to the top of the file so that I can quickly glance over the capabilities that a component has at </span><span class="No-Break"><span class="koboSpan" id="kobo.808.1">its disposal:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.809.1">
&lt;script setup lang="ts"&gt;import { ref } from "vue";
import type { Ref } from "vue";
import type { </span><strong class="bold"><span class="koboSpan" id="kobo.810.1">Recipe</span></strong><span class="koboSpan" id="kobo.811.1">, RecipeResults } from "@/types/spoonacular";
</span><strong class="bold"><span class="koboSpan" id="kobo.812.1">import { useRecipeInformation } from "@/composables/recipeApi";</span></strong><span class="koboSpan" id="kobo.813.1">
import { usePlannerStore } from "@/stores/planner";
const store = usePlannerStore();
</span><strong class="bold"><span class="koboSpan" id="kobo.814.1">import { useCacheStore } from "@/stores/cache";</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.815.1">const cacheStore = useCacheStore();</span></strong><span class="koboSpan" id="kobo.816.1">
// …abbreviated
</span><strong class="bold"><span class="koboSpan" id="kobo.817.1">const preloadRecipe = async (id: number): Promise&lt;void&gt; =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.818.1">  const cacheKey = recipe-details-${id};</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.819.1">  if (!cacheStore.cachedData(cacheKey)) {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.820.1">    const data = (await useRecipeInformation(id.toString())) as Recipe;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.821.1">    cacheStore.cacheData(cacheKey, data);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.822.1">  }</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.823.1">};</span></strong><span class="koboSpan" id="kobo.824.1">
const insertRecipeOnDay = (recipe: RecipeResults): void =&gt; {
  if (dateSelected.value) {
</span><strong class="bold"><span class="koboSpan" id="kobo.825.1">    preloadRecipe(recipe.id);</span></strong><span class="koboSpan" id="kobo.826.1">
    store.addRecipe({ ...recipe, date: dateSelected.value });
    recipeDialogClose();
  }
};
// …abbreviated
&lt;/script&gt;</span></pre>
<p><span class="koboSpan" id="kobo.827.1">Now, if you’ve </span><a id="_idIndexMarker245"/><span class="koboSpan" id="kobo.828.1">selected a recipe, if you visit the cooking instructions, you’ll notice that the content is there instantly! </span><span class="koboSpan" id="kobo.828.2">The added value of this approach depends on a couple of factors. </span><span class="koboSpan" id="kobo.828.3">If we expect that, on average, users want to navigate to a detailed view after adding a recipe, it makes </span><span class="No-Break"><span class="koboSpan" id="kobo.829.1">perfect sense.</span></span></p>
<p><span class="koboSpan" id="kobo.830.1">In other cases, it only adds an additional API call. </span><span class="koboSpan" id="kobo.830.2">So, use this pattern only when needed. </span><span class="koboSpan" id="kobo.830.3">In our case, it serves as a demonstration of using the cache store from multiple entry points in </span><span class="No-Break"><span class="koboSpan" id="kobo.831.1">our application.</span></span></p>
<p><span class="koboSpan" id="kobo.832.1">We have to make sure that we can remove the recipe as well. </span><span class="koboSpan" id="kobo.832.2">We’re going to apply that logic to the card that holds the recipe. </span><span class="koboSpan" id="kobo.832.3">We don’t have to centralize these functions since we have the store to take care of this for us! </span><span class="koboSpan" id="kobo.832.4">Therefore, we can remove the </span><strong class="source-inline"><span class="koboSpan" id="kobo.833.1">removeRecipeFromDay</span></strong><span class="koboSpan" id="kobo.834.1"> method (highlighted in the following code) from the </span><strong class="source-inline"><span class="koboSpan" id="kobo.835.1">CalendarDays</span></strong><span class="koboSpan" id="kobo.836.1"> component, as well as the event listener in </span><span class="No-Break"><span class="koboSpan" id="kobo.837.1">the template:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.838.1">
&lt;calendar-card  :card="card"
  @daySelected="recipeDialogOpen"
</span><strong class="bold"><span class="koboSpan" id="kobo.839.1">  @recipeRemoved="removeRecipeFromDay"</span></strong><span class="koboSpan" id="kobo.840.1">
/&gt;</span></pre>
<p><span class="koboSpan" id="kobo.841.1">Now, we can zoom in on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.842.1">CalendarCard.vue</span></strong><span class="koboSpan" id="kobo.843.1"> component to add the ability to remove </span><a id="_idIndexMarker246"/><span class="koboSpan" id="kobo.844.1">recipes to/from this component. </span><span class="koboSpan" id="kobo.844.2">We’ll start by removing the </span><strong class="source-inline"><span class="koboSpan" id="kobo.845.1">recipeRemoved</span></strong><span class="koboSpan" id="kobo.846.1"> event (highlighted in the following code) </span><span class="No-Break"><span class="koboSpan" id="kobo.847.1">and function:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.848.1">
const emits = defineEmits(["daySelected", </span><strong class="bold"><span class="koboSpan" id="kobo.849.1">"recipeRemoved"</span></strong><span class="koboSpan" id="kobo.850.1">]);// …abbreviated
</span><strong class="bold"><span class="koboSpan" id="kobo.851.1">const recipeRemoved = (recipe: Today, date: Date): void =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.852.1">  emits("recipeRemoved", recipe, date);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.853.1">};</span></strong></pre>
<p><span class="koboSpan" id="kobo.854.1">We’ll create a new function after importing the planner store in this component. </span><span class="koboSpan" id="kobo.854.2">In the function, we’ll call </span><strong class="source-inline"><span class="koboSpan" id="kobo.855.1">removeRecipeByIdDate</span></strong><span class="koboSpan" id="kobo.856.1"> from the store and pass the </span><span class="No-Break"><span class="koboSpan" id="kobo.857.1">current context:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.858.1">
&lt;script setup lang="ts"&gt;import { useFormatDate } from "@/composables/formatters";
const emits = defineEmits(["daySelected"]);
</span><strong class="bold"><span class="koboSpan" id="kobo.859.1">import { usePlannerStore } from "@/stores/planner";</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.860.1">const store = usePlannerStore();</span></strong><span class="koboSpan" id="kobo.861.1">
import AppLink from "./AppLink.vue";
interface Today {
  id: number;
  title: string;
  readyInMinutes: number;
}
interface Card {
  date: Date;
  today: Today[];
}
const props = defineProps&lt;{
  card: Card;
}&gt;();
const addRecipeToDay = (card: Card): void =&gt; {
  emits("daySelected", card);
};
</span><strong class="bold"><span class="koboSpan" id="kobo.862.1">const removeFromDay = (recipes: { id: number; date: Date }): void =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.863.1">  const { id, date } = recipes;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.864.1">  store.removeRecipeByIdDate({ id, date });</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.865.1">};</span></strong><span class="koboSpan" id="kobo.866.1">
&lt;/script&gt;</span></pre>
<p><span class="koboSpan" id="kobo.867.1">In the template, we’ll </span><a id="_idIndexMarker247"/><span class="koboSpan" id="kobo.868.1">modify the removal button by calling the new function with the </span><span class="No-Break"><span class="koboSpan" id="kobo.869.1">correct parameters:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.870.1">
&lt;v-card-actions&gt;  &lt;v-spacer&gt;&lt;/v-spacer&gt;
  &lt;v-btn
    text
    icon="mdi-trash-can-outline"
</span><strong class="bold"><span class="koboSpan" id="kobo.871.1">    @click="removeFromDay({ id: today.id, date: card.date })"</span></strong><span class="koboSpan" id="kobo.872.1">
  &gt;&lt;/v-btn&gt;
&lt;/v-card-actions&gt;</span></pre>
<p><span class="koboSpan" id="kobo.873.1">With this, we</span><a id="_idIndexMarker248"/><span class="koboSpan" id="kobo.874.1"> can document and use actions in places that make sense within the context of the app. </span><span class="koboSpan" id="kobo.874.2">With the store, we’ve created a central state where we can access and manipulate different components without needing to pass properties from one component to the next. </span><span class="koboSpan" id="kobo.874.3">Having a library such as Pinia integrated with the Vue environment makes it a straightforward choice since it can fully</span><a id="_idTextAnchor157"/><span class="koboSpan" id="kobo.875.1"> leverage the reactive capabilities of Vue out of </span><span class="No-Break"><span class="koboSpan" id="kobo.876.1">the box!</span></span></p>
<h2 id="_idParaDest-102"><a id="_idTextAnchor158"/><span class="koboSpan" id="kobo.877.1">Computed store values</span></h2>
<p><span class="koboSpan" id="kobo.878.1">To stress </span><a id="_idIndexMarker249"/><span class="koboSpan" id="kobo.879.1">the reusability aspect, we will finally take a look at </span><strong class="source-inline"><span class="koboSpan" id="kobo.880.1">RecipesList.vue</span></strong><span class="koboSpan" id="kobo.881.1">, which we’ve filled with static content. </span><span class="koboSpan" id="kobo.881.2">Since the meal planner only shows the upcoming few days, we may want to show the full extent of past and future </span><span class="No-Break"><span class="koboSpan" id="kobo.882.1">planned recipes.</span></span></p>
<p><span class="koboSpan" id="kobo.883.1">We have two tabs in </span><strong class="source-inline"><span class="koboSpan" id="kobo.884.1">RecipesList</span></strong><span class="koboSpan" id="kobo.885.1"> – one for showing upcoming recipes and one for past recipes. </span><span class="koboSpan" id="kobo.885.2">While we could ingest all the recipes from the store and apply some sorting with a centralized store, it makes more sense to handle it close to </span><span class="No-Break"><span class="koboSpan" id="kobo.886.1">the source.</span></span></p>
<p><span class="koboSpan" id="kobo.887.1">We can use computed values in stores, just like Vue components! </span><span class="koboSpan" id="kobo.887.2">To display them, we’ll internally sort the recipes and provide </span><span class="No-Break"><span class="koboSpan" id="kobo.888.1">two values:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.889.1">
import { ref, </span><strong class="bold"><span class="koboSpan" id="kobo.890.1">computed</span></strong><span class="koboSpan" id="kobo.891.1"> } from "vue";import { defineStore } from "pinia";
import { useLocalStorage } from "@vueuse/core"
</span><strong class="bold"><span class="koboSpan" id="kobo.892.1">import type { Recipe } from "@/types/spoonacular";</span></strong><span class="koboSpan" id="kobo.893.1">
interface RecipeList extends Recipe {
    date: Date;
}
export const usePlannerStore = defineStore('planner', () =&gt; {
    const recipes = ref&lt;Recipe[] | any&gt;(useLocalStorage('planner', []));
</span><strong class="bold"><span class="koboSpan" id="kobo.894.1">    const recipesSortedByDate = () =&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.895.1">        recipes.value.sort((a: { date : Date }, b: { date: Date }) =&gt; new Date(a.date).getTime() &lt; new Date(b.date).getTime() ? </span><span class="koboSpan" id="kobo.895.2">-1 : 1)</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.896.1">    const pastRecipes = computed(() =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.897.1">        const sorted = recipesSortedByDate();</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.898.1">        return sorted.filter((recipe: RecipeList) =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.899.1">            const date = new Date(recipe.date);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.900.1">            return date &lt; new Date();</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.901.1">        }) as RecipeList[]</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.902.1">    })</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.903.1">    const futureRecipes = computed(() =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.904.1">        const sorted = recipesSortedByDate();</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.905.1">        return sorted.filter((recipe: RecipeList) =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.906.1">            const date = new Date(recipe.date);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.907.1">            return date &gt;= new Date();</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.908.1">        }) as RecipeList[];</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.909.1">    })</span></strong><span class="koboSpan" id="kobo.910.1">
    const addRecipe = (recipe: Recipe) =&gt; {
        console.log('addRecipe', recipe)
        recipes.value.push(recipe)
    }
    const removeRecipeByIdDate = (options: { id: number, date: Date }) =&gt; {
        const { id, date } = options;
        const recipeIndex: number = recipes.value.findIndex((recipe: Recipe) =&gt; recipe.id === id &amp;&amp; new Date(recipe.date).setHours(0, 0, 0, 0) === new Date(date).setHours(0, 0, 0, 0))
        recipes.value.splice(recipeIndex, 1)
    }
    return { recipes, </span><strong class="bold"><span class="koboSpan" id="kobo.911.1">pastRecipes</span></strong><span class="koboSpan" id="kobo.912.1">, </span><strong class="bold"><span class="koboSpan" id="kobo.913.1">futureRecipes</span></strong><span class="koboSpan" id="kobo.914.1">, addRecipe, removeRecipeByIdDate }
});</span></pre>
<p><span class="koboSpan" id="kobo.915.1">As I </span><a id="_idIndexMarker250"/><span class="koboSpan" id="kobo.916.1">mentioned earlier, it is perfectly fine to have non-exposed methods in our store. </span><span class="koboSpan" id="kobo.916.2">With the final </span><strong class="source-inline"><span class="koboSpan" id="kobo.917.1">return</span></strong><span class="koboSpan" id="kobo.918.1"> statement, we can decide what methods to expose on the module. </span><span class="koboSpan" id="kobo.918.2">The functions are nothing extraordinary. </span><span class="koboSpan" id="kobo.918.3">After sorting by date, they filter and return dates from the past </span><span class="No-Break"><span class="koboSpan" id="kobo.919.1">or future.</span></span></p>
<p><span class="koboSpan" id="kobo.920.1">Let’s connect the dates to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.921.1">RecipesList.vue</span></strong><span class="koboSpan" id="kobo.922.1"> component. </span><span class="koboSpan" id="kobo.922.2">We will focus on the </span><strong class="source-inline"><span class="koboSpan" id="kobo.923.1">script</span></strong><span class="koboSpan" id="kobo.924.1"> tag since we built the interface previously. </span><span class="koboSpan" id="kobo.924.2">We’ll remove the highlighted parts from the </span><a id="_idIndexMarker251"/><span class="No-Break"><span class="koboSpan" id="kobo.925.1">following code:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.926.1">
&lt;script setup lang="ts"&gt;import { ref, </span><strong class="bold"><span class="koboSpan" id="kobo.927.1">computed</span></strong><span class="koboSpan" id="kobo.928.1">, onMounted } from "vue";
import type { Ref } from "vue";
</span><strong class="bold"><span class="koboSpan" id="kobo.929.1">import { storeToRefs } from "pinia";</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.930.1">import type { Recipe } from "@/types/spoonacular";</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.931.1">interface RecipeList extends Recipe {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.932.1">  date: Date;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.933.1">}</span></strong><span class="koboSpan" id="kobo.934.1">
import RecipeTable from "./RecipeTable.vue";
</span><strong class="bold"><span class="koboSpan" id="kobo.935.1">const { pastRecipes, futureRecipes } = storeToRefs(store);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.936.1">// return a date in the future:</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.937.1">const addDays = (days: number): Date =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.938.1">  const date = new Date();</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.939.1">  date.setDate(date.getDate() + days);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.940.1">  return date;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.941.1">};</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.942.1">// generate some mock data for now:</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.943.1">const recipes = [</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.944.1">  { id: 1, title: "test", date: addDays(1) },</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.945.1">  { id: 2, title: "test2", date: addDays(1) },</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.946.1">  { id: 2, title: "test3", date: addDays(-1) },</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.947.1">];</span></strong><span class="koboSpan" id="kobo.948.1">
const openPreview = (recipe: { title: string }): void =&gt; {
  console.log(`opening recipe ${recipe.title}`);
};
</span><strong class="bold"><span class="koboSpan" id="kobo.949.1">const pastRecipes = computed(() =&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.950.1">  recipes.filter((recipe: RecipeList) =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.951.1">    const date = new Date(recipe.date);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.952.1">    return date &lt; new Date();</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.953.1">  })</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.954.1">);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.955.1">const futureRecipes = computed(</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.956.1">  () =&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.957.1">    recipes.filter((recipe: RecipeList) =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.958.1">      const date = new Date(recipe.date);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.959.1">      return date &gt;= new Date();</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.960.1">    }) as RecipeList[]</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.961.1">);</span></strong><span class="koboSpan" id="kobo.962.1">
const tab: Ref&lt;string&gt; = ref("upcoming");
onMounted(() =&gt; {
  if (futureRecipes.</span><strong class="bold"><span class="koboSpan" id="kobo.963.1">value.</span></strong><span class="koboSpan" id="kobo.964.1">length === 0) {
    tab.value = "past";
  }
});
&lt;/script&gt;</span></pre>
<p><span class="koboSpan" id="kobo.965.1">Without</span><a id="_idIndexMarker252"/><span class="koboSpan" id="kobo.966.1"> the mockup code, it looks a lot more readable already! </span><span class="koboSpan" id="kobo.966.2">We’ll also connect the </span><strong class="source-inline"><span class="koboSpan" id="kobo.967.1">openPreview</span></strong><span class="koboSpan" id="kobo.968.1"> event to another dialog. </span><span class="koboSpan" id="kobo.968.2">We’ll just reuse the existing </span><strong class="source-inline"><span class="koboSpan" id="kobo.969.1">CookingInstructions.vue</span></strong><span class="koboSpan" id="kobo.970.1"> component, but you could also consider creating a specific preview of </span><span class="No-Break"><span class="koboSpan" id="kobo.971.1">your own.</span></span></p>
<p><span class="koboSpan" id="kobo.972.1">Let’s change the </span><strong class="source-inline"><span class="koboSpan" id="kobo.973.1">script</span></strong><span class="koboSpan" id="kobo.974.1"> tag so that it matches </span><span class="No-Break"><span class="koboSpan" id="kobo.975.1">the following:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.976.1">
&lt;script setup lang="ts"&gt;import { ref, onMounted } from "vue";
import type { Ref } from "vue";
import { storeToRefs } from "pinia";
</span><strong class="bold"><span class="koboSpan" id="kobo.977.1">import type { Recipe } from "@/types/spoonacular";</span></strong><span class="koboSpan" id="kobo.978.1">
import { usePlannerStore } from "@/stores/planner";
const store = usePlannerStore();
import RecipeTable from "./RecipeTable.vue";
</span><strong class="bold"><span class="koboSpan" id="kobo.979.1">import CookingInstructions from "./CookingInstructions.vue";</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.980.1">import AppLink from "./AppLink.vue";</span></strong><span class="koboSpan" id="kobo.981.1">
const { pastRecipes, futureRecipes } = storeToRefs(store);
</span><strong class="bold"><span class="koboSpan" id="kobo.982.1">const dialogVisible: Ref&lt;boolean&gt; = ref(false);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.983.1">const selectedRecipe: Ref&lt;Recipe | null&gt; = ref(null);</span></strong><span class="koboSpan" id="kobo.984.1">
const openPreview = (</span><strong class="bold"><span class="koboSpan" id="kobo.985.1">recipe: Recipe</span></strong><span class="koboSpan" id="kobo.986.1">): void =&gt; {
</span><strong class="bold"><span class="koboSpan" id="kobo.987.1">  selectedRecipe.value = recipe;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.988.1">  dialogVisible.value = true;</span></strong><span class="koboSpan" id="kobo.989.1">
};
const tab: Ref&lt;string&gt; = ref("upcoming");
onMounted(() =&gt; {
  if (futureRecipes.length === 0) {
    tab.value = "past";
  }
});
&lt;/script&gt;</span></pre>
<p><span class="koboSpan" id="kobo.990.1">Then, we’ll add a</span><a id="_idIndexMarker253"/><span class="koboSpan" id="kobo.991.1"> dialog from Vuetify to the template code to </span><span class="No-Break"><span class="koboSpan" id="kobo.992.1">show </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.993.1">CookingInstructions</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.994.1">:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.995.1">
&lt;template&gt;  &lt;div v-if="pastRecipes.length === 0 &amp;&amp; futureRecipes.length === 0"&gt;
    No recipes yet. </span><span class="koboSpan" id="kobo.995.2">Add some to your planner!
</span><span class="koboSpan" id="kobo.995.3">  &lt;/div&gt;
  &lt;div v-else&gt;
   &lt;!-- abbreviated -–&gt;
    &lt;/v-window&gt;
 </span><strong class="bold"><span class="koboSpan" id="kobo.996.1">   &lt;v-dialog v-model="dialogVisible" class="dialog" scrollable&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.997.1">      &lt;v-card v-if="selectedRecipe"&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.998.1">        &lt;cooking-instructions :id="selectedRecipe.id" /&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.999.1">        &lt;v-card-actions&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1000.1">          &lt;v-btn text&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1001.1">            &lt;app-link :to="/recipe/${selectedRecipe.id}"</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1002.1">              &gt;Cooking instructions&lt;/app-link</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1003.1">            &gt;&lt;/v-btn</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1004.1">          &gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1005.1">          &lt;v-spacer /&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1006.1">          &lt;v-btn @click="dialogVisible = false" icon="mdi-close"&gt;&lt;/v-btn&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1007.1">        &lt;/v-card-actions&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1008.1">      &lt;/v-card&gt;</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1009.1">    &lt;/v-dialog&gt;</span></strong><span class="koboSpan" id="kobo.1010.1">
  &lt;/div&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.1011.1">With this in place, navigating </span><a id="_idIndexMarker254"/><span class="koboSpan" id="kobo.1012.1">from the preview to the Cooking instructions page is almost instant again since we’re caching the contents and only have to load them on the first request. </span><span class="koboSpan" id="kobo.1012.2">Using the store, we can interact with the date in a centralized and reusable way. </span><span class="koboSpan" id="kobo.1012.3">Let</span><a id="_idTextAnchor159"/><span class="koboSpan" id="kobo.1013.1">’s try and solidify this by adding a final component to </span><span class="No-Break"><span class="koboSpan" id="kobo.1014.1">our app.</span></span></p>
<h3><span class="koboSpan" id="kobo.1015.1">Rating the recipes</span></h3>
<p><span class="koboSpan" id="kobo.1016.1">As a final addition, we’ll demonstrate the reusability of composables by adding a rating feature to </span><a id="_idIndexMarker255"/><span class="koboSpan" id="kobo.1017.1">every recipe. </span><span class="koboSpan" id="kobo.1017.2">It will store the recipe ID and a rating of 1 through 5 stars. </span><span class="koboSpan" id="kobo.1017.3">We should be able to read and update the rating from anywhere in </span><span class="No-Break"><span class="koboSpan" id="kobo.1018.1">the application.</span></span></p>
<p><span class="koboSpan" id="kobo.1019.1">First, we’ll create the store. </span><span class="koboSpan" id="kobo.1019.2">For that, we’ll add a folder called </span><strong class="source-inline"><span class="koboSpan" id="kobo.1020.1">rating</span></strong><span class="koboSpan" id="kobo.1021.1"> with the following contents in the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.1022.1">index.ts</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.1023.1"> file:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1024.1">
import { ref } from "vue";import { defineStore } from "pinia";
import { useLocalStorage } from "@vueuse/core"
interface Rating {
    id: number;
    rating: number;
}
export const useRatingStore = defineStore('rating', () =&gt; {
    const ratings = ref&lt;Rating[] | any&gt;(useLocalStorage('rating', []));
    const getRatingById = (id: number) =&gt; {
        const rating = ratings.value.find((rating: Rating) =&gt; rating.id === id)
        return rating?.rating;
    }
    const saveRating = (rating: Rating) =&gt; {
        const ratingIndex = ratings.value.findIndex((r: Rating) =&gt; r.id === rating.id)
        if (ratingIndex === -1) {
            ratings.value.push(rating)
        } else {
            ratings.value[ratingIndex] = rating
        }
    }
    return { getRatingById, saveRating }
})</span></pre>
<p><span class="koboSpan" id="kobo.1025.1">Now, we’ll create</span><a id="_idIndexMarker256"/><span class="koboSpan" id="kobo.1026.1"> a component called </span><strong class="source-inline"><span class="koboSpan" id="kobo.1027.1">RecipeRating.vue</span></strong><span class="koboSpan" id="kobo.1028.1">. </span><span class="koboSpan" id="kobo.1028.2">It will use the rating store and, based on a provided ID, retrieve any ratings for that ID. </span><span class="koboSpan" id="kobo.1028.3">It will also allow you to add a new rating for that particular ID, overwriting the </span><span class="No-Break"><span class="koboSpan" id="kobo.1029.1">old value.</span></span></p>
<p><span class="koboSpan" id="kobo.1030.1">Vuetify has a premade component for this, so when we’re combining stores and a component library, we can quickly build </span><span class="No-Break"><span class="koboSpan" id="kobo.1031.1">interactive components:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1032.1">
&lt;script setup lang="ts"&gt;import { ref } from "vue";
import type { Ref } from "vue";
</span><strong class="bold"><span class="koboSpan" id="kobo.1033.1">import { useRatingStore } from "@/stores/modules/rating";</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1034.1">const store = useRatingStore();</span></strong><span class="koboSpan" id="kobo.1035.1">
const props = defineProps&lt;{
  id: number;
  readonly?: boolean;
}&gt;();
</span><strong class="bold"><span class="koboSpan" id="kobo.1036.1">const rating: Ref&lt;number&gt; = ref(store.getRatingById(props.id));</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1037.1">const saveRating = () =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1038.1">  store.saveRating({id: props.id, rating: rating.value});</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.1039.1">};</span></strong><span class="koboSpan" id="kobo.1040.1">
&lt;/script&gt;
&lt;template&gt;
  &lt;div class="flex items-center"&gt;
    &lt;v-rating
      v-model="rating"
      color="light-green"
      :readonly="readonly"
      half-increments
      item-aria-label="This item is rated {0} of {1}"
      hover
      </span><strong class="bold"><span class="koboSpan" id="kobo.1041.1">@click="saveRating"</span></strong><span class="koboSpan" id="kobo.1042.1">
    &gt;&lt;/v-rating&gt;
  &lt;/div&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.1043.1">The</span><a id="_idIndexMarker257"/><span class="koboSpan" id="kobo.1044.1"> important parts are highlighted, although you should be familiar with them by now. </span><span class="koboSpan" id="kobo.1044.2">We can add this component anywhere in our application where we have access to a </span><span class="No-Break"><span class="koboSpan" id="kobo.1045.1">recipe ID.</span></span></p>
<p><span class="koboSpan" id="kobo.1046.1">Let’s start with </span><strong class="source-inline"><span class="koboSpan" id="kobo.1047.1">CookingInstructions.vue</span></strong><span class="koboSpan" id="kobo.1048.1">. </span><span class="koboSpan" id="kobo.1048.2">We need to import the component and then add it to </span><span class="No-Break"><span class="koboSpan" id="kobo.1049.1">our template:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.1050.1">
&lt;script setup lang="ts"&gt;// …abbreviated
import AppLoader from "./AppLoader.vue";
</span><strong class="bold"><span class="koboSpan" id="kobo.1051.1">import RecipeRating from "./RecipeRating.vue";</span></strong><span class="koboSpan" id="kobo.1052.1">
// …abbreviated
&lt;/script&gt;
&lt;template&gt;
  &lt;app-loader v-if="!recipe" /&gt;
  &lt;v-container v-else fluid&gt;
    &lt;v-col&gt;
      &lt;v-img height="200" :src="recipe.image" cover v-if="recipe.image" /&gt;
      &lt;h1 class="text-h3 ma-4"&gt;{{ recipe.title }}&lt;/h1&gt;
</span><strong class="bold"><span class="koboSpan" id="kobo.1053.1">      &lt;recipe-rating :id="recipe.id" /&gt;</span></strong><span class="koboSpan" id="kobo.1054.1">
      &lt;!-- abbreviated --&gt;
    &lt;/v-col&gt;
  &lt;/v-container&gt;
&lt;/template&gt;</span></pre>
<p><span class="koboSpan" id="kobo.1055.1">Feel free to add the </span><strong class="source-inline"><span class="koboSpan" id="kobo.1056.1">rating</span></strong><span class="koboSpan" id="kobo.1057.1"> component on other mentions as well. </span><span class="koboSpan" id="kobo.1057.2">It’s just two lines </span><span class="No-Break"><span class="koboSpan" id="kobo.1058.1">of code!</span></span></p>
<p><span class="koboSpan" id="kobo.1059.1">With that, we’ve </span><a id="_idIndexMarker258"/><span class="koboSpan" id="kobo.1060.1">iterated over our Marvel app by utilizing a component library to speed up development time. </span><span class="koboSpan" id="kobo.1060.2">It allows us to build interfaces with relative ease. </span><span class="koboSpan" id="kobo.1060.3">We’ve also refactored and updated our code since our needs hav</span><a id="_idTextAnchor160"/><span class="koboSpan" id="kobo.1061.1">e changed. </span><span class="koboSpan" id="kobo.1061.2">This situation reflects how real-world code </span><span class="No-Break"><span class="koboSpan" id="kobo.1062.1">bases evolve.</span></span></p>
<h1 id="_idParaDest-103"><a id="_idTextAnchor161"/><span class="koboSpan" id="kobo.1063.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.1064.1">In this chapter, we combined two concepts to build an application that scales well in development. </span><span class="koboSpan" id="kobo.1064.2">As we’ve seen, by adopting more and more of the principles of both the component library as well as a centralized store, the more readable and simplified our </span><span class="No-Break"><span class="koboSpan" id="kobo.1065.1">code becomes.</span></span></p>
<p><span class="koboSpan" id="kobo.1066.1">Using a component library such as Vuetify provides us with a quick way of adding interactive elements to a user interface that are well tested and easy to use out of the box. </span><span class="koboSpan" id="kobo.1066.2">Coming with means of customization and theming, we can make sure that our implementation follows any </span><span class="No-Break"><span class="koboSpan" id="kobo.1067.1">style guide.</span></span></p>
<p><span class="koboSpan" id="kobo.1068.1">This would be a good time to try your hand at customizing the user interface, either by setting up themes and styles or just by using the classes and properties on </span><span class="No-Break"><span class="koboSpan" id="kobo.1069.1">existing components.</span></span></p>
<p><span class="koboSpan" id="kobo.1070.1">By adding state to our app, we’ve made it usable and reusable for our users. </span><span class="koboSpan" id="kobo.1070.2">In our example, we’ve stored our data in the browser, which isn’t as portable. </span><span class="koboSpan" id="kobo.1070.3">However, it does give us a practical look at dealing with data and caching resources. </span><span class="koboSpan" id="kobo.1070.4">With the methods in a central place, it becomes easier to refactor the way we would </span><span class="No-Break"><span class="koboSpan" id="kobo.1071.1">store data.</span></span></p>
<p><span class="koboSpan" id="kobo.1072.1">We’ve deliberately not built a perfect app from the beginning and instead demonstrated how a refactoring process evolves with the needs and features of app development. </span><span class="koboSpan" id="kobo.1072.2">Admittedly, it’s still not perfect at this point. </span><span class="koboSpan" id="kobo.1072.3">As an extra exercise, you could try and see whether you can apply some of the lessons we’ve learned </span><span class="No-Break"><span class="koboSpan" id="kobo.1073.1">so far.</span></span></p>
<p><span class="koboSpan" id="kobo.1074.1">In the next chapter, we’ll solidify our Vuetify knowledge by building another application using the component library. </span><span class="koboSpan" id="kobo.1074.2">We’ll make things more interesting by building a data resource. </span><span class="koboSpan" id="kobo.1074.3">We’ll learn about not just reading from an endpoint but also writing and storing data by building a simple </span><span class="No-Break"><span class="koboSpan" id="kobo.1075.1">fitness tracker!</span></span></p>
</div>
</body></html>
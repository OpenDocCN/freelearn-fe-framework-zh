<html><head></head><body>
		<div id="_idContainer079">
			<h1 id="_idParaDest-164"><em class="italic"><a id="_idTextAnchor166"/>Chapter 13</em>: Internationalization and Localization </h1>
			<p>This chapter is all about opening your site up to an international audience. We will talk about patterns you can use to make translating your site as it scales simple! Creating your site in English makes it accessible to the 1.3 billion people in the world who speak the language. However, if we provide users with localization options, we can translate the site into any language, therefore making our site accessible to all. </p>
			<p>In this chapter, we will cover the following topics:</p>
			<ul>
				<li>Understanding localization and internationalization</li>
				<li>Implementing routes for internationalization</li>
				<li>Page translations for programmatic pages</li>
				<li>Providing locale translations for single-instance pages</li>
			</ul>
			<h1 id="_idParaDest-165"><a id="_idTextAnchor167"/>Technical requirements</h1>
			<p>To navigate this chapter, you will need to have completed <a href="B15983_12_ePub_RK.xhtml#_idTextAnchor159"><em class="italic">Chapter 12</em></a><em class="italic">, Using Real-Time Data</em>.</p>
			<p>The code present in this chapter can be found at <a href="https://github.com/PacktPublishing/Elevating-React-Web-Development-with-Gatsby-3/tree/main/Chapter13">https://github.com/PacktPublishing/Elevating-React-Web-Development-with-Gatsby-3/tree/main/Chapter13</a>.</p>
			<h1 id="_idParaDest-166"><a id="_idTextAnchor168"/>Understanding localization and internationalization</h1>
			<p>While the end goal of this chapter is to set up localization, we can make things easier by implementing internationalization first. The terms localization and internationalization are often confused, so let's define these terms properly: </p>
			<ul>
				<li><strong class="bold">Internationalization</strong>: The process of ensuring that your website is created in such a way that it can <a id="_idIndexMarker649"/>support different languages, locales, and cultures. Internationalization is all about being proactive in your site's design and development to ensure that you don't have to completely redesign it later when you introduce it to a new market. This could include allowing text to be displayed from right to left as well as left to right, for example.</li>
				<li><strong class="bold">Localization</strong>: Normally conducted after internationalization, localization is the process of adapting <a id="_idIndexMarker650"/>your site to meet a new locale requirement. This could be adding a language or cultural requirement.</li>
			</ul>
			<p>By spending the time upfront to get the internationalization right within the project, you can save yourself considerable time when you need to add a new locale later down the line. Let's now look at how we can modify our project with an internationalization strategy.</p>
			<h1 id="_idParaDest-167"><a id="_idTextAnchor169"/>Implementing routes for internationalization</h1>
			<p>A common approach for large sites to accommodate localization is to prefix all paths with a language <a id="_idIndexMarker651"/>code. Let's take our about page, for <a id="_idIndexMarker652"/>example – the English (and default) language version of the page is located at <strong class="source-inline">/about</strong> but the French version of the page might be located at <strong class="source-inline">/fr/about</strong> and the German version of it at <strong class="source-inline">/de/about</strong>.</p>
			<p>Let's implement this pattern now for our default language of English and add French as a secondary language. We can make this easy with the help of <strong class="source-inline">gatsby-theme-i18n</strong>:</p>
			<ol>
				<li>Install the new dependencies:<p class="source-code">npm install gatsby-theme-i18n gatsby-plugin-react-</p><p class="source-code">helmet react-helmet</p><p>Here we are installing the <strong class="source-inline">gatsby-theme-i18n</strong> package and its dependencies. This package automatically creates the route prefixes for us. It also adds <strong class="source-inline">language</strong> and <strong class="source-inline">alternate</strong> tags to the head of document. This helps Google identify that two pages contain the same content in different languages.</p><p class="callout-heading">Important Note</p><p class="callout">This theme uses <strong class="source-inline">react-helmet</strong>, which may clash with <strong class="source-inline">react-helmet-async</strong>, a package we have used in other chapters. Be sure to check that the head of your document is set up as intended when using both, and if you experience issues stick to a single package.</p></li>
				<li>Include the <strong class="source-inline">gatsby-theme-i18n</strong> plugin in your <strong class="source-inline">gatsby-config.js</strong> file:<p class="source-code">{</p><p class="source-code">      resolve: 'gatsby-theme-i18n',</p><p class="source-code">      options: {</p><p class="source-code">        defaultLang: 'en',</p><p class="source-code">        configPath:</p><p class="source-code">          require.resolve('./i18n/config.json'),</p><p class="source-code">      },</p><p class="source-code">    },</p><p>As part of this configuration, we add a couple of options. <strong class="source-inline">defaultLang</strong> refers to the default <a id="_idIndexMarker653"/>language we will use on <a id="_idIndexMarker654"/>the site – in this case, this is English, so we use the language code <strong class="source-inline">en</strong>. <strong class="source-inline">configPath</strong> is the configuration path to where we will set up <strong class="source-inline">i18n</strong>. This is most commonly in its own folder, which we will create in the next step.</p></li>
				<li>Create a folder in your root directory called <strong class="source-inline">i18n</strong>.</li>
				<li>Create a new file inside the <strong class="source-inline">i18n</strong> folder called <strong class="source-inline">config.json</strong>, and add the following:<p class="source-code">[</p><p class="source-code">    {</p><p class="source-code">      "code": "en",</p><p class="source-code">      "hrefLang": "en-US",</p><p class="source-code">      "name": "English",</p><p class="source-code">      "localName": "English",</p><p class="source-code">      "langDir": "ltr",</p><p class="source-code">      "dateFormat": "MM/DD/YYYY"</p><p class="source-code">    },</p><p class="source-code">    {</p><p class="source-code">      "code": "fr",</p><p class="source-code">      "hrefLang": "fr-FR",</p><p class="source-code">      "name": "French",</p><p class="source-code">      "localName": "Francais",</p><p class="source-code">      "langDir": "ltr",</p><p class="source-code">      "dateFormat": "DD/MM/YYYY"</p><p class="source-code">    }</p><p class="source-code">  ]</p><p>Here it is important that we define a configuration for every locale we intend to support. Each configuration object must contain the following:</p><p>a. <strong class="source-inline">code</strong>: This refers to the language's code you will use to access this locale. Though you can <a id="_idIndexMarker655"/>set this to whatever you <a id="_idIndexMarker656"/>want for each language, it is probably best to keep them easily identifiable, for example, <strong class="source-inline">fr</strong> for French and <strong class="source-inline">en</strong> for English.</p><p>b. <strong class="source-inline">hrefLang</strong>: This is the value that is used for the <strong class="source-inline">hrefLang</strong> tag attribute in the head of the HTML. It is used to tell Google which language you are using on a specific page. </p><p>c. <strong class="source-inline">name</strong>: The name of the language in the native language of the developer.</p><p>d. <strong class="source-inline">localName</strong>: This is how the name of the language is spelled by its native speakers. </p><p>e. <strong class="source-inline">langDir</strong>: This is the direction that text is read in the given locale. This could be <strong class="source-inline">ltr</strong> for left-to-right text or <strong class="source-inline">rtl</strong> for right-to-left text.</p><p>f. <strong class="source-inline">dateFormat</strong>: This is the date format used within the locale.</p><p class="callout-heading">Quick Tip</p><p class="callout">When adding locales later on, this is the only file that needs to be updated to create the required routes for the locale.</p></li>
				<li>Finally replace <a id="_idIndexMarker657"/>instances of the Gatsby <strong class="source-inline">Link</strong> component <a id="_idIndexMarker658"/>on your site with the <strong class="source-inline">LocalizedLink</strong> component from <strong class="source-inline">gatbsy-theme-i18n</strong>:<p class="source-code"><strong class="bold">import { LocalizedLink } from "gatsby-theme-i18n";</strong></p><p class="source-code">import React from "react";</p><p class="source-code">const Footer = () =&gt; {</p><p class="source-code">  return (</p><p class="source-code">    &lt;footer className="px-2 border-t w-full max-w-5xl</p><p class="source-code">      mx-auto py-4"&gt;</p><p class="source-code">      &lt;div className="flex justify-between w-full"&gt;</p><p class="source-code">        &lt;div className="flex flex-col justify-center</p><p class="source-code">         items-end space-y-1"&gt;</p><p class="source-code">          &lt;p&gt;Your name here.&lt;/p&gt;</p><p class="source-code">          <strong class="bold">&lt;LocalizedLink to="/" language="en"</strong></p><p class="source-code"><strong class="bold">            className="text-blue-400 text-xs"&gt;</strong></p><p class="source-code"><strong class="bold">            English</strong></p><p class="source-code"><strong class="bold">          &lt;/LocalizedLink&gt;</strong></p><p class="source-code"><strong class="bold">          &lt;LocalizedLink to="/" language="fr"</strong></p><p class="source-code"><strong class="bold">             className="text-blue-400 text-xs"&gt;</strong></p><p class="source-code"><strong class="bold">            Francais</strong></p><p class="source-code"><strong class="bold">          &lt;/LocalizedLink&gt;</strong></p><p class="source-code">        &lt;/div&gt;</p><p class="source-code">      &lt;/div&gt;</p><p class="source-code">    &lt;/footer&gt;</p><p class="source-code">  );</p><p class="source-code">};</p><p class="source-code">export default Footer;</p><p><strong class="source-inline">LocalizedLink</strong> is a component that extends the <strong class="source-inline">Link</strong> component with a <strong class="source-inline">language</strong> prop. By specifying a language's <strong class="source-inline">code</strong> (from the <strong class="source-inline">i18n/config.json</strong> file), we route the user to the corresponding page in that specific <a id="_idIndexMarker659"/>language. If no language is <a id="_idIndexMarker660"/>specified, it will keep the user in their currently active locale. In the preceding example code, we have modified the footer to include links to the index page for both English and French visitors. This will allow site visitors to switch between the locales on any page.</p></li>
				<li>Let's verify the previous steps. First, start your Gatsby development server's GraphQL layer (normally located at <strong class="source-inline">http://localhost:8000/_graphql</strong>) and run the following query:<p class="source-code">query MyQuery {</p><p class="source-code">  allSitePage {</p><p class="source-code">    nodes {</p><p class="source-code">      path</p><p class="source-code">    }</p><p class="source-code">  }</p><p class="source-code">}</p><p>In the <a id="_idIndexMarker661"/>returned data object, you <a id="_idIndexMarker662"/>should be able to see nodes with paths for all locales:</p><p class="source-code">{</p><p class="source-code">  "data": {</p><p class="source-code">    "allSitePage": {</p><p class="source-code">      "nodes": [</p><p class="source-code">        {</p><p class="source-code">          "path": <strong class="bold">"/</strong>"</p><p class="source-code">        },</p><p class="source-code">        {</p><p class="source-code">          "path": "<strong class="bold">/fr/</strong> "</p><p class="source-code">        },</p><p class="source-code">        {</p><p class="source-code">          "path": <strong class="bold">"/blog</strong>"</p><p class="source-code">        },</p><p class="source-code">        {</p><p class="source-code">          "path": "<strong class="bold">/fr/blog</strong>"</p><p class="source-code">        },</p><p class="source-code">        // Continued list</p><p class="source-code">      ]</p><p class="source-code">    }</p><p class="source-code">  },</p><p class="source-code">  "extensions": {}</p><p class="source-code">}</p></li>
				<li>Finally, navigate <a id="_idIndexMarker663"/>to your Gatsby <a id="_idIndexMarker664"/>development site. Your footer should now contain links to the two languages:</li>
			</ol>
			<div>
				<div id="_idContainer074" class="IMG---Figure">
					<img src="image/Figure_13.01_B15983.jpg" alt="Figure 13.1 – Site footer with language toggle&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.1 – Site footer with language toggle</p>
			<p>Clicking <strong class="bold">French</strong> should route you to <strong class="source-inline">/fr/</strong> and clicking <strong class="bold">English</strong> should route you back to <strong class="source-inline">/</strong>.</p>
			<p>Now that we have set up our pages for different locales, let's ensure that we have language-appropriate content to display on these pages. Let's start by looking at pages generated programmatically.</p>
			<h1 id="_idParaDest-168"><a id="_idTextAnchor170"/>Page translations for programmatic pages</h1>
			<p>To be able to offer pages such as articles and blog posts translated, we will need to provide the content <a id="_idIndexMarker665"/>in both languages. Let's look at how we structure our project so that posts in different languages are available to the site visitor.  </p>
			<p><strong class="source-inline">gatsby-theme-i18n</strong> comes with built-in support for handling <strong class="bold">MDX</strong> content (a format you can read more about in <a href="B15983_03_ePub_RK.xhtml#_idTextAnchor057"><em class="italic">Chapter 3</em></a><em class="italic">, Sourcing and Querying Data (from Anywhere!)</em>). If you are using Markdown files, this will also work for you. Just ensure that the <strong class="source-inline">gatsby-plugin-mdx</strong> plugin is set up to treat <strong class="source-inline">.md</strong> files as <strong class="source-inline">.mdx</strong> by adding the extension to the plugin's configuration options:</p>
			<p class="source-code">   {</p>
			<p class="source-code">      resolve: 'gatsby-plugin-mdx',</p>
			<p class="source-code">      options: {</p>
			<p class="source-code">        extensions: ['.mdx', <strong class="bold">'.md'</strong>],</p>
			<p class="source-code">      },</p>
			<p class="source-code">    }</p>
			<p>I will be using the posts that are local files for this demo, but the same steps will work for CMS content once it is ingested to Gatsby's data layer:</p>
			<ol>
				<li value="1">First, we need to restructure our blog posts folder in a way that makes them easy to identify when we have duplicates in different languages. Instead of filenames, use folder <a id="_idIndexMarker666"/>names to group them. Inside <strong class="source-inline">/blog-posts</strong>, create a folder for each post. A good name format for these folders would be <strong class="source-inline">YYYY-mm-DD-Post-Title</strong>. This makes the folder sortable by date but also tells you what the post is about without you having to open the folder.</li>
				<li>Inside this folder, place the corresponding default language blog post and rename it to <strong class="source-inline">index.mdx</strong>. Be sure that the MDX file contains a <strong class="source-inline">slug</strong> in the frontmatter. An example might look like this:<p class="source-code">---</p><p class="source-code">type: Blog</p><p class="source-code">title: My First Hackathon Experience</p><p class="source-code">desc: This post is all about my learnings from my</p><p class="source-code">  first hackathon experience in London.</p><p class="source-code">date: 2020-06-20</p><p class="source-code">hero: ../../../assets/images/cover-1.jpeg</p><p class="source-code">tags: [hackathon, webdev, ux]</p><p class="source-code"><strong class="bold">slug: /my-first-post/</strong></p><p class="source-code">---</p><p class="source-code">My First Hackathon Experience was great!</p><p class="source-code">Rest of content...</p></li>
				<li>Repeat <em class="italic">Step 2</em> for every blog post you wish to add.</li>
				<li>Create a second file in this folder called <strong class="source-inline">index.fr.mdx</strong>. This file's name has the locale code added between the filename and extension. In this example, we are using France (French), so the locale code is <strong class="source-inline">fr</strong>. Replicate the <strong class="source-inline">index.mdx</strong> file's frontmatter <a id="_idIndexMarker667"/>in French by translating all the text values. The <strong class="source-inline">slug</strong>, <strong class="source-inline">type</strong>, <strong class="source-inline">hero</strong>, <strong class="source-inline">date</strong>, and <strong class="source-inline">tags</strong> must remain the same for both files. The resultant file for the example started in <em class="italic">Step 2</em> looks as follows:<p class="source-code">---</p><p class="source-code">type: Blog</p><p class="source-code"><strong class="bold">title: Ma première expérience de hackathon</strong></p><p class="source-code"><strong class="bold">desc: Ce post est tout sur mes apprentissages de ma</strong></p><p class="source-code"><strong class="bold">  première expérience de hackathon à Londres.</strong></p><p class="source-code">date: 2020-06-20</p><p class="source-code">hero: ../../../assets/images/cover-1.jpeg</p><p class="source-code">tags: [hackathon, webdev, ux]</p><p class="source-code">slug: /my-first-post/</p><p class="source-code">---</p><p class="source-code">Ma première expérience de hackathon était super !</p><p class="source-code">Rest of content...</p></li>
				<li>Repeat <em class="italic">Step 4</em> for any additional languages and locales you wish to support.</li>
				<li>Update your <strong class="source-inline">gatsby-node.js</strong> files' blog post page creation configuration with the following:<p class="source-code">exports.createPages = async ({ actions, graphql,</p><p class="source-code"> reporter }) =&gt; {</p><p class="source-code">  const { createPage } = actions;</p><p class="source-code">  const BlogPostTemplate =</p><p class="source-code">    path.resolve('./src/templates/blog-page.js');</p><p class="source-code">  const BlogPostQuery = await graphql('</p><p class="source-code">    {</p><p class="source-code">      allMdx(filter: { frontmatter: { type: { eq:</p><p class="source-code">        "Blog" } } }) {</p><p class="source-code">        nodes {</p><p class="source-code">          <strong class="bold">frontmatter {</strong></p><p class="source-code"><strong class="bold">            slug</strong></p><p class="source-code"><strong class="bold">          }</strong></p><p class="source-code">        }</p><p class="source-code">      }</p><p class="source-code">    }</p><p class="source-code">  ');</p><p class="source-code">  const BlogPosts = BlogPostQuery.data.allMdx.nodes;</p><p class="source-code">  BlogPosts.forEach(({ <strong class="bold">frontmatter: { slug }</strong> }) =&gt; {</p><p class="source-code">    createPage({</p><p class="source-code">      <strong class="bold">path: slug,</strong></p><p class="source-code">      component: BlogPostTemplate,</p><p class="source-code">      <strong class="bold">context: {</strong></p><p class="source-code"><strong class="bold">        slug: slug,</strong></p><p class="source-code"><strong class="bold">      },</strong></p><p class="source-code">    });</p><p class="source-code">  });</p><p class="source-code">};</p><p>Here, we query for the <strong class="source-inline">slug</strong> from the frontmatter of the MDX files. We then use this to create the page with the <strong class="source-inline">createPage</strong> function, ensuring that we also provide the <strong class="source-inline">slug</strong> to the component as <strong class="source-inline">context</strong>. <strong class="source-inline">atsby-theme-i18n</strong> listens for page creation and will additionally create the same page for each locale without any additional configuration! It will also add two fields to the MDX nodes <a id="_idIndexMarker668"/>in our GraphQL data layer – <strong class="source-inline">locale</strong> and <strong class="source-inline">isDefault</strong>, which tell you what locale the MDX is and whether the MDX is the default locale, respectively.</p></li>
				<li>We now need to tell Gatsby to use the correct MDX file on the correct locale path. Without this step, your site will find the MDX file with the first matching <strong class="source-inline">slug</strong> when creating blog posts. This may not match the locale as we have multiple files with the same <strong class="source-inline">slug</strong> and could lead to us being lost in translation. First, update the blog page template (located at <strong class="source-inline">src/templates/blog-page.js</strong>) query with the following:<p class="source-code">export const pageQuery = graphql'</p><p class="source-code">  query(<strong class="bold">$locale: String!</strong>, $slug: String!) {</p><p class="source-code">    blogpost: mdx(</p><p class="source-code">      frontmatter: { slug: { eq: $slug } }</p><p class="source-code">      <strong class="bold">fields: { locale: { eq: $locale } }</strong></p><p class="source-code">    ) {</p><p class="source-code">      frontmatter {</p><p class="source-code">        date</p><p class="source-code">        title</p><p class="source-code">        desc</p><p class="source-code">        tags</p><p class="source-code">        hero {</p><p class="source-code">          childImageSharp {</p><p class="source-code">            gatsbyImageData(width: 600, height: 400,</p><p class="source-code">              placeholder: BLURRED)</p><p class="source-code">          }</p><p class="source-code">        }</p><p class="source-code">      }</p><p class="source-code">      body</p><p class="source-code">    }</p><p class="source-code">  }</p><p class="source-code">';</p><p>Here, we access the locale field provided via the <strong class="source-inline">gatsby-theme-i18n</strong> plugin and use it to filter <a id="_idIndexMarker669"/>the MDX blog posts to those that match the specified locale. This will ensure that we render the blog post in the correct language on any blog page.</p></li>
				<li>Perform the exact same step in the <strong class="source-inline">src/templates/blog-preview.js</strong> file:<p class="source-code">export const pageQuery = graphql'</p><p class="source-code">  query($locale: String!,$skip: Int!, $limit: Int!) {</p><p class="source-code">    blogposts: allMdx(</p><p class="source-code">      limit: $limit</p><p class="source-code">      skip: $skip</p><p class="source-code">      filter: {frontmatter: {type: {eq: "Blog"}},</p><p class="source-code">    fields: <strong class="bold">{locale: { eq: $locale }}}</strong></p><p class="source-code">      sort: { fields: frontmatter___date, order: DESC }</p><p class="source-code">    ) {</p><p class="source-code">      nodes {</p><p class="source-code">        frontmatter {</p><p class="source-code">          date</p><p class="source-code">          title</p><p class="source-code">          tags</p><p class="source-code">          desc</p><p class="source-code">          slug</p><p class="source-code">          hero {</p><p class="source-code">            childImageSharp {</p><p class="source-code">              gatsbyImageData(width: 240, height: 160,</p><p class="source-code">                placeholder: BLURRED)</p><p class="source-code">            }</p><p class="source-code">          }</p><p class="source-code">        }</p><p class="source-code">      }</p><p class="source-code">    }</p><p class="source-code">  }</p><p class="source-code">';</p></li>
				<li>Let's verify the <a id="_idIndexMarker670"/>previous steps. First, start your Gatsby development server's GraphQL layer (normally located at <strong class="source-inline">http://localhost:8000/_graphql</strong>) and run the following query:<p class="source-code">query MyQuery {</p><p class="source-code">  blogposts: allMdx(filter: {frontmatter: {type: {eq:</p><p class="source-code">    "Blog"}}}) {</p><p class="source-code">    nodes {</p><p class="source-code">      fields {</p><p class="source-code">        locale</p><p class="source-code">        isDefault</p><p class="source-code">      }</p><p class="source-code">      frontmatter {</p><p class="source-code">        slug</p><p class="source-code">      }</p><p class="source-code">    }</p><p class="source-code">  }</p><p class="source-code">}</p><p>Here, we are querying for all MDX of type <strong class="source-inline">Blog</strong> and retrieving the locale, whether that <a id="_idIndexMarker671"/>locale is the default, and the <strong class="source-inline">slug</strong>. The result should look like this:</p><p class="source-code">{</p><p class="source-code">  "data": {</p><p class="source-code">    "blogposts": {</p><p class="source-code">      "nodes": [</p><p class="source-code">        {</p><p class="source-code">          "fields": {</p><p class="source-code">            "locale": "en",</p><p class="source-code">            "isDefault": true</p><p class="source-code">          },</p><p class="source-code">          "frontmatter": {</p><p class="source-code">            "slug": "/my-first-post/"</p><p class="source-code">          }</p><p class="source-code">        },</p><p class="source-code">        {</p><p class="source-code">          "fields": {</p><p class="source-code">            "locale": "fr",</p><p class="source-code">            "isDefault": false</p><p class="source-code">          },</p><p class="source-code">          "frontmatter": {</p><p class="source-code">            "slug": "/my-first-post/"</p><p class="source-code">          }</p><p class="source-code">        }</p><p class="source-code">      ]</p><p class="source-code">    }</p><p class="source-code">  }</p><p class="source-code">}</p><p>A result should be present for each locale for any given <strong class="source-inline">slug</strong>. Assuming this is the case, you <a id="_idIndexMarker672"/>can navigate to <strong class="source-inline">/blog</strong> on your Gatsby development site. You should see your blog content in your default language:</p></li>
			</ol>
			<div>
				<div id="_idContainer075" class="IMG---Figure">
					<img src="image/Figure_13.02_B15983.jpg" alt="Figure 13.2 – Blog page in English&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.2 – Blog page in English</p>
			<p>Navigating to <strong class="source-inline">/fr/blog</strong>, you <a id="_idIndexMarker673"/>should see your content in French:</p>
			<div>
				<div id="_idContainer076" class="IMG---Figure">
					<img src="image/Figure_13.03_B15983.jpg" alt="Figure 13.3 – Blog page in French&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 13.3 – Blog page in French</p>
			<p class="callout-heading">Quick Tip</p>
			<p class="callout">If you are clicking on a blog post and always receiving the default locale version, the most likely cause is that you are using <strong class="source-inline">Link</strong> instead of <strong class="source-inline">LocalizedLink</strong> when navigating to the page. Review <em class="italic">Step 5</em> of the <em class="italic">Implementing routes for internationalization</em> section of this chapter.</p>
			<p>We can provide translations for our programmatically generated pages with ease using this strategy. Let's now learn how we can set up translations for single-instance pages. </p>
			<h1 id="_idParaDest-169"><a id="_idTextAnchor171"/>Providing locale translations for single-instance pages</h1>
			<p>For static pages, we will need a different approach to providing translations. For any strings that require <a id="_idIndexMarker674"/>translation <a id="_idIndexMarker675"/>we can no longer have the values in line with our JSX. A very common approach is to use <strong class="source-inline">react-i18next</strong>, which has a great hook called <strong class="source-inline">useTranslation</strong> that allows you to switch strings out depending on the locale. Let's use this now to translate content on our index page for site visitors:</p>
			<ol>
				<li value="1">Open a terminal at your root directory and add these new dependencies:<p class="source-code">npm install gatsby-theme-i18n-react-i18next react-</p><p class="source-code">i18next i18next</p><p>Here, we are installing the <strong class="source-inline">gatsby-theme-i18n-react-i18next</strong> package and its dependencies. This package is a Gatsby theme plugin that provides locale support to our application by wrapping our site in <strong class="source-inline">react-i18next</strong>'s context provider. Underneath the hood, this package wraps the site by using <strong class="source-inline">wrapPageElement</strong> in the <strong class="source-inline">gatsby-browser.js</strong> in the same way we did in <a href="B15983_12_ePub_RK.xhtml#_idTextAnchor159"><em class="italic">Chapter 12</em></a><em class="italic">, Using Real-Time Data</em>.</p></li>
				<li>Include the <strong class="source-inline">gatsby-theme-i18n-react-i18next</strong> plugin in your <strong class="source-inline">gatsby-config.js</strong> file:<p class="source-code">    {</p><p class="source-code">      resolve: 'gatsby-theme-i18n-react-i18next',</p><p class="source-code">      options: {</p><p class="source-code">        locales: './i18n/locales',</p><p class="source-code">        i18nextOptions: {</p><p class="source-code">          ns: ["globals"],</p><p class="source-code">        },</p><p class="source-code">      },</p><p class="source-code">    },</p><p>As part of this <a id="_idIndexMarker676"/>configuration, we <a id="_idIndexMarker677"/>add a couple of options. <strong class="source-inline">locales</strong> refer to location where we will store our translations. <strong class="source-inline">i18nextOptions</strong> accepts <a id="_idIndexMarker678"/>any configuration options that <strong class="source-inline">i18next</strong> accepts (the full list is available at <a href="https://www.i18next.com/overview/configuration-options">https://www.i18next.com/overview/configuration-options</a>). Here, we are passing in the <strong class="source-inline">ns</strong> option, which is an array of namespaces to use. For this example, we will just be creating a single namespace called <strong class="source-inline">globals</strong>, but you may want to add more as your site grows.</p><p class="callout-heading">Important Note</p><p class="callout">The <strong class="source-inline">gatsby-theme-i18n-react-18next</strong> is an add-on package that will only work in tandem with <strong class="source-inline">gatsby-theme-i18n</strong>. Ensure that this package is installed by following the steps in the <em class="italic">Implementing routes for internationalization</em> section.</p></li>
				<li>Create a new folder in <strong class="source-inline">i18n</strong> called <strong class="source-inline">locales</strong>.</li>
				<li>Within <strong class="source-inline">locales</strong>, create a new folder for each locale your site supports, for example, <strong class="source-inline">en</strong> and <strong class="source-inline">fr</strong>.</li>
				<li>For each namespace, create a JSON file in the <strong class="source-inline">locale</strong> folder. In our case, we need to create a single file named <strong class="source-inline">globals.json</strong> for our <strong class="source-inline">globals</strong> namespace in each folder. This file should contain any translations you require, retrievable with a key that is consistent across all files. Your English file (which should be located at <strong class="source-inline">i18n/locales/en/globals.json</strong>) should contain the following:<p class="source-code">{</p><p class="source-code">    "header": "Site Header",</p><p class="source-code">    "yourName": "Your Name",</p><p class="source-code">    "aboutMe": "About Me",</p><p class="source-code">    "location": "London, UK",</p><p class="source-code">    "bio": "A short biography about me"</p><p class="source-code">  }</p><p>Your French file (which should be located at <strong class="source-inline">i18n/locales/fr/globals.json</strong>) should contain the following:</p><p class="source-code">{</p><p class="source-code">    "header": "En-tête du site",</p><p class="source-code">    "yourName": "Votre nom",</p><p class="source-code">    "aboutMe": "À propos de moi",</p><p class="source-code">    "location": "France, Paris",</p><p class="source-code">    "bio": "Une courte biographie sur moi."</p><p class="source-code">  }</p></li>
				<li>To use the <a id="_idIndexMarker679"/>translation <a id="_idIndexMarker680"/>within a Gatsby page component, we can use the <strong class="source-inline">useTranslation</strong> hook from <strong class="source-inline">react-i18next</strong>. Let's look at the about me link on the index page (located at <strong class="source-inline">src/pages/index.js</strong>) as an example:<p class="source-code">import React from "react";</p><p class="source-code"><strong class="bold">import { useTranslation } from "react-i18next";</strong></p><p class="source-code">import { LocalizedLink } from "gatsby-theme-i18n";</p><p class="source-code">import Layout from "../components/layout/Layout";</p><p class="source-code">import SEO from "../components/layout/SEO";</p><p class="source-code">export default function SamplePage() {</p><p class="source-code">  <strong class="bold">const { t } = useTranslation("globals");</strong></p><p class="source-code">  return (</p><p class="source-code">    &lt;Layout&gt;</p><p class="source-code">      &lt;SEO title="Home" description="The landing page</p><p class="source-code">        of my website" /&gt;</p><p class="source-code">      &lt;div className="max-w-5xl mx-auto py-16 lg:py-</p><p class="source-code">        24"&gt;</p><p class="source-code">        &lt;LocalizedLink to="/about" className="btn"&gt;</p><p class="source-code">          <strong class="bold">{t("aboutMe")}</strong></p><p class="source-code">        &lt;/LocalizedLink&gt;</p><p class="source-code">      &lt;/div&gt;</p><p class="source-code">    &lt;/Layout&gt;</p><p class="source-code">  );</p><p class="source-code">}</p><p>We import <strong class="source-inline">useTranslation</strong> from <strong class="source-inline">reacti18next</strong>. Then within the page component, we <a id="_idIndexMarker681"/>invoke the hook <a id="_idIndexMarker682"/>specifying the namespace we wish to use. In our case, this is the <strong class="source-inline">globals</strong> namespace we have created. The <strong class="source-inline">t</strong> function can be used to retrieve the translation from the namespace by passing in a valid key from the <strong class="source-inline">globals.json</strong> objects created in <em class="italic">Step 5</em>. <strong class="source-inline">t("aboutMe")</strong> will return <em class="italic">About me</em> when on the <strong class="source-inline">en</strong> locale and <em class="italic">À propos de moi</em> when on the <strong class="source-inline">fr</strong> locale.</p></li>
				<li>We can also use the exact same process in any other components, such as our header, for example:<p class="source-code">import React from "react";</p><p class="source-code"><strong class="bold">import { useTranslation } from "react-i18next";</strong></p><p class="source-code">import { LocalizedLink } from "gatsby-theme-i18n"</p><p class="source-code">const Header = () =&gt; {</p><p class="source-code">  const { t } = useTranslation("globals");</p><p class="source-code">  return(</p><p class="source-code">  &lt;header className="px-2 border-b w-full max-w-7xl</p><p class="source-code">    mx-auto py-4 flex items-center justify-between"&gt;</p><p class="source-code">    &lt;LocalizedLink to="/"&gt;</p><p class="source-code">      &lt;div className="flex items-center space-x-2</p><p class="source-code">        hover:text-blue-600"&gt;</p><p class="source-code">        &lt;p className="font-bold text-</p><p class="source-code">          2xl"&gt;{<strong class="bold">t("header")</strong>}&lt;/p&gt;</p><p class="source-code">      &lt;/div&gt;</p><p class="source-code">    &lt;/LocalizedLink&gt;</p><p class="source-code">  &lt;/header&gt;</p><p class="source-code">  )</p><p class="source-code">  };</p><p class="source-code">export default Header;</p><p>You can even <a id="_idIndexMarker683"/>use this inside <a id="_idIndexMarker684"/>React components that are used within MDX content if you need to!</p></li>
				<li>Verify your implementation by navigating to the index page on your Gatsby development site. Toggle the locale by modifying the path or using the <strong class="source-inline">Footer</strong> component, and you should see any copy that is using <strong class="source-inline">useTranslation</strong> update.</li>
			</ol>
			<p>We've only scratched the <a id="_idIndexMarker685"/>surface of the features that <strong class="source-inline">i18next</strong> offers. Visit their documentation at <a href="https://www.i18next.com/">https://www.i18next.com/</a> to learn more about the powerful capabilities they offer. With this strategy and the preceding sections, you should now feel confident translating any aspect of your site. Let's now summarize what we've learned.</p>
			<h1 id="_idParaDest-170"><a id="_idTextAnchor172"/>Summary</h1>
			<p>In this final chapter, we learned about making our site accessible to a global audience. We first identified the differences between internationalization and localization. We then used the <strong class="source-inline">gatsby-theme-i18n</strong> plugin to create routes for our locales. We created programmatic blog posts in different languages and ensured the correct translation was visible when visiting a locale. Finally, we also translated our static pages using the <strong class="source-inline">gatsby-theme-i18n-react-i18next</strong> plugin. Between these two plugins, you now have the power to translate any of your site's content. </p>
			<p>Hi!</p>
			<p>I am Samuel Larsen-Disney, author of Elevating React Web Development with Gatsby. I really hope you enjoyed reading this book and found it useful for increasing your productivity and efficiency in Gatsby. </p>
			<p>It would really help me (and other potential readers!) if you could leave a review on Amazon sharing your thoughts on Elevating React Web Development with Gatsby here. </p>
			<p>Go to the link below or scan the QR code to leave your review:</p>
			<p><a href="https://packt.link/r/1800209096 ">https://packt.link/r/1800209096</a></p>
			<div>
				<div id="_idContainer077" class="IMG---Figure">
					<img src="image/QR_code_B15983.jpg" alt=""/>
				</div>
			</div>
			<p>Your review will help me to understand what's worked well in this book, and what could be improved upon for future editions, so it really is appreciated.</p>
			<p>Best Wishes,</p>
			<div>
				<div id="_idContainer078" class="IMG---Figure">
					<img src="image/Author_photo_B15983.jpg" alt=""/>
				</div>
			</div>
			<p>Samuel Larsen-Disney</p>
		</div>
	</body></html>
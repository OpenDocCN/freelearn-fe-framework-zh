<html><head></head><body>
		<div id="_idContainer034">
			<h1 id="_idParaDest-41"><a id="_idTextAnchor041"/>Chapter 3: Using Models, Services, and Mocking Data</h1>
			<p>One of the main features of a frontend web application is communication with the backend. Our application needs to collect user input and send it for processing.</p>
			<p>In this chapter, you will learn how to define data by creating typescript interfaces and column definitions for the <strong class="source-inline">ProTable</strong> component. You will learn how to simulate the backend logic and data using Umi <strong class="bold">mock files</strong>. You will know how to send HTTP requests using the <strong class="bold">umi-request </strong>library. You will also learn to share states and logic between components using <strong class="bold">models</strong>.</p>
			<p>We'll cover the following main topics:</p>
			<ul>
				<li>Defining response types and column types</li>
				<li>Creating the opportunity details page</li>
				<li>Simulating data and API responses</li>
				<li>Sending HTTP requests with Umi request</li>
				<li>Using models for sharing states and logic</li>
			</ul>
			<p>By the end of this chapter, you'll have learned how the data flow works in Umi and how to organize your projects using the <strong class="source-inline">services</strong> and <strong class="source-inline">models</strong> folders. You'll also learn how to use the Umi features to simulate backend logic and send HTTP requests. You will also better understand how the <strong class="source-inline">ProTable</strong> component helps us to work with batches of data.</p>
			<h1 id="_idParaDest-42"><a id="_idTextAnchor042"/>Technical requirements</h1>
			<p>To complete this chapter's exercises, you only need a computer with any OS (I recommend Ubuntu 20.04 or higher) and the software installed in <a href="B18503_01_Final_JM_ePub.xhtml#_idTextAnchor014"><em class="italic">Chapter 1</em></a>,<em class="italic"> Environment Setup and Introduction to UmiJS</em> (Visual Studio Code, Node.js, and Yarn).</p>
			<p>You can find the complete project in the <strong class="source-inline">Chapter03</strong> folder in the GitHub repository available at <a href="https://github.com/PacktPublishing/Enterprise-React-Development-with-UmiJs">https://github.com/PacktPublishing/Enterprise-React-Development-with-UmiJs</a>.</p>
			<h1 id="_idParaDest-43"><a id="_idTextAnchor043"/>Defining response types and column types</h1>
			<p>In this <a id="_idIndexMarker158"/>section, we will create TypeScript interfaces to define the data that we'll receive from the<a id="_idIndexMarker159"/> backend and create column definitions for the <strong class="source-inline">ProTable</strong> component on each page.</p>
			<p>Let's start with the interfaces. Follow these steps to create the TypeScript interfaces:</p>
			<ol>
				<li>Let's first create the folder for definition files. Under the <strong class="source-inline">src</strong> folder, create a new folder called <strong class="source-inline">types</strong>.</li>
				<li>Now, in the <strong class="source-inline">types</strong> folder, create a new file named <strong class="source-inline">user.d.ts</strong> and add the following interface code:<p class="source-code">export interface User {</p><p class="source-code">  id?: number;</p><p class="source-code">  name?: string;</p><p class="source-code">  company?: string;</p><p class="source-code">  role?: {</p><p class="source-code">    id: number;</p><p class="source-code">    title: string;</p><p class="source-code">  };</p><p class="source-code">  isLoggedIn: boolean;</p><p class="source-code">}</p></li>
			</ol>
			<p>The <strong class="source-inline">User</strong> interface defines how we'll receive user information from the backend.</p>
			<ol>
				<li value="3">Create a new file in the <strong class="source-inline">types</strong> folder named <strong class="source-inline">customer.d.ts</strong> and add the following interface:<p class="source-code">export interface Customer {</p><p class="source-code">  id?: number;</p><p class="source-code">  name?: string;</p><p class="source-code">  company?: string;</p><p class="source-code">  phone?: string;</p><p class="source-code">  email?: string;</p><p class="source-code">  role?: string;</p><p class="source-code">}</p></li>
			</ol>
			<p>The <strong class="source-inline">Customer</strong> interface <a id="_idIndexMarker160"/>defines how we'll receive customer information from the backend.</p>
			<ol>
				<li value="4">Now, we'll create<a id="_idIndexMarker161"/> two interfaces for the <strong class="source-inline">opportunity</strong> model. Create a new file named <strong class="source-inline">opportunity.d.ts</strong> in the <strong class="source-inline">types</strong> folder and add the interfaces as follows:<p class="source-code"><strong class="bold">import { Customer } from './customer';</strong></p><p class="source-code">export interface Opportunity {</p><p class="source-code">  id: number;</p><p class="source-code">  topic: string;</p><p class="source-code">  budget: string;</p><p class="source-code">  status: number;</p><p class="source-code">  customer: <strong class="bold">Customer</strong>;</p><p class="source-code">}</p><p class="source-code">export interface Activity {</p><p class="source-code">  id: number;</p><p class="source-code">  type: number;</p><p class="source-code">  schedule: Date;</p><p class="source-code">  createdBy: string;</p><p class="source-code">  summary: string;</p><p class="source-code">}</p></li>
			</ol>
			<p>The <strong class="source-inline">Opportunity</strong> interface defines how we'll receive the opportunity information from the backend. </p>
			<p>Note <a id="_idIndexMarker162"/>that we<a id="_idIndexMarker163"/> imported the <strong class="source-inline">Customer</strong> interface and used it as the type of the <strong class="source-inline">customer</strong> property. An opportunity always relates to a specific customer registered in the CRM.</p>
			<p>The <strong class="source-inline">Activity</strong> interface defines how we receive opportunities activity information from the backend.</p>
			<ol>
				<li value="5">Let's create the interfaces for the report's data. In the <strong class="source-inline">types</strong> folder, create a new file called <strong class="source-inline">analytics.d.ts</strong> and add the following interfaces:<p class="source-code">export interface TopOpportunity {</p><p class="source-code">  name: string;</p><p class="source-code">  revenue: string;</p><p class="source-code">}</p><p class="source-code">export interface LeadsSource {</p><p class="source-code">  source: string;</p><p class="source-code">  count: number;</p><p class="source-code">  percent: number;</p><p class="source-code">}</p><p class="source-code">export interface HistoryByMonth {</p><p class="source-code">  name: string;</p><p class="source-code">  month: string;</p><p class="source-code">  value: string;</p><p class="source-code">}</p></li>
			</ol>
			<p>These<a id="_idIndexMarker164"/> interfaces define how we'll receive the data for the top <a id="_idIndexMarker165"/>opportunities chart, the leads by source chart, and the opportunities won/lost by month chart.</p>
			<p>Now, let's define how the <strong class="source-inline">ProTable</strong> component on each page should display the data received from the backend.</p>
			<h2 id="_idParaDest-44"><a id="_idTextAnchor044"/>Creating column definitions for ProTable</h2>
			<p>We need to set how the <strong class="source-inline">ProTable</strong> component will display data by defining the columns. I <a id="_idIndexMarker166"/>recommend you create column definitions in a separate file whenever possible to maintain the component code and keep it clean.</p>
			<p>Follow these steps to create the <a id="_idIndexMarker167"/>column definitions on each page:</p>
			<ol>
				<li value="1">Let's start with the <strong class="bold">Customers</strong> page. Create a new file named <strong class="source-inline">columns.tsx</strong> in the <strong class="source-inline">Customers</strong> folder under the <strong class="source-inline">src/pages</strong> folder.</li>
				<li>In the <strong class="source-inline">columns.tsx</strong> file, define the table columns as follows:<p class="source-code"><strong class="bold">import { Customer } from '@/types/customer';</strong></p><p class="source-code">import { ProColumns } from '@ant-design/pro-table';</p><p class="source-code">import { FormattedMessage } from 'umi';</p><p class="source-code">const columns: ProColumns&lt;<strong class="bold">Customer</strong>&gt;[] = [</p><p class="source-code">  {</p><p class="source-code">    title: &lt;FormattedMessage id="table.customer.name" </p><p class="source-code">           /&gt;,</p><p class="source-code">    <strong class="bold">dataIndex: 'name',</strong></p><p class="source-code">  },</p><p class="source-code">  {</p><p class="source-code">    title: &lt;FormattedMessage id="table.customer.email"</p><p class="source-code">           /&gt;,</p><p class="source-code">    <strong class="bold">dataIndex: 'email',</strong></p><p class="source-code">    copyable: true,</p><p class="source-code">  },</p><p class="source-code">  {</p><p class="source-code">    title: &lt;FormattedMessage id="table.customer.phone"</p><p class="source-code">           /&gt;,</p><p class="source-code">    <strong class="bold">dataIndex: 'phone',</strong></p><p class="source-code">  },</p><p class="source-code">  {</p><p class="source-code">    title: &lt;FormattedMessage id="table.customer.role" </p><p class="source-code">           /&gt;,</p><p class="source-code">    <strong class="bold">dataIndex: 'role',</strong></p><p class="source-code">  },</p><p class="source-code">  {</p><p class="source-code">    title: &lt;FormattedMessage  </p><p class="source-code">            id="table.customer.company" /&gt;,</p><p class="source-code">    <strong class="bold">dataIndex: 'company',</strong></p><p class="source-code">  },</p><p class="source-code">];</p><p class="source-code">export default columns;</p></li>
			</ol>
			<p>Note that we used the <strong class="source-inline">Customer</strong> interface to declare the data type. Each column definition has a <strong class="source-inline">title</strong> and a <strong class="source-inline">dataIndex</strong>. The latter needs to match a property of the <strong class="source-inline">Customer</strong> interface for <strong class="source-inline">ProTable</strong> to display that property value in its column.</p>
			<ol>
				<li value="3">Let's add a <a id="_idIndexMarker168"/>column to display options<a id="_idIndexMarker169"/> in a specific row. Add this definition to the <strong class="source-inline">columns.tsx</strong> file:<p class="source-code">{</p><p class="source-code">  title: &lt;FormattedMessage id="table.options" /&gt;,</p><p class="source-code">  valueType: 'option',</p><p class="source-code">  hideInSetting: true,</p><p class="source-code">  hideInDescriptions: true,</p><p class="source-code">  <strong class="bold">render: (_, record, __, action)</strong> =&gt; [</p><p class="source-code">    &lt;a</p><p class="source-code">      key="editable"</p><p class="source-code">      onClick={() =&gt; {</p><p class="source-code">        <strong class="bold">action?.startEditable(record.id as number);</strong></p><p class="source-code">      }}</p><p class="source-code">    &gt;</p><p class="source-code">      &lt;FormattedMessage id="table.edit" /&gt;</p><p class="source-code">    &lt;/a&gt;,</p><p class="source-code">  ],</p><p class="source-code">},</p></li>
			</ol>
			<p>In the <strong class="source-inline">options</strong> column, besides the properties we set to not display the column in settings and descriptions, we set the behavior of the <strong class="source-inline">render</strong> function. This<a id="_idIndexMarker170"/> allows you to access the React node, the row entity, the index, and the default <strong class="source-inline">ProTable</strong> actions. When the user clicks on this option, the <strong class="source-inline">startEditable</strong> action allows them to edit the row.</p>
			<ol>
				<li value="4">Now, we'll use<a id="_idIndexMarker171"/> the column definitions in the <strong class="source-inline">ProTable</strong> component. Add the following line to the <strong class="source-inline">index.tsx</strong> file to import the <strong class="source-inline">columns.tsx</strong> file:<p class="source-code"><strong class="bold">import columns from './columns';</strong></p></li>
				<li>Define the <strong class="source-inline">ProTable</strong> <strong class="source-inline">columns</strong> property with the imported file, as follows:<p class="source-code"><strong class="bold">columns={columns}</strong></p></li>
				<li>Next, add the <strong class="source-inline">Customer</strong> interface to define the data type of the <strong class="source-inline">ProTable</strong> columns:<p class="source-code"><strong class="bold">&lt;ProTable&lt;Customer&gt;</strong></p></li>
				<li>Now, let's create the column definitions for the <strong class="bold">Opportunities</strong> page. Create a new file named <strong class="source-inline">columns.tsx</strong> in the <strong class="source-inline">Opportunities</strong> folder under the <strong class="source-inline">src/pages</strong> folder.</li>
				<li>Add the definitions to the <strong class="source-inline">columns.tsx</strong> file, as follows:<p class="source-code">import { Customer } from '@/typ<a id="_idTextAnchor045"/>es/customer';</p><p class="source-code"><strong class="bold">import { Opportunity } from '@/types/opportunity';</strong></p><p class="source-code">import { ProColumns } from '@ant-design/pro-table';</p><p class="source-code">import { Tag } from 'antd';</p><p class="source-code">import { FormattedMessage, history } from 'umi';</p><p class="source-code">const columns: ProColumns&lt;<strong class="bold">Opportunity</strong>&gt;[] = [</p><p class="source-code">  {</p><p class="source-code">    title: &lt;FormattedMessage</p><p class="source-code">            id="table.opportunity.topic" /&gt;,</p><p class="source-code">    dataIndex: 'topic',</p><p class="source-code">    width: 300,</p><p class="source-code">  },</p><p class="source-code">  {</p><p class="source-code">    title: &lt;FormattedMessage</p><p class="source-code">            id="table.opportunity.budget" /&gt;,</p><p class="source-code">    dataIndex: 'budget',</p><p class="source-code">    render: (node) =&gt; &lt;&gt;{`$ ${node}`}&lt;/&gt;,</p><p class="source-code">  },</p><p class="source-code">  {</p><p class="source-code">    title: &lt;FormattedMessage</p><p class="source-code">            id="table.opportunity.status" /&gt;,</p><p class="source-code">    dataIndex: 'status',</p><p class="source-code">    <strong class="bold">valueType: 'select',</strong></p><p class="source-code">    hideInDescriptions: true,</p><p class="source-code">    <strong class="bold">filters: true,</strong></p><p class="source-code"><strong class="bold">    onFilter: true,</strong></p><p class="source-code">  },</p><p class="source-code">];</p><p class="source-code">export default columns;</p></li>
			</ol>
			<p>Note that we used the <strong class="source-inline">Opportunity</strong> interface we created previously to define the data type.</p>
			<p>In the <strong class="source-inline">status</strong> column, we set the <strong class="source-inline">valueType</strong> property to <strong class="source-inline">select</strong>, and the <strong class="source-inline">filters</strong> and <strong class="source-inline">onFilter</strong> properties to <strong class="source-inline">true</strong>, so the user can choose and filter the table using this <strong class="source-inline">column</strong> value.</p>
			<ol>
				<li value="9"><strong class="source-inline">status</strong> is a numeric value representing the opportunity's progress in the sales flow. But, we want the user to see the title instead of a number, so let's add the <strong class="source-inline">enumType</strong> property to the <strong class="source-inline">status</strong> column, as follows:<p class="source-code"><strong class="bold">valueEnum:</strong> {</p><p class="source-code">  <strong class="bold">0:</strong> {</p><p class="source-code">    text: (</p><p class="source-code">      <strong class="bold">&lt;Tag color="#8d79f2" key={0}&gt;</strong></p><p class="source-code">        &lt;FormattedMessage id="step.propose" /&gt;</p><p class="source-code">      &lt;/Tag&gt;</p><p class="source-code">    ),</p><p class="source-code">  },</p><p class="source-code">  <strong class="bold">1:</strong> {</p><p class="source-code">    text: (</p><p class="source-code">      <strong class="bold">&lt;Tag color="#c7f279" key={0}&gt;</strong></p><p class="source-code">        &lt;FormattedMessage id="step.develop" /&gt;</p><p class="source-code">      &lt;/Tag&gt;</p><p class="source-code">    ),</p><p class="source-code">  },</p><p class="source-code">  <strong class="bold">2:</strong> {</p><p class="source-code">    text: (</p><p class="source-code">      <strong class="bold">&lt;Tag color="#e379f2" key={0}&gt;</strong></p><p class="source-code">        &lt;FormattedMessage id="step.qualify" /&gt;</p><p class="source-code">      &lt;/Tag&gt;</p><p class="source-code">    ),</p><p class="source-code">  },</p><p class="source-code">  <strong class="bold">3:</strong> {</p><p class="source-code">    text: (</p><p class="source-code">      <strong class="bold">&lt;Tag color="#79f2e3" key={0}&gt;</strong></p><p class="source-code">        &lt;FormattedMessage id="step.close" /&gt;</p><p class="source-code">      &lt;/Tag&gt;</p><p class="source-code">    ),</p><p class="source-code">  },</p><p class="source-code">},</p></li>
			</ol>
			<p>The status will appear as tags with different colors and the respective step title.</p>
			<ol>
				<li value="10">The <a id="_idIndexMarker172"/>opportunity relates to a customer, and <a id="_idIndexMarker173"/>we need to define columns for the customer properties. Let's add these columns as follows:<p class="source-code">{</p><p class="source-code">  title: &lt;FormattedMessage  </p><p class="source-code">          id="table.opportunity.customer" /&gt;,</p><p class="source-code">  dataIndex: 'customer',</p><p class="source-code">  render: (node) =&gt; &lt;&gt;{node &amp;&amp; (node as </p><p class="source-code">                                Customer).name}&lt;/&gt;,</p><p class="source-code">  editable: false,</p><p class="source-code">},</p><p class="source-code">{</p><p class="source-code">  title: &lt;FormattedMessage id="table.customer.email"</p><p class="source-code">         /&gt;,</p><p class="source-code">  dataIndex: 'customer',</p><p class="source-code">  <strong class="bold">hideInTable: true,</strong></p><p class="source-code">  render: (node) =&gt; &lt;&gt;{node &amp;&amp; (node as </p><p class="source-code">                                Customer).email}&lt;/&gt;,</p><p class="source-code">  editable: false,</p><p class="source-code">},</p><p class="source-code">{</p><p class="source-code">  title: &lt;FormattedMessage id="table.customer.phone" </p><p class="source-code">         /&gt;,</p><p class="source-code">  dataIndex: 'customer',</p><p class="source-code">  <strong class="bold">hideInTable: true,</strong></p><p class="source-code">  render: (node) =&gt; &lt;&gt;{node &amp;&amp; (node as</p><p class="source-code">                                Customer).phone}&lt;/&gt;,</p><p class="source-code">  editable: false,</p><p class="source-code">},</p><p class="source-code">{</p><p class="source-code">  title: &lt;FormattedMessage id="table.customer.company"</p><p class="source-code">         /&gt;,</p><p class="source-code">  dataIndex: 'customer',</p><p class="source-code">  <strong class="bold">hideInTable: true,</strong></p><p class="source-code">  render: (node) =&gt; &lt;&gt;{node &amp;&amp; (node as </p><p class="source-code">                                Customer).company}&lt;/&gt;,</p><p class="source-code">  editable: false,</p><p class="source-code">},</p></li>
			</ol>
			<p>Note that the only column in the table is the customer's name. In the other columns, we set <strong class="source-inline">hideInTable</strong> to <strong class="source-inline">true</strong>. We'll use these columns in the opportunity details page that we'll create later in this chapter.</p>
			<ol>
				<li value="11">We'll also <a id="_idIndexMarker174"/>add a column to display <a id="_idIndexMarker175"/>options to a specific row in this table. Add this definition to the <strong class="source-inline">columns.tsx</strong> file:<p class="source-code">{</p><p class="source-code">  title: &lt;FormattedMessage id="table.options" /&gt;,</p><p class="source-code">  valueType: 'option',</p><p class="source-code">  hideInSetting: true,</p><p class="source-code">  hideInDescriptions: true,</p><p class="source-code">  render: (_, record, __, action) =&gt; [</p><p class="source-code">    &lt;a</p><p class="source-code">      key="editable"</p><p class="source-code">      onClick={() =&gt; {</p><p class="source-code">        <strong class="bold">action?.startEditable(record.id as number);</strong></p><p class="source-code">      }}</p><p class="source-code">    &gt;</p><p class="source-code">      &lt;FormattedMessage id="table.edit" /&gt;</p><p class="source-code">    &lt;/a&gt;,</p><p class="source-code">    &lt;a key="more" onClick={() =&gt; </p><p class="source-code">      <strong class="bold">history.push(`/opportunity/${record.id}`)</strong>}&gt;</p><p class="source-code">      &lt;FormattedMessage id="table.more" /&gt;</p><p class="source-code">    &lt;/a&gt;,</p><p class="source-code">  ],</p><p class="source-code">},</p></li>
			</ol>
			<p>The <strong class="source-inline">options</strong> column introduces two options – <strong class="bold">Edit the row</strong> and <strong class="bold">Show more</strong>. When users click for more, the umi history will redirect the user to the opportunity details page located in the <strong class="source-inline">/opp<a id="_idTextAnchor046"/>ortunity/:id</strong> path.</p>
			<ol>
				<li value="12">Now, we'll <a id="_idIndexMarker176"/>use the column definitions<a id="_idIndexMarker177"/> in the <strong class="source-inline">ProTable</strong> component. Add the following line to the <strong class="source-inline">index.tsx</strong> file to import the <strong class="source-inline">columns.tsx</strong> file:<p class="source-code"><strong class="bold">import columns from './columns';</strong></p></li>
				<li>Define the <strong class="source-inline">ProTable</strong> <strong class="source-inline">columns</strong> property with the imported file, as follows:<p class="source-code"><strong class="bold">columns={columns}</strong></p></li>
				<li>Import the <strong class="source-inline">Opportunity</strong> interface, as follows:<p class="source-code"><strong class="bold">import { Opportunity } from '@/types/opportunity';</strong></p></li>
				<li>Next, add the <strong class="source-inline">Opportunity</strong> interface to define the data type of the <strong class="source-inline">ProTable</strong> columns:<p class="source-code"><strong class="bold">&lt;ProTable&lt;Opportunity&gt;</strong></p></li>
				<li>Follow these previous steps to add the column definitions to <strong class="source-inline">ProTable</strong> on the home page. We'll reuse the <strong class="source-inline">columns.tsx</strong> file from the <strong class="bold">Opportunities</strong> page, so you need to import the file, as follows:<p class="source-code"><strong class="bold">import columns from '../Opportunities/columns';</strong></p></li>
				<li>Now, we need to add the texts to the multi-language files. Add the texts to the <strong class="source-inline">en-US.ts</strong> file in the <strong class="source-inline">src/locales</strong> folder, as follows:<p class="source-code">'table.options': 'Options',</p><p class="source-code">'table.edit': 'Edit',</p><p class="source-code">'table.more': 'More',</p><p class="source-code">'table.new': 'New',</p><p class="source-code">'table.customer.title': 'Customers',</p><p class="source-code">'table.customer.role': 'Role',</p><p class="source-code">'table.customer.name': 'Name',</p><p class="source-code">'table.customer.email': 'Email',</p><p class="source-code">'table.customer.phone': 'Phone',</p><p class="source-code">'table.customer.company': 'Company',</p><p class="source-code">'form.customer.title': 'New customer',</p><p class="source-code">'table.opportunity.assign': 'Assign Opportunities',</p><p class="source-code">'table.opportunity.title': 'Opportunity',</p><p class="source-code">'table.opportunity.detail': 'Details',</p><p class="source-code">'table.opportunity.activities': 'Activities',</p><p class="source-code">'table.opportunity.topic': 'Topic',</p><p class="source-code">'table.opportunity.budget': 'Budget',</p><p class="source-code">'table.opportunity.status': 'Step',</p><p class="source-code">'table.opportunity.customer': 'Customer',</p><p class="source-code">'form.opportunity.title': 'New opportunity',</p></li>
			</ol>
			<p>We don't need to add these texts to the <strong class="source-inline">pt-BR.ts</strong> file because we already downloaded the complete file in the previous chapter.</p>
			<p>In this section, we<a id="_idIndexMarker178"/> created the TypeScript interfaces<a id="_idIndexMarker179"/> to define all the data we'll receive from the backend and the column definitions for the <strong class="source-inline">ProTable</strong> component on each page.</p>
			<p>Now, let's create the opportunity details page, which will show the activities on the opportunity.</p>
			<h1 id="_idParaDest-45"><a id="_idTextAnchor047"/>Creating the opportunity details page</h1>
			<p>In this section, we'll create<a id="_idIndexMarker180"/> the opportunity details page. The opportunity details page allows the user to track and register opportunity activities.</p>
			<p>The user can also change the opportunity step and edit the opportunity properties such as <strong class="source-inline">title</strong> and <strong class="source-inline">expected revenue</strong>.</p>
			<p>Follow these steps to create the opportunity details page:</p>
			<ol>
				<li value="1">Run the following command to generate the opportunity detail page:<p class="source-code"><strong class="bold">yarn umi g page /OpportunityDetail/index --typeScript --less</strong></p></li>
				<li>We'll use a pro component called <strong class="source-inline">ProDescriptions</strong>. It's similar to the <strong class="source-inline">ProTable</strong> component but intended for display properties instead of a batch of data. Run the following command to add the <strong class="source-inline">ProDescriptions</strong> component to the project:<p class="source-code"><strong class="bold">yarn add @ant-design/pro-descriptions@1.10.5</strong></p></li>
				<li>Next, import these dependencies to the <strong class="source-inline">index.tsx</strong> file in the <strong class="source-inline">OpportunityDetail</strong> folder, as follows:<p class="source-code">import { Opportunity } from '@/types/opportunity';</p><p class="source-code">import ProDescriptions from '@ant-design/pro-descriptions';</p><p class="source-code">import { Page Container } from '@ant-design/pro-layout';</p><p class="source-code">import ProTable from '@ant-design/pro-table';</p><p class="source-code">import { Breadcrumb, Button, Card, Steps, Tag } from 'antd';</p><p class="source-code">import { useParams, history, FormattedMessage } from 'umi';</p><p class="source-code">import columns from '../Opportunities/columns';</p><p class="source-code">import { PlusOutlined } from '@ant-design/icons';</p><p class="source-code">import { Activity } from '@/types/opportunity';</p></li>
				<li>Now, create<a id="_idIndexMarker181"/> the <strong class="source-inline">page</strong> component in the <strong class="source-inline">index.tsx</strong> file, as follows:<p class="source-code">export default function Page() {</p><p class="source-code">  <strong class="bold">const { id } = useParams&lt;{ id: string }&gt;();</strong></p><p class="source-code">  return (</p><p class="source-code">    &lt;PageContainer</p><p class="source-code">      extra={[</p><p class="source-code">        &lt;Button icon={&lt;PlusOutlined /&gt;} key="activity" </p><p class="source-code">         type="primary"&gt;</p><p class="source-code">          &lt;FormattedMessage id="activity.new" /&gt;</p><p class="source-code">        &lt;/Button&gt;,</p><p class="source-code">      ]}</p><p class="source-code">    &gt;</p><p class="source-code">      &lt;Card bordered&gt;</p><p class="source-code">        <strong class="bold">&lt;ProDescriptions&lt;Opportunity&gt;</strong></p><p class="source-code">          title={&lt;FormattedMessage </p><p class="source-code">                 id="table.opportunity.detail" /&gt;}</p><p class="source-code">          columns={columns}</p><p class="source-code">          dataSource={[]}</p><p class="source-code">        /&gt;</p><p class="source-code">      &lt;/Card&gt;</p><p class="source-code">      &lt;Card bordered&gt;</p><p class="source-code">        <strong class="bold">&lt;ProTable&lt;Activity&gt;</strong></p><p class="source-code">          headerTitle={&lt;FormattedMessage </p><p class="source-code">            id="table.opportunity.activities" /&gt;}</p><p class="source-code">          rowKey="id"</p><p class="source-code">          toolbar={{ settings: undefined }}</p><p class="source-code">          search={false}</p><p class="source-code">          pagination={{ pageSize: 5 }}</p><p class="source-code">          columns={[]}</p><p class="source-code">          params={{ customerId: id }}</p><p class="source-code">          request={() =&gt; {}}</p><p class="source-code">        /&gt;</p><p class="source-code">      &lt;/Card&gt;</p><p class="source-code">    &lt;/PageContainer&gt;</p><p class="source-code">  );</p><p class="source-code">}</p></li>
			</ol>
			<p>Note that we <a id="_idIndexMarker182"/>accessed the ID we got from the route parameters. We will use it to request a specific opportunity from the backend.</p>
			<p>We also used the <strong class="source-inline">ProDescriptions</strong> component to show the opportunity details and <strong class="source-inline">ProTable</strong> to list the opportunity activities.</p>
			<ol>
				<li value="5">The opportunity details page will only be accessible in the <strong class="source-inline">opportunities</strong> table row option and not accessible in the menu, so let's <a id="_idIndexMarker183"/>add a <strong class="bold">breadcrumb</strong> to help the user navigate <a id="_idIndexMarker184"/>thought the interfaces. Add the <strong class="source-inline">header</strong> property to the <strong class="source-inline">PageContainer</strong> component, as follows:<p class="source-code"><strong class="bold">header=</strong>{{</p><p class="source-code">  title: &lt;FormattedMessage </p><p class="source-code">          id="table.opportunity.title" /&gt;,</p><p class="source-code">  breadcrumb: (</p><p class="source-code">    &lt;Breadcrumb&gt;</p><p class="source-code">      &lt;Breadcrumb.Item&gt;</p><p class="source-code">        &lt;a onClick={() =&gt; </p><p class="source-code">          history.push('/opportunities')}&gt;</p><p class="source-code">          &lt;FormattedMessage id="menu.opportunities" /&gt;</p><p class="source-code">        &lt;/a&gt;</p><p class="source-code">      &lt;/Breadcrumb.Item&gt;</p><p class="source-code">      &lt;Breadcrumb.Item&gt;</p><p class="source-code">        &lt;FormattedMessage id="table.opportunity.title"</p><p class="source-code">        /&gt;</p><p class="source-code">      &lt;/Breadcrumb.Item&gt;</p><p class="source-code">    &lt;/Breadcrumb&gt;</p><p class="source-code">  ),</p><p class="source-code">}}</p></li>
				<li>Now, we'll add the <strong class="source-inline">Steps</strong> component from Ant Design to visually show the progress of the opportunity. Add the <strong class="source-inline">Steps</strong> component before the <strong class="source-inline">ProDescriptions</strong> component <a id="_idIndexMarker185"/>as the first child of the <strong class="source-inline">Card</strong> component, as follows: <p class="source-code">&lt;Steps <strong class="bold">current={0}</strong>&gt;</p><p class="source-code">  &lt;Steps.Step</p><p class="source-code">    key="quality"</p><p class="source-code">    description={&lt;Tag color="#e379f2" key={0} /&gt;}</p><p class="source-code">    title={&lt;FormattedMessage id="step.qualify" /&gt;}</p><p class="source-code">  /&gt;</p><p class="source-code">  &lt;Steps.Step</p><p class="source-code">    key="develop"</p><p class="source-code">    description={&lt;Tag color="#c7f279" key={1} /&gt;}</p><p class="source-code">    title={&lt;FormattedMessage id="step.develop" /&gt;}</p><p class="source-code">  /&gt;</p><p class="source-code">  &lt;Steps.Step</p><p class="source-code">    key="propose"</p><p class="source-code">    description={&lt;Tag color="#8d79f2" key={2} /&gt;}</p><p class="source-code">    title={&lt;FormattedMessage id="step.propose" /&gt;}</p><p class="source-code">  /&gt;</p><p class="source-code">  &lt;Steps.Step</p><p class="source-code">    key="close"</p><p class="source-code">    description={&lt;Tag color="#42C3E3" key={3} /&gt;}</p><p class="source-code">    title={&lt;FormattedMessage id="step.close" /&gt;}</p><p class="source-code">  /&gt;</p><p class="source-code">&lt;/Steps&gt;</p><p class="source-code">&lt;br /&gt;</p></li>
			</ol>
			<p>The <strong class="source-inline">current</strong> property indicates the progress of the opportunity in the sales flow.</p>
			<ol>
				<li value="7">Now, add the<a id="_idIndexMarker186"/> route definition to the opportunity details page in the <strong class="source-inline">routes.ts</strong> file in the <strong class="source-inline">config</strong> folder, as follows:<p class="source-code">{</p><p class="source-code">  path: '/opportunity/:id',</p><p class="source-code">  component: '@/pages/OpportunityDetail',</p><p class="source-code">},</p></li>
			</ol>
			<p>Note that we don't add the <strong class="source-inline">name</strong> and <strong class="source-inline">icon</strong> properties because we don't want the opportunity details page listed in the side menu.</p>
			<p>We are almost finishing building the opportunity details page. Now, we'll use the <strong class="source-inline">Activity</strong> interface we created previously to define the columns of the activities table.</p>
			<h2 id="_idParaDest-46"><a id="_idTextAnchor048"/>Defining the activities table columns</h2>
			<p>The <a id="_idIndexMarker187"/>opportunity details page lists the activities taken on the opportunity using the <strong class="source-inline">ProTable</strong> component, so we also need to define the columns for this table.  </p>
			<p>Follow these steps to define the columns for the <strong class="source-inline">ProTable</strong> component:</p>
			<ol>
				<li value="1">Create a new file named <strong class="source-inline">columns.tsx</strong> in the <strong class="source-inline">OpportunityDetails</strong> folder under the <strong class="source-inline">src/pages</strong> folder.</li>
				<li>Next, add the column definitions to the <strong class="source-inline">columns.tsx</strong> file, as follows:<p class="source-code">import { ProColumns } from '@ant-design/pro-table';</p><p class="source-code">import { FormattedMessage } from 'umi';</p><p class="source-code">import { Activity } from '@/types/opportunity';</p><p class="source-code">import { Tag } from 'antd';</p><p class="source-code">const columns: ProColumns&lt;Activity&gt;[] = [</p><p class="source-code">  {</p><p class="source-code">    title: &lt;FormattedMessage </p><p class="source-code">            id="table.activity.summary" /&gt;,</p><p class="source-code">    dataIndex: 'summary',</p><p class="source-code">    width: 300,</p><p class="source-code">  },</p><p class="source-code">  {</p><p class="source-code">    title: &lt;FormattedMessage id="table.activity.type"</p><p class="source-code">           /&gt;,</p><p class="source-code">    <strong class="bold">dataIndex: 'type',</strong></p><p class="source-code">  },</p><p class="source-code">  {</p><p class="source-code">    title: &lt;FormattedMessage </p><p class="source-code">            id="table.activity.schedule" /&gt;,</p><p class="source-code">    valueType: 'date',</p><p class="source-code">    dataIndex: 'schedule',</p><p class="source-code">  },</p><p class="source-code">  {</p><p class="source-code">    title: &lt;FormattedMessage </p><p class="source-code">            id="table.activity.createdBy" /&gt;,</p><p class="source-code">    dataIndex: 'createdBy',</p><p class="source-code">  },</p><p class="source-code">];</p><p class="source-code">export default columns;</p></li>
			</ol>
			<p>The <strong class="source-inline">type</strong> property is a numeric value representing the activity type.</p>
			<ol>
				<li value="3">We <a id="_idIndexMarker188"/>want the user to see a title instead of a numeric value in the <strong class="source-inline">type</strong> column, so let's add the <strong class="source-inline">enumType</strong> property to the <strong class="source-inline">type</strong> column, as follows:<p class="source-code"><strong class="bold">valueEnum:</strong> {</p><p class="source-code">  <strong class="bold">0:</strong> {</p><p class="source-code">    text: (</p><p class="source-code">      <strong class="bold">&lt;Tag color="#42C3E3" key={0}&gt;</strong></p><p class="source-code">        &lt;FormattedMessage id="activity.call" /&gt;</p><p class="source-code">      &lt;/Tag&gt;</p><p class="source-code">    ),</p><p class="source-code">  },</p><p class="source-code">  <strong class="bold">1:</strong> {</p><p class="source-code">    text: (</p><p class="source-code">      <strong class="bold">&lt;Tag color="#42C3E3" key={1}&gt;</strong></p><p class="source-code">        &lt;FormattedMessage id="activity.email" /&gt;</p><p class="source-code">      &lt;/Tag&gt;</p><p class="source-code">    ),</p><p class="source-code">  },</p><p class="source-code">  <strong class="bold">2:</strong> {</p><p class="source-code">    text: (</p><p class="source-code">      <strong class="bold">&lt;Tag color="#42C3E3" key={2}&gt;</strong></p><p class="source-code">        &lt;FormattedMessage id="activity.meeting" /&gt;</p><p class="source-code">      &lt;/Tag&gt;</p><p class="source-code">    ),</p><p class="source-code">  },</p><p class="source-code">  <strong class="bold">3:</strong> {</p><p class="source-code">    text: (</p><p class="source-code">      <strong class="bold">&lt;Tag color="#42C3E3" key={3}&gt;</strong></p><p class="source-code">        &lt;FormattedMessage id="activity.event" /&gt;</p><p class="source-code">      &lt;/Tag&gt;</p><p class="source-code">    ),</p><p class="source-code">  },</p><p class="source-code">},</p></li>
			</ol>
			<p>Now, the <strong class="source-inline">type</strong> column will show a tag with the activity type title in different colors.</p>
			<ol>
				<li value="4">Now, we'll use<a id="_idIndexMarker189"/> the column definitions in the <strong class="source-inline">ProTable</strong> component. Add the following line to the <strong class="source-inline">index.tsx</strong> file to import the <strong class="source-inline">columns.tsx</strong> file:<p class="source-code"><strong class="bold">import activityColumns from './columns';</strong></p></li>
				<li>Next, define the <strong class="source-inline">ProTable</strong> <strong class="source-inline">columns</strong> property using the imported file, as follows:<p class="source-code"><strong class="bold">columns={activityColumns}</strong></p></li>
				<li>To finish the opportunity details page, let's add the texts to the <strong class="source-inline">en-US.ts</strong> file in the <strong class="source-inline">src/locales</strong> folder, as follows:<p class="source-code">'step.qualify': 'Qualify',</p><p class="source-code">'step.develop': 'Develop',</p><p class="source-code">'step.propose': 'Propose',</p><p class="source-code">'step.close': 'Close',</p><p class="source-code">'activity.call': 'Call',</p><p class="source-code">'activity.email': 'Email',</p><p class="source-code">'activity.meeting': 'Meeting',</p><p class="source-code">'activity.event': 'Event',</p><p class="source-code">'activity.new': 'New activity',</p><p class="source-code">'table.activity.summary': 'Summary',</p><p class="source-code">'table.activity.type': 'Type',</p><p class="source-code">'table.activity.schedule': 'Scheduled',</p><p class="source-code">'table.activity.createdBy': 'User',</p></li>
			</ol>
			<p>In this section, we<a id="_idIndexMarker190"/> created the opportunity details page. We added a breadcrumb to help the user navigate between interfaces and the <strong class="source-inline">Steps</strong> component to show the opportunity progress. We also defined the activities table columns by creating the <strong class="source-inline">columns.tsx</strong> file.</p>
			<p>Now, we are ready to learn how to simulate backend logic and API responses by creating Umi mock files.</p>
			<h1 id="_idParaDest-47"><a id="_idTextAnchor049"/>Simulating data and API responses</h1>
			<p>In this<a id="_idIndexMarker191"/> section, you'll learn how to create mock files to simulate backend logic and API responses.</p>
			<p>Mock files are<a id="_idIndexMarker192"/> helpful to decouple frontend development from backend development, as you don't need the backend ready to make requests and populate your interface with data.  </p>
			<p>A mock file is <a id="_idIndexMarker193"/>simply a JavaScript object with endpoint route definitions and a response to each endpoint. Consider the following example:</p>
			<p class="source-code">export default {</p>
			<p class="source-code">  <strong class="bold">'GET /api/products': { total: 0, products: [] }</strong>,</p>
			<p class="source-code">};</p>
			<p>In this example, when the project is running, we can send an <strong class="source-inline">HTTP</strong> <strong class="source-inline">GET</strong> request to http://localhost:8000/api/products to receive the object defined in the mock file. </p>
			<p>Umi will registry<a id="_idIndexMarker194"/> all files with the <strong class="source-inline">.js</strong> and <strong class="source-inline">.ts</strong> extensions inside the <strong class="source-inline">mock</strong> folder as mock files.</p>
			<p>Now that we know how mock files work, let's create<a id="_idIndexMarker195"/> mock files for our application. Follow these steps:</p>
			<ol>
				<li value="1">In the project root directory, create a new folder named <strong class="source-inline">mock</strong>.</li>
				<li>Instead of manually generating the data we want to send, we'll use a library called <strong class="bold">faker.js</strong> to generate random data. The <strong class="source-inline">faker.js</strong> library delivers various data categories we can choose from, such as user profiles, company contacts, and product information. Run the following command to install the <strong class="source-inline">faker.js</strong> library:<p class="source-code"><strong class="bold">$ yarn add -D faker@5.5.3</strong></p></li>
				<li>Let's also add the TypeScript declaration files for <strong class="source-inline">faker.js</strong> by running the following command:<p class="source-code"><strong class="bold">$ yarn add -D @types/faker</strong></p></li>
				<li>Next, add the TypeScript declaration files for <strong class="bold">express</strong> by running the following command:<p class="source-code"><strong class="bold">$ yarn add -D @types/express</strong></p></li>
			</ol>
			<p>We'll use the <strong class="source-inline">Response</strong> and <strong class="source-inline">Request</strong> interfaces from <strong class="source-inline">express</strong> to define the requests and responses in our mock endpoints.</p>
			<ol>
				<li value="5">Now, in the <strong class="source-inline">mock</strong> folder, create a new file named <strong class="source-inline">customer.ts</strong>.</li>
				<li>In the <strong class="source-inline">customer.ts</strong> file, create <a id="_idIndexMarker196"/>a list of <a id="_idIndexMarker197"/>customers, as follows:<p class="source-code"><strong class="bold">import * as faker from 'faker';</strong></p><p class="source-code">import { Response } from 'express';</p><p class="source-code">import { Customer } from '@/types/customer.d';</p><p class="source-code">const customers: Customer[] = [];</p><p class="source-code">for (let index = 0; index &lt; 30; index++) {</p><p class="source-code">  customers.push({</p><p class="source-code">    id: index,</p><p class="source-code">    name: <strong class="bold">faker.name</strong>.findName(),</p><p class="source-code">    company: <strong class="bold">faker.company</strong>.companyName(),</p><p class="source-code">    phone: <strong class="bold">faker.phone</strong>.phoneNumber(),</p><p class="source-code">    role: <strong class="bold">faker.name.jobTitle</strong>(),</p><p class="source-code">    email: <strong class="bold">faker.internet.email</strong>(),</p><p class="source-code">  });</p><p class="source-code">}</p></li>
			</ol>
			<p>We used the <strong class="source-inline">faker.js</strong> library to generate random customer properties.</p>
			<ol>
				<li value="7">Next, create the endpoint route definitions in the <strong class="source-inline">customer.ts</strong> file, as follows:<p class="source-code">export default {</p><p class="source-code">  <strong class="bold">'PUT /api/customer'</strong>: (_: any, res: Response) =&gt; </p><p class="source-code"><strong class="bold">    </strong>res.send({ success: true }),</p><p class="source-code">  <strong class="bold">'PUT /api/customer/disable'</strong>: (_: any, res: Response) </p><p class="source-code"><strong class="bold">    </strong>=&gt;</p><p class="source-code">    res.send({ success: true }),</p><p class="source-code">  <strong class="bold">'/api/customer/list'</strong>: (_: any, res: Response) =&gt;</p><p class="source-code">    res.send({ <strong class="bold">data: customers</strong>, success: true }),</p><p class="source-code">  <strong class="bold">'POST /api/customer'</strong>: (_: any, res: Response) =&gt;</p><p class="source-code">    res.status(201).send({ success: true }),</p><p class="source-code">};</p></li>
			</ol>
			<p>We <a id="_idIndexMarker198"/>defined four endpoints: </p>
			<ul>
				<li>A mock endpoint<a id="_idIndexMarker199"/> to update the customer record (<strong class="source-inline">PUT /api/customer</strong>) </li>
				<li>A mock endpoint to disable the customer record (<strong class="source-inline">PUT /api/customer/disable</strong>)</li>
				<li>A mock endpoint to list all the customers (<strong class="source-inline">/api/customer/list</strong>)</li>
				<li>A mock endpoint to create a new customer record (<strong class="source-inline">POST /api/customer</strong>)</li>
			</ul>
			<p>Note that we don't need to define the HTTP method when the endpoint uses the method <strong class="source-inline">GET</strong> as in the endpoint to list all customers (<strong class="source-inline">/api/customer/list</strong>).</p>
			<ol>
				<li value="8">Now, create a new file in the <strong class="source-inline">mock</strong> folder named <strong class="source-inline">analytics.ts</strong> and add the following:<p class="source-code">import * as faker from 'faker';</p><p class="source-code">import { Response } from 'express';</p><p class="source-code">export default { }</p></li>
			</ol>
			<p>We'll create data to <a id="_idIndexMarker200"/>populate the charts on the <strong class="bold">Reports</strong> page in this file.</p>
			<ol>
				<li value="9">In the <strong class="source-inline">analytics.ts</strong> file, create a new mock endpoint to deliver the top opportunities, as<a id="_idIndexMarker201"/> follows:<p class="source-code"><strong class="bold">'/api/analytics/top/opportunity'</strong>: (_: any, res: Response) =&gt;</p><p class="source-code">    res.send({</p><p class="source-code">      data: [</p><p class="source-code">        { name: faker.commerce.productName(), </p><p class="source-code">          revenue: 15000 },</p><p class="source-code">        { name: faker.commerce.productName(), </p><p class="source-code">          revenue: 30000 },</p><p class="source-code">        { name: faker.commerce.productName(), </p><p class="source-code">          revenue: 40000 },</p><p class="source-code">        { name: faker.commerce.productName(), </p><p class="source-code">          revenue: 50000 },</p><p class="source-code">      ],</p><p class="source-code">      success: true,</p><p class="source-code">    }),</p></li>
				<li>Next, create a mock endpoint to deliver the leads by source, as follows:<p class="source-code"><strong class="bold">'/api/analytics/leads/source'</strong>: (_: any, res: Response) =&gt;</p><p class="source-code">    res.send({</p><p class="source-code">      data: [</p><p class="source-code">        { source: 'Social Media', count: 40,</p><p class="source-code">           percent: 0.4 },</p><p class="source-code">        { source: 'Email Marketing', count: 21, </p><p class="source-code">          percent: 0.21 },</p><p class="source-code">        { source: 'Campaigns', count: 17, </p><p class="source-code">          percent: 0.17 },</p><p class="source-code">        { source: 'Landing Page', count: 13, </p><p class="source-code">          percent: 0.13 },</p><p class="source-code">        { source: 'Events', count: 9, percent: 0.09 },</p><p class="source-code">      ],</p><p class="source-code">      success: true,</p><p class="source-code">    }),</p></li>
				<li>Finally, create <a id="_idIndexMarker202"/>a mock endpoint to deliver the opportunities won/lost by month, as follows:<p class="source-code"><strong class="bold">'/api/analytics/bymonth/opportunity'</strong>: (_: any, res: Response) =&gt;</p><p class="source-code">    res.send({</p><p class="source-code">      data: [</p><p class="source-code">        { name: 'Won', month: 'Jan.', value: 18 },</p><p class="source-code">        { name: 'Won', month: 'Feb.', value: 28 },</p><p class="source-code">        { name: 'Won', month: 'Mar.', value: 39 },</p><p class="source-code">        { name: 'Won', month: 'Apr.', value: 81 },</p><p class="source-code">        { name: 'Won', month: 'May', value: 47 },</p><p class="source-code">        { name: 'Won', month: 'Jun.', value: 20 },</p><p class="source-code">        { name: 'Won', month: 'Jul.', value: 24 },</p><p class="source-code">        { name: 'Won', month: 'Aug.', value: 35 },</p><p class="source-code">        { name: 'Lost', month: 'Jan.', value: 12 },</p><p class="source-code">        { name: 'Lost', month: 'Feb.', value: 23 },</p><p class="source-code">        { name: 'Lost', month: 'Mar.', value: 34 },</p><p class="source-code">        { name: 'Lost', month: 'Apr.', value: 99 },</p><p class="source-code">        { name: 'Lost', month: 'May', value: 52 },</p><p class="source-code">        { name: 'Lost', month: 'Jun.', value: 35 },</p><p class="source-code">        { name: 'Lost', month: 'Jul.', value: 37 },</p><p class="source-code">        { name: 'Lost', month: 'Aug.', value: 42 },</p><p class="source-code">      ],</p><p class="source-code">      success: true,</p><p class="source-code">    }),</p></li>
				<li>Now, we'll <a id="_idIndexMarker203"/>create a mock file for the opportunities. Create <a id="_idIndexMarker204"/>a new file in the <strong class="source-inline">mock</strong> folder called <strong class="source-inline">opportunity.ts</strong> and add the following:<p class="source-code"><strong class="bold">import * as faker from 'faker';</strong></p><p class="source-code">import { Opportunity, Activity } from '@/types/opportunity.d';</p><p class="source-code">import { Request, Response } from 'express';</p><p class="source-code"><strong class="bold">const opportunity: Opportunity[] = [];</strong></p><p class="source-code"><strong class="bold">const activities: Activity[] = [];</strong></p><p class="source-code">for (let index = 0; index &lt; 5; index++) {</p><p class="source-code">  activities.push({</p><p class="source-code">    id: index,</p><p class="source-code">    type: <strong class="bold">faker.datatype.number({ max: 3, min: 0,</strong></p><p class="source-code"><strong class="bold">      precision: 1 })</strong>,</p><p class="source-code">    schedule: <strong class="bold">faker.date.recent</strong>(),</p><p class="source-code">    createdBy: <strong class="bold">faker.name.findName</strong>(),</p><p class="source-code">    summary: <strong class="bold">faker.lorem.words</strong>(6),</p><p class="source-code">  });</p><p class="source-code">}</p><p class="source-code">for (let index = 0; index &lt; 30; index++) {</p><p class="source-code">  opportunity.push({</p><p class="source-code">    id: index,</p><p class="source-code">    topic: <strong class="bold">faker.commerce.productName</strong>(),</p><p class="source-code">    customer: {</p><p class="source-code">      id: index,</p><p class="source-code">      name: <strong class="bold">faker.name.findName</strong>(),</p><p class="source-code">      company: <strong class="bold">faker.company.companyName</strong>(),</p><p class="source-code">      phone: <strong class="bold">faker.phone.phoneNumber</strong>(),</p><p class="source-code">      role: <strong class="bold">faker.name.jobTitle</strong>(),</p><p class="source-code">      email: <strong class="bold">faker.internet.email</strong>(),</p><p class="source-code">    },</p><p class="source-code">    budget: <strong class="bold">faker.finance.amount</strong>(100000),</p><p class="source-code">    status: <strong class="bold">faker.datatype.number</strong>({ max: 3, min: 0, </p><p class="source-code">      precision: 1 }),</p><p class="source-code">  });</p><p class="source-code">}</p></li>
			</ol>
			<p>We created two lists, <strong class="source-inline">activities</strong> and <strong class="source-inline">opportunities</strong>, and used the <strong class="source-inline">faker.js</strong> library to fill <a id="_idIndexMarker205"/>these lists with random data.</p>
			<ol>
				<li value="13">Next, create<a id="_idIndexMarker206"/> these two methods:<p class="source-code">const <strong class="bold">listOpportunities</strong> = (req: Request, res: Response) =&gt; {</p><p class="source-code">  <strong class="bold">const { slice } = req.query;</strong></p><p class="source-code">  res.send({</p><p class="source-code">    data: opportunity.slice(0, slice ? <strong class="bold">Number(slice)</strong> :</p><p class="source-code">      undefined),</p><p class="source-code">    success: true,</p><p class="source-code">  });</p><p class="source-code">};</p><p class="source-code">const <strong class="bold">getOpportunity</strong> = (req: Request, res: Response) =&gt; {</p><p class="source-code">  const { <strong class="bold">opportunityId</strong> } = req.query;</p><p class="source-code">  res.send(opportunity[<strong class="bold">Number(opportunityId)</strong>]);</p><p class="source-code">};</p></li>
			</ol>
			<p>The <strong class="source-inline">listOpportunities</strong> method slices the <strong class="source-inline">opportunities</strong> array using the number given in the <strong class="source-inline">slice</strong> request query parameter.</p>
			<p>The <strong class="source-inline">getOpportunity</strong> method accesses the <strong class="source-inline">opportunity</strong> array item at the index position provided by the <strong class="source-inline">opportunityId</strong> request query parameter.</p>
			<ol>
				<li value="14">Finally, create the definitions of the mock endpoints, as follows:<p class="source-code">export default {</p><p class="source-code">  <strong class="bold">'/api/opportunity/list'</strong>: listOpportunities,</p><p class="source-code">  <strong class="bold">'/api/opportunity'</strong>: getOpportunity,</p><p class="source-code">  <strong class="bold">'/api/opportunity/activities'</strong>: (_: any, res:</p><p class="source-code"><strong class="bold">   </strong> Response) =&gt;</p><p class="source-code">    res.send({ data: activities, success: true }),</p><p class="source-code">  <strong class="bold">'POST /api/opportunity'</strong>: (_: any, res: Response) =&gt;</p><p class="source-code">    res.status(201).send({ success: true }),</p><p class="source-code">  <strong class="bold">'PUT /api/opportunity/disable'</strong>: (_: any, res:</p><p class="source-code"><strong class="bold">   </strong> Response) =&gt;</p><p class="source-code">    res.send({ success: true }),</p><p class="source-code">  <strong class="bold">'PUT /api/opportunity'</strong>: (_: any, res: Response) =&gt;</p><p class="source-code">    res.send({ success: true }),</p><p class="source-code">};</p></li>
			</ol>
			<p>We <a id="_idIndexMarker207"/>defined<a id="_idIndexMarker208"/> six endpoints: </p>
			<ul>
				<li>A mock endpoint to list all the opportunities (<strong class="source-inline">/api/opportunity/list</strong>) </li>
				<li>A mock endpoint to get an opportunity by ID (<strong class="source-inline">/api/opportunity</strong>)</li>
				<li>A mock endpoint to get opportunity activities (<strong class="source-inline">/api/opportunity/activities</strong>)</li>
				<li>A mock endpoint to create a new opportunity record (<strong class="source-inline">POST /api/opportunity</strong>)</li>
				<li>A mock endpoint to disable an opportunity record (<strong class="source-inline">PUT /api/opportunity/disable</strong>)</li>
				<li>A mock endpoint to update an opportunity record (<strong class="source-inline">PUT /api/opportunity</strong>)</li>
			</ul>
			<p>In this section, we<a id="_idIndexMarker209"/> created mock files to provide data for our <a id="_idIndexMarker210"/>interfaces using the <strong class="source-inline">faker.js</strong> library to generate random data. </p>
			<p>Now, we'll learn how to organize our project with the <strong class="source-inline">services</strong> folder and send requests to our simulated backend using the umi-request library.</p>
			<h1 id="_idParaDest-48"><a id="_idTextAnchor050"/>Sending HTTP requests with Umi request</h1>
			<p>In this<a id="_idIndexMarker211"/> section, we'll develop the requests to the backend using the umi-request library.</p>
			<p>We'll create all <a id="_idIndexMarker212"/>the requests in separate files inside the <strong class="source-inline">services</strong> folder for each context. This organization helps us clean the components' code and reuses the requests over the interfaces.</p>
			<p>For sending HTTP requests, we'll use <strong class="bold">Umi request</strong>. This is a library based in<a id="_idIndexMarker213"/> the <strong class="bold">fetch</strong> and <strong class="bold">axios</strong> libraries <a id="_idIndexMarker214"/>that is simple to use and provides common features such as error handling and caching. Consider the following example:</p>
			<p class="source-code">request&lt;<strong class="bold">Product</strong>&gt;(<strong class="bold">'/api/products'</strong>, {</p>
			<p class="source-code">  <strong class="bold">method</strong>: 'POST',</p>
			<p class="source-code">  <strong class="bold">headers</strong>: { Authorization: 'Bearer eyJhbGciOi...' },</p>
			<p class="source-code">  <strong class="bold">params</strong>: { onSale: true },</p>
			<p class="source-code">  <strong class="bold">data</strong>: {</p>
			<p class="source-code">    id: 0,</p>
			<p class="source-code">    title: 'My product',</p>
			<p class="source-code">    price: 10.0,</p>
			<p class="source-code">  },</p>
			<p class="source-code">});</p>
			<p>The <strong class="source-inline">request</strong> function<a id="_idIndexMarker215"/> requires two main parameters – the <strong class="source-inline">URL</strong> parameter where we want to send the request, and the <strong class="source-inline">options</strong> parameter in which we can define the HTTP method, the request headers, the request parameters, and the request body in the <strong class="source-inline">data</strong> property. You can also determine the response type. In this<a id="_idIndexMarker216"/> example, we described the response type with the <strong class="source-inline">Product</strong> interface.</p>
			<p>Follow these steps to develop the requests:</p>
			<ol>
				<li value="1">Create a new folder named <strong class="source-inline">services</strong> in the <strong class="source-inline">src</strong> folder.</li>
				<li>Inside the <strong class="source-inline">services</strong> folder, create a new file named <strong class="source-inline">analytics.ts</strong> and the requests, as follows:<p class="source-code">import { HistoryByMonth, LeadsSource, TopOpportunity, } from '@/types/analytics';</p><p class="source-code">import { request } from 'umi';</p><p class="source-code">export function <strong class="bold">getTopOpportunities()</strong> {</p><p class="source-code">  return request&lt;{ data: TopOpportunity[]; </p><p class="source-code">    success: boolean }&gt;(</p><p class="source-code">    `<strong class="bold">/api/analytics/top/opportunity</strong>`,</p><p class="source-code">    {</p><p class="source-code">      method: 'GET',</p><p class="source-code">    },</p><p class="source-code">  );</p><p class="source-code">}</p><p class="source-code">export function <strong class="bold">getLeadsBySource()</strong> {</p><p class="source-code">  return request&lt;{ data: LeadsSource[]; </p><p class="source-code">    success: boolean }&gt;(</p><p class="source-code">    `<strong class="bold">/api/analytics/leads/source</strong>`,</p><p class="source-code">    {</p><p class="source-code">      method: 'GET',</p><p class="source-code">    },</p><p class="source-code">  );</p><p class="source-code">}</p><p class="source-code">export function <strong class="bold">getHistoryByMonth()</strong> {</p><p class="source-code">  return request&lt;{ data: HistoryByMonth[]; </p><p class="source-code">    success: boolean }&gt;(</p><p class="source-code">    `<strong class="bold">/api/analytics/bymonth/opportunity</strong>`,</p><p class="source-code">    {</p><p class="source-code">      method: 'GET',</p><p class="source-code">    },</p><p class="source-code">  );</p><p class="source-code">}</p></li>
			</ol>
			<p>We <a id="_idIndexMarker217"/>created three functions – <strong class="source-inline">getTopOpportunities</strong> to<a id="_idIndexMarker218"/> request the top opportunities, <strong class="source-inline">getLeadsBySource</strong> to request the leads by source, and <strong class="source-inline">getHistoryByMonth</strong> to request the opportunities won/lost by month.</p>
			<ol>
				<li value="3">Now, we can use the requests response to fill our charts data source on the <strong class="bold">Reports</strong> page. Add <a id="_idIndexMarker219"/>the following to <a id="_idIndexMarker220"/>the <strong class="source-inline">index.tsx</strong> file in the <strong class="source-inline">pages/Reports</strong> folder:<p class="source-code">const [leadsBySource, setLeadsBySource] = </p><p class="source-code">  <strong class="bold">useState</strong>&lt;LeadsSource[]&gt;([]);</p><p class="source-code">const [historyByMonth, setHistoryByMonth] = </p><p class="source-code">  <strong class="bold">useState</strong>&lt;any[]&gt;([]);</p><p class="source-code">const [topOpp, setTopOpp] = </p><p class="source-code">  <strong class="bold">useState</strong>&lt;TopOpportunity[]&gt;([]);</p><p class="source-code"><strong class="bold">useEffect</strong>(() =&gt; {</p><p class="source-code">  const fetchTopOpp = async () =&gt; {</p><p class="source-code">    setTopOpp((<strong class="bold">await getTopOpportunities()</strong>).data);</p><p class="source-code">  };</p><p class="source-code">  const fetchLeadsBySource = async () =&gt; {</p><p class="source-code">    setLeadsBySource((<strong class="bold">await getLeadsBySource()</strong>).data);</p><p class="source-code">  };</p><p class="source-code">  const fetchHistoryByMonth = async () =&gt; {</p><p class="source-code">    setHistoryByMonth((<strong class="bold">await </strong></p><p class="source-code"><strong class="bold">                       getHistoryByMonth()</strong>).data);</p><p class="source-code">  };</p><p class="source-code">  fetchHistoryByMonth();</p><p class="source-code">  fetchLeadsBySource();</p><p class="source-code">  fetchTopOpp();</p><p class="source-code">}, []);</p></li>
			</ol>
			<p>We created three states using the <strong class="source-inline">useState</strong> React hook to store our charts data and utilized the <strong class="source-inline">useEffect</strong> React hook to fill our charts with data when the page is rendered.</p>
			<ol>
				<li value="4">Import<a id="_idIndexMarker221"/> all the React dependencies<a id="_idIndexMarker222"/> and functions from the <strong class="source-inline">analytics.ts</strong> file, as follows:<p class="source-code">import { useState, useEffect } from 'react';</p><p class="source-code">import {</p><p class="source-code">  getHistoryByMonth,</p><p class="source-code">  getLeadsBySource,</p><p class="source-code">  getTopOpportunities,</p><p class="source-code">} from '@/services/analytics';</p></li>
				<li>Next, add each state to the <strong class="source-inline">data</strong> property of the corresponding <strong class="source-inline">Chart</strong> component. The result should look like the following:</li>
			</ol>
			<div>
				<div id="_idContainer029" class="IMG---Figure">
					<img src="image/Figure_3.01_B18503.jpg" alt="Figure 3.1 – The Reports page charts filled with data&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.1 – The Reports page charts filled with data</p>
			<ol>
				<li value="6">Let's create the<a id="_idIndexMarker223"/> requests for the customer page. In the <strong class="source-inline">services</strong> folder, create a <a id="_idIndexMarker224"/>new file named <strong class="source-inline">customer.ts</strong> and write the requests, as follows:<p class="source-code">import { Customer } from '@/types/customer';</p><p class="source-code">import { request } from 'umi';</p><p class="source-code">export function <strong class="bold">listCustomers</strong>(params?: any) {</p><p class="source-code">  return request&lt;{ data: Customer[]; success: boolean </p><p class="source-code">    }&gt;(`<strong class="bold">/api/customer/list</strong>`, {</p><p class="source-code">    method: 'GET',</p><p class="source-code">    params,</p><p class="source-code">  });</p><p class="source-code">}</p><p class="source-code">export function <strong class="bold">createCustomer</strong>(customer: Customer) {</p><p class="source-code">  return request&lt;{ success: boolean </p><p class="source-code">    }&gt;(`<strong class="bold">/api/customer</strong>`, {</p><p class="source-code">    method: 'POST',</p><p class="source-code">    data: customer,</p><p class="source-code">  });</p><p class="source-code">}</p><p class="source-code">export function <strong class="bold">disableCustomer</strong>(customerId?: string) {</p><p class="source-code">  return request&lt;{ success: boolean </p><p class="source-code">    }&gt;(`<strong class="bold">/api/customer/disable</strong>`, {</p><p class="source-code">    method: 'PUT',</p><p class="source-code">    params: { customerId },</p><p class="source-code">  });</p><p class="source-code">}</p><p class="source-code">export function <strong class="bold">updateCustomer</strong>(customer: Customer) {</p><p class="source-code">  return request&lt;{ success: boolean </p><p class="source-code">    }&gt;(`<strong class="bold">/api/customer</strong>`, {</p><p class="source-code">    method: 'PUT',</p><p class="source-code">    data: customer,</p><p class="source-code">  });</p><p class="source-code">}</p></li>
			</ol>
			<p>We <a id="_idIndexMarker225"/>created four functions – <strong class="source-inline">listCustomers</strong> to list <a id="_idIndexMarker226"/>all the customers,<strong class="source-inline"> createCustomer</strong> to post a new customer record, <strong class="source-inline">disableCustomer</strong> to disable a customer record, and <strong class="source-inline">updateCustomer</strong> to update a customer record.</p>
			<ol>
				<li value="7">Now, we can list a customer in the <strong class="source-inline">ProTable</strong> component on the customer page. Import the <strong class="source-inline">listCustomers</strong> function to the <strong class="source-inline">index.tsx</strong> file in the <strong class="source-inline">pages/Customers</strong> folder by adding the following line:<p class="source-code"><strong class="bold">import { listCustomers } from '@/services/customer';</strong></p></li>
				<li>Next, add the <strong class="source-inline">listCustomers</strong> function to the <strong class="source-inline">request</strong> property of the <strong class="source-inline">ProTable</strong> component, as follows:<p class="source-code"><strong class="bold">request={listCustomers}</strong></p></li>
			</ol>
			<p>The result should look like the following:</p>
			<div>
				<div id="_idContainer030" class="IMG---Figure">
					<img src="image/Figure_3.02_B18503.jpg" alt="Figure 3.2 – The Customers list in the ProTable component&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.2 – The Customers list in the ProTable component</p>
			<ol>
				<li value="9">Finally, we'll create the requests on the opportunity page. Create a new file named <strong class="source-inline">opportunity.ts</strong> in the <strong class="source-inline">services</strong> folder.</li>
				<li>Create<a id="_idIndexMarker227"/> the following functions in the <strong class="source-inline">opportunity.ts</strong> file, as<a id="_idIndexMarker228"/> follows:<p class="source-code">import { Opportunity, Activity } from '@/types/opportunity';</p><p class="source-code">import { request } from 'umi';</p><p class="source-code">export function <strong class="bold">listOpportunities</strong>(params?: any) {</p><p class="source-code">  return request&lt;{ data: Opportunity[];</p><p class="source-code">    success: boolean }&gt;(</p><p class="source-code">    `<strong class="bold">/api/opportunity/list</strong>`,</p><p class="source-code">    {</p><p class="source-code">      method: 'GET',</p><p class="source-code">      params,</p><p class="source-code">    },</p><p class="source-code">  );</p><p class="source-code">}</p><p class="source-code">export function <strong class="bold">listActivities</strong>(params?: any) {</p><p class="source-code">  return request&lt;{ data: Activity[]; </p><p class="source-code">    success: boolean }&gt;(</p><p class="source-code">    `<strong class="bold">/api/opportunity/activities</strong>`,</p><p class="source-code">    {</p><p class="source-code">      method: 'GET',</p><p class="source-code">      params,</p><p class="source-code">    },</p><p class="source-code">  );</p><p class="source-code">}</p><p class="source-code">export function <strong class="bold">getOpportunity</strong>(params?: any) {</p><p class="source-code">  return request&lt;Opportunity&gt;(`<strong class="bold">/api/opportunity</strong>`, {</p><p class="source-code">    method: 'GET',</p><p class="source-code">    params,</p><p class="source-code">  });</p><p class="source-code">}</p></li>
			</ol>
			<p>We created <a id="_idIndexMarker229"/>three functions – <strong class="source-inline">listOpportunities</strong> to get all the opportunities, <strong class="source-inline">listActivities</strong> to list all the opportunity activities, and <strong class="source-inline">getOpportunity</strong> to get an opportunity by ID.</p>
			<ol>
				<li value="11">Next, create the other<a id="_idIndexMarker230"/> three functions in the <strong class="source-inline">opportunity.ts</strong> file, as follows:<p class="source-code">export function <strong class="bold">createOpportunity</strong>(opportunity: Opportunity) {</p><p class="source-code">  return request&lt;{ success: boolean </p><p class="source-code">    }&gt;(`<strong class="bold">/api/opportunity</strong>`, {</p><p class="source-code">    method: 'POST',</p><p class="source-code">    data: opportunity,</p><p class="source-code">  });</p><p class="source-code">}</p><p class="source-code">export function <strong class="bold">disableOpportunity</strong>(opportunityId?: string) {</p><p class="source-code">  return request&lt;{ success: boolean </p><p class="source-code">    }&gt;(`<strong class="bold">/api/opportunity/disable</strong>`, {</p><p class="source-code">    method: 'PUT',</p><p class="source-code">    params: { opportunityId },</p><p class="source-code">  });</p><p class="source-code">}</p><p class="source-code">export function <strong class="bold">updateOpportunity</strong>(opportunity: Opportunity) {</p><p class="source-code">  return request&lt;{ success: boolean </p><p class="source-code">    }&gt;(`<strong class="bold">/api/opportunity</strong>`, {</p><p class="source-code">    method: 'PUT',</p><p class="source-code">    data: opportunity,</p><p class="source-code">  });</p><p class="source-code">}</p></li>
			</ol>
			<p>We created three more functions – <strong class="source-inline">createOpportunity</strong> to create a new opportunity record, <strong class="source-inline">disableOpportunity</strong> to disable an opportunity record, and <strong class="source-inline">updateOpportunity</strong> to update an opportunity record.</p>
			<ol>
				<li value="12">Now, we<a id="_idIndexMarker231"/> can list an opportunity in the <strong class="source-inline">ProTable</strong> component on the opportunity page. Add the following<a id="_idIndexMarker232"/> import to the <strong class="source-inline">index.tsx</strong> file in the <strong class="source-inline">pages/Oppo<a id="_idTextAnchor051"/>rtunity</strong> folder:<p class="source-code"><strong class="bold">import { listOpportunities } from '@/services/opportunity';</strong></p></li>
				<li>Next, add the <strong class="source-inline">listOpportunities</strong> function to the <strong class="source-inline">request</strong> property of the <strong class="source-inline">ProTable</strong> component, as follows:<p class="source-code"><strong class="bold">request={listOpportunities}</strong></p></li>
			</ol>
			<p>The result should look like the following:</p>
			<div>
				<div id="_idContainer031" class="IMG---Figure">
					<img src="image/Figure_3.03_B18503.jpg" alt="Figure 3.3 – The Opportunity list on the ProTable component&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.3 – The Opportunity list on the ProTable component</p>
			<ol>
				<li value="14">Let's also <a id="_idIndexMarker233"/>get the opportunity and list the opportunity activities on the opportunity details page. Import the following to the opportunity details page:<p class="source-code">import { useEffect, useState } from 'react';</p><p class="source-code">import { getOpportunity, listActivities } from '@/services/opportunity';</p></li>
				<li>Next, add<a id="_idIndexMarker234"/> the state to store the opportunity and the effect to request it, as follows:<p class="source-code">const [opportunity, setOpportunity] = </p><p class="source-code">  useState&lt;Opportunity&gt;();</p><p class="source-code">useEffect(() =&gt; {</p><p class="source-code">  const fetchOpportunity = async () =&gt; {</p><p class="source-code">    setOpportunity(await getOpportunity({ </p><p class="source-code">      opportunityId: id }));</p><p class="source-code">  };</p><p class="source-code">  fetchOpportunity();</p><p class="source-code">}, [])</p></li>
				<li>Next, add the <strong class="source-inline">opportunity</strong> state to the <strong class="source-inline">dataSource</strong> property of the <strong class="source-inline">ProDescriptions</strong> component, as follows:<p class="source-code"><strong class="bold">dataSource={opportunity}</strong></p></li>
				<li>Let's also add the <strong class="source-inline">listActivities</strong> function to the <strong class="source-inline">request</strong> property of the <strong class="source-inline">ProTable</strong> components, as follows:<p class="source-code"><strong class="bold">request={listActivities}</strong></p></li>
				<li>Add the <a id="_idIndexMarker235"/><strong class="source-inline">opportunity</strong> <strong class="source-inline">status</strong> property to the <strong class="source-inline">current</strong> property of the <strong class="source-inline">Step</strong> component, as follows:<p class="source-code"><strong class="bold">current={opportunity?.status}</strong></p></li>
			</ol>
			<p>Now, the <a id="_idIndexMarker236"/>opportunity details page should look like the following:</p>
			<div>
				<div id="_idContainer032" class="IMG---Figure">
					<img src="image/Figure_3.04_B18503.jpg" alt="Figure 3.4 – Opportunity – Details and the Activities list &#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Figure 3.4 – Opportunity – Details and the Activities list </p>
			<p>In this section, we created the <strong class="source-inline">services</strong> folder and the request for each page using the umi-request library. We also used the request on each page to access the data to fill our interfaces. Next, we'll learn to share states and logic between components by creating model files.</p>
			<h1 id="_idParaDest-49"><a id="_idTextAnchor052"/>Using models for sharing states and logic</h1>
			<p>In this section, we'll create models for sharing states and logic between components.</p>
			<p>A model is a <a id="_idIndexMarker237"/>special custom React hook to centralize the states and logic for a specific context. </p>
			<p>We must <a id="_idIndexMarker238"/>create the models' files inside the <strong class="source-inline">src/models</strong> folder, and we can access these models using the <strong class="source-inline">useModel</strong> custom hook, as follows:</p>
			<p class="source-code"><strong class="bold">const { currentUser } = useModel('user');</strong></p>
			<p>Here, the <strong class="source-inline">user</strong> namespace matches the model filename, so the model file must be named <strong class="source-inline">user.ts</strong>.</p>
			<p>Let's create the <strong class="source-inline">customer</strong> model and the <strong class="source-inline">opportunity</strong> model to demonstrate the use of models. These two models will contain the logic and result for creating, reading, and updating operations and share these operations between different interfaces.</p>
			<p>Follow these steps to create the models:</p>
			<ol>
				<li value="1">Create a new folder called <strong class="source-inline">models</strong> inside the <strong class="source-inline">src</strong> folder.</li>
				<li>Next, create a new file named <strong class="source-inline">customer.ts</strong> under the <strong class="source-inline">models</strong> folder and add the following:<p class="source-code">import { useCallback, useState } from 'react';</p><p class="source-code">import { Customer } from '@/types/customer';</p><p class="source-code">import {</p><p class="source-code">  disableCustomer,</p><p class="source-code">  updateCustomer,</p><p class="source-code">  createCustomer,</p><p class="source-code">} from '@/services/customer';</p><p class="source-code">export interface <strong class="bold">CustomerModel</strong> {</p><p class="source-code">  <strong class="bold">disable</strong>: (customerId: string) =&gt; void;</p><p class="source-code">  <strong class="bold">update</strong>: (customer: Customer) =&gt; void;</p><p class="source-code">  <strong class="bold">create</strong>: (customer: Customer) =&gt; void;</p><p class="source-code">  <strong class="bold">clearResult</strong>: () =&gt; void;</p><p class="source-code">  <strong class="bold">result</strong>: { success?: boolean };</p><p class="source-code">}</p></li>
			</ol>
			<p>We created the <strong class="source-inline">CustomerModel</strong> interface to describe all the functions and states we want to share between components.</p>
			<ol>
				<li value="3">Now, create <a id="_idIndexMarker239"/>the functions and state, as follows:<p class="source-code">export default (): CustomerModel =&gt; {</p><p class="source-code">  <strong class="bold">const [result, setResult] = useState&lt;{</strong></p><p class="source-code"><strong class="bold">    success?: boolean }&gt;({</strong></p><p class="source-code"><strong class="bold">    success: false,</strong></p><p class="source-code"><strong class="bold">  });</strong></p><p class="source-code">  const disable = useCallback(async (</p><p class="source-code">    customerId?: string) =&gt; {</p><p class="source-code">    setResult(<strong class="bold">await disableCustomer(customerId)</strong>);</p><p class="source-code">  }, []);</p><p class="source-code">  const update = useCallback(async (</p><p class="source-code">    customer: Customer) =&gt; {</p><p class="source-code">    setResult(<strong class="bold">await updateCustomer(customer)</strong>);</p><p class="source-code">  }, []);</p><p class="source-code">  const create = useCallback(async (</p><p class="source-code">    customer: Customer) =&gt; {</p><p class="source-code">    setResult(<strong class="bold">await createCustomer(customer)</strong>);</p><p class="source-code">  }, []);</p><p class="source-code">  const clearResult = useCallback(() =&gt; setResult({ </p><p class="source-code">    success: false }), []);</p><p class="source-code">  return { disable, update, create, clearResult, </p><p class="source-code">    result };</p><p class="source-code">};</p></li>
			</ol>
			<p>We<a id="_idIndexMarker240"/> created a state to store the result and used the requests from the <strong class="source-inline">services</strong> files to execute the operations.</p>
			<ol>
				<li value="4">Let's use the <strong class="source-inline">customer</strong> model functions in the <strong class="source-inline">ProTable</strong> component on the <strong class="bold">Customers</strong> page. Add the following to the <strong class="source-inline">index.tsx</strong> file in the <strong class="source-inline">pages/Customer</strong> folder:<p class="source-code">const { disable, update, clearResult, result } = </p><p class="source-code">  useModel('customer');</p><p class="source-code">  const { formatMessage } = useIntl();</p><p class="source-code">  useEffect(() =&gt; {</p><p class="source-code">    if (result?.success) {</p><p class="source-code">      <strong class="bold">message.success(formatMessage({ </strong></p><p class="source-code"><strong class="bold">        id: 'messages.success.operation' }));</strong></p><p class="source-code">      clearResult();</p><p class="source-code">    }</p><p class="source-code">  }, [result]);</p></li>
			</ol>
			<p>We used the <strong class="source-inline">result</strong> state to determine whether the operation succeeded and showed a success message.</p>
			<ol>
				<li value="5">Add <a id="_idIndexMarker241"/>the <strong class="source-inline">editable</strong> property to the <strong class="source-inline">ProTable</strong> component using the <strong class="source-inline">model</strong> functions, as follows:<p class="source-code">editable={{</p><p class="source-code">  type: 'multiple',</p><p class="source-code">  deletePopconfirmMessage: &lt;FormattedMessage </p><p class="source-code">    id="table.confirm" /&gt;,</p><p class="source-code">  deleteText: &lt;FormattedMessage id="table.disable" /&gt;,</p><p class="source-code">  onDelete: async (key) =&gt; <strong class="bold">disable</strong>(key as string),</p><p class="source-code">  onSave: async (_, record) =&gt; <strong class="bold">update</strong>(record),</p><p class="source-code">}}</p></li>
			</ol>
			<p>We used the <strong class="source-inline">disable</strong> and <strong class="source-inline">update</strong> functions to provide the editable feature in the <strong class="source-inline">ProTable</strong> component.</p>
			<ol>
				<li value="6">Now, repeat the previous steps to create the <strong class="source-inline">opportunity</strong> model and enable the editable feature in the <strong class="bold">Opportunities</strong> page's <strong class="source-inline">ProTable</strong> component.</li>
				<li>Add the text to the <strong class="source-inline">en-US.ts</strong> file under the <strong class="source-inline">locales</strong> folder, as follows:<p class="source-code">'table.disable': 'Disable',</p><p class="source-code">'table.confirm': 'Do you want to disable the record?',</p></li>
			</ol>
			<p>Now, you <a id="_idIndexMarker242"/>can edit the records on both pages, as shown in the following screenshot:</p>
			<div>
				<div id="_idContainer033" class="IMG---Figure">
					<img src="image/Figure_3.05_B18503.jpg" alt="Feature 3.5 – The ProTable editable feature on the Customers page&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">Feature 3.5 – The ProTable editable feature on the Customers page</p>
			<p>In this section, you learned how models work. We created the <strong class="source-inline">customer</strong> and <strong class="source-inline">opportunity</strong> models for sharing states and logic and used them in the <strong class="bold">Customers</strong> and <strong class="bold">Opportunities</strong> pages to enable the <strong class="source-inline">ProTable</strong> editable feature.</p>
			<h1 id="_idParaDest-50"><a id="_idTextAnchor053"/>Summary</h1>
			<p>In this chapter, we created the definition files for all the backend data and created the <strong class="source-inline">ProTable</strong> column definitions on each page. We created the opportunity details page using the <strong class="source-inline">ProDescritions</strong> component and the <strong class="source-inline">Activity</strong> interface to describe the opportunity activities.  </p>
			<p>You learned how Umi mock files work and how to create mock endpoints to provide simulated backend data and logic by creating the mock files for our application. Next, you learned how to organize your application requests using the <strong class="source-inline">services</strong> folder and send requests using the umi-request library by creating the <strong class="source-inline">services</strong> files for our application. Finally, you learned how models work and created the <strong class="source-inline">customer</strong> and <strong class="source-inline">opportunity</strong> models to share logic and state between components.</p>
			<p>In the next chapter, you will learn how to handle API error responses by configuring the umi-request library, protecting routes using <strong class="bold">plugin-access</strong>, and storing and globally accessing user information after login.</p>
		</div>
	</body></html>
<html><head></head><body>
  <div id="_idContainer075" class="Basic-Text-Frame">
    <h1 class="chapterNumber">7</h1>
    <h1 id="_idParaDest-118" class="chapterTitle">Handling Navigation with Routes</h1>
    <p class="normal">Almost every web application requires routing, which is the process of responding to a URL based on a set of route handler declarations. In other words, this is a mapping from the URL to rendered content. However, this task is more involved than it seems at first, due to the complexities of managing different URL patterns and mapping them to appropriate content rendering. This includes handling nested routes and dynamic parameters and ensuring proper navigation flow. The complexities of these tasks are why you’re going to leverage<a id="_idIndexMarker253"/> the <code class="inlineCode">react-router</code> package in this chapter, the de facto routing tool for React.</p>
    <p class="normal">First, you’ll learn the basics of declaring routes using JSX syntax. Then, you’ll learn about the dynamic aspects of routing, such as dynamic path segments and query parameters. Next, you’ll implement links using components from <code class="inlineCode">react-router</code>.</p>
    <p class="normal">Here are the high-level topics that we’ll cover in this chapter:</p>
    <ul>
      <li class="bulletList">Declaring routes</li>
      <li class="bulletList">Handling route parameters</li>
      <li class="bulletList">Using link components</li>
    </ul>
    <h1 id="_idParaDest-119" class="heading-1">Technical requirements</h1>
    <p class="normal">You can find the code files for this chapter on GitHub at <a href="https://github.com/PacktPublishing/React-and-React-Native-5E/tree/main/Chapter07"><span class="url">https://github.com/PacktPublishing/React-and-React-Native-5E/tree/main/Chapter07</span></a>.</p>
    <h1 id="_idParaDest-120" class="heading-1">Declaring routes</h1>
    <p class="normal">With <code class="inlineCode">react-router</code>, you <a id="_idIndexMarker254"/>can collocate routes with the content that they render. By defining routes using JSX syntax alongside the components they are associated with, <code class="inlineCode">react-router</code> empowers developers to create a clear and logical structure for their React applications. This collocation makes it easier to understand how different parts of the application are connected and navigated, leading to improved readability and maintainability of the code base.</p>
    <p class="normal">Throughout this chapter, we’ll explore the fundamentals of routing in React applications using <code class="inlineCode">react-router</code>. We’ll start by creating a basic example route to familiarize ourselves with the syntax and structure of route declarations. Then, we’ll dive deeper into organizing routes by feature, rather than relying on a monolithic routing module. Finally, we’ll implement a common parent-child routing pattern to demonstrate how to handle more complex routing scenarios.</p>
    <h2 id="_idParaDest-121" class="heading-2">Hello route</h2>
    <p class="normal">Before we start <a id="_idIndexMarker255"/>writing code, let’s set up the <code class="inlineCode">react-router</code><a id="_idIndexMarker256"/> project. Run the following command to add <code class="inlineCode">react-router-dom</code> to the dependencies:</p>
    <pre class="programlisting con"><code class="hljs-con">npm install react-router-dom
</code></pre>
    <p class="normal">Let’s create a simple route that renders a simple component: </p>
    <ol class="numberedList" style="list-style-type: decimal;">
      <li class="numberedList" value="1">First, we have a small React component that we want to render when the route is activated:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">function</span> <span class="hljs-title">MyComponent</span>() {
  <span class="hljs-keyword">return</span> <span class="hljs-tag">&lt;</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>Hello Route!<span class="hljs-tag">&lt;/</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>;
}
</code></pre>
      </li>
      <li class="numberedList">Next, let’s look at the route definition:
        <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">import</span> <span class="hljs-title">React</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"react"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title">ReactDOM</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"react-dom/client"</span>;
<span class="hljs-keyword">import</span> { createBrowserRouter, <span class="hljs-title">RouterProvider</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">"react-router-dom"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-title">MyComponent</span> <span class="hljs-keyword">from</span> <span class="hljs-string">"./MyComponent"</span>;
<span class="hljs-keyword">const</span> router = <span class="hljs-title">createBrowserRouter</span>([
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">"/"</span>,
    <span class="hljs-attr">element</span>: <span class="hljs-tag">&lt;</span><span class="hljs-name">MyComponent</span><span class="hljs-tag"> /&gt;</span>,
  },
]);
<span class="hljs-title">ReactDOM</span>.<span class="hljs-title">createRoot</span>(<span class="hljs-variable">document</span>.<span class="hljs-title">getElementById</span>(<span class="hljs-string">"root"</span>)!).<span class="hljs-title">render</span>(
  <span class="hljs-tag">&lt;</span><span class="hljs-name">React.StrictMode</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">RouterProvider</span><span class="hljs-tag"> </span><span class="hljs-attr">router</span><span class="hljs-tag">=</span><span class="hljs-string">{router}</span><span class="hljs-tag"> /&gt;</span>
  <span class="hljs-tag">&lt;/</span><span class="hljs-name">React.StrictMode</span><span class="hljs-tag">&gt;</span>
);
</code></pre>
      </li>
    </ol>
    <p class="normal">The <code class="inlineCode">RouterProvider</code> component is the top-level component of the application. Let’s break it down to find out what’s happening within the router.</p>
    <p class="normal">You have the<a id="_idIndexMarker257"/> actual routes declared in the <code class="inlineCode">createBrowserRouter</code> function. There are two key properties of any route: <code class="inlineCode">path</code> and <code class="inlineCode">element</code>. When<a id="_idIndexMarker258"/> the <code class="inlineCode">path</code> property is matched against the active URL, the component is rendered. But where is it rendered, exactly? The router doesn’t actually render anything itself; it’s responsible for managing how other components are connected based on the current URL. In other words, the router checks the current URL and returns the corresponding component from the <code class="inlineCode">createBrowserRouter</code> declaration. Sure enough, when you look at this example in a browser, <code class="inlineCode">&lt;MyComponent&gt;</code> is rendered as expected:</p>
    <figure class="mediaobject"> <img src="../Images/B19636_07_01.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 7.1: The rendered output of our component</p>
    <p class="normal">When the <code class="inlineCode">path</code> property matches the current URL, the route component is replaced by the <code class="inlineCode">element</code> property value. In this example, the route returns <code class="inlineCode">&lt;MyComponent&gt;</code>. If a given route doesn’t match, nothing is rendered.</p>
    <p class="normal">This example shows the fundamentals of routing in React. It’s really simple and intuitive to declare routes. To further solidify your understanding of <code class="inlineCode">react-router</code>, I encourage you to experiment with the concepts we’ve covered. Try creating more routes on your own, and observe<a id="_idIndexMarker259"/> how they impact the behavior of your application. After that, you can try more advanced techniques like lazy loading components using React.lazy and Suspense (you’ll learn more about these in the next chapter), and implement route-based code <a id="_idIndexMarker260"/>splitting to optimize your application’s performance. By diving deeper into these topics and applying them to your own projects, you’ll gain a greater appreciation for the capabilities of <code class="inlineCode">react-router</code> and its role in building modern, efficient, and user-friendly React applications.</p>
    <h2 id="_idParaDest-122" class="heading-2">Decoupling route declarations</h2>
    <p class="normal">The difficulty with <a id="_idIndexMarker261"/>routing happens when your application has dozens of routes declared within a single module since it’s more difficult to mentally map routes to features.</p>
    <p class="normal">To help with this, each top-level feature of the application can define its own routes. This way, it’s clear which routes belong to which feature. So, let’s start with the <code class="inlineCode">App</code> component:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">const</span> router = <span class="hljs-title">createBrowserRouter</span>([
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">"/"</span>,
    <span class="hljs-attr">element</span>: <span class="hljs-tag">&lt;</span><span class="hljs-name">Layout</span><span class="hljs-tag"> /&gt;</span>,
    <span class="hljs-attr">children</span>: [
      {
        <span class="hljs-attr">index</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">element</span>: <span class="hljs-tag">&lt;</span><span class="hljs-name">h1</span><span class="hljs-tag">&gt;</span>Nesting Routes<span class="hljs-tag">&lt;/</span><span class="hljs-name">h1</span><span class="hljs-tag">&gt;</span>,
      },
      routeOne,
      routeTwo,
    ],
  },
]);
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title">App</span> = () =&gt; <span class="hljs-tag">&lt;</span><span class="hljs-name">RouterProvider</span><span class="hljs-tag"> </span><span class="hljs-attr">router</span><span class="hljs-tag">=</span><span class="hljs-string">{router}</span><span class="hljs-tag"> /&gt;</span>;
</code></pre>
    <p class="normal">In this example, the application has two routes: <code class="inlineCode">one</code> and <code class="inlineCode">two</code>. These are imported as route objects and placed inside <code class="inlineCode">createBrowserRouter</code>. The first <code class="inlineCode">element</code> in this router is the <code class="inlineCode">&lt;Layout /&gt;</code> component, which renders a page template with data that never changes and serves as a place for our route data. Let’s take a look at the <code class="inlineCode">&lt;Layout /&gt;</code> component:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">function</span> <span class="hljs-title">Layout</span>() {
  <span class="hljs-keyword">return</span> (
    <span class="hljs-tag">&lt;</span><span class="hljs-name">main</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">nav</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">Link</span><span class="hljs-tag"> </span><span class="hljs-attr">to</span><span class="hljs-tag">=</span><span class="hljs-string">"/"</span><span class="hljs-tag">&gt;</span>Main<span class="hljs-tag">&lt;/</span><span class="hljs-name">Link</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span> | <span class="hljs-tag">&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">Link</span><span class="hljs-tag"> </span><span class="hljs-attr">to</span><span class="hljs-tag">=</span><span class="hljs-string">"/one"</span><span class="hljs-tag">&gt;</span>One<span class="hljs-tag">&lt;/</span><span class="hljs-name">Link</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span> | <span class="hljs-tag">&lt;/</span><span class="hljs-name">span</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">Link</span><span class="hljs-tag"> </span><span class="hljs-attr">to</span><span class="hljs-tag">=</span><span class="hljs-string">"/two"</span><span class="hljs-tag">&gt;</span>Two<span class="hljs-tag">&lt;/</span><span class="hljs-name">Link</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">nav</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">Outlet</span><span class="hljs-tag"> /&gt;</span>
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">main</span><span class="hljs-tag">&gt;</span>
  );
}
</code></pre>
    <p class="normal">This<a id="_idIndexMarker262"/> component contains a small navigation toolbar with links and the <code class="inlineCode">&lt;Outlet /&gt;</code> component. It’s a built-in <code class="inlineCode">react-router</code> component that will be replaced with matched route elements.</p>
    <p class="normal">The router only gets as big as the number of application features, instead of the number of routes, which could be substantially larger. Let’s take a look at one of the feature routes:</p>
    <pre class="programlisting code"><code class="hljs-code"> <span class="hljs-keyword">const</span> <span class="hljs-attr">routes</span>: <span class="hljs-title">RouteObject</span> = {
  <span class="hljs-attr">path</span>: <span class="hljs-string">"/one"</span>,
  <span class="hljs-attr">element</span>: <span class="hljs-tag">&lt;</span><span class="hljs-name">Outlet</span><span class="hljs-tag"> /&gt;</span>,
  <span class="hljs-attr">children</span>: [
    {
      <span class="hljs-attr">index</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">element</span>: <span class="hljs-tag">&lt;</span><span class="hljs-name">Redirect</span><span class="hljs-tag"> </span><span class="hljs-attr">path</span><span class="hljs-tag">=</span><span class="hljs-string">"/one/1"</span><span class="hljs-tag"> /&gt;</span>,
    },
    {
      <span class="hljs-attr">path</span>: <span class="hljs-string">"1"</span>,
      <span class="hljs-attr">element</span>: <span class="hljs-tag">&lt;</span><span class="hljs-name">First</span><span class="hljs-tag"> /&gt;</span>,
    },
    {
      <span class="hljs-attr">path</span>: <span class="hljs-string">"2"</span>,
      <span class="hljs-attr">element</span>: <span class="hljs-tag">&lt;</span><span class="hljs-name">Second</span><span class="hljs-tag"> /&gt;</span>,
    },
  ],
};
</code></pre>
    <p class="normal">This module, <code class="inlineCode">one/index.js</code>, exports a configuration object with three routes:</p>
    <ul>
      <li class="bulletList">When the <code class="inlineCode">/one</code> path is matched, redirect to <code class="inlineCode">/one/1</code>.</li>
      <li class="bulletList">When the <code class="inlineCode">/one/1</code> path is matched, render the <code class="inlineCode">First</code> component.</li>
      <li class="bulletList">When the <code class="inlineCode">/one/2</code> path is matched, render the <code class="inlineCode">Second</code> component.</li>
    </ul>
    <p class="normal">This <a id="_idIndexMarker263"/>means that when the app loads the URL, <code class="inlineCode">/one</code>, the <code class="inlineCode">&lt;Redirect&gt;</code> component, will send the user to <code class="inlineCode">/one/1</code>. Like the <code class="inlineCode">RouterProvider</code>, the <code class="inlineCode">Redirect</code> component lacks UI elements inside; it solely manages logic. </p>
    <p class="normal">This aligns with React’s practice of embedding components in layouts to handle specific functionalities. This approach allows for a clean separation of concerns, with components focused solely on rendering UI elements and others, like <code class="inlineCode">Redirect</code>, dedicated to handling routing logic. The <code class="inlineCode">Redirect</code> component in <code class="inlineCode">react-router</code> is responsible for programmatically navigating the user to a different route. It’s commonly used to redirect users from one URL to another based on certain conditions, such as authentication status or route parameters. By abstracting away the navigation logic into a separate component, it promotes code reusability and maintainability within the application.</p>
    <p class="normal">You’re using <code class="inlineCode">Redirect</code> here because we don’t have content on the root route. Often, your application doesn’t actually have content to render at the root of a feature, or at the root of the application itself. This pattern allows you to send the user to the appropriate route and the appropriate content. Here’s what you’ll see when you open the app and click on the <strong class="screenText">One</strong> link:</p>
    <figure class="mediaobject"> <img src="../Images/B19636_07_02.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 7.2: The contents of page 1</p>
    <p class="normal">The second feature follows the exact same pattern as the first. Here’s what the <code class="inlineCode">First</code> component looks like:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title">First</span>() {
  <span class="hljs-keyword">return</span> <span class="hljs-tag">&lt;</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>Feature 1, page 1<span class="hljs-tag">&lt;/</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>;
}
</code></pre>
    <p class="normal">Each feature, in this example, uses the same minimal rendered content. These components <a id="_idIndexMarker264"/>are ultimately what the user needs to see when they navigate to a given route. By organizing routes this way, you’ve made your features self-contained with regard to routing. </p>
    <p class="normal">In the following section, you’ll learn how to further organize your routes into parent-child relationships.</p>
    <h1 id="_idParaDest-123" class="heading-1">Handling route parameters</h1>
    <p class="normal">The URLs<a id="_idIndexMarker265"/> that you’ve seen so far in this chapter have all been static. Most applications will use both <strong class="keyWord">static</strong> and <strong class="keyWord">dynamic</strong> routes. In this section, you’ll learn how to pass dynamic URL segments to your components, how to make these segments optional, and how to get query string parameters.</p>
    <h2 id="_idParaDest-124" class="heading-2">Resource IDs in routes</h2>
    <p class="normal">One common<a id="_idIndexMarker266"/> use case is to make the ID of a resource part of the URL. This makes it easy for your code to get the ID and then make an <strong class="keyWord">API</strong> call that fetches the relevant resource data. Let’s implement a route that renders a user detail page. This will require a route that includes the user ID, which then needs to somehow be passed to the component so that it can fetch the user.</p>
    <p class="normal">Let’s start with the <code class="inlineCode">App</code> component that declares the routes:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">const</span> router = <span class="hljs-title">createBrowserRouter</span>([
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">"/"</span>,
    <span class="hljs-attr">element</span>: <span class="hljs-tag">&lt;</span><span class="hljs-name">UsersContainer</span><span class="hljs-tag"> /&gt;</span>,
    <span class="hljs-attr">errorElement</span>: <span class="hljs-tag">&lt;</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>Route not found<span class="hljs-tag">&lt;/</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>,
  },
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">"/users/:id"</span>,
    <span class="hljs-attr">element</span>: <span class="hljs-tag">&lt;</span><span class="hljs-name">UserContainer</span><span class="hljs-tag"> /&gt;</span>,
    <span class="hljs-attr">errorElement</span>: <span class="hljs-tag">&lt;</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>User not found<span class="hljs-tag">&lt;/</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>,
    <span class="hljs-attr">loader</span>: <span class="hljs-title">async</span> ({ params }) =&gt; {
      <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> <span class="hljs-title">fetchUser</span>(<span class="hljs-title">Number</span>(params.<span class="hljs-property">id</span>));
      <span class="hljs-keyword">return</span> { user };
    },
  },
]);
<span class="hljs-keyword">function</span> <span class="hljs-title">App</span>() {
  <span class="hljs-keyword">return</span> <span class="hljs-tag">&lt;</span><span class="hljs-name">RouterProvider</span><span class="hljs-tag"> </span><span class="hljs-attr">router</span><span class="hljs-tag">=</span><span class="hljs-string">{router}</span><span class="hljs-tag"> /&gt;</span>;
}
</code></pre>
    <p class="normal">The <code class="inlineCode">:</code> syntax marks <a id="_idIndexMarker267"/>the beginning of a URL variable. The <code class="inlineCode">id</code> variable will be passed to the <code class="inlineCode">UserContainer</code> component. Before displaying the component, the <code class="inlineCode">loader</code> function is triggered, asynchronously fetching data for the specified user ID. In the case of data loading errors, the <code class="inlineCode">errorElement</code> prop provides a fallback to handle such situations effectively. Here’s how <code class="inlineCode">UserContainer</code> is implemented:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">function</span> <span class="hljs-title">UserContainer</span>() {
  <span class="hljs-keyword">const</span> params = <span class="hljs-title">useParams</span>();
  <span class="hljs-keyword">const</span> { user } = <span class="hljs-title">useLoaderData</span>() <span class="hljs-keyword">as</span> { <span class="hljs-attr">user</span>: <span class="hljs-title">User</span> };
  <span class="hljs-keyword">return</span> (
    <span class="hljs-tag">&lt;</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
      User ID: {params.id}
      <span class="hljs-tag">&lt;</span><span class="hljs-name">UserData</span><span class="hljs-tag"> </span><span class="hljs-attr">user</span><span class="hljs-tag">=</span><span class="hljs-string">{user}</span><span class="hljs-tag"> /&gt;</span>
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">div</span><span class="hljs-tag">&gt;</span>
  );
}
</code></pre>
    <p class="normal">The <code class="inlineCode">useParams()</code> hook is used to get any dynamic parts of the URL. In this case, you’re interested in the <code class="inlineCode">id</code> parameter. Then, we get <code class="inlineCode">user</code> from the loader function using the <code class="inlineCode">useLoaderData</code> hook. If the URL is missing the segment completely, then this code won’t run at all; the router will revert us to the <code class="inlineCode">errorElement</code> component.</p>
    <p class="normal">Now, let’s take a look at the API functions that were used in this example:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">export</span> type <span class="hljs-title">User</span> = {
  <span class="hljs-attr">first</span>: string;
  <span class="hljs-attr">last</span>: string;
  <span class="hljs-attr">age</span>: number;
};
<span class="hljs-keyword">const</span> <span class="hljs-attr">users</span>: <span class="hljs-title">User</span>[] = [
  { <span class="hljs-attr">first</span>: <span class="hljs-string">"John"</span>, <span class="hljs-attr">last</span>: <span class="hljs-string">"Snow"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">40</span> },
  { <span class="hljs-attr">first</span>: <span class="hljs-string">"Peter"</span>, <span class="hljs-attr">last</span>: <span class="hljs-string">"Parker"</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">30</span> },
];
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title">fetchUsers</span>(): <span class="hljs-title">Promise</span>&lt;<span class="hljs-title">User</span>[]&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title">Promise</span>(<span class="hljs-function">(</span><span class="hljs-params">resolve</span><span class="hljs-function">) =&gt;</span> {
    <span class="hljs-title">resolve</span>(users);
  });
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title">fetchUser</span>(<span class="hljs-params">id: number</span>): <span class="hljs-title">Promise</span>&lt;<span class="hljs-title">User</span>&gt; {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title">Promise</span>(<span class="hljs-function">(</span><span class="hljs-params">resolve, reject</span><span class="hljs-function">) =&gt;</span> {
    <span class="hljs-keyword">const</span> user = users[id];
    <span class="hljs-keyword">if</span> (user === <span class="hljs-literal">undefined</span>) {
      <span class="hljs-title">reject</span>(<span class="hljs-string">'</span><span class="hljs-string">User </span><span class="hljs-subst">${id}</span><span class="hljs-string"> not found'</span>);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-title">resolve</span>(user);
    }
  });
}
</code></pre>
    <p class="normal">The <code class="inlineCode">fetchUsers()</code> function is used by the <code class="inlineCode">UsersContainer</code> component to populate the list of <a id="_idIndexMarker268"/>user links. The <code class="inlineCode">fetchUser()</code> function will find and resolve a value from the <code class="inlineCode">users</code> array of the mock data.</p>
    <p class="normal">Here is the <code class="inlineCode">User</code> component, which is responsible for rendering the user details:</p>
    <pre class="programlisting code"><code class="hljs-code">type <span class="hljs-title">UserDataProps</span> = {
  <span class="hljs-attr">user</span>: <span class="hljs-title">User</span>;
};
<span class="hljs-keyword">function</span> <span class="hljs-title">UserData</span>(<span class="hljs-params">{ user }: UserDataProps</span>) {
  <span class="hljs-keyword">return</span> (
    <span class="hljs-tag">&lt;</span><span class="hljs-name">section</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>{user.first}<span class="hljs-tag">&lt;/</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>{user.last}<span class="hljs-tag">&lt;/</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>{user.age}<span class="hljs-tag">&lt;/</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">section</span><span class="hljs-tag">&gt;</span>
  );
}
</code></pre>
    <p class="normal">When you run this app and navigate to <code class="inlineCode">/</code>, you should see a list of users that looks like this:</p>
    <figure class="mediaobject"> <img src="../Images/B19636_07_03.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 7.3: The contents of the app home page</p>
    <p class="normal">Clicking <a id="_idIndexMarker269"/>on the first link should take you to <code class="inlineCode">/users/0</code>, which looks like this:</p>
    <figure class="mediaobject"> <img src="../Images/B19636_07_04.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 7.4: The contents of the user page</p>
    <p class="normal">If you navigate to a user that doesn’t exist, for example, <code class="inlineCode">/users/2</code>, here’s what you’ll see:</p>
    <figure class="mediaobject"> <img src="../Images/B19636_07_05.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 7.5: When a user isn’t found</p>
    <p class="normal">The reason that you get this error message instead of a 500 error is that the API endpoint <a id="_idIndexMarker270"/>knows how to deal with missing resources:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">if</span> (user === <span class="hljs-literal">undefined</span>) {
  <span class="hljs-title">reject</span>(<span class="hljs-string">'User ${id} not found'</span>);
}
</code></pre>
    <p class="normal">This rejection will be handled by <code class="inlineCode">react-router</code> with the provided <code class="inlineCode">errorElement</code> component.</p>
    <p class="normal">In the next section, we’ll look at defining optional route parameters.</p>
    <h2 id="_idParaDest-125" class="heading-2">Query parameters</h2>
    <p class="normal">Sometimes, we <a id="_idIndexMarker271"/>need optional URL path values or query parameters. URLs work best for simple options, and query parameters work best if there are many values that the component can use.</p>
    <p class="normal">Let’s implement a <a id="_idIndexMarker272"/>user list component that renders a list of users. Optionally, you want to be able to sort the list in descending order. Let’s make this with the route that can accept a query string:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">const</span> router = <span class="hljs-title">createBrowserRouter</span>([
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">"/"</span>,
    <span class="hljs-attr">element</span>: <span class="hljs-tag">&lt;</span><span class="hljs-name">UsersContainer</span><span class="hljs-tag"> /&gt;</span>,
  },
]);
<span class="hljs-title">ReactDOM</span>.<span class="hljs-title">createRoot</span>(<span class="hljs-variable">document</span>.<span class="hljs-title">getElementById</span>(<span class="hljs-string">"root"</span>)!).<span class="hljs-title">render</span>(
  <span class="hljs-tag">&lt;</span><span class="hljs-name">React.StrictMode</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;</span><span class="hljs-name">RouterProvider</span><span class="hljs-tag"> </span><span class="hljs-attr">router</span><span class="hljs-tag">=</span><span class="hljs-string">{router}</span><span class="hljs-tag"> /&gt;</span>
  <span class="hljs-tag">&lt;/</span><span class="hljs-name">React.StrictMode</span><span class="hljs-tag">&gt;</span>
);
</code></pre>
    <p class="normal">There is no special setup in the router for handling query parameters. It’s up to the component to handle any query strings provided to it. So, while the route declaration doesn’t provide a mechanism to define accepted query strings, the router will still pass the query parameters to the component. Let’s take a look at the user list container component:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">export</span> type <span class="hljs-title">SortOrder</span> = <span class="hljs-string">"asc"</span> | <span class="hljs-string">"desc"</span>;
<span class="hljs-keyword">function</span> <span class="hljs-title">UsersContainer</span>() {
  <span class="hljs-keyword">const</span> [users, setUsers] = useState&lt;string[]&gt;([]);
  <span class="hljs-keyword">const</span> [search] = <span class="hljs-title">useSearchParams</span>();
  <span class="hljs-title">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-keyword">const</span> order = search.<span class="hljs-title">get</span>(<span class="hljs-string">"order"</span>) <span class="hljs-keyword">as</span> <span class="hljs-title">SortOrder</span>;
    <span class="hljs-title">fetchUsers</span>(order).<span class="hljs-title">then</span>(<span class="hljs-function">(</span><span class="hljs-params">users</span><span class="hljs-function">) =&gt;</span> {
      <span class="hljs-title">setUsers</span>(users);
    });
  }, [search]);
  <span class="hljs-keyword">return</span> <span class="hljs-tag">&lt;</span><span class="hljs-name">Users</span><span class="hljs-tag"> </span><span class="hljs-attr">users</span><span class="hljs-tag">=</span><span class="hljs-string">{users}</span><span class="hljs-tag"> /&gt;</span>;
}
</code></pre>
    <p class="normal">This <a id="_idIndexMarker273"/>component looks for either of the <code class="inlineCode">order</code> query<a id="_idIndexMarker274"/> strings. It uses this as an argument to the <code class="inlineCode">fetchUsers()</code> API to determine the sort order.</p>
    <p class="normal">Here’s what the <code class="inlineCode">Users</code> component looks like:</p>
    <pre class="programlisting code"><code class="hljs-code">type <span class="hljs-title">UsersProps</span> = {
  <span class="hljs-attr">users</span>: string[];
};
<span class="hljs-keyword">function</span> <span class="hljs-title">Users</span>(<span class="hljs-params">{ users }: UsersProps</span>) {
  <span class="hljs-keyword">return</span> (
    <span class="hljs-tag">&lt;</span><span class="hljs-name">ul</span><span class="hljs-tag">&gt;</span>
      {users.map((user) =&gt; (
        <span class="hljs-tag">&lt;</span><span class="hljs-name">li</span><span class="hljs-tag"> </span><span class="hljs-attr">key</span><span class="hljs-tag">=</span><span class="hljs-string">{user}</span><span class="hljs-tag">&gt;</span>{user}<span class="hljs-tag">&lt;/</span><span class="hljs-name">li</span><span class="hljs-tag">&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">ul</span><span class="hljs-tag">&gt;</span>
  );
}
</code></pre>
    <p class="normal">Here is what’s rendered when you navigate to <code class="inlineCode">/</code>:</p>
    <figure class="mediaobject"> <img src="../Images/B19636_07_06.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 7.6: Rendering the user list in default order</p>
    <p class="normal">If you<a id="_idIndexMarker275"/> include the <code class="inlineCode">order</code> query parameter<a id="_idIndexMarker276"/> by navigating to <code class="inlineCode">/?order=desc</code>, here’s what you get:</p>
    <figure class="mediaobject"> <img src="../Images/B19636_07_07.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 7.7: Rendering the user list in descending order</p>
    <p class="normal">In this section, you learned about parameters in routes. Perhaps the most common pattern is to have the ID of a resource in your app as part of the URL, which means that components need to be able to parse out this information in order to interact with the API. You also learned about query parameters in routes, which are useful for dynamic content, filtering, or passing temporary data between components. Next, you’ll learn about link components.</p>
    <h1 id="_idParaDest-126" class="heading-1">Using link components</h1>
    <p class="normal">In this<a id="_idIndexMarker277"/> section, you’ll learn how to create links. You might be tempted to use the standard <code class="inlineCode">&lt;a&gt;</code> elements to link to pages controlled by <code class="inlineCode">react-router</code>. The problem with this approach is that these links, in simple terms, will try to locate the page on the backend by sending a <code class="inlineCode">GET</code> request. This isn’t what you want because the route configuration is already in the app and we can handle routes locally.</p>
    <p class="normal">First, you’ll see <a id="_idIndexMarker278"/>an example that illustrates how <code class="inlineCode">&lt;Link&gt;</code> components behave somewhat like <code class="inlineCode">&lt;a&gt;</code> elements, except that they work locally. Then, you’ll see how to build links that use URL parameters and query parameters.</p>
    <h2 id="_idParaDest-127" class="heading-2">Basic linking</h2>
    <p class="normal">The idea of <a id="_idIndexMarker279"/>links in React apps is that they point to routes that point to components, which render new content. The <code class="inlineCode">Link</code> component also takes care of the browser history API and looks up route-component mappings. Here’s an application component that renders two links:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">function</span> <span class="hljs-title">Layout</span>() {
  <span class="hljs-keyword">return</span> (
    <span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">nav</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>
          <span class="hljs-tag">&lt;</span><span class="hljs-name">Link</span><span class="hljs-tag"> </span><span class="hljs-attr">to</span><span class="hljs-tag">=</span><span class="hljs-string">"first"</span><span class="hljs-tag">&gt;</span>First<span class="hljs-tag">&lt;/</span><span class="hljs-name">Link</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;/</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>
          <span class="hljs-tag">&lt;</span><span class="hljs-name">Link</span><span class="hljs-tag"> </span><span class="hljs-attr">to</span><span class="hljs-tag">=</span><span class="hljs-string">"second"</span><span class="hljs-tag">&gt;</span>Second<span class="hljs-tag">&lt;/</span><span class="hljs-name">Link</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;/</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">nav</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">main</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">Outlet</span><span class="hljs-tag"> /&gt;</span>
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">main</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span>
  );
}
<span class="hljs-keyword">const</span> router = <span class="hljs-title">createBrowserRouter</span>([
  {
    <span class="hljs-attr">path</span>: <span class="hljs-string">"/"</span>,
    <span class="hljs-attr">element</span>: <span class="hljs-tag">&lt;</span><span class="hljs-name">Layout</span><span class="hljs-tag"> /&gt;</span>,
    <span class="hljs-attr">children</span>: [
      {
        <span class="hljs-attr">path</span>: <span class="hljs-string">"/first"</span>,
        <span class="hljs-attr">element</span>: <span class="hljs-tag">&lt;</span><span class="hljs-name">First</span><span class="hljs-tag"> /&gt;</span>,
      },
      {
        <span class="hljs-attr">path</span>: <span class="hljs-string">"/second"</span>,
        <span class="hljs-attr">element</span>: <span class="hljs-tag">&lt;</span><span class="hljs-name">Second</span><span class="hljs-tag"> /&gt;</span>,
      },
    ],
  },
]);
<span class="hljs-keyword">function</span> <span class="hljs-title">App</span>() {
  <span class="hljs-keyword">return</span> <span class="hljs-tag">&lt;</span><span class="hljs-name">RouterProvider</span><span class="hljs-tag"> </span><span class="hljs-attr">router</span><span class="hljs-tag">=</span><span class="hljs-string">{router}</span><span class="hljs-tag"> /&gt;</span>;
}
</code></pre>
    <p class="normal">The <code class="inlineCode">to</code> property <a id="_idIndexMarker280"/>specifies the route to activate when clicked. In this case, the application has two routes: <code class="inlineCode">/first</code> and <code class="inlineCode">/second</code>. Here is what the rendered links look like:</p>
    <figure class="mediaobject"> <img src="../Images/B19636_07_08.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 7.8: Links to the first and second pages of the app</p>
    <p class="normal">When you click the <strong class="screenText">First</strong> link, the page content changes to look like this:</p>
    <figure class="mediaobject"> <img src="../Images/B19636_07_09.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 7.9: The first page when the app is rendered</p>
    <p class="normal">Now that you can use <code class="inlineCode">Link</code> components to render links to basic paths, it’s time to learn about building dynamic links with parameters.</p>
    <h2 id="_idParaDest-128" class="heading-2">URL and query parameters</h2>
    <p class="normal">Constructing <a id="_idIndexMarker281"/>the dynamic segments of a path that is passed to <code class="inlineCode">&lt;Link&gt;</code> involves string manipulation. Everything<a id="_idIndexMarker282"/> that’s part of the path goes to the <code class="inlineCode">to</code> property. This means that you have to write more code to construct the string, but it also means less behind-the-scenes magic happening in the router.</p>
    <p class="normal">Let’s create a simple component that will echo back whatever is passed to the echo URL segment or the echo query parameter:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">function</span> <span class="hljs-title">Echo</span>() {
  <span class="hljs-keyword">const</span> params = <span class="hljs-title">useParams</span>();
  <span class="hljs-keyword">const</span> [searchParams] = <span class="hljs-title">useSearchParams</span>();
  <span class="hljs-keyword">return</span> <span class="hljs-tag">&lt;</span><span class="hljs-name">h1</span><span class="hljs-tag">&gt;</span>{params.msg || searchParams.get("msg")}<span class="hljs-tag">&lt;/</span><span class="hljs-name">h1</span><span class="hljs-tag">&gt;</span>;
}
</code></pre>
    <p class="normal">In order to get search parameters that were passed to a route, you can use the <code class="inlineCode">useSearchParams()</code> hook, which gives you a <code class="inlineCode">URLSearchParams</code> object. In this case, we can call <code class="inlineCode">searchParams.get("msg")</code> to get the parameter we need.</p>
    <p class="normal">Now, let’s take a look at the <code class="inlineCode">App</code> component that renders two links. The first will build a string that uses a dynamic value as a URL parameter. The second will use <code class="inlineCode">URLSearchParams</code> to build the query string portion of the URL:</p>
    <pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword">const</span> param = <span class="hljs-string">"From Param"</span>;
<span class="hljs-keyword">const</span> query = <span class="hljs-keyword">new</span> <span class="hljs-title">URLSearchParams</span>({ <span class="hljs-attr">msg</span>: <span class="hljs-string">"From Query"</span> });
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">function</span> <span class="hljs-title">App</span>() {
  <span class="hljs-keyword">return</span> (
    <span class="hljs-tag">&lt;</span><span class="hljs-name">section</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">Link</span><span class="hljs-tag"> </span><span class="hljs-attr">to</span><span class="hljs-tag">=</span><span class="hljs-string">{</span><span class="hljs-tag">'</span><span class="hljs-attr">echo</span><span class="hljs-tag">/${</span><span class="hljs-attr">param</span><span class="hljs-tag">}'}&gt;</span>Echo param<span class="hljs-tag">&lt;/</span><span class="hljs-name">Link</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>
        <span class="hljs-tag">&lt;</span><span class="hljs-name">Link</span><span class="hljs-tag"> </span><span class="hljs-attr">to</span><span class="hljs-tag">=</span><span class="hljs-string">{</span><span class="hljs-tag">'</span><span class="hljs-attr">echo</span><span class="hljs-tag">?${</span><span class="hljs-attr">query.toString</span><span class="hljs-tag">()}'}&gt;</span>Echo query<span class="hljs-tag">&lt;/</span><span class="hljs-name">Link</span><span class="hljs-tag">&gt;</span>
      <span class="hljs-tag">&lt;/</span><span class="hljs-name">p</span><span class="hljs-tag">&gt;</span>
    <span class="hljs-tag">&lt;/</span><span class="hljs-name">section</span><span class="hljs-tag">&gt;</span>
  );
}
</code></pre>
    <p class="normal">Here’s what the two links look like when they’re rendered:</p>
    <figure class="mediaobject"> <img src="../Images/B19636_07_10.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 7.10: Different types of link parameters</p>
    <p class="normal">The <strong class="screenText">Param</strong> link<a id="_idIndexMarker283"/> takes you to <code class="inlineCode">/echo/From%20Param</code>, which looks like this:</p>
    <figure class="mediaobject"> <img src="../Images/B19636_07_11.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 7.11: The param version of the page</p>
    <p class="normal">The <strong class="screenText">Query</strong> link<a id="_idIndexMarker284"/> takes you to <code class="inlineCode">/echo?msg=From+Query</code>, which looks like this:</p>
    <figure class="mediaobject"> <img src="../Images/B19636_07_12.png" alt="" role="presentation"/></figure>
    <p class="packt_figref">Figure 7.12: The query version of the page</p>
    <p class="normal">In learning about the <code class="inlineCode">Link</code> component and dynamic link construction, you’ve unlocked a more interactive and navigable web experience, empowering users to move through your application <a id="_idIndexMarker285"/>with URL and query parameters that enrich their journey.</p>
    <h1 id="_idParaDest-129" class="heading-1">Summary</h1>
    <p class="normal">In this chapter, you learned about routing in React applications. The job of a router is to render content that corresponds to a URL. The <code class="inlineCode">react-router</code> package is the standard tool for this job. You learned how routes are JSX elements, just like the components they render. Sometimes, you need to split routes into feature-based modules. A common pattern for structuring page content is to have a parent component that renders the dynamic parts as the URL changes. Then, you learned how to handle the dynamic parts of URL segments and query strings. You also learned how to build links throughout your application using the <code class="inlineCode">&lt;Link&gt;</code> element.</p>
    <p class="normal">Understanding routing in React applications lays the groundwork for building complex applications with efficient navigation, preparing you for the subsequent chapters that delve into performance optimization, state management, and integrating external APIs, ensuring a seamless user experience.</p>
    <p class="normal">In the next chapter, you’ll learn how to split your code into smaller chunks using lazy components.</p>
  </div>
</body></html>
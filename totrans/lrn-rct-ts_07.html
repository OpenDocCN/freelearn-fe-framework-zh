<html><head></head><body>
		<div id="_idContainer120">
			<h1 id="_idParaDest-186" class="chapter-number"><a id="_idTextAnchor188"/>7</h1>
			<h1 id="_idParaDest-187"><a id="_idTextAnchor189"/>Working with Forms</h1>
			<p>Forms <a id="_idIndexMarker547"/>are extremely common in apps, so it’s essential to be able to efficiently implement them. In some apps, forms can be large and complex, and getting them to perform well <span class="No-Break">is challenging.</span></p>
			<p>In this chapter, we’ll learn how to build forms in React using different approaches. The example form we will make here is a contact form that you would often see on company websites. It will contain a handful of fields and some <span class="No-Break">validation logic.</span></p>
			<p>The first approach to building a form will be to store field values in the state. We will see how this approach can bloat code and hurt performance. The next approach embraces the browser’s native form capabilities, reducing the amount of code required and improving performance. We will then use React Router’s <strong class="source-inline">Form</strong> component, which we briefly covered in <a href="B19051_06.xhtml#_idTextAnchor151"><span class="No-Break"><em class="italic">Chapter 6</em></span></a>, <em class="italic">Routing with React Router</em>. The final approach will be to use a popular library<a id="_idIndexMarker548"/> called <strong class="bold">React Hook Form</strong>. We’ll experience how React Hook Form helps us implement form validation and submission logic while maintaining <span class="No-Break">excellent performance.</span></p>
			<p>We’ll cover the <span class="No-Break">following topics:</span></p>
			<ul>
				<li>Using <span class="No-Break">controlled fields</span></li>
				<li>Using <span class="No-Break">uncontrolled fields</span></li>
				<li>Using React <span class="No-Break">Router Form</span></li>
				<li>Using <span class="No-Break">native validation</span></li>
				<li>Using React <span class="No-Break">Hook Form</span></li>
			</ul>
			<h1 id="_idParaDest-188"><a id="_idTextAnchor190"/>Technical requirements</h1>
			<p>We will use the following technologies in <span class="No-Break">this chapter:</span></p>
			<ul>
				<li><strong class="bold">Browser</strong>: A modern browser such as <span class="No-Break">Google Chrome</span></li>
				<li><strong class="bold">Node.js</strong> and <strong class="bold">npm</strong>: You can install them <span class="No-Break">from </span><a href="https://nodejs.org/en/download/"><span class="No-Break">https://nodejs.org/en/download/</span></a></li>
				<li><strong class="bold">Visual Studio Code</strong>: You can install it <span class="No-Break">from </span><a href="https://code.visualstudio.com/"><span class="No-Break">https://code.visualstudio.com/</span></a></li>
			</ul>
			<p>All the code snippets in this chapter can be found online <span class="No-Break">at </span><a href="https://github.com/PacktPublishing/Learn-React-with-TypeScript-2nd-Edition/tree/main/Chapter7"><span class="No-Break">https://github.com/PacktPublishing/Learn-React-with-TypeScript-2nd-Edition/tree/main/Chapter7</span></a><span class="No-Break">.</span></p>
			<h1 id="_idParaDest-189"><a id="_idTextAnchor191"/>Using controlled fields</h1>
			<p>In this section, we <a id="_idIndexMarker549"/>will build the first version of our contact form. It will contain fields for the user’s name, email address, contact reason, and any additional notes the user may want <span class="No-Break">to make.</span></p>
			<p>This method will involve the use of <strong class="bold">controlled fields</strong>, which is where field values are stored in the state. We will use this approach to implement the form – however, in doing so, we will pay attention to the amount of code required and the negative impact on performance; this will help you see why other methods <span class="No-Break">are better.</span></p>
			<p>To get started, first, we need to create a React and TypeScript project, as in <span class="No-Break">previous chapters.</span></p>
			<h2 id="_idParaDest-190"><a id="_idTextAnchor192"/>Creating the project</h2>
			<p>We will develop the form using Visual Studio Code and a new Create React App based project setup. We’ve previously covered this several times, so we will not cover the steps in this chapter – instead, refer to <a href="B19051_03.xhtml#_idTextAnchor072"><span class="No-Break"><em class="italic">Chapter 3</em></span></a>, <em class="italic">Setting Up React and TypeScript</em>. Create the project<a id="_idIndexMarker550"/> for the contact form with the name of <span class="No-Break">your</span><span class="No-Break"><a id="_idIndexMarker551"/></span><span class="No-Break"> choice.</span></p>
			<p>We will style the form with Tailwind CSS. We have previously covered how to install and configure Tailwind in Create React App in <a href="B19051_05.xhtml#_idTextAnchor127"><span class="No-Break"><em class="italic">Chapter 5</em></span></a>, <em class="italic">Approaches to Styling Frontends</em>, so after you have created the React and TypeScript project, install and <span class="No-Break">configure Tailwind.</span></p>
			<p>We will use a Tailwind plugin to help us style the form – it provides nice styles for field elements out of the box. Carry out the steps below to install and configure <span class="No-Break">this plugin:</span></p>
			<ol>
				<li>Install this plugin by running the following command in <span class="No-Break">a terminal:</span><pre class="source-code">
npm i -D @tailwindcss/forms</pre></li>
				<li>Open <strong class="source-inline">tailwind.config.js</strong> to configure the plugin. Add the highlighted code to this <a id="_idIndexMarker552"/>file to tell Tailwind to use the forms <a id="_idIndexMarker553"/>plugin we <span class="No-Break">just installed:</span><pre class="source-code">
module.exports = {</pre><pre class="source-code">
  content: ['./src/**/*.{js,jsx,ts,tsx}'],</pre><pre class="source-code">
  theme: {</pre><pre class="source-code">
    extend: {},</pre><pre class="source-code">
  },</pre><pre class="source-code">
  plugins: [<strong class="bold">require('@tailwindcss/forms')</strong>],</pre><pre class="source-code">
};</pre></li>
			</ol>
			<p>That completes the project setup. Next, we will create the first version of <span class="No-Break">the form.</span></p>
			<h2 id="_idParaDest-191"><a id="_idTextAnchor193"/>Creating a contact form</h2>
			<p>Now, carry out the <a id="_idIndexMarker554"/>following steps to create the first version of the <span class="No-Break">contact form:</span></p>
			<ol>
				<li value="1">Create a file called <strong class="source-inline">ContactPage.tsx</strong> in the <strong class="source-inline">src</strong> folder with the following <span class="No-Break"><strong class="source-inline">import</strong></span><span class="No-Break"> statement:</span><pre class="source-code">
import { useState, FormEvent } from 'react';</pre></li>
			</ol>
			<p>We have imported the <strong class="source-inline">useState</strong> hook and the <strong class="source-inline">FormEvent</strong> type from React, which we will eventually use in <span class="No-Break">the implementation.</span></p>
			<ol>
				<li value="2">Add the following <strong class="source-inline">type</strong> alias under the import statement. This type will represent all the <span class="No-Break">field values:</span><pre class="source-code">
type Contact = {</pre><pre class="source-code">
  name: string;</pre><pre class="source-code">
  email: string;</pre><pre class="source-code">
  reason: string;</pre><pre class="source-code">
  notes: string;</pre><pre class="source-code">
};</pre></li>
				<li>Add the following <span class="No-Break"><strong class="source-inline">function</strong></span><span class="No-Break"> component:</span><pre class="source-code">
export function ContactPage() {</pre><pre class="source-code">
  return (</pre><pre class="source-code">
    &lt;div className="flex flex-col py-10 max-w-md       mx-auto"&gt;</pre><pre class="source-code">
      &lt;h2 className="text-3xl font-bold underline         mb-3"&gt;Contact Us&lt;/h2&gt;</pre><pre class="source-code">
      &lt;p className="mb-3"&gt;</pre><pre class="source-code">
        If you enter your details we'll get back to you           as soon as we</pre><pre class="source-code">
        can.</pre><pre class="source-code">
      &lt;/p&gt;</pre><pre class="source-code">
      &lt;form&gt;&lt;/form&gt;</pre><pre class="source-code">
    &lt;/div&gt;</pre><pre class="source-code">
  );</pre><pre class="source-code">
}</pre></li>
			</ol>
			<p>This displays a heading and some instructions, horizontally centered on <span class="No-Break">the page.</span></p>
			<ol>
				<li value="4">Add the <a id="_idIndexMarker555"/>following fields inside the <span class="No-Break"><strong class="source-inline">form</strong></span><span class="No-Break"> element:</span><pre class="source-code">
&lt;form ...&gt;</pre><pre class="source-code">
  <strong class="bold">&lt;div&gt;</strong></pre><pre class="source-code">
<strong class="bold">    &lt;label htmlFor="name"&gt;Your name&lt;/label&gt;</strong></pre><pre class="source-code">
<strong class="bold">    &lt;input type="text" id="name" /&gt;</strong></pre><pre class="source-code">
<strong class="bold">  &lt;/div&gt;</strong></pre><pre class="source-code">
<strong class="bold">  &lt;div&gt;</strong></pre><pre class="source-code">
<strong class="bold">    &lt;label htmlFor="email"&gt;Your email address&lt;/label&gt;</strong></pre><pre class="source-code">
<strong class="bold">    &lt;input type="email" id="email" /&gt;</strong></pre><pre class="source-code">
<strong class="bold">  &lt;/div&gt;</strong></pre><pre class="source-code">
<strong class="bold">  &lt;div&gt;</strong></pre><pre class="source-code">
<strong class="bold">    &lt;label htmlFor="reason"&gt;Reason you need to contact       us&lt;/label&gt;</strong></pre><pre class="source-code">
<strong class="bold">    &lt;select id="reason"&gt;</strong></pre><pre class="source-code">
<strong class="bold">      &lt;option value=""&gt;&lt;/option&gt;</strong></pre><pre class="source-code">
<strong class="bold">      &lt;option value="Support"&gt;Support&lt;/option&gt;</strong></pre><pre class="source-code">
<strong class="bold">      &lt;option value="Feedback"&gt;Feedback&lt;/option&gt;</strong></pre><pre class="source-code">
<strong class="bold">      &lt;option value="Other"&gt;Other&lt;/option&gt;</strong></pre><pre class="source-code">
<strong class="bold">    &lt;/select&gt;</strong></pre><pre class="source-code">
<strong class="bold">  &lt;/div&gt;</strong></pre><pre class="source-code">
<strong class="bold">  &lt;div&gt;</strong></pre><pre class="source-code">
<strong class="bold">    &lt;label htmlFor="notes"&gt;Additional notes&lt;/label&gt;</strong></pre><pre class="source-code">
<strong class="bold">    &lt;textarea id="notes" /&gt;</strong></pre><pre class="source-code">
<strong class="bold">  &lt;/div&gt;</strong></pre><pre class="source-code">
&lt;/form&gt;</pre></li>
			</ol>
			<p>We have <a id="_idIndexMarker556"/>added fields for the user’s name, email address, contact reason, and additional notes. Each field label is associated with its editor by setting the <strong class="source-inline">htmlFor</strong> attribute to the editor’s <strong class="source-inline">id</strong> value. This helps assistive technology such as screen readers to read out labels when fields <span class="No-Break">gain focus.</span></p>
			<ol>
				<li value="5">Add a <strong class="source-inline">submit</strong> button to the bottom of the <strong class="source-inline">form</strong> element <span class="No-Break">as follows:</span><pre class="source-code">
&lt;form ...&gt;</pre><pre class="source-code">
  ...</pre><pre class="source-code">
  <strong class="bold">&lt;div&gt;</strong></pre><pre class="source-code">
<strong class="bold">    &lt;button</strong></pre><pre class="source-code">
<strong class="bold">      type="submit"</strong></pre><pre class="source-code">
<strong class="bold">      className="mt-2 h-10 px-6 font-semibold bg-black         text-white"</strong></pre><pre class="source-code">
<strong class="bold">    &gt;</strong></pre><pre class="source-code">
<strong class="bold">      Submit</strong></pre><pre class="source-code">
<strong class="bold">    &lt;/button&gt;</strong></pre><pre class="source-code">
<strong class="bold">  &lt;/div&gt;</strong></pre><pre class="source-code">
&lt;/form&gt;</pre></li>
				<li>The field <a id="_idIndexMarker557"/>containers will all have the same style, so create a variable for the style and assign it to all the field containers <span class="No-Break">as follows:</span><pre class="source-code">
<strong class="bold">const fieldStyle = "flex flex-col mb-2";</strong></pre><pre class="source-code">
return (</pre><pre class="source-code">
  &lt;div ...&gt;</pre><pre class="source-code">
    ...</pre><pre class="source-code">
    &lt;form ...&gt;</pre><pre class="source-code">
      &lt;div <strong class="bold">className={fieldStyle}</strong>&gt;...&lt;/div&gt;</pre><pre class="source-code">
      &lt;div <strong class="bold">className={fieldStyle}</strong>&gt;...&lt;/div&gt;</pre><pre class="source-code">
      &lt;div <strong class="bold">className={fieldStyle}</strong>&gt;...&lt;/div&gt;</pre><pre class="source-code">
      &lt;div <strong class="bold">className={fieldStyle}</strong>&gt;...&lt;/div&gt;</pre><pre class="source-code">
      &lt;div&gt;</pre><pre class="source-code">
        &lt;button</pre><pre class="source-code">
          type="submit"</pre><pre class="source-code">
          className="mt-2 h-10 px-6 font-semibold             bg-black text-white"</pre><pre class="source-code">
        &gt;</pre><pre class="source-code">
          Submit</pre><pre class="source-code">
        &lt;/button&gt;</pre><pre class="source-code">
      &lt;/div&gt;</pre><pre class="source-code">
    &lt;/form&gt;</pre><pre class="source-code">
  &lt;/div&gt;</pre><pre class="source-code">
);</pre></li>
			</ol>
			<p>The fields are nicely styled now using a vertically flowing flexbox and a small margin under <span class="No-Break">each one.</span></p>
			<ol>
				<li value="7">Add the <a id="_idIndexMarker558"/>state to hold the field values <span class="No-Break">as follows:</span><pre class="source-code">
export function ContactPage() {</pre><pre class="source-code">
  <strong class="bold">const [contact, setContact] = useState&lt;Contact&gt;({</strong></pre><pre class="source-code">
<strong class="bold">    name: "",</strong></pre><pre class="source-code">
<strong class="bold">    email: "",</strong></pre><pre class="source-code">
<strong class="bold">    reason: "",</strong></pre><pre class="source-code">
<strong class="bold">    notes: "",</strong></pre><pre class="source-code">
<strong class="bold">  });</strong></pre><pre class="source-code">
  const fieldStyle = ...;</pre><pre class="source-code">
  ...</pre><pre class="source-code">
}</pre></li>
			</ol>
			<p>We have given the state the <strong class="source-inline">Contact</strong> type we created earlier and initialized the field values to <span class="No-Break">empty strings.</span></p>
			<ol>
				<li value="8">Bind the <a id="_idIndexMarker559"/>state to the <strong class="source-inline">name</strong> field editor <span class="No-Break">as follows:</span><pre class="source-code">
&lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
  &lt;label htmlFor="name"&gt;Your name&lt;/label&gt;</pre><pre class="source-code">
  &lt;input</pre><pre class="source-code">
    type="text"</pre><pre class="source-code">
    id="name"</pre><pre class="source-code">
    <strong class="bold">value={contact.name}</strong></pre><pre class="source-code">
<strong class="bold">    onChange={(e) =&gt;</strong></pre><pre class="source-code">
<strong class="bold">      setContact({ ...contact, name: e.target.value })</strong></pre><pre class="source-code">
<strong class="bold">    }</strong></pre><pre class="source-code">
  /&gt;</pre><pre class="source-code">
&lt;/div&gt;</pre></li>
			</ol>
			<p><strong class="source-inline">value</strong> is set to the current value of the state. <strong class="source-inline">onChange</strong> is triggered when the user fills in the input element, which we use to update the state value. To construct the new state object, we clone the current state and override its <strong class="source-inline">name</strong> property with the new value from the <span class="No-Break"><strong class="source-inline">onChange</strong></span><span class="No-Break"> parameter.</span></p>
			<ol>
				<li value="9">Repeat the same approach for the binding state to the other field editors <span class="No-Break">as follows:</span><pre class="source-code">
&lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
  ...</pre><pre class="source-code">
  &lt;input</pre><pre class="source-code">
    type="email"</pre><pre class="source-code">
    id="email"</pre><pre class="source-code">
    <strong class="bold">value={contact.email}</strong></pre><pre class="source-code">
<strong class="bold">    onChange={(e) =&gt;</strong></pre><pre class="source-code">
<strong class="bold">      setContact({ ...contact, email: e.target.value })</strong></pre><pre class="source-code">
<strong class="bold">    }</strong></pre><pre class="source-code">
  /&gt;</pre><pre class="source-code">
&lt;/div&gt;</pre><pre class="source-code">
&lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
  ...</pre><pre class="source-code">
  &lt;select</pre><pre class="source-code">
    id="reason"</pre><pre class="source-code">
    <strong class="bold">value={contact.reason}</strong></pre><pre class="source-code">
<strong class="bold">    onChange={(e) =&gt;</strong></pre><pre class="source-code">
<strong class="bold">      setContact({ ...contact, reason: e.target.value })</strong></pre><pre class="source-code">
<strong class="bold">    }</strong></pre><pre class="source-code">
  &gt;</pre><pre class="source-code">
    ...</pre><pre class="source-code">
  &lt;/select&gt;</pre><pre class="source-code">
&lt;/div&gt;</pre><pre class="source-code">
&lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
  ...</pre><pre class="source-code">
  &lt;textarea</pre><pre class="source-code">
    id="notes"</pre><pre class="source-code">
    <strong class="bold">value={contact.notes}</strong></pre><pre class="source-code">
<strong class="bold">    onChange={(e) =&gt;</strong></pre><pre class="source-code">
<strong class="bold">      setContact({ ...contact, notes: e.target.value })</strong></pre><pre class="source-code">
<strong class="bold">    }</strong></pre><pre class="source-code">
  /&gt;</pre><pre class="source-code">
&lt;/div&gt;</pre></li>
				<li>Add a <a id="_idIndexMarker560"/>submit handler to the <strong class="source-inline">form</strong> element <span class="No-Break">as follows:</span><pre class="source-code">
<strong class="bold">function handleSubmit(e: FormEvent&lt;HTMLFormElement&gt;) {</strong></pre><pre class="source-code">
<strong class="bold">  e.preventDefault();</strong></pre><pre class="source-code">
<strong class="bold">  console.log('Submitted details:', contact);</strong></pre><pre class="source-code">
<strong class="bold">}</strong></pre><pre class="source-code">
const fieldStyle = ...;</pre><pre class="source-code">
return (</pre><pre class="source-code">
  &lt;div&gt;</pre><pre class="source-code">
    ...</pre><pre class="source-code">
    &lt;form <strong class="bold">onSubmit={handleSubmit}</strong>&gt;</pre><pre class="source-code">
      ...</pre><pre class="source-code">
    &lt;/form&gt;</pre><pre class="source-code">
  &lt;/div&gt;</pre><pre class="source-code">
);</pre></li>
			</ol>
			<p>The submit handler parameter is typed using React’s <strong class="source-inline">FormEvent</strong> type. The submit handler function prevents the form from being sent to the server using the <strong class="source-inline">preventDefault</strong> method on the handler parameter. Instead of sending the form to a server, we output the <strong class="source-inline">contact</strong> state to <span class="No-Break">the console.</span></p>
			<ol>
				<li value="11">The last step is to render <strong class="source-inline">ContactPage</strong> in the <strong class="source-inline">App</strong> component. Open <strong class="source-inline">App.tsx</strong> and replace its content with <span class="No-Break">the following:</span><pre class="source-code">
import { ContactPage } from './ContactPage';</pre><pre class="source-code">
function App() {</pre><pre class="source-code">
  return &lt;ContactPage /&gt;;</pre><pre class="source-code">
}</pre><pre class="source-code">
export default App;</pre></li>
			</ol>
			<p>The <strong class="source-inline">App</strong> component simply renders the <strong class="source-inline">ContactPage</strong> page component we just created. The <strong class="source-inline">App</strong> component also remains a default export so that <strong class="source-inline">index.tsx</strong> <span class="No-Break">isn’t broken.</span></p>
			<p>That completes the first iteration <a id="_idIndexMarker561"/>of the form. We will now use the form and discover a potential performance problem. Carry out the <span class="No-Break">following steps:</span></p>
			<ol>
				<li value="1">Run the app in development mode by executing <strong class="source-inline">npm start</strong> in the terminal. The form appears <span class="No-Break">as follows:</span></li>
			</ol>
			<div>
				<div id="_idContainer113" class="IMG---Figure">
					<img src="image/B19051_07_01.jpg" alt="Figure 7.1 – Contact form"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.1 – Contact form</p>
			<ol>
				<li value="2">We are going to highlight component re-rendering using React DevTools, which will highlight a potential <span class="No-Break">performance problem.</span></li>
			</ol>
			<p>Open the browser DevTools and select the <strong class="bold">Components</strong> panel. If there is no <strong class="bold">Components</strong> panel, ensure that the React DevTools are installed in the browser (see <a href="B19051_03.xhtml#_idTextAnchor072"><span class="No-Break"><em class="italic">Chapter 3</em></span></a> for how to install <span class="No-Break">React DevTools).</span></p>
			<p>Click on the settings cog to view the React DevTools settings and tick the <strong class="bold">Highlight updates when components render</strong> option. This option will display a blue-green outline around components in the page <span class="No-Break">that re-render.</span></p>
			<ol>
				<li value="3">Fill in the form and <a id="_idIndexMarker562"/>notice a bluey green outline appears around the form every time a character is entered into <span class="No-Break">a field:</span></li>
			</ol>
			<div>
				<div id="_idContainer114" class="IMG---Figure">
					<img src="image/B19051_07_02.jpg" alt="Figure 7.2 – Highlighted re-render for every keystroke"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.2 – Highlighted re-render for every keystroke</p>
			<p>So, every time a character is entered into a field, the whole form is re-rendered. This makes sense because a state change occurs when a field changes, and a state change causes a re-render. This isn’t a huge problem in this small form but can be a significant performance problem in <span class="No-Break">larger forms.</span></p>
			<ol>
				<li value="4">Complete all the fields in the form and click on the <strong class="bold">Submit</strong> button. The field values are output to <span class="No-Break">the console.</span></li>
			</ol>
			<p>That completes the first <a id="_idIndexMarker563"/>iteration of the form. Keep the app running as we reflect on the implementation and move to the <span class="No-Break">next section.</span></p>
			<p>The key takeaway from this section is that controlling field values with the state can lead to performance problems. Having to bind the state to each field also feels a <span class="No-Break">bit repetitive.</span></p>
			<p>Next, we will implement a more performant and succinct version of <span class="No-Break">the form.</span></p>
			<h1 id="_idParaDest-192"><a id="_idTextAnchor194"/>Using uncontrolled fields</h1>
			<p><strong class="bold">Uncontrolled fields</strong> are the <a id="_idIndexMarker564"/>opposite of controlled fields – it’s where field values <em class="italic">aren’t</em> controlled by state. Instead, native browser features are used to obtain field values. In this section, we will refactor the contact form to use uncontrolled fields and see <span class="No-Break">the benefits.</span></p>
			<p>Carry out the <a id="_idIndexMarker565"/><span class="No-Break">following steps:</span></p>
			<ol>
				<li value="1">Open <strong class="source-inline">ContactPage.tsx</strong> and start by removing <strong class="source-inline">useState</strong> from the React import, because this is no <span class="No-Break">longer required.</span></li>
				<li>Then, at the top of the <strong class="source-inline">component</strong> function, remove the call to <strong class="source-inline">useState</strong> (this iteration of the form won’t use <span class="No-Break">any state).</span></li>
				<li>Remove the <strong class="source-inline">value</strong> and <strong class="source-inline">onChange</strong> props from the field editors, because we are no longer controlling field values with <span class="No-Break">the state.</span></li>
				<li>Now, add a <strong class="source-inline">name</strong> attribute on all the field editors <span class="No-Break">as follows:</span><pre class="source-code">
&lt;form onSubmit={handleSubmit}&gt;</pre><pre class="source-code">
  &lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
    &lt;label htmlFor="name"&gt;Your name&lt;/label&gt;</pre><pre class="source-code">
    &lt;input type="text" id="name" <strong class="bold">name="name"</strong> /&gt;</pre><pre class="source-code">
  &lt;/div&gt;</pre><pre class="source-code">
  &lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
    &lt;label htmlFor="email"&gt;Your email address&lt;/label&gt;</pre><pre class="source-code">
    &lt;input type="email" id="email" <strong class="bold">name="email" </strong>/&gt;</pre><pre class="source-code">
  &lt;/div&gt;</pre><pre class="source-code">
  &lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
    &lt;label htmlFor="reason"&gt;</pre><pre class="source-code">
      Reason you need to contact us</pre><pre class="source-code">
    &lt;/label&gt;</pre><pre class="source-code">
    &lt;select id="reason" <strong class="bold">name="reason"</strong>&gt;</pre><pre class="source-code">
      ...</pre><pre class="source-code">
    &lt;/select&gt;</pre><pre class="source-code">
  &lt;/div&gt;</pre><pre class="source-code">
  &lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
    &lt;label htmlFor="notes"&gt;Additional notes&lt;/label&gt;</pre><pre class="source-code">
    &lt;textarea id="notes" <strong class="bold">name="notes"</strong> /&gt;</pre><pre class="source-code">
  &lt;/div&gt;</pre><pre class="source-code">
  ...</pre><pre class="source-code">
&lt;/form&gt;;</pre></li>
			</ol>
			<p>The <strong class="source-inline">name</strong> attribute is important because it will allow us to easily extract field values in the form submit handler, which we will <span class="No-Break">do next.</span></p>
			<ol>
				<li value="5">Add the following code<a id="_idIndexMarker566"/> in the submit handler to extract the field values before they are output to <span class="No-Break">the console:</span><pre class="source-code">
function handleSubmit(e: FormEvent&lt;HTMLFormElement&gt;) {</pre><pre class="source-code">
  e.preventDefault();</pre><pre class="source-code">
  <strong class="bold">const formData = new FormData(e.currentTarget);</strong></pre><pre class="source-code">
<strong class="bold">  const contact = {</strong></pre><pre class="source-code">
<strong class="bold">    name: formData.get('name'),</strong></pre><pre class="source-code">
<strong class="bold">    email: formData.get('email'),</strong></pre><pre class="source-code">
<strong class="bold">    reason: formData.get('reason'),</strong></pre><pre class="source-code">
<strong class="bold">    notes: formData.get('notes'),</strong></pre><pre class="source-code">
<strong class="bold">  } as Contact;</strong></pre><pre class="source-code">
  console.log('Submitted details:', contact);</pre><pre class="source-code">
}</pre></li>
			</ol>
			<p><strong class="source-inline">FormData</strong> is an interface that allows access to values in a form and takes in a form element in its constructor parameter. It contains a <strong class="source-inline">get</strong> method that returns the value <a id="_idIndexMarker567"/>of the field whose name is passed as an argument. For more information on <strong class="source-inline">FormData</strong>, <span class="No-Break">see </span><a href="https://developer.mozilla.org/en-US/docs/Web/API/FormData"><span class="No-Break">https://developer.mozilla.org/en-US/docs/Web/API/FormData</span></a><span class="No-Break">.</span></p>
			<p>That completes the refactoring of the form. To recap, uncontrolled fields don’t have values stored in the state. Instead, field values are obtained using <strong class="source-inline">FormData</strong>, which relies on field editors having a <span class="No-Break"><strong class="source-inline">name</strong></span><span class="No-Break"> attribute.</span></p>
			<p>Notice the reduced code in the implementation compared to the controlled fields implementation. We will now try the form and check whether the form is re-rendered on every keystroke. Carry out the <span class="No-Break">following steps:</span></p>
			<ol>
				<li value="1">In the running app, make sure DevTools is still open with the <strong class="bold">Highlight updates when the components render</strong> option <span class="No-Break">still ticked.</span></li>
				<li>Fill in the form and you will notice that the re-render outline never appears. This makes sense because there is no longer any state, so a re-render can’t occur because of a <span class="No-Break">state change.</span></li>
				<li>Complete all the fields in the form and click on the <strong class="bold">Submit</strong> button. The field values are output to the console just as they <span class="No-Break">were before.</span></li>
			</ol>
			<div>
				<div id="_idContainer115" class="IMG---Figure">
					<img src="image/B19051_07_03.jpg" alt="Figure 7.3 – Completed form with submitted data in console"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.3 – Completed form with submitted data in console</p>
			<ol>
				<li value="4">Stop the <a id="_idIndexMarker568"/>app from running by pressing <em class="italic">Ctrl</em> + <span class="No-Break"><em class="italic">C</em></span><span class="No-Break">.</span></li>
			</ol>
			<p>So, this implementation is shorter, more performant, and an excellent approach for simple forms. The key points in the implementation are to include a <strong class="source-inline">name</strong> attribute for field editors and use the <strong class="source-inline">FormData</strong> interface to extract the <span class="No-Break">form values.</span></p>
			<p>The current implementation is very simple though – for example, there is no submission success message. In the next section, we will use React Router and add a <span class="No-Break">submission message.</span></p>
			<h1 id="_idParaDest-193"><a id="_idTextAnchor195"/>Using React Router Form</h1>
			<p>In <a href="B19051_06.xhtml#_idTextAnchor151"><span class="No-Break"><em class="italic">Chapter 6</em></span></a>, we started to learn about React Router’s <strong class="source-inline">Form</strong> component. We <a id="_idIndexMarker569"/>learned that <strong class="source-inline">Form</strong> is a wrapper around the HTML <strong class="source-inline">form</strong> element that handles the form submission. We will now cover <strong class="source-inline">Form</strong> in more detail and use it to provide a nice submission success message on our <span class="No-Break">contact form.</span></p>
			<p>Carry out the <span class="No-Break">following steps:</span></p>
			<ol>
				<li value="1">First, install <a id="_idIndexMarker570"/>React Router by executing the following command in <span class="No-Break">the terminal:</span><pre class="source-code">
npm i react-router-dom</pre></li>
				<li>Now, let’s create a <strong class="source-inline">ThankYouPage</strong> component, which will inform the user that their submission has been successful. To do this, create a file called <strong class="source-inline">ThankYouPage.tsx</strong> in the <strong class="source-inline">src</strong> folder with the <span class="No-Break">following content:</span><pre class="source-code">
import { useParams } from 'react-router-dom';</pre><pre class="source-code">
export function ThankYouPage() {</pre><pre class="source-code">
  const { name } = useParams&lt;{ name: string }&gt;();</pre><pre class="source-code">
  return (</pre><pre class="source-code">
    &lt;div className="flex flex-col py-10 max-w-md       mx-auto"&gt;</pre><pre class="source-code">
      &lt;div</pre><pre class="source-code">
        role="alert"</pre><pre class="source-code">
        className="bg-green-100 py-5 px-6 text-base text-          green-700 "</pre><pre class="source-code">
      &gt;</pre><pre class="source-code">
        Thanks {name}, we will be in touch shortly</pre><pre class="source-code">
      &lt;/div&gt;</pre><pre class="source-code">
    &lt;/div&gt;</pre><pre class="source-code">
  );</pre><pre class="source-code">
}</pre></li>
			</ol>
			<p>The component uses a route parameter for the person’s name that is included in the thank <span class="No-Break">you message.</span></p>
			<ol>
				<li value="3">Next, open <strong class="source-inline">App.tsx</strong> and add the following imports from <span class="No-Break">React Router:</span><pre class="source-code">
import {</pre><pre class="source-code">
  createBrowserRouter,</pre><pre class="source-code">
  RouterProvider,</pre><pre class="source-code">
  Navigate</pre><pre class="source-code">
} from 'react-router-dom';</pre></li>
			</ol>
			<p>We haven’t come across React Router’s <strong class="source-inline">Navigate</strong> component before – it is a component that performs navigation. We will use this in <em class="italic">step 5</em>, in the route definitions, to redirect from the root path to the <span class="No-Break">contact page.</span></p>
			<ol>
				<li value="4">Add <strong class="source-inline">contactPageAction</strong> to the <strong class="source-inline">import</strong> statement for <strong class="source-inline">ContactPage</strong> and also import <a id="_idIndexMarker571"/>the <span class="No-Break"><strong class="source-inline">ThankYouPage</strong></span><span class="No-Break"> component:</span><pre class="source-code">
import {</pre><pre class="source-code">
  ContactPage,</pre><pre class="source-code">
  <strong class="bold">contactPageAction</strong></pre><pre class="source-code">
} from './ContactPage';</pre><pre class="source-code">
<strong class="bold">import { ThankYouPage } from './ThankYouPage';</strong></pre></li>
			</ol>
			<p>Note that <strong class="source-inline">contactPageAction</strong> doesn’t exist yet, so a compile error will occur. We will resolve this error in <span class="No-Break"><em class="italic">step 9</em></span><span class="No-Break">.</span></p>
			<ol>
				<li value="5">Still in <strong class="source-inline">App.tsx</strong>, set up routes that render the contact and thank <span class="No-Break">you pages:</span><pre class="source-code">
const router = createBrowserRouter([</pre><pre class="source-code">
  {</pre><pre class="source-code">
    path: '/',</pre><pre class="source-code">
    element: &lt;Navigate to="contact" /&gt;,</pre><pre class="source-code">
  },</pre><pre class="source-code">
  {</pre><pre class="source-code">
    path: '/contact',</pre><pre class="source-code">
    element: &lt;ContactPage /&gt;,</pre><pre class="source-code">
    action: contactPageAction,</pre><pre class="source-code">
  },</pre><pre class="source-code">
  {</pre><pre class="source-code">
    path: '/thank-you/:name',</pre><pre class="source-code">
    element: &lt;ThankYouPage /&gt;,</pre><pre class="source-code">
  },</pre><pre class="source-code">
]);</pre></li>
			</ol>
			<p>There is an <strong class="source-inline">action</strong> property on the <strong class="source-inline">contact</strong> route that we haven’t covered yet – this handles form submission. We have set this to <strong class="source-inline">contactPageAction</strong>, which we will create in <span class="No-Break"><em class="italic">step 9</em></span><span class="No-Break">.</span></p>
			<ol>
				<li value="6">The last task in <strong class="source-inline">App.tsx</strong> is to <a id="_idIndexMarker572"/>change the <strong class="source-inline">App</strong> component to return <strong class="source-inline">RouterProvider</strong> with the <span class="No-Break">route definitions:</span><pre class="source-code">
function App() {</pre><pre class="source-code">
  return &lt;RouterProvider router={router} /&gt;;</pre><pre class="source-code">
}</pre></li>
				<li>Now, open <strong class="source-inline">ContactPage.tsx</strong> and add the following imports from <span class="No-Break">React Router:</span><pre class="source-code">
import {</pre><pre class="source-code">
  Form,</pre><pre class="source-code">
  ActionFunctionArgs,</pre><pre class="source-code">
  redirect,</pre><pre class="source-code">
} from 'react-router-dom';</pre></li>
				<li>In the JSX, change the <strong class="source-inline">form</strong> element to be a React Router <strong class="source-inline">Form</strong> component and remove the <span class="No-Break"><strong class="source-inline">onSubmit</strong></span><span class="No-Break"> attribute:</span><pre class="source-code">
&lt;<strong class="bold">Form method="post"</strong>&gt;</pre><pre class="source-code">
  ...</pre><pre class="source-code">
&lt;/<strong class="bold">Form</strong>&gt;</pre></li>
			</ol>
			<p>We have set the form’s method to <strong class="source-inline">"post"</strong> because the form will mutate data. The default form method <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">"get"</strong></span><span class="No-Break">.</span></p>
			<ol>
				<li value="9">Now, move <a id="_idIndexMarker573"/>the <strong class="source-inline">handleSubmit</strong> function outside the component, to the bottom of the file. Rename the function to <strong class="source-inline">contactPageAction</strong>, allow it to be exported, and make <span class="No-Break">it asynchronous:</span><pre class="source-code">
<strong class="bold">export</strong> <strong class="bold">async</strong> function <strong class="bold">contactPageAction</strong>(</pre><pre class="source-code">
  e: FormEvent&lt;HTMLFormElement&gt;</pre><pre class="source-code">
) {</pre><pre class="source-code">
  e.preventDefault();</pre><pre class="source-code">
  const formData = new FormData(e.currentTarget);</pre><pre class="source-code">
  const contact = {</pre><pre class="source-code">
    name: formData.get('name'),</pre><pre class="source-code">
    email: formData.get('email'),</pre><pre class="source-code">
    reason: formData.get('reason'),</pre><pre class="source-code">
    notes: formData.get('notes'),</pre><pre class="source-code">
  } as Contact;</pre><pre class="source-code">
  console.log('Submitted details:', contact);</pre><pre class="source-code">
}</pre></li>
			</ol>
			<p>This will now be a React Router action that handles part of the <span class="No-Break">form submission.</span></p>
			<ol>
				<li value="10">Change the parameters on <strong class="source-inline">contactPageAction</strong> to <span class="No-Break">the following:</span><pre class="source-code">
export async function contactPageAction(<strong class="bold">{</strong></pre><pre class="source-code">
<strong class="bold">  request,</strong></pre><pre class="source-code">
<strong class="bold">}: ActionFunctionArgs</strong>)</pre></li>
			</ol>
			<p>React Router will pass in a <strong class="source-inline">request</strong> object when it calls <span class="No-Break">this function.</span></p>
			<ol>
				<li value="11">Remove the <strong class="source-inline">e.preventDefault()</strong> statement in <strong class="source-inline">contactPageAction</strong> because React Router does this <span class="No-Break">for us.</span></li>
				<li>Change the <strong class="source-inline">formData</strong> assignment to get the data from the React Router’s <span class="No-Break"><strong class="source-inline">request</strong></span><span class="No-Break"> object:</span><pre class="source-code">
const formData = <strong class="bold">await request.formData()</strong>;</pre></li>
				<li>The last<a id="_idIndexMarker574"/> change to the <strong class="source-inline">contactPageAction</strong> function is to redirect to the thank you page at the end of <span class="No-Break">the submission:</span><pre class="source-code">
export async function contactPageAction({</pre><pre class="source-code">
  request,</pre><pre class="source-code">
}: ActionFunctionArgs) {</pre><pre class="source-code">
  ...</pre><pre class="source-code">
  <strong class="bold">return redirect(</strong></pre><pre class="source-code">
<strong class="bold">    `/thank-you/${formData.get('name')}`</strong></pre><pre class="source-code">
<strong class="bold">  );</strong></pre><pre class="source-code">
}</pre></li>
				<li>Remove the <strong class="source-inline">FormEvent</strong> import because this is <span class="No-Break">redundant now.</span></li>
				<li>Run the app in development mode by executing <strong class="source-inline">npm start</strong> in <span class="No-Break">the terminal.</span></li>
				<li>The app will automatically redirect to the <strong class="source-inline">Contact</strong> page. Complete the form and <span class="No-Break">submit it.</span></li>
			</ol>
			<p>The app will redirect to the thank <span class="No-Break">you page:</span></p>
			<div>
				<div id="_idContainer116" class="IMG---Figure">
					<img src="image/B19051_07_04.jpg" alt="Figure 7.4 – Thank you page"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.4 – Thank you page</p>
			<p>That <a id="_idIndexMarker575"/>completes this section on React Router’s form capability. Keep the app running as we recap and move to the <span class="No-Break">next section.</span></p>
			<p>The <a id="_idIndexMarker576"/>key points on React Router’s <strong class="source-inline">Form</strong> component are <span class="No-Break">as follows:</span></p>
			<ul>
				<li>React Router’s <strong class="source-inline">Form</strong> component is a wrapper around the HTML <span class="No-Break"><strong class="source-inline">form</strong></span><span class="No-Break"> element</span></li>
				<li>The form is submitted to the current route by default, but can be submitted to a different path using the <span class="No-Break"><strong class="source-inline">path</strong></span><span class="No-Break"> attribute</span></li>
				<li>We can write logic inside the submission process using an action function defined on the route <a id="_idIndexMarker577"/>that is <span class="No-Break">submitted to</span></li>
			</ul>
			<p>For more information on<a id="_idIndexMarker578"/> React Router’s Form component, see the following <span class="No-Break">link: </span><a href="https://reactrouter.com/en/components/form"><span class="No-Break">https://reactrouter.com/en/components/form</span></a><span class="No-Break">.</span></p>
			<p>Next, we will implement validation on <span class="No-Break">the form.</span></p>
			<h1 id="_idParaDest-194"><a id="_idTextAnchor196"/>Using native validation</h1>
			<p>In this section, we will add<a id="_idIndexMarker579"/> the required validation to the name, email, and reason fields and ensure that the email matches a particular pattern. We will use standard HTML form validation to implement <span class="No-Break">these rules.</span></p>
			<p>Carry out the <a id="_idIndexMarker580"/><span class="No-Break">following steps:</span></p>
			<ol>
				<li value="1">In <strong class="source-inline">ContactPage.tsx</strong>, add a <strong class="source-inline">required</strong> attribute to the name, email, and reason field editors to add HTML form required validation for <span class="No-Break">these fields:</span><pre class="source-code">
&lt;Form method="post"&gt;</pre><pre class="source-code">
  &lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
    ...</pre><pre class="source-code">
    &lt;input type="text" id="name" name="name" <strong class="bold">required</strong> /&gt;</pre><pre class="source-code">
  &lt;/div&gt;</pre><pre class="source-code">
  &lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
    ...</pre><pre class="source-code">
    &lt;input type="email" id="email" name="email" <strong class="bold">required</strong> /&gt;</pre><pre class="source-code">
  &lt;/div&gt;</pre><pre class="source-code">
  &lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
    ...</pre><pre class="source-code">
    &lt;select id="reason" name="reason" <strong class="bold">required</strong> &gt;...&lt;/      select&gt;</pre><pre class="source-code">
  &lt;/div&gt;</pre><pre class="source-code">
  ...</pre><pre class="source-code">
&lt;/Form&gt;</pre></li>
				<li>Add the following pattern-matching validation on the <strong class="source-inline">email</strong> <span class="No-Break">field editor:</span><pre class="source-code">
&lt;input</pre><pre class="source-code">
  type="email"</pre><pre class="source-code">
  id="email"</pre><pre class="source-code">
  name="email"</pre><pre class="source-code">
  required</pre><pre class="source-code">
  <strong class="bold">pattern="\S+@\S+\.\S+"</strong></pre><pre class="source-code">
/&gt;</pre></li>
			</ol>
			<p>This pattern will ensure that the entry is in an <span class="No-Break">email format.</span></p>
			<ol>
				<li value="3">In the <a id="_idIndexMarker581"/>running app, without populating any fields, submit the form. Validation kicks in and the form submission doesn’t complete. Instead, the name field is focused and an error message appears <span class="No-Break">beneath it:</span></li>
			</ol>
			<div>
				<div id="_idContainer117" class="IMG---Figure">
					<img src="image/B19051_07_05.jpg" alt="Figure 7.5 – HTML form validation message for the name field"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.5 – HTML form validation message for the name field</p>
			<p>Note that the error message is styled slightly differently in different browsers – the preceding screenshot is <span class="No-Break">from Firefox.</span></p>
			<ol>
				<li value="4">Correctly fill in the name field so that it is valid. Then, move on to experiment with the email field validation. For example, try entering an email address without an @ character; you will find that the email field needs to be populated with a correctly formatted <span class="No-Break">email address.</span></li>
			</ol>
			<div>
				<div id="_idContainer118" class="IMG---Figure">
					<img src="image/B19051_07_06.jpg" alt="Figure 7.6 – HTML form validation message for the email field"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.6 – HTML form validation message for the email field</p>
			<ol>
				<li value="5">Correctly fill in the email field so that it is valid. Then, move on to experiment with the reason field validation. Try to select the blank reason and you will find that a validation <span class="No-Break">error occurs.</span></li>
				<li>Correctly fill in all the fields and submit the form. You will find that the thank you message appears as it <span class="No-Break">did previously.</span></li>
				<li>Stop the <a id="_idIndexMarker582"/>app from running by pressing <em class="italic">CTRL</em> + <span class="No-Break"><em class="italic">C</em></span><span class="No-Break">.</span></li>
			</ol>
			<p>The simplicity of the implementation of standard HTML form validation is nice. However, if we want to customize the validation user experience, we’ll need to write JavaScript to use the constraint validation API. For information on this API and more information on <a id="_idIndexMarker583"/>HTML form validation, see the following <span class="No-Break">link: </span><a href="https://developer.mozilla.org/en-US/docs/Learn/Forms/Form_validation"><span class="No-Break">https://developer.mozilla.org/en-US/docs/Learn/Forms/Form_validation</span></a><span class="No-Break">.</span></p>
			<p>In the next section, we’ll use a popular form library to improve the validation user experience. This is a little easier to work with in React than the constraint <span class="No-Break">validation API.</span></p>
			<h1 id="_idParaDest-195"><a id="_idTextAnchor197"/>Using React Hook Form</h1>
			<p>In this section, we will learn about React Hook Form and use it to improve the validation user experience in our <span class="No-Break">contact form.</span></p>
			<h2 id="_idParaDest-196"><a id="_idTextAnchor198"/>Understanding React Hook Form</h2>
			<p>As the name <a id="_idIndexMarker584"/>suggests, React Hook Form is a React library for building forms. It is very flexible and can be used for simple forms such as our contact form, as well as large forms with complex validation and submission logic. It is also very performant and optimised not to cause unnecessary re-renders. It is also very popular with tens of thousands of GitHub stars and maturing nicely having been first released <span class="No-Break">in 2019.</span></p>
			<p>The key part of React Hooks Form is a <strong class="source-inline">useForm</strong> hook, which returns useful functions and the state. The following code snippet shows the <strong class="source-inline">useForm</strong> hook <span class="No-Break">being called:</span></p>
			<pre class="source-code">
const {
  register,
  handleSubmit,
  formState: { errors, isSubmitting, isSubmitSuccessful }
} = useForm&lt;FormData&gt;();</pre>
			<p><strong class="source-inline">useForm</strong> has a generic type parameter for the type of the field values. In the preceding example, the field values type <span class="No-Break">is </span><span class="No-Break"><strong class="source-inline">FormData</strong></span><span class="No-Break">.</span></p>
			<h3>Understanding the register function</h3>
			<p>A key function that <strong class="source-inline">useForm</strong> returns is a <strong class="source-inline">register</strong> function, which takes in a unique field name and returns the following <a id="_idIndexMarker585"/>in an <span class="No-Break">object structure:</span></p>
			<ul>
				<li>An <strong class="source-inline">onChange</strong> handler, which happens when the field editor’s <span class="No-Break">value changes</span></li>
				<li>An <strong class="source-inline">onBlur</strong> handler, which happens when the field editor <span class="No-Break">loses focus</span></li>
				<li>A reference to the field <span class="No-Break">editor element</span></li>
				<li>The <span class="No-Break">field name</span></li>
			</ul>
			<p>These items returned from the <strong class="source-inline">register</strong> function are spread onto the field editor element to allow React Hook Form to efficiently track its value. The following code snippet allows a name field editor to be tracked by React <span class="No-Break">Hook Form:</span></p>
			<pre class="source-code">
&lt;input {<strong class="bold">...register('name')</strong>} /&gt;</pre>
			<p>After the result of <strong class="source-inline">register</strong> has been spread on to the <strong class="source-inline">input</strong> element, it will contain <strong class="source-inline">ref</strong>, <strong class="source-inline">name</strong>, <strong class="source-inline">onChange</strong>, and <span class="No-Break"><strong class="source-inline">onBlur</strong></span><span class="No-Break"> attributes.:</span></p>
			<pre class="source-code">
&lt;input
  ref={someVariableInRHF}
  name="name"
  onChange={someHandlerInRHF}
  onBlur={anotherHandlerInRHF}
/&gt;</pre>
			<p>The <strong class="source-inline">ref</strong>, <strong class="source-inline">onChange</strong>, and <strong class="source-inline">onBlur</strong> attributes will reference code in React Hook Form that tracks <a id="_idIndexMarker586"/>the value of the <span class="No-Break"><strong class="source-inline">input</strong></span><span class="No-Break"> element.</span></p>
			<h3>Specifying validation</h3>
			<p>Field validation is <a id="_idIndexMarker587"/>defined in the <strong class="source-inline">register</strong> field in an options parameter <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
&lt;input {...register('name', <strong class="bold">{required: true}</strong>)} /&gt;</pre>
			<p>In the preceding example, required validation is specified. The associated error message can be defined as an alternative to the <strong class="source-inline">true</strong> flag <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
&lt;input
  {...register('name', { required: <strong class="bold">'You must enter a name'</strong> })}
/&gt;</pre>
			<p>There are a range of different validation rules that can be applied. See this page in the React Hook Form<a id="_idIndexMarker588"/> documentation for a list of all the rules that are <span class="No-Break">available: </span><a href="https://react-hook-form.com/get-started#applyvalidation"><span class="No-Break">https://react-hook-form.com/get-started#applyvalidation</span></a><span class="No-Break">.</span></p>
			<h3>Obtaining validation errors</h3>
			<p>The <strong class="source-inline">useForm</strong> returns a state<a id="_idIndexMarker589"/> called <strong class="source-inline">errors</strong>, which contains the form validation errors. The <strong class="source-inline">errors</strong> state is an object containing invalid field error messages. For example, if a <strong class="source-inline">name</strong> field is invalid because a <strong class="source-inline">required</strong> rule has been violated, the <strong class="source-inline">errors</strong> object could be <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
{
  name: {
    message: 'You must enter your email address',
    type: 'required'
  }
}</pre>
			<p>Fields in a valid state don’t exist in the <strong class="source-inline">errors</strong> object, so a field validation error message can be conditionally rendered <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
{errors.name &amp;&amp; &lt;div&gt;{errors.name.message}&lt;/div&gt;}</pre>
			<p>In the preceding code snippet, if the name field is valid, <strong class="source-inline">errors.name</strong> will be <strong class="source-inline">undefined</strong>, and so the error message won’t render. If the name field is invalid, <strong class="source-inline">errors.name</strong> will contain the error and so the error message <span class="No-Break">will render.</span></p>
			<h3>Handling submission</h3>
			<p>The <strong class="source-inline">useForm</strong> hook also<a id="_idIndexMarker590"/> returns a handler called <strong class="source-inline">handleSubmit</strong> that can be used for form submission. <strong class="source-inline">handleSubmit</strong> takes in a function that React Hook Form calls when it has successfully validated the form. Here’s an example of <strong class="source-inline">handleSubmit</strong> <span class="No-Break">being used:</span></p>
			<pre class="source-code">
<strong class="bold">function onSubmit(data: FormData) {</strong>
<strong class="bold">  console.log('Submitted data:', data);</strong>
<strong class="bold">}</strong>
return (
  &lt;form onSubmit={<strong class="bold">handleSubmit(onSubmit)</strong>}&gt;
  &lt;/form&gt;
);</pre>
			<p>In the preceding example, <strong class="source-inline">onSubmit</strong> is only called in the submission when the form is successfully validated and not when the form <span class="No-Break">is invalid.</span></p>
			<p>The <strong class="source-inline">isSubmitting</strong> state can be used to disable elements whilst the form is being submitted. The following example disables the <strong class="source-inline">submit</strong> button while the form is <span class="No-Break">being submitted:</span></p>
			<pre class="source-code">
&lt;button type="submit" disabled={isSubmitting}&gt;Submit&lt;/button&gt;</pre>
			<p><strong class="source-inline">isSubmitSuccessful</strong> can be used to conditionally render a successful <span class="No-Break">submission message:</span></p>
			<pre class="source-code">
if (isSubmitSuccessful) {
  return &lt;div&gt;The form was successfully submitted&lt;/div&gt;;
}</pre>
			<p>There are <a id="_idIndexMarker591"/>many more features in React Hook Form, but these are the essential functions and states that are commonly used. Refer to the <a id="_idIndexMarker592"/>React Hook Form documentation for more information <span class="No-Break">at </span><a href="https://react-hook-form.com/"><span class="No-Break">https://react-hook-form.com/</span></a><span class="No-Break">.</span></p>
			<p>Now that we understand React Hook Form’s basics, we will refactor our contact form to <span class="No-Break">use it.</span></p>
			<h2 id="_idParaDest-197"><a id="_idTextAnchor199"/>Using React Hook Form</h2>
			<p>We will<a id="_idIndexMarker593"/> refactor the contact form that we have been working on to use React Hook Form. The form will contain the same features but the implementation will use React Hook Form. After making the code changes, we will check how often the form is re-rendered using <span class="No-Break">React’s DevTools.</span></p>
			<p>We will remove the use of React Router’s <strong class="source-inline">Form</strong> component– it currently handles form submission. React Hook Form is capable of handling submission as well, and we need it to fully control submission to ensure the form is valid as part of <span class="No-Break">this process.</span></p>
			<p>Carry out the <span class="No-Break">following steps:</span></p>
			<ol>
				<li value="1">Let’s start <a id="_idIndexMarker594"/>by installing React Hook Form. Run the following command in <span class="No-Break">the terminal:</span><pre class="source-code">
npm i react-hook-form</pre></li>
			</ol>
			<p>TypeScript types are included in this package, so there is no need for a <span class="No-Break">separate installation.</span></p>
			<ol>
				<li value="2">Open <strong class="source-inline">ContactPage.tsx</strong> and add an <strong class="source-inline">import</strong> statement for <strong class="source-inline">useForm</strong> from React <span class="No-Break">Hook Form:</span><pre class="source-code">
import { useForm } from 'react-hook-form';</pre></li>
				<li>Remove <strong class="source-inline">Form</strong>, <strong class="source-inline">redirect</strong>, and <strong class="source-inline">ActionFunctionArgs</strong> from the React Router <strong class="source-inline">import</strong> statement and replace them <span class="No-Break">with </span><span class="No-Break"><strong class="source-inline">useNavigate</strong></span><span class="No-Break">:</span><pre class="source-code">
import { useNavigate } from 'react-router-dom';</pre></li>
			</ol>
			<p>We will use <strong class="source-inline">useNavigate</strong> to navigate to the thank you page at the end of the <span class="No-Break">form submission.</span></p>
			<ol>
				<li value="4">Add the following call to <strong class="source-inline">useForm</strong> at the top of the <strong class="source-inline">ContactPage</strong> component and destructure the <strong class="source-inline">register</strong> and <span class="No-Break"><strong class="source-inline">handleSubmit</strong></span><span class="No-Break"> functions:</span><pre class="source-code">
export function ContactPage() {</pre><pre class="source-code">
  <strong class="bold">const { register, handleSubmit } = useForm&lt;Contact&gt;();</strong></pre><pre class="source-code">
  ...</pre><pre class="source-code">
}</pre></li>
				<li>Add the following call to <strong class="source-inline">useNavigate</strong> after the call to <strong class="source-inline">useForm</strong> to get a function that we can use to <span class="No-Break">perform navigation:</span><pre class="source-code">
export function ContactPage() {</pre><pre class="source-code">
  const { register, handleSubmit } = useForm&lt;Contact&gt;();</pre><pre class="source-code">
<strong class="bold">  const navigate = useNavigate();</strong></pre><pre class="source-code">
}</pre></li>
				<li>In the JSX, replace the use of React Router’s <strong class="source-inline">Form</strong> element with a native <strong class="source-inline">form</strong> element. Remove the <strong class="source-inline">method</strong> attribute on the <strong class="source-inline">form</strong> element, and replace it with the following <span class="No-Break"><strong class="source-inline">onSubmit</strong></span><span class="No-Break"> attribute:</span><pre class="source-code">
&lt;<strong class="bold">form onSubmit={handleSubmit(onSubmit)}</strong>&gt;</pre><pre class="source-code">
  ...</pre><pre class="source-code">
&lt;/form&gt;</pre></li>
			</ol>
			<p>We will implement the <strong class="source-inline">onSubmit</strong> function in the <span class="No-Break">next step.</span></p>
			<ol>
				<li value="7">Add the<a id="_idIndexMarker595"/> following <strong class="source-inline">onSubmit</strong> function after the call to <strong class="source-inline">useNavigate</strong>. React Hook Form will call this function with the form data after it has ensured the form <span class="No-Break">is valid:</span><pre class="source-code">
const navigate = useNavigate();</pre><pre class="source-code">
<strong class="bold">function onSubmit(contact: Contact) {</strong></pre><pre class="source-code">
<strong class="bold">  console.log('Submitted details:', contact);</strong></pre><pre class="source-code">
<strong class="bold">  navigate(`/thank-you/${contact.name}`);</strong></pre><pre class="source-code">
<strong class="bold">}</strong></pre></li>
			</ol>
			<p>The function outputs the form data to the console and then navigates to the thank <span class="No-Break">you page.</span></p>
			<ol>
				<li value="8">Remove the <strong class="source-inline">contactPageAction</strong> function at the bottom of the file because this is no <span class="No-Break">longer required.</span></li>
				<li>Replace the <strong class="source-inline">name</strong> attribute on the field editors with a call to <strong class="source-inline">register</strong>. Pass the field name into <strong class="source-inline">register</strong> and spread the result of <strong class="source-inline">register</strong> <span class="No-Break">as follows:</span><pre class="source-code">
&lt;form onSubmit={handleSubmit(onSubmit)}&gt;</pre><pre class="source-code">
  &lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
    &lt;label htmlFor="name"&gt;Your name&lt;/label&gt;</pre><pre class="source-code">
    &lt;input ... <strong class="bold">{...register('name')}</strong> /&gt;</pre><pre class="source-code">
  &lt;/div&gt;</pre><pre class="source-code">
  &lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
    &lt;label htmlFor="email"&gt;Your email address&lt;/label&gt;</pre><pre class="source-code">
    &lt;input ... <strong class="bold">{...register('email')}</strong> /&gt;</pre><pre class="source-code">
  &lt;/div&gt;</pre><pre class="source-code">
  &lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
    &lt;label htmlFor="reason"&gt;Reason you need to contact       us&lt;/label&gt;</pre><pre class="source-code">
    &lt;select ... <strong class="bold">{...register('reason')}</strong>&gt;</pre><pre class="source-code">
      ...</pre><pre class="source-code">
    &lt;/select&gt;</pre><pre class="source-code">
  &lt;/div&gt;</pre><pre class="source-code">
  &lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
    &lt;label htmlFor="notes"&gt;Additional notes&lt;/label&gt;</pre><pre class="source-code">
    &lt;textarea ... <strong class="bold">{...register('notes')}</strong> /&gt;</pre><pre class="source-code">
  &lt;/div&gt;</pre><pre class="source-code">
  ...</pre><pre class="source-code">
&lt;/Form&gt;</pre></li>
			</ol>
			<p>React Hook Form will now be able to track <span class="No-Break">these fields.</span></p>
			<ol>
				<li value="10">Open <strong class="source-inline">App.tsx</strong> and <a id="_idIndexMarker596"/>remove <strong class="source-inline">contactPageAction</strong> from the <strong class="source-inline">import</strong> statement for <strong class="source-inline">ContactPage</strong> and remove it from the <strong class="source-inline">/</strong><span class="No-Break"><strong class="source-inline">contact</strong></span><span class="No-Break"> route:</span><pre class="source-code">
import { ContactPage } from './ContactPage';</pre><pre class="source-code">
...</pre><pre class="source-code">
const router = createBrowserRouter([</pre><pre class="source-code">
  {</pre><pre class="source-code">
    path: '/',</pre><pre class="source-code">
    element: &lt;Navigate to="contact" /&gt;,</pre><pre class="source-code">
  },</pre><pre class="source-code">
  {</pre><pre class="source-code">
    path: '/contact',</pre><pre class="source-code">
    element: &lt;ContactPage /&gt;</pre><pre class="source-code">
  },</pre><pre class="source-code">
  {</pre><pre class="source-code">
    path: '/thank-you/:name',</pre><pre class="source-code">
    element: &lt;ThankYouPage /&gt;,</pre><pre class="source-code">
  }</pre><pre class="source-code">
]);</pre></li>
				<li>Run the app in development mode by executing <strong class="source-inline">npm start</strong> in <span class="No-Break">the terminal.</span></li>
				<li>Open the React DevTools and ensure the <strong class="bold">Highlight updates when components render</strong> option is still ticked so that we can observe when the form <span class="No-Break">is re-rendered.</span></li>
				<li>Fill in the form with valid values. The re-render outline doesn’t appear when the field values are entered because they aren’t using the state to cause a re-render yet. This is confirmation that React Hook Form efficiently tracks <span class="No-Break">field values.</span></li>
				<li>Now, click<a id="_idIndexMarker597"/> on the <strong class="bold">Submit</strong> button. After the form has been successfully submitted, the field values are output to the console and the thank you page appears, just <span class="No-Break">as before.</span></li>
			</ol>
			<p>We’ve had to do a little more work to set up the form in React Hook Form so that it can track the fields. This enables React Hook Form to validate the fields, which we will implement in the <span class="No-Break">next section.</span></p>
			<h2 id="_idParaDest-198"><a id="_idTextAnchor200"/>Adding validation</h2>
			<p>We will now <a id="_idIndexMarker598"/>remove the use of standard HTML form validation and use React Hook Form’s validation. Using React Hook Form’s validation allows us to more easily provide a great validation <span class="No-Break">user experience.</span></p>
			<p>Carry out the <span class="No-Break">following steps:</span></p>
			<ol>
				<li value="1">Open <strong class="source-inline">ContactPage.tsx</strong> and add the <strong class="source-inline">FieldError</strong> type to the React Hook Form <span class="No-Break"><strong class="source-inline">import</strong></span><span class="No-Break"> statement:</span><pre class="source-code">
import { useForm, <strong class="bold">FieldError</strong> } from 'react-hook-form';</pre></li>
				<li>Destructure the <strong class="source-inline">errors</strong> state from <strong class="source-inline">useForm</strong> <span class="No-Break">as follows:</span><pre class="source-code">
const {</pre><pre class="source-code">
  register,</pre><pre class="source-code">
  handleSubmit,</pre><pre class="source-code">
  <strong class="bold">formState: { errors }</strong></pre><pre class="source-code">
} = useForm&lt;Contact&gt;();</pre></li>
			</ol>
			<p><strong class="source-inline">errors</strong> will contain validation errors if there <span class="No-Break">are any.</span></p>
			<ol>
				<li value="3">Add a <strong class="source-inline">noValidate</strong> attribute to the form element to prevent any native <span class="No-Break">HTML validation:</span><pre class="source-code">
&lt;form <strong class="bold">noValidate</strong> onSubmit={handleSubmit(onSubmit)}&gt;</pre></li>
				<li>Remove the native HTML validation rules on all the field editors by removing the validation <strong class="source-inline">required</strong> and <span class="No-Break"><strong class="source-inline">pattern</strong></span><span class="No-Break"> attributes.</span></li>
				<li>Add the required validation rules to the <strong class="source-inline">register</strong> function for the name, email, and reason fields, <span class="No-Break">as follows:</span><pre class="source-code">
&lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
  &lt;label htmlFor="name"&gt;Your name&lt;/label&gt;</pre><pre class="source-code">
  &lt;input</pre><pre class="source-code">
    type="text"</pre><pre class="source-code">
    id="name"</pre><pre class="source-code">
    {...register('name'<strong class="bold">, {</strong></pre><pre class="source-code">
<strong class="bold">      required: 'You must enter your name'</strong></pre><pre class="source-code">
<strong class="bold">    }</strong>)}</pre><pre class="source-code">
  /&gt;</pre><pre class="source-code">
&lt;/div&gt;</pre><pre class="source-code">
&lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
  &lt;label htmlFor="email"&gt;Your email address&lt;/label&gt;</pre><pre class="source-code">
  &lt;input</pre><pre class="source-code">
    type="email"</pre><pre class="source-code">
    id="email"</pre><pre class="source-code">
    {...register('email'<strong class="bold">, {</strong></pre><pre class="source-code">
<strong class="bold">      required: 'You must enter your email address'</strong></pre><pre class="source-code">
<strong class="bold">    }</strong>)}</pre><pre class="source-code">
  /&gt;</pre><pre class="source-code">
&lt;/div&gt;</pre><pre class="source-code">
&lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
  &lt;label htmlFor="reason"&gt;Reason you need to contact us&lt;/label&gt;</pre><pre class="source-code">
  &lt;select</pre><pre class="source-code">
    id="reason"</pre><pre class="source-code">
    {...register('reason'<strong class="bold">, {</strong></pre><pre class="source-code">
<strong class="bold">      required: 'You must enter the reason for contacting         us'</strong></pre><pre class="source-code">
<strong class="bold">    }</strong>)}</pre><pre class="source-code">
  &gt;</pre><pre class="source-code">
    ...</pre><pre class="source-code">
  &lt;/select&gt;</pre><pre class="source-code">
&lt;/div&gt;</pre></li>
			</ol>
			<p>We have specified the validation error message with the <span class="No-Break">validation rules.</span></p>
			<ol>
				<li value="6">Add an<a id="_idIndexMarker599"/> additional rule for the email field to ensure it matches a <span class="No-Break">particular pattern:</span><pre class="source-code">
&lt;input</pre><pre class="source-code">
  type="email"</pre><pre class="source-code">
  id="email"</pre><pre class="source-code">
  {...register('email', {</pre><pre class="source-code">
    required: 'You must enter your email address'<strong class="bold">,</strong></pre><pre class="source-code">
<strong class="bold">    pattern: {</strong></pre><pre class="source-code">
<strong class="bold">      value: /\S+@\S+\.\S+/,</strong></pre><pre class="source-code">
<strong class="bold">      message: 'Entered value does not match email         format',</strong></pre><pre class="source-code">
<strong class="bold">    }</strong></pre><pre class="source-code">
  })}</pre><pre class="source-code">
/&gt;</pre></li>
				<li>We will now style fields if they are invalid. Each field is going to have the same styling logic, so define the style in a function <span class="No-Break">as follows:</span><pre class="source-code">
<strong class="bold">function getEditorStyle(fieldError: FieldError | undefined) {</strong></pre><pre class="source-code">
<strong class="bold">  return fieldError ? 'border-red-500' : '';</strong></pre><pre class="source-code">
<strong class="bold">}</strong></pre><pre class="source-code">
return (</pre><pre class="source-code">
  &lt;div&gt;</pre><pre class="source-code">
    ...</pre><pre class="source-code">
  &lt;/div&gt;</pre><pre class="source-code">
);</pre></li>
			</ol>
			<p>The field error is passed into the <strong class="source-inline">getEditorStyle</strong> function. The function returns a Tailwind CSS class that styles the element with a red border if there is <span class="No-Break">an error.</span></p>
			<ol>
				<li value="8">Use the <strong class="source-inline">getEditorStyle</strong> function to style the name, email, and reasons fields <a id="_idIndexMarker600"/><span class="No-Break">when invalid:</span><pre class="source-code">
&lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
  &lt;label htmlFor="name"&gt;Your name&lt;/label&gt;</pre><pre class="source-code">
  &lt;input ... <strong class="bold">className={getEditorStyle(errors.name)}</strong> /&gt;</pre><pre class="source-code">
&lt;/div&gt;</pre><pre class="source-code">
&lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
  &lt;label htmlFor="email"&gt;Your email address&lt;/label&gt;</pre><pre class="source-code">
  &lt;input ... <strong class="bold">className={getEditorStyle(errors.email)}</strong> /&gt;</pre><pre class="source-code">
&lt;/div&gt;</pre><pre class="source-code">
&lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
  &lt;label htmlFor="reason"&gt;Reason you need to contact us&lt;/label&gt;</pre><pre class="source-code">
  &lt;select ... <strong class="bold">className={getEditorStyle(errors.reason)}</strong> &gt;</pre><pre class="source-code">
    ...</pre><pre class="source-code">
  &lt;/select&gt;</pre><pre class="source-code">
&lt;/div&gt;</pre></li>
			</ol>
			<p>React Hook Form’s <strong class="source-inline">errors</strong> state contains a property for a field containing a validation error if the field has an invalid value. For example, if the name field value is invalid, <strong class="source-inline">errors</strong> will contain a property <span class="No-Break">called </span><span class="No-Break"><strong class="source-inline">name</strong></span><span class="No-Break">.</span></p>
			<ol>
				<li value="9">Now, let’s <a id="_idIndexMarker601"/>display the validation error under each field when it’s invalid. The structure and style of the error will be the same for each field with a varying message, so we will create a reusable validation error component. Create a file in the <strong class="source-inline">src</strong> folder called <strong class="source-inline">ValidationError.tsx</strong> with the <span class="No-Break">following content:</span><pre class="source-code">
import { FieldError } from 'react-hook-form';</pre><pre class="source-code">
type Props = {</pre><pre class="source-code">
  fieldError: FieldError | undefined;</pre><pre class="source-code">
};</pre><pre class="source-code">
export function ValidationError({ fieldError }: Props) {</pre><pre class="source-code">
  if (!fieldError) {</pre><pre class="source-code">
    return null;</pre><pre class="source-code">
  }</pre><pre class="source-code">
  return (</pre><pre class="source-code">
    &lt;div role="alert" className="text-red-500 text-xs       mt-1"&gt;</pre><pre class="source-code">
      {fieldError.message}</pre><pre class="source-code">
    &lt;/div&gt;</pre><pre class="source-code">
  );</pre><pre class="source-code">
}</pre></li>
			</ol>
			<p>The component has a <strong class="source-inline">fieldError</strong> prop for the field error from React Hook Form. Nothing is rendered if there is no field error. If there is an error, it is rendered with red text inside a <strong class="source-inline">div</strong> element. The <strong class="source-inline">role="alert"</strong> attribute allows a screen reader to read the <span class="No-Break">validation error.</span></p>
			<ol>
				<li value="10">Return to <strong class="source-inline">ContactPage.tsx</strong> and import the <span class="No-Break"><strong class="source-inline">ValidationError</strong></span><span class="No-Break"> component:</span><pre class="source-code">
import { ValidationError } from './ValidationError';</pre></li>
				<li>Add <a id="_idIndexMarker602"/>instances of <strong class="source-inline">ValidationError</strong> beneath each field editor <span class="No-Break">as follows:</span><pre class="source-code">
&lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
  &lt;label htmlFor="name"&gt;Your name&lt;/label&gt;</pre><pre class="source-code">
  &lt;input ... /&gt;</pre><pre class="source-code">
<strong class="bold">  &lt;ValidationError fieldError={errors.name} /&gt;</strong></pre><pre class="source-code">
&lt;/div&gt;</pre><pre class="source-code">
&lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
  &lt;label htmlFor="email"&gt;Your email address&lt;/label&gt;</pre><pre class="source-code">
  &lt;input ... /&gt;</pre><pre class="source-code">
<strong class="bold">  &lt;ValidationError fieldError={errors.email} /&gt;</strong></pre><pre class="source-code">
&lt;/div&gt;</pre><pre class="source-code">
&lt;div className={fieldStyle}&gt;</pre><pre class="source-code">
  &lt;label htmlFor="reason"&gt;Reason you need to contact us&lt;/label&gt;</pre><pre class="source-code">
  &lt;select ... &gt;...&lt;/select&gt;</pre><pre class="source-code">
<strong class="bold">  &lt;ValidationError fieldError={errors.reason} /&gt;</strong></pre><pre class="source-code">
&lt;/div&gt;</pre></li>
			</ol>
			<p>That completes the implementation of the form validation. We will now test our enhanced form in the <span class="No-Break">following steps:</span></p>
			<ol>
				<li value="1">In the running<a id="_idIndexMarker603"/> app, ensure the <strong class="bold">Highlight updates when components render</strong> option is still ticked in DevTools so we can observe when the form <span class="No-Break">is re-rendered.</span></li>
				<li>Click on the <strong class="bold">Submit</strong> button without filling in <span class="No-Break">the form.</span></li>
			</ol>
			<div>
				<div id="_idContainer119" class="IMG---Figure">
					<img src="image/B19051_07_07.jpg" alt="Figure 7.7 – Highlighted re-render and validation errors when the form is submitted"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 7.7 – Highlighted re-render and validation errors when the form is submitted</p>
			<ol>
				<li value="3">Fill in the form and click on the <strong class="bold">Submit</strong> button. The validation errors appear. You will also notice that the form now re-renders when submitted because of the <strong class="source-inline">errors</strong> state. This is a necessary re-render because we need the page to update with the validation <span class="No-Break">error messages.</span></li>
			</ol>
			<p>Another thing that you may have noticed is that nothing is output to the console because our <strong class="source-inline">onSubmit</strong> function is not called until the form <span class="No-Break">is valid.</span></p>
			<ol>
				<li value="4">Fill in the form correctly and submit it. The field values are now output to the console and the thank you <span class="No-Break">page appears.</span></li>
			</ol>
			<p>The form is working <span class="No-Break">nicely now.</span></p>
			<p>One thing you <a id="_idIndexMarker604"/>may have spotted is when validation actually happens – it happens when the form is submitted. We will change the validation to happen every time a field editor loses focus. Carry out the <span class="No-Break">following steps:</span></p>
			<ol>
				<li value="1">On <strong class="source-inline">ContactPage.tsx</strong>, add the following argument to the <span class="No-Break"><strong class="source-inline">useForm</strong></span><span class="No-Break"> call:</span><pre class="source-code">
const {</pre><pre class="source-code">
  register,</pre><pre class="source-code">
  handleSubmit,</pre><pre class="source-code">
  formState: { errors },</pre><pre class="source-code">
} = useForm&lt;Contact&gt;(<strong class="bold">{</strong></pre><pre class="source-code">
<strong class="bold">  mode: "onBlur",</strong></pre><pre class="source-code">
<strong class="bold">  reValidateMode: "onBlur"</strong></pre><pre class="source-code">
<strong class="bold">}</strong>);</pre></li>
			</ol>
			<p>The <strong class="source-inline">mode</strong> option now tells React Hook Form to initially validate when a field editor loses focus. The <strong class="source-inline">reValidationMode</strong> option now tells React Hook Form to validate subsequently when a field editor <span class="No-Break">loses focus.</span></p>
			<ol>
				<li value="2">In the running app, visit the fields in the form without filling them in and see the <span class="No-Break">validation happen.</span></li>
			</ol>
			<p>That completes the form and indeed this section on React Hook Form. Here’s a recap of the critical parts of React <span class="No-Break">Hook Form:</span></p>
			<ul>
				<li>React Hook Form <a id="_idIndexMarker605"/>doesn’t cause unnecessary re-renders when a form is <span class="No-Break">filled in.</span></li>
				<li>React Hook Form’s <strong class="source-inline">register</strong> function needs to be spread on field editors. This function allows field values to be efficiently tracked and allows validation rules to <span class="No-Break">be specified.</span></li>
				<li>React Hook Form’s <a id="_idIndexMarker606"/>submit handler automatically prevents a server post and ensures the form is valid before our submission logic <span class="No-Break">is called.</span></li>
			</ul>
			<p>Next, we will summarize <span class="No-Break">this chapter.</span></p>
			<h1 id="_idParaDest-199"><a id="_idTextAnchor201"/>Summary</h1>
			<p>At the start of this chapter, we learned that field values in a form can be controlled by the state. However, this leads to lots of unnecessary re-rendering of the form. We then realised that not controlling field values with the state and using the <strong class="source-inline">FormData</strong> interface to retrieve field values instead is more performant and requires <span class="No-Break">less code.</span></p>
			<p>We used React Router’s <strong class="source-inline">Form</strong> component, which is a wrapper around the native <strong class="source-inline">form</strong> element. It submits data to a client-side route instead of a server. However, it doesn’t cover validation – we tried using native HTML validation for that, which was simple to implement, but providing a great user experience with native HTML validation <span class="No-Break">is tricky.</span></p>
			<p>We introduced ourselves to a popular forms library called React Hook Form to provide a better validation user experience. It contains a <strong class="source-inline">useForm</strong> hook that returns useful functions and a state. The library doesn’t cause unnecessary renders, so it is <span class="No-Break">very performant.</span></p>
			<p>We learned that React Hook Form’s <strong class="source-inline">register</strong> function needs to be spread on every field editor. This is so that it can efficiently track field values without causing unnecessary renders. We learned that React Hook Form contains several common validation rules, including required fields and field values that match a particular pattern. Field validation rules are specified in the <strong class="source-inline">register</strong> function and can be specified with an appropriate validation message. <strong class="source-inline">useForm</strong> returns an <strong class="source-inline">errors</strong> state variable, which can be used to render validation error <span class="No-Break">messages conditionally.</span></p>
			<p>We explored the submit handler that React Hook Form provides. We learned that it prevents a server post and ensures that the form is valid. This submit handler has an argument for a function that is called with the valid <span class="No-Break">form data.</span></p>
			<p>In the next chapter, we will focus on state management <span class="No-Break">in detail.</span></p>
			<h1 id="_idParaDest-200"><a id="_idTextAnchor202"/>Questions</h1>
			<p>Answer the following questions to check what you have learned about forms <span class="No-Break">in React:</span></p>
			<ol>
				<li value="1">How many times will the following form render after the initial render when <strong class="source-inline">Bob</strong> is entered into the <span class="No-Break">name field?</span><pre class="source-code">
function ControlledForm () {</pre><pre class="source-code">
  const [name, setName] = useState('');</pre><pre class="source-code">
  return (</pre><pre class="source-code">
    &lt;form</pre><pre class="source-code">
      onSubmit={(e) =&gt; {</pre><pre class="source-code">
        e.preventDefault();</pre><pre class="source-code">
        console.log(name);</pre><pre class="source-code">
      }}</pre><pre class="source-code">
    &gt;</pre><pre class="source-code">
      &lt;input</pre><pre class="source-code">
        placeholder="Enter your name"</pre><pre class="source-code">
        value={name}</pre><pre class="source-code">
        onChange={(e) =&gt; setName(e.target.value)}</pre><pre class="source-code">
      /&gt;</pre><pre class="source-code">
    &lt;/form&gt;</pre><pre class="source-code">
  );</pre><pre class="source-code">
}</pre></li>
				<li>How many times will the following form render after the initial render when <strong class="source-inline">Bob</strong> is entered into the <span class="No-Break">name field?</span><pre class="source-code">
function UnControlledForm() {</pre><pre class="source-code">
  return (</pre><pre class="source-code">
    &lt;form</pre><pre class="source-code">
      onSubmit={(e) =&gt; {</pre><pre class="source-code">
        e.preventDefault();</pre><pre class="source-code">
        console.log(</pre><pre class="source-code">
          new FormData(e.currentTarget).get('name')</pre><pre class="source-code">
        );</pre><pre class="source-code">
      }}</pre><pre class="source-code">
    &gt;</pre><pre class="source-code">
      &lt;input placeholder="Enter your name" name="name" /&gt;</pre><pre class="source-code">
    &lt;/form&gt;</pre><pre class="source-code">
  );</pre><pre class="source-code">
}</pre></li>
				<li>The following form contains an uncontrolled search field. When search criteria is entered into it and submitted, <strong class="source-inline">null</strong> appears in the console rather than the search criteria. Why is <span class="No-Break">that so?</span><pre class="source-code">
function SearchForm() {</pre><pre class="source-code">
  return (</pre><pre class="source-code">
    &lt;form</pre><pre class="source-code">
      onSubmit={(e) =&gt; {</pre><pre class="source-code">
        e.preventDefault();</pre><pre class="source-code">
        console.log(</pre><pre class="source-code">
          new FormData(e.currentTarget).get('search')</pre><pre class="source-code">
        );</pre><pre class="source-code">
      }}</pre><pre class="source-code">
    &gt;</pre><pre class="source-code">
      &lt;input type="search" placeholder="Search ..." /&gt;</pre><pre class="source-code">
    &lt;/form&gt;</pre><pre class="source-code">
  );</pre><pre class="source-code">
}</pre></li>
				<li>The following component is a search form implemented using React Hook Form. When search criteria are entered into it and submitted, an empty object appears in the console, rather than an object containing the search criteria. Why is <span class="No-Break">that so?</span><pre class="source-code">
function SearchReactHookForm() {</pre><pre class="source-code">
  const { handleSubmit } = useForm();</pre><pre class="source-code">
  return (</pre><pre class="source-code">
    &lt;form</pre><pre class="source-code">
      onSubmit={handleSubmit((search) =&gt; console.        log(search))}</pre><pre class="source-code">
    &gt;</pre><pre class="source-code">
      &lt;input type="search" placeholder="Search ..." /&gt;</pre><pre class="source-code">
    &lt;/form&gt;</pre><pre class="source-code">
  );</pre><pre class="source-code">
}</pre></li>
				<li>The following component is another search form implemented using React Hook Form. The form does function correctly but a type error is raised on the <strong class="source-inline">onSubmit</strong> parameter. How can the type error <span class="No-Break">be resolved?</span><pre class="source-code">
function SearchReactHookForm() {</pre><pre class="source-code">
  const { handleSubmit, register } = useForm();</pre><pre class="source-code">
  async function onSubmit(<strong class="bold">search</strong>) {</pre><pre class="source-code">
    console.log(search.criteria);</pre><pre class="source-code">
    // send to web server to perform the search</pre><pre class="source-code">
  }</pre><pre class="source-code">
  return (</pre><pre class="source-code">
    &lt;form onSubmit={handleSubmit(onSubmit)}&gt;</pre><pre class="source-code">
      &lt;input</pre><pre class="source-code">
        type="search"</pre><pre class="source-code">
        placeholder="Search ..."</pre><pre class="source-code">
        {...register('criteria')}</pre><pre class="source-code">
      /&gt;</pre><pre class="source-code">
    &lt;/form&gt;</pre><pre class="source-code">
  );</pre><pre class="source-code">
}</pre></li>
				<li>Continuing with the search form from the last question, how can we disable the <strong class="source-inline">input</strong> element while the search is being performed on the <span class="No-Break">web server?</span></li>
				<li>Continuing with the search form from the last question, how can we prevent a search from executing if the criteria <span class="No-Break">is blank?</span></li>
			</ol>
			<h1 id="_idParaDest-201"><a id="_idTextAnchor203"/>Answers</h1>
			<ol>
				<li value="1">The form will render three times when <strong class="source-inline">Bob</strong> is entered into the name field. This is because each change of value causes a re-render because the value is bound to <span class="No-Break">the state.</span></li>
				<li>The form will never re-render when <strong class="source-inline">Bob</strong> is entered into the name field because its value isn’t bound to <span class="No-Break">the state.</span></li>
				<li>The <strong class="source-inline">FormData</strong> interface requires the <strong class="source-inline">name</strong> attribute to be on the <strong class="source-inline">input</strong> element or it won’t be able to find it and it will <span class="No-Break">return </span><span class="No-Break"><strong class="source-inline">null</strong></span><span class="No-Break">:</span><pre class="source-code">
&lt;input type="search" placeholder="Search ..." <strong class="bold">name="search"</strong> /&gt;</pre></li>
				<li>For React Hook Form to track the field, the <strong class="source-inline">register</strong> function needs to be spread on the <strong class="source-inline">input</strong> element <span class="No-Break">as follows:</span><pre class="source-code">
function SearchReactHookForm() {</pre><pre class="source-code">
  const { handleSubmit<strong class="bold">, register</strong> } = useForm();</pre><pre class="source-code">
  return (</pre><pre class="source-code">
    &lt;form</pre><pre class="source-code">
      onSubmit={handleSubmit((search) =&gt; console.        log(search))}</pre><pre class="source-code">
    &gt;</pre><pre class="source-code">
      &lt;input</pre><pre class="source-code">
        type="search"</pre><pre class="source-code">
        placeholder="Search ..."</pre><pre class="source-code">
<strong class="bold">        {...register('criteria')}</strong></pre><pre class="source-code">
      /&gt;</pre><pre class="source-code">
    &lt;/form&gt;</pre><pre class="source-code">
  );</pre><pre class="source-code">
}</pre></li>
				<li>A type for field values can be defined and specified in the call to <strong class="source-inline">useForm</strong> and also the <strong class="source-inline">onSubmit</strong> <span class="No-Break">search parameter:</span><pre class="source-code">
<strong class="bold">type Search = {</strong></pre><pre class="source-code">
<strong class="bold">  criteria: string;</strong></pre><pre class="source-code">
<strong class="bold">};</strong></pre><pre class="source-code">
function SearchReactHookForm() {</pre><pre class="source-code">
  const { handleSubmit, register } = useForm<strong class="bold">&lt;Search&gt;</strong>();</pre><pre class="source-code">
  async function onSubmit(search<strong class="bold">: Search</strong>) {</pre><pre class="source-code">
    ...</pre><pre class="source-code">
  }</pre><pre class="source-code">
  return ...</pre><pre class="source-code">
}</pre></li>
				<li>React Hook Form’s <strong class="source-inline">isSubmitting</strong> state can be used to disable the <strong class="source-inline">input</strong> element while the search is being performed on the <span class="No-Break">web server:</span><pre class="source-code">
function SearchReactHookForm() {</pre><pre class="source-code">
  const {</pre><pre class="source-code">
    handleSubmit,</pre><pre class="source-code">
    register,</pre><pre class="source-code">
    <strong class="bold">formState: { isSubmitting },</strong></pre><pre class="source-code">
  } = useForm&lt;Search&gt;();</pre><pre class="source-code">
  ...</pre><pre class="source-code">
  return (</pre><pre class="source-code">
    &lt;form onSubmit={handleSubmit(onSubmit)}&gt;</pre><pre class="source-code">
      &lt;input</pre><pre class="source-code">
        type="search"</pre><pre class="source-code">
        placeholder="Search ..."</pre><pre class="source-code">
        {...register('criteria')}</pre><pre class="source-code">
<strong class="bold">        disabled={isSubmitting}</strong></pre><pre class="source-code">
      /&gt;</pre><pre class="source-code">
    &lt;/form&gt;</pre><pre class="source-code">
  );</pre><pre class="source-code">
}</pre></li>
				<li>The required validation can be added to the search form to prevent a search from executing if the criteria <span class="No-Break">are blank:</span><pre class="source-code">
&lt;input</pre><pre class="source-code">
  type="search"</pre><pre class="source-code">
  placeholder="Search ..."</pre><pre class="source-code">
  {...register('criteria'<strong class="bold">, { required: true }</strong>)}</pre><pre class="source-code">
  disabled={isSubmitting}</pre><pre class="source-code">
/&gt;</pre></li>
			</ol>
		</div>
		<div>
			<div id="_idContainer121" class="Content">
			</div>
		</div>
	

		<div id="_idContainer122" class="Content">
			<h1 id="_idParaDest-202"><a id="_idTextAnchor204"/>Part 3: Data</h1>
			<p>This part covers different approaches for interacting with both REST and GraphQL APIs and the benefits of each approach. We will learn about different approaches for efficiently managing the data from these APIs in states, including using several popular third-party libraries. </p>
			<p>This part includes the <span class="No-Break">following chapters:</span></p>
			<ul>
				<li><a href="B19051_08.xhtml#_idTextAnchor205"><em class="italic">Chapter 8</em></a>, <em class="italic">State Management</em></li>
				<li><a href="B19051_09.xhtml#_idTextAnchor220"><em class="italic">Chapter 9</em></a>, <em class="italic">Interacting with RESTful APIs</em></li>
				<li><a href="B19051_10.xhtml#_idTextAnchor248"><em class="italic">Chapter 10</em></a>, <em class="italic">Interacting with GraphQL APIs</em></li>
			</ul>
		</div>
		<div>
			<div id="_idContainer123">
			</div>
		</div>
	</body></html>
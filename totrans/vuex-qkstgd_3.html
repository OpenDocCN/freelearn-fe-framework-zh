<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Setting Up Development and Test Environment</h1>
                </header>
            
            <article>
                
<p><span>When I started using Vue, I found it difficult to integrate Vue with webpack. I also had trouble configuring Karma to use webpack for my tests, not to mention figuring out how to test single file components!</span></p>
<p><span>For this reason, in the next pages you will be guided through the process of configuring an environment ready for both Vue/Vuex development and testing. I think you will find the next pages quite useful.</span></p>
<p>In this chapter you will:</p>
<ul>
<li>set up the development environment using npm.</li>
<li>install, configure and use webpack.</li>
<li>install, configure and use vue-loader.</li>
<li>set up the testing environment using Karma + Jasmine.</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Technical requirements</h1>
                </header>
            
            <article>
                
<p>You will be required to have Node.js installed on a system. <span>Finally, to use the Git repository of this book, the user needs to install Git. </span></p>
<p>The code files of this chapter can be found on GitHub:<br/>
<a href="https://github.com/PacktPublishing/Vuex-Quick-Start-Guide/tree/master/chapter-3" target="_blank">https://github.com/PacktPublishing/Vuex-Quick-Start-Guide/tree/master/chapter-3</a></p>
<p>Check out the following video to see the code in action:<br/>
<a href="https://goo.gl/oacFdP" target="_blank">https://goo.gl/oacFdP</a></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Setting up the development environment</h1>
                </header>
            
            <article>
                
<p>Vue provides a tool,<span> </span><kbd>vue-cli</kbd>, for scaffolding Vue.js projects. It also supports webpack, the web packaging tool we are going to use. To install<span> </span><kbd>vue-cli</kbd><em>,</em><span> </span>you just need to type<span> </span><kbd>npm install -g vue-cli</kbd> <span>in a console</span><span>.</span></p>
<p>Although using<span> </span><kbd>vue-cli</kbd><span> </span>is the fastest way to start a new project, in the following paragraphs, I will explain how to set up a Vue project from scratch. </p>
<p> We will set up a Vue/Vuex project using the<span> </span><strong>npm</strong><span> </span>(<strong>node package manager</strong>), explaining every step and installing only a minimum set of dependencies, as opposed to<span> </span><kbd>vue-cli</kbd>, which will install a lot of npm packages in order to provide a general-purpose project configuration.</p>
<p>By using the GitHub repository of this book and checking out the first commits, you can observe what I did to set up the<span> </span><em>EveryNote</em><span> </span>app development environment.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using npm to prepare the project for Vue/Vuex </h1>
                </header>
            
            <article>
                
<p>To use npm, you need to have Node.js installed. You can find information on how to install Node.js at<span> </span><a href="https://nodejs.org/">https://nodejs.org/</a>.</p>
<p>The first step to make a Vue/Vuex project is creating a directory and initializing it with npm. Open a console and type the following commands:</p>
<pre><strong>mkdir notes-app</strong><br/><strong>cd notes-app</strong><br/><strong>npm init</strong></pre>
<p>The<span> </span><kbd>npm init</kbd> <span>command</span><span> </span><span>will ask you some questions. Each question has a default value that is normally a good choice. You can just press <em>Enter</em> for each question. After that, it will create a</span><span> </span><kbd>package.json</kbd><span> </span><span>file with the values you provided. We will use this file to save project dependencies and to create some commands that are useful for the app's development.</span></p>
<p>Let's begin by installing webpack and its related utilities. Webpack is a module bundler, and it will help us to create the production bundles, as well as handle Vue single-file components. If you have never used webpack, you should google it to familiarize yourself with its core principles. From now on, I will assume that you have basic knowledge of webpack. Type the following commands in the console:</p>
<pre><strong>npm install --save-dev webpack</strong><br/><strong>npm install --save-dev webpack-cli</strong><br/><strong>npm install --save-dev webpack-dev-server</strong><br/><strong>npm install --save-dev html-webpack-plugin</strong><br/><strong>npm install --save-dev clean-webpack-plugin</strong></pre>
<p>A directory named<span> </span><kbd>node_modules</kbd><span> </span>has been created, and you can find the source code of the packages we have just installed inside this directory. If you use<span> </span><kbd>Git</kbd>,<span> </span><kbd>node_modules</kbd><span> </span>should be put inside<span> </span><kbd>.gitignore</kbd>. The<span> </span><kbd>--save-dev</kbd> <span>option</span><span> </span><span>writes the five package names we've just installed to the <kbd>package.json</kbd> file. This way, each time you type</span><span> </span><kbd>npm install</kbd><span>, all saved packages will be downloaded, if needed.</span></p>
<p>Let's see what these packages do:</p>
<ul>
<li><kbd>webpack</kbd>: Will take all the source files and bundle them into a folder that will have the corresponding production files</li>
<li><kbd>webpack-dev-server</kbd>: Starts a development HTTP server, and helps us to write code and debug it in the browser</li>
</ul>
<ul>
<li><kbd>html-webpack-plugin</kbd>: Will help us create an<span> </span><kbd>index.html</kbd><span> </span>that will load the webpack bundle file</li>
<li><kbd>clean-webpack-plugin</kbd>: Removes the distribution folder created by webpack when bundling the project</li>
</ul>
<p>By typing<span> </span><kbd>npm install</kbd>, all the saved packages will be reinstalled inside the <kbd>node_modules</kbd><span> </span>folder. This way, to initialize a project, you just need to get the code (using<span> </span><kbd>git clone</kbd>, for example) and type<span> </span><kbd>npm install</kbd>, and the project will be ready to be used.</p>
<p>Let's now create a file named <kbd>webpack.config.js</kbd><span> </span>to configure webpack. The initial file will look like the following:</p>
<pre><span>// webpack.config.js<br/>const </span>path = require(<span>'path'</span>)<span>;<br/></span><span>const </span><span>HtmlWebpackPlugin </span>= require(<span>'html-webpack-plugin'</span>)<span>;<br/></span><span>const </span><span>CleanWebpackPlugin </span>= require(<span>'clean-webpack-plugin'</span>)<span>;<br/></span><span>const </span><span>webpack </span>= require(<span>'webpack'</span>)<span>;<br/></span><span><br/></span><span>const </span>config = {<br/>  <span>entry</span>: {<br/>    <span>app</span>: <span>'./src/main.js'</span><span>,<br/></span><span>  </span>}<span>,<br/></span><span>  </span><span>output</span>: {<br/>    <span>filename</span>: <span>'[name].bundle.js'</span><span>,<br/></span><span>    </span><span>path</span>: path.<span>resolve</span>(__dirname<span>, </span><span>'dist/'</span>)<span>,<br/></span><span>  </span>}<span>,<br/></span><span>  </span><span>plugins</span>: [<br/>    <span>new </span><span>HtmlWebpackPlugin</span>({ <span>template</span>: <span>'src/index.html' </span>})<span>,<br/></span><span>    </span><span>new </span><span>CleanWebpackPlugin</span>([<span>'dist'</span>])<span>,<br/></span><span>    </span><span>new </span><span>webpack</span>.DefinePlugin({<br/>      <span>'process.env.NODE_ENV'</span>: JSON.<span>stringify</span>(<span>process</span>.<span>env</span>.<span>NODE_ENV </span>|| <span>'development'</span>)<span>,<br/></span><span>    </span>})<span>,<br/></span><span>  </span>]<span><br/></span>}<span>;<br/></span><span><br/></span><span>module</span>.<span>exports </span>= config<span>;</span></pre>
<p>In the preceding configuration, we assumed that we have a folder named<span> </span><kbd>src</kbd>, and inside we have an<span> </span><kbd>index.html</kbd><span> </span>and a<span> </span><kbd>main.js</kbd>.</p>
<p>You may a<span>lso</span><span> </span><span>have noticed that I used </span><kbd>webpack.DefinePlugin</kbd><span>: This plugin </span><span>lets</span><span> </span><span>you define constants that can be used inside the project. In this case, we define </span><kbd>process.env.NODE_ENV</kbd><span> </span><span>to tell the development environment apart from the production one.</span></p>
<p>Now we can create the<span> </span><kbd>src</kbd><span> </span>folder: </p>
<pre><strong>mkdir src</strong></pre>
<p>Once this is done, create the <kbd>index.html</kbd> file inside the <kbd>src</kbd><span> </span>folder:</p>
<pre>&lt;!-- src/index.html --&gt;<br/>&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>&lt;head&gt;<br/>  &lt;meta charset="UTF-8"&gt;<br/>  &lt;title&gt;Packt: Vuex condensed&lt;/title&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/>Hello world<br/>&lt;/body&gt;<br/>&lt;/html&gt;</pre>
<p class="mce-root">Now write the <kbd>main.js</kbd><span> </span>file, as follows:</p>
<pre>// src/main.js<br/>console.log('Hello world');</pre>
<p>We can now use webpack to build the project. We can use the <span><kbd>npx</kbd> </span>node command, which executes npm package binaries, saving us from having to write the whole path to the webpack executable:</p>
<pre><strong>npx webpack --config webpack.config.js</strong></pre>
<p>A folder named<span> </span><kbd>dist</kbd><span> </span>will be created, and inside you will find the <kbd>app.bundle.js</kbd><span> </span>and <kbd>index.html</kbd><span> </span>files. If you open the HTML file, you may notice that the following line has been added at the end of the body tag:</p>
<pre>&lt;script type="text/javascript" src="app.bundle.js"&gt;&lt;/script&gt;</pre>
<p>That is the<span> </span><kbd>html</kbd><span> </span>tag that will load the webpack bundle. We will see later how to tell webpack to use Vue single-file components.</p>
<p>Since building each individual bundle and loading them in an HTTP server to see the changes during development is not convenient, we will use<span> </span><kbd>webpack-dev-server</kbd>:</p>
<pre><strong>npx webpack-dev-server --config webpack.config.js</strong></pre>
<p>If you open a browser at <kbd>http://localhost:8080/</kbd>, you will see a white page with a <span class="packt_screen">Hello world</span><span> </span>phrase inside. If you open the browser development tools, you will see the same sentence printed in the browser console.</p>
<p>Let's put some commands to run webpack and<span> </span><kbd>webpack-dev-server</kbd><span> </span>inside the <kbd>package.json</kbd> file so that we can run them by typing<span> </span><kbd>npm run build</kbd> and<span> </span><kbd>npm start</kbd>:</p>
<pre>{<br/>  "name": "notes-app",<br/>  "version": "1.0.0",<br/>  ...<br/>  "scripts": {<br/>    <strong>"start": "webpack-dev-server --mode development"</strong>,<br/>    <strong>"build": "cross-env NODE_ENV=production webpack --mode production"</strong><br/>  },<br/>  ...<br/>  "devDependencies": {<br/>    "clean-webpack-plugin": "^0.1.17",<br/>    "html-webpack-plugin": "^2.30.1",<br/>    "webpack": "^3.10.0",<br/>    "webpack-dev-server": "^2.11.0"<br/>  }<br/>}</pre>
<p>Since webpack 4.0, you have needed to specify whether you are running webpack for a production environment or a development one. The<span> </span><kbd>--mode </kbd><span>parameter</span><span> </span><span>lets you specify which environment you are building for. Finally, </span><kbd>--config webpack.config.js</kbd><span> </span><span>can be omitted.</span></p>
<p>You may have noticed that I added <kbd>cross-env NODE_ENV=production</kbd><span> </span>in the<span> </span><kbd>build</kbd><span> </span>section.<span> </span><span>That's because, when building the application for production, we need the </span><kbd>NODE_ENV</kbd><span> </span><span>environment variable to be set to a production value. This way, we can use something like the following code to determine whether we are building production code:</span></p>
<pre>const debug = process.env.NODE_ENV !== 'production';</pre>
<p>To use<span> </span><kbd>cross-env</kbd>, you need to install it by typing:</p>
<pre><strong>npm install --save-dev cross-env</strong></pre>
<p>Finally, let's install Vue and Vuex and use them to check whether everything is properly configured.</p>
<p>Execute the following command in a console:</p>
<pre><strong>npm install --save vue vuex</strong></pre>
<p>Edit the <kbd>main.js</kbd><span> </span>file as follows:</p>
<pre>import Vue from 'vue';<br/>import Vuex from 'vuex';<br/><br/>Vue.use(Vuex);<br/>const store = new Vuex.Store({});<br/>new Vue({<br/>  el: '#app',<br/>  store,<br/>  template:'&lt;div&gt;Hello Vue(x) World!&lt;/div&gt;'<br/>});</pre>
<p>Update<span> </span><kbd>index.html</kbd><span> </span>as follows:</p>
<pre>&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>&lt;head&gt;<br/>  &lt;meta charset="UTF-8"&gt;<br/>  &lt;title&gt;Packt: Vuex condensed&lt;/title&gt;<br/>&lt;/head&gt;<br/>&lt;body&gt;<br/><strong>&lt;div id="app"&gt;&lt;/div&gt;</strong><br/>&lt;/body&gt;<br/>&lt;/html&gt;</pre>
<p>Now type<span> </span><kbd>npm start</kbd><span> </span>and voila—the browser shows our very first Vuex application: <kbd>Hello Vue(x) World! </kbd></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Using vue-loader for single-file components</h1>
                </header>
            
            <article>
                
<p>Vue.js provides a webpack loader,<span> </span><kbd>vue-loader</kbd>, to transform single-file components into JavaScript modules. To install<span> </span><kbd>vue-loader</kbd> and related tools, type the following commands into a console:</p>
<pre><strong>npm install --save-dev vue-loader</strong><br/><strong>npm install --save-dev vue-template-compiler</strong><br/><strong>npm install --save-dev vue-style-loader</strong><br/><strong>npm install --save-dev css-loader</strong><br/><strong>npm install --save-dev file-loader</strong></pre>
<p>The<span> </span><kbd>file-loader</kbd> is needed to import external files, such as images. The other packages are needed to tell webpack how to build all the pieces inside the <kbd>.vue</kbd><span> </span>file.</p>
<p>Let's update<span> </span><kbd>webpack.config.js</kbd><span> </span>to use single-file components that will have a file extension of<span> </span><kbd>.vue</kbd>:</p>
<pre>// ...<br/>const config = {<br/>  // ...<br/>  module: {<br/>    rules: [<br/>      {<br/>        test: /\.vue$/,<br/>        loader: 'vue-loader'<br/>      },<br/>      {<br/>        test: /\.css$/,<br/>        use: [<br/>          'vue-style-loader',<br/>          'css-loader'<br/>        ]<br/>      },<br/>      {<br/>        test: /\.(png|jpg|jpeg|gif|svg)$/,<br/>        loader: 'file-loader',<br/>        options: {<br/>          name: '[name].[ext]?[hash]'<br/>        }<br/>      }<br/>    ]<br/>  },<br/>  resolve: {<br/>    alias: {<br/>      vue$: 'vue/dist/vue.esm.js',<br/>    },<br/>  },<br/>  // ...<br/>};<br/>// ...</pre>
<p>Within the<span> </span><kbd>rules</kbd> <span>section</span><span> </span><span>inside the configuration, we tell webpack which loader to use when a file is imported inside a source file. In the preceding code, we configured webpack to use</span><span> </span><kbd>vue-loader</kbd><span> </span><span>for every</span><span> </span><kbd>.vue</kbd><span> </span><span>file,</span><span> </span><kbd>css-loader</kbd>,<span> </span><span>and</span><span> </span><kbd>vue-style-loader</kbd><span> </span><span>for </span><kbd>.css</kbd><span> </span><span>files, and</span><span> </span><kbd>file-loader</kbd><span> </span><span>for images.</span></p>
<p>In order to test that everything has been correctly configured, we will create an<span> </span><kbd>app.vue</kbd><span> </span>file:</p>
<pre>// src/app.vue<br/>&lt;template&gt;<br/>  &lt;div class="app"&gt;App &lt;span class="version"&gt;v{{version}}&lt;/span&gt;&lt;/div&gt;<br/>&lt;/template&gt;<br/>&lt;script&gt;<br/>  export default {<br/>    computed: {<br/>      version() {<br/>        return this.$store.state.version;<br/>      }<br/>    }<br/>  };<br/>&lt;/script&gt;<br/>&lt;style&gt;<br/>  .app {<br/>    font-family: "Times New Roman", Times, serif;<br/>    background-image: url("./background.jpg");<br/>  }<br/>&lt;/style&gt;</pre>
<p>You need a<span> </span><kbd>background.jpg </kbd><span>file </span><span>to build the preceding file. It is enough to put any image within the</span><span> </span><kbd>src</kbd><span> </span><span>folder and rename it as </span><span><kbd>background.jpg</kbd></span><span>.</span></p>
<p>This file uses<span> </span><kbd>Vuex.Store</kbd>, the three parts of a Vue single-file component—<kbd>&lt;template&gt;</kbd>,<span> </span><kbd>&lt;script&gt;</kbd>, and<span> </span><kbd>&lt;style&gt;</kbd>—and an image as the background. This way, we are going to test<span> </span><kbd>vue-loader</kbd><span> </span>and its related packages,<span> </span><kbd>Vuex.Store</kbd>, and<span> </span><kbd>file-loader</kbd><span> </span>for the background image.</p>
<p>Let's now update<span> </span><kbd>main.js</kbd><span> </span>to use<span> </span><kbd>app.vue</kbd>:</p>
<pre>// src/main.js<br/>import Vue from 'vue';<br/>import Vuex from 'vuex';<br/>import app from './app.vue';<br/><br/>Vue.use(Vuex);<br/><br/>const store = new Vuex.Store({<br/>  state: {<br/>    version: '1.0.0'<br/>  }<br/>});<br/><br/>new Vue({<br/>  el: '#app',<br/>  store,<br/>  template:'&lt;app&gt;&lt;/app&gt;',<br/>  components: {app}<br/>});</pre>
<p>Restart<span> </span><kbd>webpack-dev-server</kbd><span> </span>(<kbd>npm start</kbd>) and open the URL<span> </span><kbd>http://localhost:8080/</kbd>, and you will see something like the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img src="assets/5ca88b5c-b3dc-4acf-82a2-010d7401a8da.png" style=""/></div>
<div class="packt_figref CDPAlignCenter CDPAlign">Figure 3.1: Using app.vue</div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Configuring the test environment</h1>
                </header>
            
            <article>
                
<p>If you are configuring webpack for single-file components, you will probably find it a bit tricky; configuring a test environment is definitely difficult the first time.</p>
<p>We will use Karma as the test runner, Jasmine as the test/assertions<span> </span>framework, and Chrome as the browser that will run all the tests.</p>
<p>First, let's install all we need:</p>
<pre><strong>npm install --save-dev karma karma-webpack</strong><br/><strong>npm install --save-dev karma-chrome-launcher</strong><br/><strong>npm install --save-dev jasmine-core karma-jasmine</strong></pre>
<p>Then we need to create a<span> </span><kbd>karma.conf.js</kbd> file, as follows:</p>
<pre>// Using webpack configuration<br/>var webpackConfig = require('./webpack.config.js');<br/>delete webpackConfig.entry; // No entry for tests<br/><br/>module.exports = function(config) {<br/>  config.set({<br/>    basePath: '',<br/>    <strong>frameworks: ['jasmine']</strong>,<br/>    files: [<br/>      'test/**/*.spec.js'<br/>    ],<br/>    exclude: [<br/>    ],<br/>    preprocessors: {<br/>      <strong>'test/**/*.spec.js': ['webpack']</strong><br/>    },<br/>    reporters: ['progress'],<br/>    port: 9876,<br/>    colors: true,<br/>    logLevel: config.LOG_INFO,<br/>    autoWatch: true,<br/>    <strong>browsers: ['Chrome']</strong>,<br/>    singleRun: false,<br/>    concurrency: Infinity,<br/>    <strong>webpack: webpackConfig</strong>,<br/><br/>    // avoid walls of useless text<br/>    webpackMiddleware: {<br/>      noInfo: true<br/>    }<br/>  })<br/>};</pre>
<p>The preceding configuration will run all files that end with<span> </span><kbd>.spec.js</kbd><span> </span>inside the <kbd>test</kbd><span> </span>folder. In addition, we told Karma to preprocess files using webpack.</p>
<p>Let's create a test folder inside<span> </span><kbd>notes-app</kbd>:</p>
<pre><strong>mkdir test</strong></pre>
<p>Finally, we will create a simple test that will load a<span> </span><kbd>.vue</kbd><span> </span>file and test it.</p>
<p>Create a folder inside<span> </span><kbd>test</kbd><span> </span>named<span> </span><kbd>test-setup</kbd> and put it inside a<span> </span><kbd>dummy.vue</kbd><span> </span>file:</p>
<pre><span>// test/test-setup/dummy.vue<br/>&lt;template&gt;<br/></span><span>  &lt;div </span><span>class=</span><span>"app"</span><span>&gt;</span>{{<span>msg</span>}}<span>&lt;/div&gt;<br/></span><span>&lt;/template&gt;<br/></span><span>&lt;script&gt;<br/></span><span>  </span><span>export default </span>{<br/>    <span>data</span>() {<br/>      <span>return </span>{<span>msg</span>: <span>'A message'</span>}<span>;<br/></span><span>    </span>}<br/>  }<span>;<br/></span><span>&lt;/script&gt;</span></pre>
<p>Create a test file named <kbd>dummy.vue.spec.js</kbd>:</p>
<pre><span>// test/test-setup/dummy.vue.spec.js<br/>import </span>Vue <span>from </span><span>'vue'</span><span>;<br/></span><span>import </span>Test <span>from </span><span>'./dummy.vue'</span><span>;<br/></span><span><br/></span><span>describe</span>(<span>'dummy.vue'</span><span>, </span><span>function </span>() {<br/>  <span>it</span>(<span>'should have correct message'</span><span>, </span><span>function </span>() {<br/>    <span>expect</span>(Test.<span>data</span>().<span>msg</span>).<span>toBe</span>(<span>'A message'</span>)<span>;<br/></span><span>  </span>})<span>;<br/></span><span><br/></span><span>  </span><span>it</span>(<span>'should render correct message'</span><span>, </span><span>function </span>() {<br/>    <span>const </span>vm = <span>new </span>Vue({<br/>      <span>template</span>: <span>'&lt;div&gt;&lt;test&gt;&lt;/test&gt;&lt;/div&gt;'</span><span>,<br/></span><span>      </span><span>components</span>: {<br/>        <span>'test'</span>: Test<br/>      }<br/>    }).<span>$mount</span>()<span>;<br/></span><span>    </span><span>expect</span>(vm.$el.<span>querySelector</span>(<span>'.app'</span>).textContent)<br/>        .<span>toBe</span>(<span>'A message'</span>)<span>;<br/></span><span>  </span>})<br/>})<span>;</span></pre>
<p>Update<span> </span><kbd>package.json</kbd><span> </span>as follows:</p>
<pre>"scripts": {<br/>    <strong>"test": "karma start"</strong>,<br/>    "start": "webpack-dev-server --config webpack.config.js",<br/>    "build": "webpack --config webpack.config.js"<br/>},</pre>
<p>Next, execute<span> </span><kbd>npm test</kbd><span> </span>to run the test we just created. You should see something like the following in the console:</p>
<pre><strong>Chrome ... : Executed 2 of 2 SUCCESS (0.006 secs / 0 secs)<br/></strong></pre>
<p>We are now ready to begin the development of the EveryNote web application, which is the topic of the next chapter.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>In this chapter we went through all the steps necessary to set up a test and development environment, ready to start coding with Vuex and Vue single file components. In addition we added some files to test that everything was properly configured.</p>


            </article>

            
        </section>
    </body></html>
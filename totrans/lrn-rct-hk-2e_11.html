<html><head></head><body>
<div id="_idContainer161">
<h1 class="chapterNumber"><a id="_idTextAnchor200"/><span class="koboSpan" id="kobo.1.1">9</span></h1>
<h1 class="chapterTitle" id="_idParaDest-192"><a id="_idTextAnchor201"/><span class="koboSpan" id="kobo.2.1">Advanced Hooks Provided by React</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.3.1">In the previous chapter, we learned about implementing routes using React Router. </span><span class="koboSpan" id="kobo.3.2">Then, we learned about </span><a id="_idIndexMarker396"/><span class="koboSpan" id="kobo.4.1">using the Params Hook for dynamic routes. </span><span class="koboSpan" id="kobo.4.2">Next, we learned about </span><a id="_idIndexMarker397"/><span class="koboSpan" id="kobo.5.1">using the Link component to provide links to different routes. </span><span class="koboSpan" id="kobo.5.2">Finally, we learned how to programmatically redirect using the Navigation Hook.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.6.1">In this chapter, we are going to learn about the various built-in Hooks provided by React. </span><span class="koboSpan" id="kobo.6.2">We will start by giving an overview of the built-in React Hooks, and then learn about various utility Hooks. </span><span class="koboSpan" id="kobo.6.3">Next, we will learn how to use Hooks to optimize the performance of your app. </span><span class="koboSpan" id="kobo.6.4">Finally, we will learn about advanced Effect Hooks.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.7.1">By the end of this chapter, you will have a full overview of all the built-in Hooks that React provides.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.8.1">The following topics will be covered in this chapter:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.9.1">Overview of built-in React Hooks</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.10.1">Using utility Hooks</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.11.1">Using Hooks for performance optimizations</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.12.1">Using Hooks for advanced effects</span></li>
</ul>
<h1 class="heading-1" id="_idParaDest-193"><a id="_idTextAnchor202"/><span class="koboSpan" id="kobo.13.1">Technical requirements</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.14.1">A fairly recent version of Node.js should already be installed. </span><span class="koboSpan" id="kobo.14.2">The Node Package Manager (</span><code class="inlineCode"><span class="koboSpan" id="kobo.15.1">npm</span></code><span class="koboSpan" id="kobo.16.1">) also needs to be installed (it should come with Node.js). </span><span class="koboSpan" id="kobo.16.2">For more information on how to install Node.js, please check the official website: </span><a href="https://nodejs.org/"><span class="url"><span class="koboSpan" id="kobo.17.1">https://nodejs.org/</span></span></a><span class="koboSpan" id="kobo.18.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.19.1">We are going to use </span><strong class="keyWord"><span class="koboSpan" id="kobo.20.1">Visual Studio Code</span></strong><span class="koboSpan" id="kobo.21.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.22.1">VS Code</span></strong><span class="koboSpan" id="kobo.23.1">) for the guides in this book, but everything should work </span><a id="_idIndexMarker398"/><span class="koboSpan" id="kobo.24.1">similarly in any other editor. </span><span class="koboSpan" id="kobo.24.2">For more information on how to install VS Code, please refer to the official website: </span><a href="https://code.visualstudio.com"><span class="url"><span class="koboSpan" id="kobo.25.1">https://code.visualstudio.com</span></span></a><span class="koboSpan" id="kobo.26.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.27.1">In this </span><a id="_idIndexMarker399"/><span class="koboSpan" id="kobo.28.1">book, we use the following versions:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.29.1">Node.js v22.14.0</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.30.1">npm</span></code><span class="koboSpan" id="kobo.31.1"> v10.9.2</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.32.1">VS Code v1.97.2</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.33.1">While installing a newer version should not be an issue, please note that certain steps might work differently on a newer version. </span><span class="koboSpan" id="kobo.33.2">If you are having an issue with the code and steps provided in this book, please try using the mentioned versions.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.34.1">You can find the code for this chapter on GitHub: </span><a href="https://github.com/PacktPublishing/Learn-React-Hooks-Second-Edition/tree/main/Chapter09"><span class="url"><span class="koboSpan" id="kobo.35.1">https://github.com/PacktPublishing/Learn-React-Hooks-Second-Edition/tree/main/Chapter09</span></span></a><span class="koboSpan" id="kobo.36.1">.</span></p>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.37.1">It is highly recommended that you write the code on your own. </span><span class="koboSpan" id="kobo.37.2">Do not simply run the code examples that are provided with the book. </span><span class="koboSpan" id="kobo.37.3">It is important to write the code yourself to be able to learn and understand it properly. </span><span class="koboSpan" id="kobo.37.4">However, if you run into any issues, you can always refer to the code example.</span></p>
</div>
<h1 class="heading-1" id="_idParaDest-194"><a id="_idTextAnchor203"/><span class="koboSpan" id="kobo.38.1">Overview of built-in React Hooks</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.39.1">React provides </span><a id="_idIndexMarker400"/><span class="koboSpan" id="kobo.40.1">certain built-in Hooks. </span><span class="koboSpan" id="kobo.40.2">We have already learned about the basic Hooks that React provides:</span></p>
<ul>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.41.1">useState</span></code><span class="koboSpan" id="kobo.42.1"> in </span><a href="Chapter_02.xhtml#_idTextAnchor048"><em class="italic"><span class="koboSpan" id="kobo.43.1">Chapter 2</span></em></a><em class="italic"><span class="koboSpan" id="kobo.44.1">, Using the State Hook</span></em></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.45.1">useEffect</span></code><span class="koboSpan" id="kobo.46.1"> in </span><a href="Chapter_04.xhtml#_idTextAnchor103"><em class="italic"><span class="koboSpan" id="kobo.47.1">Chapter 4</span></em></a><em class="italic"><span class="koboSpan" id="kobo.48.1">, Using the Reducer and Effect Hooks</span></em></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.49.1">useContext</span></code><span class="koboSpan" id="kobo.50.1"> in </span><a href="Chapter_05.xhtml#_idTextAnchor127"><em class="italic"><span class="koboSpan" id="kobo.51.1">Chapter 5</span></em></a><em class="italic"><span class="koboSpan" id="kobo.52.1">, Implementing React Contexts</span></em></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.53.1">Additionally, React provides more advanced Hooks, which can be very useful in certain use cases. </span><span class="koboSpan" id="kobo.53.2">We already covered the following advanced Hooks:</span></p>
<ul>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.54.1">useReducer</span></code><span class="koboSpan" id="kobo.55.1"> in </span><a href="Chapter_04.xhtml#_idTextAnchor103"><em class="italic"><span class="koboSpan" id="kobo.56.1">Chapter 4</span></em></a><em class="italic"><span class="koboSpan" id="kobo.57.1">, Using the Reducer and Effect Hooks</span></em></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.58.1">useActionState</span></code><span class="koboSpan" id="kobo.59.1"> in </span><a href="Chapter_07.xhtml#_idTextAnchor169"><em class="italic"><span class="koboSpan" id="kobo.60.1">Chapter 7</span></em></a><em class="italic"><span class="koboSpan" id="kobo.61.1">, Using Hooks for Handling Forms</span></em></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.62.1">useFormStatus</span></code><span class="koboSpan" id="kobo.63.1"> (not covered yet, but similar to </span><code class="inlineCode"><span class="koboSpan" id="kobo.64.1">useActionState</span></code><span class="koboSpan" id="kobo.65.1">)</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.66.1">useOptimistic</span></code><span class="koboSpan" id="kobo.67.1"> in </span><a href="Chapter_07.xhtml#_idTextAnchor169"><em class="italic"><span class="koboSpan" id="kobo.68.1">Chapter 7</span></em></a><em class="italic"><span class="koboSpan" id="kobo.69.1">, Using Hooks for Handling Forms</span></em></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.70.1">useTransition</span></code><span class="koboSpan" id="kobo.71.1"> in </span><a href="Chapter_07.xhtml#_idTextAnchor169"><em class="italic"><span class="koboSpan" id="kobo.72.1">Chapter 7</span></em></a><em class="italic"><span class="koboSpan" id="kobo.73.1">, Using Hooks for Handling Forms</span></em></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.74.1">However, there are still more advanced Hooks that React provides:</span></p>
<ul>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.75.1">useRef</span></code></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.76.1">useImperativeHandle</span></code></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.77.1">useId</span></code></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.78.1">useSyncExternalStore</span></code></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.79.1">useDebugValue</span></code></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.80.1">useDeferredValue</span></code></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.81.1">useMemo</span></code></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.82.1">useCallback</span></code></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.83.1">useLayoutEffect</span></code></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.84.1">useInsertionEffect</span></code></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.85.1">First, let’s recap </span><a id="_idIndexMarker401"/><span class="koboSpan" id="kobo.86.1">and summarize the Hooks we have already learned about. </span><span class="koboSpan" id="kobo.86.2">Then, we are going to briefly cover all these advanced Hooks that React provides and learn why and how to use them.</span></p>
<h2 class="heading-2" id="_idParaDest-195"><a id="_idTextAnchor204"/><span class="koboSpan" id="kobo.87.1">useState</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.88.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.89.1">State Hook</span></strong><span class="koboSpan" id="kobo.90.1"> returns a </span><a id="_idIndexMarker402"/><span class="koboSpan" id="kobo.91.1">value that will persist across re-renders </span><a id="_idIndexMarker403"/><span class="koboSpan" id="kobo.92.1">and a function to update it. </span><span class="koboSpan" id="kobo.92.2">A value for </span><code class="inlineCode"><span class="koboSpan" id="kobo.93.1">initialState</span></code><span class="koboSpan" id="kobo.94.1"> can be passed to it as an argument:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.95.1">const</span></span><span class="koboSpan" id="kobo.96.1"> [state, setState] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.97.1">useState</span></span><span class="koboSpan" id="kobo.98.1">(initialState)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.99.1">Calling </span><code class="inlineCode"><span class="koboSpan" id="kobo.100.1">setState</span></code><span class="koboSpan" id="kobo.101.1"> updates the </span><a id="_idIndexMarker404"/><span class="koboSpan" id="kobo.102.1">value and re-renders the component with the updated value. </span><span class="koboSpan" id="kobo.102.2">If the value does not change, React will not re-render the component.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.103.1">A function can also be passed to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.104.1">setState</span></code><span class="koboSpan" id="kobo.105.1"> function, with the first argument being the current value. </span><span class="koboSpan" id="kobo.105.2">For example, consider the following code:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.106.1">setState</span></span><span class="koboSpan" id="kobo.107.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.108.1">val</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.109.1"> =&gt;</span></span><span class="koboSpan" id="kobo.110.1"> val + </span><span class="hljs-number"><span class="koboSpan" id="kobo.111.1">1</span></span><span class="koboSpan" id="kobo.112.1">)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.113.1">Additionally, a function can be passed to the first argument of the Hook if the initial state is the result of a complex computation. </span><span class="koboSpan" id="kobo.113.2">In that case, the function will only be called once during initialization of the Hook:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.114.1">const</span></span><span class="koboSpan" id="kobo.115.1"> [state, setState] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.116.1">useState</span></span><span class="koboSpan" id="kobo.117.1">(</span><span class="hljs-function"><span class="koboSpan" id="kobo.118.1">() =&gt;</span></span><span class="koboSpan" id="kobo.119.1"> {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.120.1">return</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.121.1">computeInitialState</span></span><span class="koboSpan" id="kobo.122.1">()
})
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.123.1">The State Hook is the most ubiquitous Hook provided by React.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.124.1">We used this Hook in </span><a href="Chapter_02.xhtml#_idTextAnchor048"><em class="italic"><span class="koboSpan" id="kobo.125.1">Chapter 2</span></em></a><em class="italic"><span class="koboSpan" id="kobo.126.1">, Using the State Hook</span></em><span class="koboSpan" id="kobo.127.1">.</span></p>
<h2 class="heading-2" id="_idParaDest-196"><a id="_idTextAnchor205"/><span class="koboSpan" id="kobo.128.1">useEffect</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.129.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.130.1">Effect Hook</span></strong><span class="koboSpan" id="kobo.131.1"> accepts a </span><a id="_idIndexMarker405"/><span class="koboSpan" id="kobo.132.1">function that contains code with side </span><a id="_idIndexMarker406"/><span class="koboSpan" id="kobo.133.1">effects, such as timers and subscriptions. </span><span class="koboSpan" id="kobo.133.2">The function passed to the Hook will </span><a id="_idIndexMarker407"/><span class="koboSpan" id="kobo.134.1">run after the render is done and the component is on the screen:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.135.1">useEffect</span></span><span class="koboSpan" id="kobo.136.1">(</span><span class="hljs-function"><span class="koboSpan" id="kobo.137.1">() =&gt;</span></span><span class="koboSpan" id="kobo.138.1"> {
  </span><span class="hljs-comment"><span class="koboSpan" id="kobo.139.1">// do something</span></span><span class="koboSpan" id="kobo.140.1">
})
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.141.1">A cleanup function can be returned from the Hook, which will be called when the component unmounts and is used, for example, to clean up timers or subscriptions:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.142.1">useEffect</span></span><span class="koboSpan" id="kobo.143.1">(</span><span class="hljs-function"><span class="koboSpan" id="kobo.144.1">() =&gt;</span></span><span class="koboSpan" id="kobo.145.1"> {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.146.1">const</span></span><span class="koboSpan" id="kobo.147.1"> interval = </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.148.1">setInterval</span></span><span class="koboSpan" id="kobo.149.1">(</span><span class="hljs-function"><span class="koboSpan" id="kobo.150.1">() =&gt;</span></span><span class="koboSpan" id="kobo.151.1"> {}, </span><span class="hljs-number"><span class="koboSpan" id="kobo.152.1">100</span></span><span class="koboSpan" id="kobo.153.1">)
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.154.1">return</span></span> <span class="hljs-function"><span class="koboSpan" id="kobo.155.1">() =&gt;</span></span><span class="koboSpan" id="kobo.156.1"> {
    </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.157.1">clearInterval</span></span><span class="koboSpan" id="kobo.158.1">(interval)
  }
})
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.159.1">The cleanup function will also be called if the component renders multiple times before the effect is activated again.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.160.1">To avoid triggering the effect on every re-render, we can specify an array of values as the second argument to the Hook. </span><span class="koboSpan" id="kobo.160.2">When any of these values change, the effect will get triggered again:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.161.1">useEffect</span></span><span class="koboSpan" id="kobo.162.1">(</span><span class="hljs-function"><span class="koboSpan" id="kobo.163.1">() =&gt;</span></span><span class="koboSpan" id="kobo.164.1"> {
  </span><span class="hljs-comment"><span class="koboSpan" id="kobo.165.1">// do something when state changes</span></span><span class="koboSpan" id="kobo.166.1">
}, [state])
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.167.1">This array passed as the second argument is called the dependency array of the effect. </span><span class="koboSpan" id="kobo.167.2">If you want the effect to only trigger during mounting and the cleanup during unmounting, you can pass an empty array as the second argument.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.168.1">We used this Hook in </span><a href="Chapter_04.xhtml#_idTextAnchor103"><em class="italic"><span class="koboSpan" id="kobo.169.1">Chapter 4</span></em></a><em class="italic"><span class="koboSpan" id="kobo.170.1">, Using the Reducer and Effect Hooks</span></em><span class="koboSpan" id="kobo.171.1">.</span></p>
<h2 class="heading-2" id="_idParaDest-197"><a id="_idTextAnchor206"/><span class="koboSpan" id="kobo.172.1">useContext</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.173.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.174.1">Context Hook</span></strong><span class="koboSpan" id="kobo.175.1"> accepts a </span><a id="_idIndexMarker408"/><span class="koboSpan" id="kobo.176.1">context object and returns the current value for the context. </span><span class="koboSpan" id="kobo.176.2">When </span><a id="_idIndexMarker409"/><span class="koboSpan" id="kobo.177.1">the context provider updates its value, the Hook will trigger a re-render with the latest value:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.178.1">const</span></span><span class="koboSpan" id="kobo.179.1"> value = </span><span class="hljs-title"><span class="koboSpan" id="kobo.180.1">useContext</span></span><span class="koboSpan" id="kobo.181.1">(</span><span class="hljs-title"><span class="koboSpan" id="kobo.182.1">NameOfTheContext</span></span><span class="koboSpan" id="kobo.183.1">)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.184.1">We used this Hook in </span><a href="Chapter_05.xhtml#_idTextAnchor127"><em class="italic"><span class="koboSpan" id="kobo.185.1">Chapter 5</span></em></a><em class="italic"><span class="koboSpan" id="kobo.186.1">, Implementing React Contexts</span></em><span class="koboSpan" id="kobo.187.1">.</span></p>
<h2 class="heading-2" id="_idParaDest-198"><a id="_idTextAnchor207"/><span class="koboSpan" id="kobo.188.1">useReducer</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.189.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.190.1">Reducer Hook</span></strong><span class="koboSpan" id="kobo.191.1"> is an </span><a id="_idIndexMarker410"/><span class="koboSpan" id="kobo.192.1">advanced version of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.193.1">useState</span></code><span class="koboSpan" id="kobo.194.1"> Hook. </span><span class="koboSpan" id="kobo.194.2">It accepts a </span><code class="inlineCode"><span class="koboSpan" id="kobo.195.1">reducer</span></code><span class="koboSpan" id="kobo.196.1"> as the </span><a id="_idIndexMarker411"/><span class="koboSpan" id="kobo.197.1">first argument, which is a function with two arguments: </span><code class="inlineCode"><span class="koboSpan" id="kobo.198.1">state</span></code><span class="koboSpan" id="kobo.199.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.200.1">action</span></code><span class="koboSpan" id="kobo.201.1">. </span><span class="koboSpan" id="kobo.201.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.202.1">reducer</span></code><span class="koboSpan" id="kobo.203.1"> function then returns the updated state computed from the current state </span><a id="_idIndexMarker412"/><span class="koboSpan" id="kobo.204.1">and the action. </span><span class="koboSpan" id="kobo.204.2">If the </span><code class="inlineCode"><span class="koboSpan" id="kobo.205.1">reducer</span></code><span class="koboSpan" id="kobo.206.1"> returns the same value as the previous state, React will not re-render components or trigger effects:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.207.1">const</span></span><span class="koboSpan" id="kobo.208.1"> [state, dispatch] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.209.1">useReducer</span></span><span class="koboSpan" id="kobo.210.1">(reducer, initialState, initFn)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.211.1">We should use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.212.1">useReducer</span></code><span class="koboSpan" id="kobo.213.1"> Hook instead of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.214.1">useState</span></code><span class="koboSpan" id="kobo.215.1"> Hook when dealing with complex state changes. </span><span class="koboSpan" id="kobo.215.2">It is also easier to deal with a global state because we can simply pass down the </span><code class="inlineCode"><span class="koboSpan" id="kobo.216.1">dispatch</span></code><span class="koboSpan" id="kobo.217.1"> function instead of multiple setter functions.</span></p>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.218.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.219.1">dispatch</span></code><span class="koboSpan" id="kobo.220.1"> function is stable and will not change on re-renders, so it is safe to omit it from </span><code class="inlineCode"><span class="koboSpan" id="kobo.221.1">useEffect</span></code><span class="koboSpan" id="kobo.222.1"> or the </span><code class="inlineCode"><span class="koboSpan" id="kobo.223.1">useCallback</span></code><span class="koboSpan" id="kobo.224.1"> dependency arrays.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.225.1">We can specify the initial state by setting the </span><code class="inlineCode"><span class="koboSpan" id="kobo.226.1">initialState</span></code><span class="koboSpan" id="kobo.227.1"> value or specifying an </span><code class="inlineCode"><span class="koboSpan" id="kobo.228.1">initFn</span></code><span class="koboSpan" id="kobo.229.1"> function as the third argument. </span><span class="koboSpan" id="kobo.229.2">Specifying such a function makes sense when computing the initial state takes a long time or when we want to reuse the function to reset the state through an action.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.230.1">We used this Hook in </span><a href="Chapter_04.xhtml#_idTextAnchor103"><em class="italic"><span class="koboSpan" id="kobo.231.1">Chapter 4</span></em></a><em class="italic"><span class="koboSpan" id="kobo.232.1">, Using the Reducer and Effect Hooks</span></em><span class="koboSpan" id="kobo.233.1">.</span></p>
<h2 class="heading-2" id="_idParaDest-199"><a id="_idTextAnchor208"/><span class="koboSpan" id="kobo.234.1">useActionState</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.235.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.236.1">Action State Hook</span></strong><span class="koboSpan" id="kobo.237.1"> is defined </span><a id="_idIndexMarker413"/><span class="koboSpan" id="kobo.238.1">as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.239.1">const</span></span><span class="koboSpan" id="kobo.240.1"> [state, action, isPending] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.241.1">useActionState</span></span><span class="koboSpan" id="kobo.242.1">(actionFn, initialState)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.243.1">To define </span><a id="_idIndexMarker414"/><span class="koboSpan" id="kobo.244.1">an Action State Hook, we need to provide an </span><code class="inlineCode"><span class="koboSpan" id="kobo.245.1">action</span></code><span class="koboSpan" id="kobo.246.1"> function as the first argument, which has the following signature:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.247.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.248.1">actionFn</span></span><span class="koboSpan" id="kobo.249.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.250.1">currentState, formData</span></span><span class="koboSpan" id="kobo.251.1">) {
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.252.1">We then </span><a id="_idIndexMarker415"/><span class="koboSpan" id="kobo.253.1">need to pass the </span><code class="inlineCode"><span class="koboSpan" id="kobo.254.1">action</span></code><span class="koboSpan" id="kobo.255.1"> prop to a </span><code class="inlineCode"><span class="koboSpan" id="kobo.256.1">&lt;form&gt;</span></code><span class="koboSpan" id="kobo.257.1"> element. </span><span class="koboSpan" id="kobo.257.2">When this form gets submitted, the action function is called with the current state of the Hook and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.258.1">FormData</span></code><span class="koboSpan" id="kobo.259.1"> submitted inside the form.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.260.1">Additionally, it is possible to provide an </span><code class="inlineCode"><span class="koboSpan" id="kobo.261.1">initialState</span></code><span class="koboSpan" id="kobo.262.1"> for the Hook and use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.263.1">isPending</span></code><span class="koboSpan" id="kobo.264.1"> value to show a loading state while the action is being processed.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.265.1">We used this Hook in </span><a href="Chapter_07.xhtml#_idTextAnchor169"><em class="italic"><span class="koboSpan" id="kobo.266.1">Chapter 7</span></em></a><em class="italic"><span class="koboSpan" id="kobo.267.1">, Using Hooks for Handling Forms</span></em><span class="koboSpan" id="kobo.268.1">.</span></p>
<h2 class="heading-2" id="_idParaDest-200"><a id="_idTextAnchor209"/><span class="koboSpan" id="kobo.269.1">useFormStatus</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.270.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.271.1">Form Status Hook</span></strong><span class="koboSpan" id="kobo.272.1"> is defined as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.273.1">const</span></span><span class="koboSpan" id="kobo.274.1"> { pending, data, method, action } = </span><span class="hljs-title"><span class="koboSpan" id="kobo.275.1">useFormStatus</span></span><span class="koboSpan" id="kobo.276.1">()
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.277.1">It is used in </span><a id="_idIndexMarker416"/><span class="koboSpan" id="kobo.278.1">cases where the form </span><a id="_idIndexMarker417"/><span class="koboSpan" id="kobo.279.1">submission is not handled by us. </span><span class="koboSpan" id="kobo.279.2">For example, if we have a backend that handles the form submission for us, or if we are using a server action for the form state (relevant when carrying out full-stack React development).</span></p>
<p class="normal"><span class="koboSpan" id="kobo.280.1">It returns a </span><code class="inlineCode"><span class="koboSpan" id="kobo.281.1">status</span></code><span class="koboSpan" id="kobo.282.1"> object with the following properties:</span></p>
<ul>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.283.1">pending</span></code><span class="koboSpan" id="kobo.284.1">: Is set to </span><code class="inlineCode"><span class="koboSpan" id="kobo.285.1">true</span></code><span class="koboSpan" id="kobo.286.1"> if the parent </span><code class="inlineCode"><span class="koboSpan" id="kobo.287.1">&lt;form&gt;</span></code><span class="koboSpan" id="kobo.288.1"> is currently being submitted</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.289.1">data</span></code><span class="koboSpan" id="kobo.290.1">: Contains the </span><code class="inlineCode"><span class="koboSpan" id="kobo.291.1">FormData</span></code><span class="koboSpan" id="kobo.292.1"> that is being submitted by the parent form</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.293.1">method</span></code><span class="koboSpan" id="kobo.294.1">: Set to either </span><code class="inlineCode"><span class="koboSpan" id="kobo.295.1">'get'</span></code><span class="koboSpan" id="kobo.296.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.297.1">'post'</span></code><span class="koboSpan" id="kobo.298.1">, depending on which method was defined in the parent </span><code class="inlineCode"><span class="koboSpan" id="kobo.299.1">&lt;form&gt;</span></code><span class="koboSpan" id="kobo.300.1">.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.301.1">action</span></code><span class="koboSpan" id="kobo.302.1">: If an action function was passed to the parent </span><code class="inlineCode"><span class="koboSpan" id="kobo.303.1">&lt;form&gt;</span></code><span class="koboSpan" id="kobo.304.1">, this will contain a reference to it. </span><span class="koboSpan" id="kobo.304.2">Otherwise, it will be </span><code class="inlineCode"><span class="koboSpan" id="kobo.305.1">null</span></code><span class="koboSpan" id="kobo.306.1">.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.307.1">For example, it can be used to </span><a id="_idIndexMarker418"/><span class="koboSpan" id="kobo.308.1">implement a submit button that is disabled while the form is submitting to the server-side:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.309.1">import</span></span><span class="koboSpan" id="kobo.310.1"> { useFormStatus } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.311.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.312.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.313.1">react-dom'</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.314.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.315.1">SubmitButton</span></span><span class="koboSpan" id="kobo.316.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.317.1">const</span></span><span class="koboSpan" id="kobo.318.1"> { pending } = </span><span class="hljs-title"><span class="koboSpan" id="kobo.319.1">useFormStatus</span></span><span class="koboSpan" id="kobo.320.1">()
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.321.1">return</span></span> <span class="hljs-tag"><span class="koboSpan" id="kobo.322.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.323.1">button</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.324.1">disabled</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.325.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.326.1">{pending}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.327.1">&gt;</span></span><span class="koboSpan" id="kobo.328.1">Submit</span><span class="hljs-tag"><span class="koboSpan" id="kobo.329.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.330.1">button</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.331.1">&gt;</span></span><span class="koboSpan" id="kobo.332.1">
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.333.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.334.1">ExampleForm</span></span><span class="koboSpan" id="kobo.335.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.336.1">return</span></span><span class="koboSpan" id="kobo.337.1"> (
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.338.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.339.1">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.340.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.341.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.342.1">SubmitButton</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.343.1"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.344.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.345.1">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.346.1">&gt;</span></span><span class="koboSpan" id="kobo.347.1">
  )
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.348.1">The Form Status Hook can only be used in components rendered inside a </span><code class="inlineCode"><span class="koboSpan" id="kobo.349.1">&lt;form&gt;</span></code><span class="koboSpan" id="kobo.350.1">. </span><span class="koboSpan" id="kobo.350.2">Unlike other Hooks, at the time of writing, this is the only Hook that is exported from </span><code class="inlineCode"><span class="koboSpan" id="kobo.351.1">react-dom</span></code><span class="koboSpan" id="kobo.352.1">, and not </span><code class="inlineCode"><span class="koboSpan" id="kobo.353.1">react</span></code><span class="koboSpan" id="kobo.354.1">.</span></p>
<h2 class="heading-2" id="_idParaDest-201"><a id="_idTextAnchor210"/><span class="koboSpan" id="kobo.355.1">useOptimistic</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.356.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.357.1">Optimistic Hook</span></strong><span class="koboSpan" id="kobo.358.1"> has the </span><a id="_idIndexMarker419"/><span class="koboSpan" id="kobo.359.1">following signature:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.360.1">const</span></span><span class="koboSpan" id="kobo.361.1"> [optimisticState, addOptimistic] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.362.1">useOptimistic</span></span><span class="koboSpan" id="kobo.363.1">(state, updateFn)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.364.1">It can be </span><a id="_idIndexMarker420"/><span class="koboSpan" id="kobo.365.1">used to optimistically update a state while we are waiting </span><a id="_idIndexMarker421"/><span class="koboSpan" id="kobo.366.1">for the remote state from the server to finish updating. </span><span class="koboSpan" id="kobo.366.2">It accepts a state (usually from </span><a id="_idIndexMarker422"/><span class="koboSpan" id="kobo.367.1">an API request, such as a </span><strong class="keyWord"><span class="koboSpan" id="kobo.368.1">Query Hook</span></strong><span class="koboSpan" id="kobo.369.1">) and an </span><code class="inlineCode"><span class="koboSpan" id="kobo.370.1">update</span></code><span class="koboSpan" id="kobo.371.1"> function. </span><span class="koboSpan" id="kobo.371.2">The Hook then returns an optimistic state and a function to add an optimistic state.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.372.1">For example, the Optimistic Hook can be used to insert a new object into an array while we are waiting for the server to finish adding it. </span><span class="koboSpan" id="kobo.372.2">In that case, the update function would look as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.373.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.374.1">updateFn</span></span><span class="koboSpan" id="kobo.375.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.376.1">state, newObject</span></span><span class="koboSpan" id="kobo.377.1">) {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.378.1">return</span></span><span class="koboSpan" id="kobo.379.1"> state.</span><span class="hljs-title"><span class="koboSpan" id="kobo.380.1">concat</span></span><span class="koboSpan" id="kobo.381.1">(
    { ...newObject, </span><span class="hljs-attr"><span class="koboSpan" id="kobo.382.1">pending</span></span><span class="koboSpan" id="kobo.383.1">: </span><span class="hljs-literal"><span class="koboSpan" id="kobo.384.1">true</span></span><span class="koboSpan" id="kobo.385.1"> }
  )
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.386.1">This update function optimistically inserts a new object but adds a </span><code class="inlineCode"><span class="koboSpan" id="kobo.387.1">pending: true</span></code><span class="koboSpan" id="kobo.388.1"> flag to it, so that we can later render pending objects in a different way (for example, slightly grayed out).</span></p>
<p class="normal"><span class="koboSpan" id="kobo.389.1">We used this Hook in </span><a href="Chapter_07.xhtml#_idTextAnchor169"><em class="italic"><span class="koboSpan" id="kobo.390.1">Chapter 7</span></em></a><em class="italic"><span class="koboSpan" id="kobo.391.1">, Using Hooks for Handling Forms</span></em><span class="koboSpan" id="kobo.392.1">.</span></p>
<h2 class="heading-2" id="_idParaDest-202"><a id="_idTextAnchor211"/><span class="koboSpan" id="kobo.393.1">useTransition</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.394.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.395.1">Transition Hook</span></strong><span class="koboSpan" id="kobo.396.1"> lets you </span><a id="_idIndexMarker423"/><span class="koboSpan" id="kobo.397.1">handle asynchronous operations by updating </span><a id="_idIndexMarker424"/><span class="koboSpan" id="kobo.398.1">the state without blocking the UI. </span><span class="koboSpan" id="kobo.398.2">This is especially useful for rendering computationally </span><a id="_idIndexMarker425"/><span class="koboSpan" id="kobo.399.1">expensive component trees, such as rendering tabs and their (potentially complex) contents, or when making a client-side router. </span><span class="koboSpan" id="kobo.399.2">The Transition Hook has the following signature:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.400.1">const</span></span><span class="koboSpan" id="kobo.401.1"> [isPending, startTransition] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.402.1">useTransition</span></span><span class="koboSpan" id="kobo.403.1">()
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.404.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.405.1">isPending</span></code><span class="koboSpan" id="kobo.406.1"> state can be used to handle the loading state. </span><span class="koboSpan" id="kobo.406.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.407.1">startTransition</span></code><span class="koboSpan" id="kobo.408.1"> function allows us to pass a function to start the transition. </span><span class="koboSpan" id="kobo.408.2">This function needs to be synchronous. </span><span class="koboSpan" id="kobo.408.3">While the updates (for example, setting state) triggered inside the functions are being executed and their effects on components evaluated, </span><code class="inlineCode"><span class="koboSpan" id="kobo.409.1">isPending</span></code><span class="koboSpan" id="kobo.410.1"> will be set to </span><code class="inlineCode"><span class="koboSpan" id="kobo.411.1">true</span></code><span class="koboSpan" id="kobo.412.1">. </span></p>
<p class="normal"><span class="koboSpan" id="kobo.413.1">This does not block the UI, so other components still behave normally while the transition is executing.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.414.1">We used this Hook in </span><a href="Chapter_07.xhtml#_idTextAnchor169"><em class="italic"><span class="koboSpan" id="kobo.415.1">Chapter 7</span></em></a><em class="italic"><span class="koboSpan" id="kobo.416.1">, Using Hooks for Handling Forms</span></em><span class="koboSpan" id="kobo.417.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.418.1">After recapping </span><a id="_idIndexMarker426"/><span class="koboSpan" id="kobo.419.1">the built-in Hooks we have already learned </span><a id="_idIndexMarker427"/><span class="koboSpan" id="kobo.420.1">about, let’s now move on to learning about other advanced built-in Hooks, which we have not used, starting with built-in utility Hooks that React provides.</span></p>
<h1 class="heading-1" id="_idParaDest-203"><a id="_idTextAnchor212"/><span class="koboSpan" id="kobo.421.1">Using utility Hooks</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.422.1">We start by learning </span><a id="_idIndexMarker428"/><span class="koboSpan" id="kobo.423.1">about </span><strong class="keyWord"><span class="koboSpan" id="kobo.424.1">utility Hooks</span></strong><span class="koboSpan" id="kobo.425.1">. </span><span class="koboSpan" id="kobo.425.2">These are Hooks that allow us to model certain use cases or help </span><a id="_idIndexMarker429"/><span class="koboSpan" id="kobo.426.1">us when developing our own Hooks, as in </span><a href="Chapter_12.xhtml#_idTextAnchor282"><em class="italic"><span class="koboSpan" id="kobo.427.1">Chapter 12</span></em></a><em class="italic"><span class="koboSpan" id="kobo.428.1">, Building Your Own Hooks</span></em><span class="koboSpan" id="kobo.429.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.430.1">We are now going to set up a demo page in our blog app to be able to test out the various utility Hooks.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.431.1">Let’s get started setting up the demo page to test out these Hooks:</span></p>
<ol>
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.432.1">Copy the </span><code class="inlineCode"><span class="koboSpan" id="kobo.433.1">Chapter08_2</span></code><span class="koboSpan" id="kobo.434.1"> folder to a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.435.1">Chapter09_1</span></code><span class="koboSpan" id="kobo.436.1"> folder by executing the following command:
        </span><pre class="programlisting con-one"><code class="hljs-con"><span class="koboSpan" id="kobo.437.1">$ cp -R Chapter08_2 Chapter09_1
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.438.1">Open the new </span><code class="inlineCode"><span class="koboSpan" id="kobo.439.1">Chapter09_1</span></code><span class="koboSpan" id="kobo.440.1"> folder in VS Code.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.441.1">Create a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.442.1">src/components/demo/</span></code><span class="koboSpan" id="kobo.443.1"> folder. </span><span class="koboSpan" id="kobo.443.2">This is where we will put our demo components later to try out the various Hooks we will learn about.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.444.1">Create a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.445.1">src/pages/Demo.jsx</span></code><span class="koboSpan" id="kobo.446.1"> file, with the following content:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.447.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.448.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.449.1">Demo</span></span><span class="koboSpan" id="kobo.450.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.451.1">return</span></span> <span class="hljs-tag"><span class="koboSpan" id="kobo.452.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.453.1">h1</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.454.1">&gt;</span></span><span class="koboSpan" id="kobo.455.1">Demo Page</span><span class="hljs-tag"><span class="koboSpan" id="kobo.456.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.457.1">h1</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.458.1">&gt;</span></span><span class="koboSpan" id="kobo.459.1">
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.460.1">Edit </span><code class="inlineCode"><span class="koboSpan" id="kobo.461.1">src/App.jsx</span></code><span class="koboSpan" id="kobo.462.1"> and import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.463.1">Demo</span></code><span class="koboSpan" id="kobo.464.1"> page:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.465.1">import</span></span><span class="koboSpan" id="kobo.466.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.467.1">Demo</span></span><span class="koboSpan" id="kobo.468.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.469.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.470.1">'./pages/Demo.jsx'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.471.1">Then, define a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.472.1">NavBarLink</span></code><span class="koboSpan" id="kobo.473.1"> for it:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="koboSpan" id="kobo.474.1">          &lt;</span><span class="hljs-title"><span class="koboSpan" id="kobo.475.1">BrowserRouter</span></span><span class="koboSpan" id="kobo.476.1">&gt;
            </span><span class="hljs-tag"><span class="koboSpan" id="kobo.477.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.478.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.479.1">style</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.480.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.481.1">{{</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.482.1">padding:</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.483.1">8</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.484.1"> }}&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.485.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.486.1">NavBarLink</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.487.1">to</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.488.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.489.1">'/'</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.490.1">&gt;</span></span><span class="koboSpan" id="kobo.491.1">Home</span><span class="hljs-tag"><span class="koboSpan" id="kobo.492.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.493.1">NavBarLink</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.494.1">&gt;</span></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.495.1">              {' | '}</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.496.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.497.1">NavBarLink</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.498.1">to</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.499.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.500.1">'/demo'</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.501.1">&gt;</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.502.1">Demo</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.503.1">&lt;/</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.504.1">NavBarLink</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.505.1">&gt;</span></strong></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.506.1">Finally, define a route for it:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="koboSpan" id="kobo.507.1">                    &lt;</span><span class="hljs-title"><span class="koboSpan" id="kobo.508.1">Routes</span></span><span class="koboSpan" id="kobo.509.1">&gt;
                      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.510.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.511.1">Route</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.512.1">index</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.513.1">element</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.514.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.515.1">{</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.516.1">&lt;</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.517.1">Home</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.518.1"> /&gt;</span></span><span class="koboSpan" id="kobo.519.1">} /&gt;
                      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.520.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.521.1">Route</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.522.1">path</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.523.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.524.1">'post/:id'</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.525.1">element</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.526.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.527.1">{</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.528.1">&lt;</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.529.1">ViewPost</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.530.1"> /&gt;</span></span><span class="koboSpan" id="kobo.531.1">} /&gt;
</span><span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.532.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.533.1">Route</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.534.1">path</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.535.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.536.1">'demo'</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.537.1">element</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.538.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.539.1">{</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.540.1">&lt;</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.541.1">Demo</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.542.1"> /&gt;</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.543.1">} /&gt;</span></strong></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.544.1">Start the </span><code class="inlineCode"><span class="koboSpan" id="kobo.545.1">dev</span></code><span class="koboSpan" id="kobo.546.1"> server and keep it running throughout the chapter, as follows:
        </span><pre class="programlisting con-one"><code class="hljs-con"><span class="koboSpan" id="kobo.547.1">$ npm run dev
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.548.1">Click the </span><strong class="screenText"><span class="koboSpan" id="kobo.549.1">Demo</span></strong><span class="koboSpan" id="kobo.550.1"> link in the nav bar to open the demo page.</span></li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.551.1">Now that we </span><a id="_idIndexMarker430"/><span class="koboSpan" id="kobo.552.1">have a demo page, we can get started learning about the other built-in advanced Hooks that React provides!</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.553.1"><img alt="Figure 9.1 – The Demo page in our blog app" src="../Images/B31327_09_01.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.554.1">Figure 9.1 – The Demo page in our blog app</span></p>
<h2 class="heading-2" id="_idParaDest-204"><a id="_idTextAnchor213"/><span class="koboSpan" id="kobo.555.1">useRef</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.556.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.557.1">Ref Hook</span></strong><span class="koboSpan" id="kobo.558.1"> returns </span><a id="_idIndexMarker431"/><span class="koboSpan" id="kobo.559.1">a </span><code class="inlineCode"><span class="koboSpan" id="kobo.560.1">ref</span></code><span class="koboSpan" id="kobo.561.1"> object that can be assigned to a component </span><a id="_idIndexMarker432"/><span class="koboSpan" id="kobo.562.1">or element via the </span><code class="inlineCode"><span class="koboSpan" id="kobo.563.1">ref</span></code><span class="koboSpan" id="kobo.564.1"> prop:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.565.1">const</span></span><span class="koboSpan" id="kobo.566.1"> refContainer = </span><span class="hljs-title"><span class="koboSpan" id="kobo.567.1">useRef</span></span><span class="koboSpan" id="kobo.568.1">(initialValue)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.569.1">After assigning </span><a id="_idIndexMarker433"/><span class="koboSpan" id="kobo.570.1">the ref object to an element or component, the ref object can be accessed via </span><code class="inlineCode"><span class="koboSpan" id="kobo.571.1">refContainer.current</span></code><span class="koboSpan" id="kobo.572.1">. </span><span class="koboSpan" id="kobo.572.2">If </span><code class="inlineCode"><span class="koboSpan" id="kobo.573.1">initialValue</span></code><span class="koboSpan" id="kobo.574.1"> is set, </span><code class="inlineCode"><span class="koboSpan" id="kobo.575.1">refContainer.current</span></code><span class="koboSpan" id="kobo.576.1"> will be set to this value before assignment.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.577.1">ref objects can be used for various use cases, but the two main ones are:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.578.1">Getting a </span><a id="_idIndexMarker434"/><span class="koboSpan" id="kobo.579.1">reference to an element to access it on the </span><strong class="keyWord"><span class="koboSpan" id="kobo.580.1">Document Object Model</span></strong><span class="koboSpan" id="kobo.581.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.582.1">DOM</span></strong><span class="koboSpan" id="kobo.583.1">)</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.584.1">Keeping mutable values around that should not be affected by the React lifecycle (e.g., not triggering a re-render when the value is mutated)</span></li>
</ul>
<h3 class="heading-3" id="_idParaDest-205"><a id="_idTextAnchor214"/><span class="koboSpan" id="kobo.585.1">Auto-focusing an input field using a Ref Hook</span></h3>
<p class="normal"><span class="koboSpan" id="kobo.586.1">We can use a Ref Hook to get a reference to an input field element and then access its </span><code class="inlineCode"><span class="koboSpan" id="kobo.587.1">focus()</span></code><span class="koboSpan" id="kobo.588.1"> function </span><a id="_idIndexMarker435"/><span class="koboSpan" id="kobo.589.1">via the DOM to implement an input field </span><a id="_idIndexMarker436"/><span class="koboSpan" id="kobo.590.1">that automatically gets focused when it renders. </span><span class="koboSpan" id="kobo.590.2">While there is also an </span><code class="inlineCode"><span class="koboSpan" id="kobo.591.1">autofocus</span></code><span class="koboSpan" id="kobo.592.1"> attribute that can be provided to elements via HTML, sometimes it’s necessary to do it programmatically – for example, if we want to focus a field after the user has finished doing something else.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.593.1">Let’s now get started implementing an auto-focusing input field using a Ref Hook:</span></p>
<ol>
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.594.1">Create a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.595.1">src/components/demo/useRef/</span></code><span class="koboSpan" id="kobo.596.1"> fold</span><a id="_idTextAnchor215"/><span class="koboSpan" id="kobo.597.1">er.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.598.1">Create a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.599.1">src/components/demo/useRef/AutoFocus.jsx</span></code><span class="koboSpan" id="kobo.600.1"> file. </span><span class="koboSpan" id="kobo.600.2">Inside it, import </span><code class="inlineCode"><span class="koboSpan" id="kobo.601.1">useRef</span></code><span class="koboSpan" id="kobo.602.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.603.1">useEffect</span></code><span class="koboSpan" id="kobo.604.1">:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.605.1">import</span></span><span class="koboSpan" id="kobo.606.1"> { useRef, useEffect } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.607.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.608.1">'react'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.609.1">Then, define the component and a Ref Hook:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.610.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.611.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.612.1">AutoFocus</span></span><span class="koboSpan" id="kobo.613.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.614.1">const</span></span><span class="koboSpan" id="kobo.615.1"> inputRef = </span><span class="hljs-title"><span class="koboSpan" id="kobo.616.1">useRef</span></span><span class="koboSpan" id="kobo.617.1">(</span><span class="hljs-literal"><span class="koboSpan" id="kobo.618.1">null</span></span><span class="koboSpan" id="kobo.619.1">)
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.620.1">Next, define an Effect Hook that is called on render and causes the input field to be focused:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-title"><span class="koboSpan" id="kobo.621.1">useEffect</span></span><span class="koboSpan" id="kobo.622.1">(</span><span class="hljs-function"><span class="koboSpan" id="kobo.623.1">() =&gt;</span></span><span class="koboSpan" id="kobo.624.1"> inputRef.</span><span class="hljs-property"><span class="koboSpan" id="kobo.625.1">current</span></span><span class="koboSpan" id="kobo.626.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.627.1">focus</span></span><span class="koboSpan" id="kobo.628.1">(), [])
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.629.1">Render the input field and pass the Ref to it:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-keyword"><span class="koboSpan" id="kobo.630.1">return</span></span><span class="koboSpan" id="kobo.631.1"> (
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.632.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.633.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.634.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.635.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.636.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.637.1">&gt;</span></span><span class="koboSpan" id="kobo.638.1">AutoFocus</span><span class="hljs-tag"><span class="koboSpan" id="kobo.639.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.640.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.641.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.642.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.643.1">input</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.644.1">ref</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.645.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.646.1">{inputRef}</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.647.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.648.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.649.1">'text'</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.650.1"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.651.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.652.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.653.1">&gt;</span></span><span class="koboSpan" id="kobo.654.1">
  )
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.655.1">Now, edit </span><code class="inlineCode"><span class="koboSpan" id="kobo.656.1">src/pages/Demo.jsx</span></code><span class="koboSpan" id="kobo.657.1"> and import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.658.1">AutoFocus</span></code><span class="koboSpan" id="kobo.659.1"> component:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.660.1">import</span></span><span class="koboSpan" id="kobo.661.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.662.1">AutoFocus</span></span><span class="koboSpan" id="kobo.663.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.664.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.665.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.666.1">@/components/demo/useRef/AutoFocus.jsx'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.667.1">Render </span><a id="_idIndexMarker437"/><span class="koboSpan" id="kobo.668.1">it on the </span><code class="inlineCode"><span class="koboSpan" id="kobo.669.1">Demo</span></code><span class="koboSpan" id="kobo.670.1"> page by adjusting </span><a id="_idIndexMarker438"/><span class="koboSpan" id="kobo.671.1">the component as follows:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.672.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.673.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.674.1">Demo</span></span><span class="koboSpan" id="kobo.675.1">() {
</span><span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.676.1">return</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.677.1"> (</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.678.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.679.1">div</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.680.1">&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.681.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.682.1">h1</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.683.1">&gt;</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.684.1">Demo Page</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.685.1">&lt;/</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.686.1">h1</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.687.1">&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.688.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.689.1">h2</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.690.1">&gt;</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.691.1">useRef</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.692.1">&lt;/</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.693.1">h2</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.694.1">&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.695.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.696.1">AutoFocus</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.697.1"> /&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.698.1">&lt;/</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.699.1">div</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.700.1">&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.701.1">  )</span></strong></span><span class="koboSpan" id="kobo.702.1">
}
</span></code></pre>
</li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.703.1">Refresh the page; you should see the input field getting focused automatically.</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.704.1"><img alt="Figure 9.2 – The input field is automatically being focused" src="../Images/B31327_09_02.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.705.1">Figure 9.2 – The input field is automatically being focused</span></p>
<h3 class="heading-3" id="_idParaDest-206"><a id="_idTextAnchor216"/><span class="koboSpan" id="kobo.706.1">Changing state within a ref</span></h3>
<p class="normal"><span class="koboSpan" id="kobo.707.1">It is important to note that mutating the current value of a ref does not cause a re-render. </span><span class="koboSpan" id="kobo.707.2">If this is </span><a id="_idIndexMarker439"/><span class="koboSpan" id="kobo.708.1">needed, we can use a </span><code class="inlineCode"><span class="koboSpan" id="kobo.709.1">ref</span></code><span class="koboSpan" id="kobo.710.1"> callback function instead. </span><span class="koboSpan" id="kobo.710.2">This function will be called when the element is loaded. </span><span class="koboSpan" id="kobo.710.3">We can use this, for example, to get the initial size of an element in the DOM. </span><span class="koboSpan" id="kobo.710.4">We can then set the state of a State Hook inside this callback function to trigger a re-render.</span></p>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.711.1">If we do not just want to get the initial width of a component but also the current width (even when the </span><a id="_idIndexMarker440"/><span class="koboSpan" id="kobo.712.1">component is resized later), we need to use a </span><strong class="keyWord"><span class="koboSpan" id="kobo.713.1">Layout Effect Hook</span></strong><span class="koboSpan" id="kobo.714.1">. </span><span class="koboSpan" id="kobo.714.2">We are going to cover this use case later in this chapter, in the </span><em class="italic"><span class="koboSpan" id="kobo.715.1">Using Hooks for advanced effects</span></em><span class="koboSpan" id="kobo.716.1"> section.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.717.1">Let’s try out callback functions in refs to get the initial width of a component now:</span></p>
<ol>
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.718.1">Create a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.719.1">src/components/demo/useRef/InitialWidthMeasure.jsx</span></code><span class="koboSpan" id="kobo.720.1"> file. </span><span class="koboSpan" id="kobo.720.2">Inside it, import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.721.1">useState</span></code><span class="koboSpan" id="kobo.722.1"> function:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.723.1">import</span></span><span class="koboSpan" id="kobo.724.1"> { useState } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.725.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.726.1">'react'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.727.1">Then, define the component and a State Hook to store the width of the component:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.728.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.729.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.730.1">InitialWidthMeasure</span></span><span class="koboSpan" id="kobo.731.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.732.1">const</span></span><span class="koboSpan" id="kobo.733.1"> [width, setWidth] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.734.1">useState</span></span><span class="koboSpan" id="kobo.735.1">(</span><span class="hljs-number"><span class="koboSpan" id="kobo.736.1">0</span></span><span class="koboSpan" id="kobo.737.1">)
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.738.1">Now, define a callback function for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.739.1">ref</span></code><span class="koboSpan" id="kobo.740.1">, which accepts the DOM </span><code class="inlineCode"><span class="koboSpan" id="kobo.741.1">node</span></code><span class="koboSpan" id="kobo.742.1"> as an argument:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-keyword"><span class="koboSpan" id="kobo.743.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.744.1">measureRef</span></span><span class="koboSpan" id="kobo.745.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.746.1">node</span></span><span class="koboSpan" id="kobo.747.1">) {
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.748.1">Check whether we successfully got a reference to the DOM node, then use the DOM API to get the current width of the element:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-keyword"><span class="koboSpan" id="kobo.749.1">if</span></span><span class="koboSpan" id="kobo.750.1"> (node !== </span><span class="hljs-literal"><span class="koboSpan" id="kobo.751.1">null</span></span><span class="koboSpan" id="kobo.752.1">) {
      </span><span class="hljs-title"><span class="koboSpan" id="kobo.753.1">setWidth</span></span><span class="koboSpan" id="kobo.754.1">(node.</span><span class="hljs-title"><span class="koboSpan" id="kobo.755.1">getBoundingClientRect</span></span><span class="koboSpan" id="kobo.756.1">().</span><span class="hljs-property"><span class="koboSpan" id="kobo.757.1">width</span></span><span class="koboSpan" id="kobo.758.1">)
    }
  }
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.759.1">Render the component and add the callback function via the </span><code class="inlineCode"><span class="koboSpan" id="kobo.760.1">ref</span></code><span class="koboSpan" id="kobo.761.1"> prop:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-keyword"><span class="koboSpan" id="kobo.762.1">return</span></span><span class="koboSpan" id="kobo.763.1"> (
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.764.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.765.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.766.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.767.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.768.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.769.1">&gt;</span></span><span class="koboSpan" id="kobo.770.1">InitialWidthMeasure</span><span class="hljs-tag"><span class="koboSpan" id="kobo.771.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.772.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.773.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.774.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.775.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.776.1">ref</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.777.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.778.1">{measureRef}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.779.1">&gt;</span></span><span class="koboSpan" id="kobo.780.1">I was initially {Math.round(width)}px wide</span><span class="hljs-tag"><span class="koboSpan" id="kobo.781.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.782.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.783.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.784.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.785.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.786.1">&gt;</span></span><span class="koboSpan" id="kobo.787.1">
  )
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.788.1">Edit </span><code class="inlineCode"><span class="koboSpan" id="kobo.789.1">src/pages/Demo.jsx</span></code><span class="koboSpan" id="kobo.790.1"> and import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.791.1">InitialWidthMeasure</span></code><span class="koboSpan" id="kobo.792.1"> component there:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.793.1">import</span></span><span class="koboSpan" id="kobo.794.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.795.1">InitialWidthMeasure</span></span><span class="koboSpan" id="kobo.796.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.797.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.798.1">'@/components/demo/useRef/InitialWidthMeasure.jsx'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.799.1">Finally, render </span><a id="_idIndexMarker441"/><span class="koboSpan" id="kobo.800.1">the component on the </span><strong class="screenText"><span class="koboSpan" id="kobo.801.1">Demo</span></strong><span class="koboSpan" id="kobo.802.1"> page:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.803.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.804.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.805.1">Demo</span></span><span class="koboSpan" id="kobo.806.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.807.1">return</span></span><span class="koboSpan" id="kobo.808.1"> (
    &lt;div&gt;
      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.809.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.810.1">h1</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.811.1">&gt;</span></span><span class="koboSpan" id="kobo.812.1">Demo Page</span><span class="hljs-tag"><span class="koboSpan" id="kobo.813.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.814.1">h1</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.815.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.816.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.817.1">h2</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.818.1">&gt;</span></span><span class="koboSpan" id="kobo.819.1">useRef</span><span class="hljs-tag"><span class="koboSpan" id="kobo.820.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.821.1">h2</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.822.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.823.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.824.1">AutoFocus</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.825.1"> /&gt;</span></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.826.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.827.1">InitialWidthMeasure</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.828.1"> /&gt;</span></strong></span>
</code></pre>
</li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.829.1">The Demo page should now automatically refresh in your browser and show the component and its initial width!</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.830.1"><img alt="Figure 9.3 – The component displaying its initial width" src="../Images/B31327_09_03.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.831.1">Figure 9.3 – The component displaying its initial width</span></p>
<h3 class="heading-3" id="_idParaDest-207"><a id="_idTextAnchor217"/><span class="koboSpan" id="kobo.832.1">Using refs to persist mutable values across re-renders</span></h3>
<p class="normal"><span class="koboSpan" id="kobo.833.1">Refs can be </span><a id="_idIndexMarker442"/><span class="koboSpan" id="kobo.834.1">used to access the DOM, but also to keep mutable values around even when the component is re-rendered, such as storing references to intervals.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.835.1">Let’s try that out by implementing a timer that counts the seconds passed:</span></p>
<ol>
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.836.1">Create a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.837.1">src/components/demo/useRef/Timer.jsx</span></code><span class="koboSpan" id="kobo.838.1"> file. </span><span class="koboSpan" id="kobo.838.2">Inside it, import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.839.1">useRef</span></code><span class="koboSpan" id="kobo.840.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.841.1">useState</span></code><span class="koboSpan" id="kobo.842.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.843.1">useEffect</span></code><span class="koboSpan" id="kobo.844.1"> functions:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.845.1">import</span></span><span class="koboSpan" id="kobo.846.1"> { useRef, useState, useEffect } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.847.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.848.1">'react'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.849.1">Then, define and export a </span><code class="inlineCode"><span class="koboSpan" id="kobo.850.1">Timer</span></code><span class="koboSpan" id="kobo.851.1"> component:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.852.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.853.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.854.1">Timer</span></span><span class="koboSpan" id="kobo.855.1">() {
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.856.1">Inside it, define a Ref Hook to store the interval and a State Hook to store the current count:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-keyword"><span class="koboSpan" id="kobo.857.1">const</span></span><span class="koboSpan" id="kobo.858.1"> intervalRef = </span><span class="hljs-title"><span class="koboSpan" id="kobo.859.1">useRef</span></span><span class="koboSpan" id="kobo.860.1">(</span><span class="hljs-literal"><span class="koboSpan" id="kobo.861.1">null</span></span><span class="koboSpan" id="kobo.862.1">)
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.863.1">const</span></span><span class="koboSpan" id="kobo.864.1"> [seconds, setSeconds] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.865.1">useState</span></span><span class="koboSpan" id="kobo.866.1">(</span><span class="hljs-number"><span class="koboSpan" id="kobo.867.1">0</span></span><span class="koboSpan" id="kobo.868.1">)
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.869.1">Define a </span><a id="_idIndexMarker443"/><span class="koboSpan" id="kobo.870.1">function that will increase the count:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-keyword"><span class="koboSpan" id="kobo.871.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.872.1">increaseSeconds</span></span><span class="koboSpan" id="kobo.873.1">() {
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.874.1">setSeconds</span></span><span class="koboSpan" id="kobo.875.1">(</span><span class="hljs-function"><span class="koboSpan" id="kobo.876.1">(</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.877.1">prevSeconds</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.878.1">) =&gt;</span></span><span class="koboSpan" id="kobo.879.1"> prevSeconds + </span><span class="hljs-number"><span class="koboSpan" id="kobo.880.1">1</span></span><span class="koboSpan" id="kobo.881.1">)
  }
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.882.1">Now, define an Effect Hook that defines a new interval and stores it in the ref:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-title"><span class="koboSpan" id="kobo.883.1">useEffect</span></span><span class="koboSpan" id="kobo.884.1">(</span><span class="hljs-function"><span class="koboSpan" id="kobo.885.1">() =&gt;</span></span><span class="koboSpan" id="kobo.886.1"> {
    intervalRef.</span><span class="hljs-property"><span class="koboSpan" id="kobo.887.1">current</span></span><span class="koboSpan" id="kobo.888.1"> = </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.889.1">setInterval</span></span><span class="koboSpan" id="kobo.890.1">(increaseSeconds, </span><span class="hljs-number"><span class="koboSpan" id="kobo.891.1">1000</span></span><span class="koboSpan" id="kobo.892.1">)
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.893.1">We can now use this ref to clear the interval when the component unmounts:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-keyword"><span class="koboSpan" id="kobo.894.1">return</span></span> <span class="hljs-function"><span class="koboSpan" id="kobo.895.1">() =&gt;</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.896.1">clearInterval</span></span><span class="koboSpan" id="kobo.897.1">(intervalRef.</span><span class="hljs-property"><span class="koboSpan" id="kobo.898.1">current</span></span><span class="koboSpan" id="kobo.899.1">)
  }, [])
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.900.1">Render the current count of the timer:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-keyword"><span class="koboSpan" id="kobo.901.1">return</span></span><span class="koboSpan" id="kobo.902.1"> (
    &lt;</span><span class="hljs-name"><span class="koboSpan" id="kobo.903.1">div</span></span><span class="koboSpan" id="kobo.904.1">&gt;
      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.905.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.906.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.907.1">&gt;</span></span><span class="koboSpan" id="kobo.908.1">Timer</span><span class="hljs-tag"><span class="koboSpan" id="kobo.909.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.910.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.911.1">&gt;</span></span><span class="koboSpan" id="kobo.912.1">
      {seconds} seconds
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.913.1">Lastly, render a button to cancel the timer:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-tag"><span class="koboSpan" id="kobo.914.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.915.1">button</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.916.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.917.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.918.1">'button'</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.919.1">onClick</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.920.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.921.1">{()</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.922.1"> =&gt;</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.923.1">clearInterval</span></span><span class="koboSpan" id="kobo.924.1">(intervalRef.</span><span class="hljs-property"><span class="koboSpan" id="kobo.925.1">current</span></span><span class="koboSpan" id="kobo.926.1">)}&gt;
        </span><span class="hljs-title"><span class="koboSpan" id="kobo.927.1">Cancel</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.928.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.929.1">button</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.930.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.931.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.932.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.933.1">&gt;</span></span><span class="koboSpan" id="kobo.934.1">
  )
}
</span></code></pre>
</li>
</ol>
<div class="note-one">
<p class="normal"><span class="koboSpan" id="kobo.935.1">If we did not need to access the interval ID outside of the Effect Hook, we could simply use a </span><code class="inlineCode"><span class="koboSpan" id="kobo.936.1">const</span></code><span class="koboSpan" id="kobo.937.1"> inside the effect instead of defining a Ref. </span><span class="koboSpan" id="kobo.937.2">While we could use a State Hook to store the interval ID, this would cause the component to re-render. </span><span class="koboSpan" id="kobo.937.3">As we can see, Refs are ideal for storing values that need to change but are not used for rendering.</span></p>
</div>
<ol>
<li class="numberedList" value="9"><span class="koboSpan" id="kobo.938.1">Edit </span><code class="inlineCode"><span class="koboSpan" id="kobo.939.1">src/pages/Demo.jsx</span></code><span class="koboSpan" id="kobo.940.1"> and import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.941.1">Timer</span></code><span class="koboSpan" id="kobo.942.1"> component there:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.943.1">import</span></span><span class="koboSpan" id="kobo.944.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.945.1">Timer</span></span><span class="koboSpan" id="kobo.946.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.947.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.948.1">'@/components/demo/useRef/Timer.jsx'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.949.1">Finally, render </span><a id="_idIndexMarker444"/><span class="koboSpan" id="kobo.950.1">the component on the Demo page:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.951.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.952.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.953.1">Demo</span></span><span class="koboSpan" id="kobo.954.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.955.1">return</span></span><span class="koboSpan" id="kobo.956.1"> (
    &lt;div&gt;
      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.957.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.958.1">h1</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.959.1">&gt;</span></span><span class="koboSpan" id="kobo.960.1">Demo Page</span><span class="hljs-tag"><span class="koboSpan" id="kobo.961.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.962.1">h1</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.963.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.964.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.965.1">h2</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.966.1">&gt;</span></span><span class="koboSpan" id="kobo.967.1">useRef</span><span class="hljs-tag"><span class="koboSpan" id="kobo.968.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.969.1">h2</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.970.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.971.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.972.1">AutoFocus</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.973.1"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.974.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.975.1">InitialWidthMeasure</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.976.1"> /&gt;</span></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.977.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.978.1">Timer</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.979.1"> /&gt;</span></strong></span>
</code></pre>
</li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.980.1">The Demo page should now automatically refresh in your browser and show the component counting seconds! </span><span class="koboSpan" id="kobo.980.2">Press the </span><strong class="screenText"><span class="koboSpan" id="kobo.981.1">Cancel</span></strong><span class="koboSpan" id="kobo.982.1"> button to stop the timer.</span></p>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.983.1">Using refs as in the previous example makes them similar to instance variables in classes, such as </span><code class="inlineCode"><span class="koboSpan" id="kobo.984.1">this.intervalRef</span></code><span class="koboSpan" id="kobo.985.1">.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.986.1">The following screenshot shows what the </span><code class="inlineCode"><span class="koboSpan" id="kobo.987.1">Timer</span></code><span class="koboSpan" id="kobo.988.1"> component looks like on the Demo page after 42 seconds have elapsed since opening the page:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.989.1"><img alt="Figure 9.4 – The Timer component showing seconds elapsed since being rendered" src="../Images/B31327_09_04.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.990.1">Figure 9.4 – The Timer component showing seconds elapsed since being rendered</span></p>
<h3 class="heading-3" id="_idParaDest-208"><a id="_idTextAnchor218"/><span class="koboSpan" id="kobo.991.1">Passing refs as props</span></h3>
<p class="normal"><span class="koboSpan" id="kobo.992.1">Sometimes, you may want to get a ref to an input field inside another component (for example, when </span><a id="_idIndexMarker445"/><span class="koboSpan" id="kobo.993.1">dealing with custom input fields). </span><span class="koboSpan" id="kobo.993.2">In the past, this required the </span><code class="inlineCode"><span class="koboSpan" id="kobo.994.1">forwardRef</span></code><span class="koboSpan" id="kobo.995.1"> helper. </span><span class="koboSpan" id="kobo.995.2">However, since React 19, we can simply pass refs as props.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.996.1">Let’s try it ou</span><a id="_idTextAnchor219"/><span class="koboSpan" id="kobo.997.1">t:</span></p>
<ol>
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.998.1">Create a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.999.1">src/components/demo/useRef/CustomInput.jsx</span></code><span class="koboSpan" id="kobo.1000.1"> file.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1001.1">Inside it, define the following custom input component, accepting a ref as a prop:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1002.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1003.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1004.1">CustomInput</span></span><span class="koboSpan" id="kobo.1005.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1006.1">{ ref }</span></span><span class="koboSpan" id="kobo.1007.1">) {
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1008.1">We can use the ref as usual now:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1009.1">return</span></span> <span class="hljs-tag"><span class="koboSpan" id="kobo.1010.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1011.1">input</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1012.1">ref</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1013.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1014.1">{ref}</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1015.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1016.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1017.1">'text'</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1018.1"> /&gt;</span></span><span class="koboSpan" id="kobo.1019.1">
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1020.1">Now, edit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1021.1">src/components/demo/useRef/AutoFocus.jsx</span></code><span class="koboSpan" id="kobo.1022.1"> file and import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1023.1">CustomInput</span></code><span class="koboSpan" id="kobo.1024.1"> component:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1025.1">import</span></span><span class="koboSpan" id="kobo.1026.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1027.1">CustomInput</span></span><span class="koboSpan" id="kobo.1028.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1029.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1030.1">'./CustomInput.jsx'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1031.1">Replace the input field with our </span><code class="inlineCode"><span class="koboSpan" id="kobo.1032.1">CustomInput</span></code><span class="koboSpan" id="kobo.1033.1"> component, and pass the ref to it:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1034.1">return</span></span><span class="koboSpan" id="kobo.1035.1"> (
    &lt;div&gt;
      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1036.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1037.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1038.1">&gt;</span></span><span class="koboSpan" id="kobo.1039.1">AutoFocus</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1040.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1041.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1042.1">&gt;</span></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1043.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.1044.1">CustomInput</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1045.1">ref</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1046.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1047.1">{inputRef}</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1048.1"> /&gt;</span></strong></span>
</code></pre>
</li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.1049.1">Refresh the Demo page and you will see that the input field is still getting autofocused!</span></p>
<h3 class="heading-3" id="_idParaDest-209"><a id="_idTextAnchor220"/><span class="koboSpan" id="kobo.1050.1">Creating ref contents only once</span></h3>
<p class="normal"><span class="koboSpan" id="kobo.1051.1">If you have a complex algorithm that needs initialization, for example, a pathfinding algorithm, it is possible </span><a id="_idIndexMarker446"/><span class="koboSpan" id="kobo.1052.1">to store a reference to it in a ref to avoid creating it on every render. </span><span class="koboSpan" id="kobo.1052.2">This should be done as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1053.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1054.1">Map</span></span><span class="koboSpan" id="kobo.1055.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1056.1">const</span></span><span class="koboSpan" id="kobo.1057.1"> pathfinderRef = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1058.1">useRef</span></span><span class="koboSpan" id="kobo.1059.1">(</span><span class="hljs-literal"><span class="koboSpan" id="kobo.1060.1">null</span></span><span class="koboSpan" id="kobo.1061.1">)
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1062.1">if</span></span><span class="koboSpan" id="kobo.1063.1"> (pathfinderRef.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1064.1">current</span></span><span class="koboSpan" id="kobo.1065.1"> === </span><span class="hljs-literal"><span class="koboSpan" id="kobo.1066.1">null</span></span><span class="koboSpan" id="kobo.1067.1">) {
    pathfinderRef.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1068.1">current</span></span><span class="koboSpan" id="kobo.1069.1"> = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1070.1">createPathfinder</span></span><span class="koboSpan" id="kobo.1071.1">()
  }
}
</span></code></pre>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.1072.1">Generally, writing or reading </span><code class="inlineCode"><span class="koboSpan" id="kobo.1073.1">ref.current</span></code><span class="koboSpan" id="kobo.1074.1"> in a render like that is not allowed in React. </span><span class="koboSpan" id="kobo.1074.2">However, in this case, it is fine because the condition makes it only execute once when the component is initialized.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.1075.1">While React always only saves the initial value of a ref once, directly calling the function inside the Ref Hook, such as </span><code class="inlineCode"><span class="koboSpan" id="kobo.1076.1">useRef(createPathfinder())</span></code><span class="koboSpan" id="kobo.1077.1">, would unnecessarily execute the expensive function on every render.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1078.1">As we have seen, there are many use cases for refs. </span><span class="koboSpan" id="kobo.1078.2">Generally, refs are useful to do the following:</span></p>
<ul>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1079.1">Store information between re-renders</span></strong><span class="koboSpan" id="kobo.1080.1">, because – unlike regular variables – refs do not reset when re-rendering</span></li>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1081.1">Change information without triggering a re-render</span></strong><span class="koboSpan" id="kobo.1082.1">, because – unlike State Hooks – refs do not trigger a re-render</span></li>
<li class="bulletList"><strong class="screenText"><span class="koboSpan" id="kobo.1083.1">Store information local to each copy of the component</span></strong><span class="koboSpan" id="kobo.1084.1">, because – unlike regular variables outside of components – refs do not have a shared value between different instances of a component</span></li>
</ul>
<h2 class="heading-2" id="_idParaDest-210"><a id="_idTextAnchor221"/><span class="koboSpan" id="kobo.1085.1">useImperativeHandle</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1086.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.1087.1">Imperative Handle Hook</span></strong><span class="koboSpan" id="kobo.1088.1"> can be </span><a id="_idIndexMarker447"/><span class="koboSpan" id="kobo.1089.1">used to customize instance values </span><a id="_idIndexMarker448"/><span class="koboSpan" id="kobo.1090.1">that </span><a id="_idIndexMarker449"/><span class="koboSpan" id="kobo.1091.1">are exposed to other components when pointing a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1092.1">ref</span></code><span class="koboSpan" id="kobo.1093.1"> to it. </span><span class="koboSpan" id="kobo.1093.2">Doing this should be avoided as much as possible, however, as it tightly couples components together, which harms reusability.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1094.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1095.1">useImperativeHandle</span></code><span class="koboSpan" id="kobo.1096.1"> function has the following signature:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.1097.1">useImperativeHandle</span></span><span class="koboSpan" id="kobo.1098.1">(ref, createHandle, [dependencies])
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1099.1">We can use this Hook, for example, to expose a special </span><code class="inlineCode"><span class="koboSpan" id="kobo.1100.1">focus</span></code><span class="koboSpan" id="kobo.1101.1"> function that not only focuses an input </span><a id="_idIndexMarker450"/><span class="koboSpan" id="kobo.1102.1">field but also highlights it. </span><span class="koboSpan" id="kobo.1102.2">Other components </span><a id="_idIndexMarker451"/><span class="koboSpan" id="kobo.1103.1">can then trigger this function via a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1104.1">ref</span></code><span class="koboSpan" id="kobo.1105.1"> to the component. </span><span class="koboSpan" id="kobo.1105.2">Let’s </span><a id="_idTextAnchor222"/><span class="koboSpan" id="kobo.1106.1">try it out now:</span></p>
<ol>
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1107.1">Create a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.1108.1">src/components/demo/useImperativeHandle/</span></code><span class="koboSpan" id="kobo.1109.1"> folder.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1110.1">Inside it, crea</span><a id="_idTextAnchor223"/><span class="koboSpan" id="kobo.1111.1">te a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.1112.1">src/components/demo/useImperativeHandle/HighlightFocusInput.jsx</span></code><span class="koboSpan" id="kobo.1113.1"> file.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1114.1">Import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1115.1">useImperativeHandle</span></code><span class="koboSpan" id="kobo.1116.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1117.1">useRef</span></code><span class="koboSpan" id="kobo.1118.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1119.1">useState</span></code><span class="koboSpan" id="kobo.1120.1"> functions:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1121.1">import</span></span><span class="koboSpan" id="kobo.1122.1"> { useImperativeHandle, useRef, useState } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1123.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1124.1">'react'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1125.1">Then, define a component that accepts a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1126.1">ref</span></code><span class="koboSpan" id="kobo.1127.1">:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1128.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1129.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1130.1">HighlightFocusInput</span></span><span class="koboSpan" id="kobo.1131.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1132.1">{ ref }</span></span><span class="koboSpan" id="kobo.1133.1">) {
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1134.1">Inside the component, we define a Ref Hook for the input field and a State Hook to store the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1135.1">highlight</span></code><span class="koboSpan" id="kobo.1136.1"> state:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1137.1">const</span></span><span class="koboSpan" id="kobo.1138.1"> inputRef = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1139.1">useRef</span></span><span class="koboSpan" id="kobo.1140.1">(</span><span class="hljs-literal"><span class="koboSpan" id="kobo.1141.1">null</span></span><span class="koboSpan" id="kobo.1142.1">)
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1143.1">const</span></span><span class="koboSpan" id="kobo.1144.1"> [highlight, setHighlight] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1145.1">useState</span></span><span class="koboSpan" id="kobo.1146.1">(</span><span class="hljs-literal"><span class="koboSpan" id="kobo.1147.1">false</span></span><span class="koboSpan" id="kobo.1148.1">)
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1149.1">Now, define an Imperative Handle Hook, pass the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1150.1">ref</span></code><span class="koboSpan" id="kobo.1151.1"> to it, and pass a function that returns an object:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-title"><span class="koboSpan" id="kobo.1152.1">useImperativeHandle</span></span><span class="koboSpan" id="kobo.1153.1">(ref, </span><span class="hljs-function"><span class="koboSpan" id="kobo.1154.1">() =&gt;</span></span><span class="koboSpan" id="kobo.1155.1"> ({
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1156.1">This object contains a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1157.1">focus</span></code><span class="koboSpan" id="kobo.1158.1"> function, which will trigger the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1159.1">focus</span></code><span class="koboSpan" id="kobo.1160.1"> function on the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1161.1">input</span></code><span class="koboSpan" id="kobo.1162.1"> element, and then set the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1163.1">highlight</span></code><span class="koboSpan" id="kobo.1164.1"> state to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1165.1">true</span></code><span class="koboSpan" id="kobo.1166.1"> for a second:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-attr"><span class="koboSpan" id="kobo.1167.1">focus</span></span><span class="koboSpan" id="kobo.1168.1">: </span><span class="hljs-function"><span class="koboSpan" id="kobo.1169.1">() =&gt;</span></span><span class="koboSpan" id="kobo.1170.1"> {
      inputRef.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1171.1">current</span></span><span class="koboSpan" id="kobo.1172.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1173.1">focus</span></span><span class="koboSpan" id="kobo.1174.1">()
      </span><span class="hljs-title"><span class="koboSpan" id="kobo.1175.1">setHighlight</span></span><span class="koboSpan" id="kobo.1176.1">(</span><span class="hljs-literal"><span class="koboSpan" id="kobo.1177.1">true</span></span><span class="koboSpan" id="kobo.1178.1">)
      </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1179.1">setTimeout</span></span><span class="koboSpan" id="kobo.1180.1">(</span><span class="hljs-function"><span class="koboSpan" id="kobo.1181.1">() =&gt;</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1182.1">setHighlight</span></span><span class="koboSpan" id="kobo.1183.1">(</span><span class="hljs-literal"><span class="koboSpan" id="kobo.1184.1">false</span></span><span class="koboSpan" id="kobo.1185.1">), </span><span class="hljs-number"><span class="koboSpan" id="kobo.1186.1">1000</span></span><span class="koboSpan" id="kobo.1187.1">)
    },
  }))
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1188.1">Lastly, render an input field and pass </span><code class="inlineCode"><span class="koboSpan" id="kobo.1189.1">inputRef</span></code><span class="koboSpan" id="kobo.1190.1"> to it:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1191.1">return</span></span><span class="koboSpan" id="kobo.1192.1"> (
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1193.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1194.1">input</span></span>
<span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1195.1">ref</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1196.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1197.1">{inputRef}</span></span>
<span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1198.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1199.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1200.1">'text'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1201.1">If </span><code class="inlineCode"><span class="koboSpan" id="kobo.1202.1">highlight</span></code><span class="koboSpan" id="kobo.1203.1"> is set </span><a id="_idIndexMarker452"/><span class="koboSpan" id="kobo.1204.1">to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1205.1">true</span></code><span class="koboSpan" id="kobo.1206.1">, render the background in a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1207.1">yellow</span></code><span class="koboSpan" id="kobo.1208.1"> color:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="koboSpan" id="kobo.1209.1">      style={{ </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1210.1">backgroundColor</span></span><span class="koboSpan" id="kobo.1211.1">: highlight ? </span><span class="hljs-string"><span class="koboSpan" id="kobo.1212.1">'yellow'</span></span><span class="koboSpan" id="kobo.1213.1"> : </span><span class="hljs-literal"><span class="koboSpan" id="kobo.1214.1">undefined</span></span><span class="koboSpan" id="kobo.1215.1"> }}
    /&gt;
  )
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1216.1">Create a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.1217.1">src/components/demo/useImperativeHandle/HighlightFocus.jsx</span></code><span class="koboSpan" id="kobo.1218.1"> file.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1219.1">Inside it, import </span><a id="_idIndexMarker453"/><span class="koboSpan" id="kobo.1220.1">the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1221.1">useR</span><a id="_idTextAnchor224"/><span class="koboSpan" id="kobo.1222.1">ef</span></code><span class="koboSpan" id="kobo.1223.1"> function and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1224.1">HighlightFocusInput</span></code><span class="koboSpan" id="kobo.1225.1"> component:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1226.1">import</span></span><span class="koboSpan" id="kobo.1227.1"> { useRef } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1228.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1229.1">'react'</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1230.1">import</span></span><span class="koboSpan" id="kobo.1231.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1232.1">HighlightFocusInput</span></span><span class="koboSpan" id="kobo.1233.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1234.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1235.1">'./HighlightFocusInput.jsx'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1236.1">Now, define a component and a Ref Hook:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1237.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1238.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1239.1">HighlightFocus</span></span><span class="koboSpan" id="kobo.1240.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1241.1">const</span></span><span class="koboSpan" id="kobo.1242.1"> inputRef = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1243.1">useRef</span></span><span class="koboSpan" id="kobo.1244.1">(</span><span class="hljs-literal"><span class="koboSpan" id="kobo.1245.1">null</span></span><span class="koboSpan" id="kobo.1246.1">)
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1247.1">Render a button to trigger the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1248.1">focus</span></code><span class="koboSpan" id="kobo.1249.1"> function from the component, and then render the component and pass the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1250.1">ref</span></code><span class="koboSpan" id="kobo.1251.1"> to it:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1252.1">return</span></span><span class="koboSpan" id="kobo.1253.1"> (
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1254.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1255.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1256.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1257.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1258.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1259.1">&gt;</span></span><span class="koboSpan" id="kobo.1260.1">HighlightFocus</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1261.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1262.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1263.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1264.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1265.1">button</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1266.1">onClick</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1267.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1268.1">{()</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1269.1"> =&gt;</span></span><span class="koboSpan" id="kobo.1270.1"> inputRef.current.focus()}&gt;focus it</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1271.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1272.1">button</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1273.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1274.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1275.1">HighlightFocusInput</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1276.1">ref</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1277.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1278.1">{inputRef}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1279.1"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1280.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1281.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1282.1">&gt;</span></span><span class="koboSpan" id="kobo.1283.1">
  )
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1284.1">Edit </span><code class="inlineCode"><span class="koboSpan" id="kobo.1285.1">src/pages/Demo.jsx</span></code><span class="koboSpan" id="kobo.1286.1"> and import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1287.1">HighlightFocus</span></code><span class="koboSpan" id="kobo.1288.1"> component:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1289.1">import</span></span><span class="koboSpan" id="kobo.1290.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1291.1">HighlightFocus</span></span><span class="koboSpan" id="kobo.1292.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1293.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1294.1">'@/components/demo/useImperativeHandle/HighlightFocus.jsx'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1295.1">Render the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1296.1">HighlightFocus</span></code><span class="koboSpan" id="kobo.1297.1"> component, as follows:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="koboSpan" id="kobo.1298.1">      &lt;</span><span class="hljs-title"><span class="koboSpan" id="kobo.1299.1">InitialWidthMeasure</span></span><span class="koboSpan" id="kobo.1300.1"> /&gt;
      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1301.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1302.1">Timer</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1303.1"> /&gt;</span></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1304.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.1305.1">h2</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1306.1">&gt;</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1307.1">useImperativeHandle</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1308.1">&lt;/</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.1309.1">h2</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1310.1">&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1311.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.1312.1">HighlightFocus</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1313.1"> /&gt;</span></strong></span><span class="koboSpan" id="kobo.1314.1">
    &lt;/div&gt;
  )
}
</span></code></pre>
</li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.1315.1">Now, go to </span><a id="_idIndexMarker454"/><span class="koboSpan" id="kobo.1316.1">the </span><strong class="screenText"><span class="koboSpan" id="kobo.1317.1">Demo</span></strong><span class="koboSpan" id="kobo.1318.1"> page and click the </span><strong class="screenText"><span class="koboSpan" id="kobo.1319.1">focus it</span></strong><span class="koboSpan" id="kobo.1320.1"> button. </span><span class="koboSpan" id="kobo.1320.2">You will </span><a id="_idIndexMarker455"/><span class="koboSpan" id="kobo.1321.1">see the input field getting focused and highlighted!</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1322.1"><img alt="Figure 9.5 – The component focusing and highlighting the input field" src="../Images/B31327_09_05.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1323.1">Figure 9.5 – The component focusing and highlighting the input field</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1324.1">As we can see, by using refs and the Imperative Handle Hook, we can access functions from other components. </span><span class="koboSpan" id="kobo.1324.2">However, this should be used with caution, as it tightly couples components, which can become a problem when our app grows and we want to reuse the components somewhere else.</span></p>
<h2 class="heading-2" id="_idParaDest-211"><a id="_idTextAnchor225"/><span class="koboSpan" id="kobo.1325.1">useId</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1326.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.1327.1">Id Hook</span></strong><span class="koboSpan" id="kobo.1328.1"> is </span><a id="_idIndexMarker456"/><span class="koboSpan" id="kobo.1329.1">used to generate unique IDs. </span><span class="koboSpan" id="kobo.1329.2">This can be useful, for example, to provide </span><a id="_idIndexMarker457"/><span class="koboSpan" id="kobo.1330.1">IDs for elements for accessibility attributes (such as </span><code class="inlineCode"><span class="koboSpan" id="kobo.1331.1">aria-labelledby</span></code><span class="koboSpan" id="kobo.1332.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.1333.1">aria-describedby</span></code><span class="koboSpan" id="kobo.1334.1">). </span><span class="koboSpan" id="kobo.1334.2">The Id Hook has the following signature:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1335.1">const</span></span><span class="koboSpan" id="kobo.1336.1"> uniqueId = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1337.1">useId</span></span><span class="koboSpan" id="kobo.1338.1">()
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1339.1">Let’s try it out now by providing a label for a checkbox field:</span></p>
<ol>
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1340.1">Create a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.1341.1">src/components/demo/useId</span><a id="_idTextAnchor226"/><span class="koboSpan" id="kobo.1342.1">/</span></code><span class="koboSpan" id="kobo.1343.1"> folder.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1344.1">Inside it, create a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.1345.1">src/components/demo</span><a id="_idTextAnchor227"/><span class="koboSpan" id="kobo.1346.1">/useId/AriaInput.jsx</span></code><span class="koboSpan" id="kobo.1347.1"> file.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1348.1">Import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1349.1">useId</span></code><span class="koboSpan" id="kobo.1350.1"> function:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1351.1">import</span></span><span class="koboSpan" id="kobo.1352.1"> { useId } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1353.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1354.1">'react'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1355.1">Then, define a component that uses the Id Hook to generate an ID for a label:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1356.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1357.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1358.1">AriaInput</span></span><span class="koboSpan" id="kobo.1359.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1360.1">const</span></span><span class="koboSpan" id="kobo.1361.1"> inputId = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1362.1">useId</span></span><span class="koboSpan" id="kobo.1363.1">()
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1364.1">Render a label with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1365.1">htmlFor</span></code><span class="koboSpan" id="kobo.1366.1"> tag pointing to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1367.1">inputId</span></code><span class="koboSpan" id="kobo.1368.1">:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1369.1">return</span></span><span class="koboSpan" id="kobo.1370.1"> (
    &lt;div&gt;
      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1371.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1372.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1373.1">&gt;</span></span><span class="koboSpan" id="kobo.1374.1">AriaInput</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1375.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1376.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1377.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1378.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1379.1">label</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1380.1">htmlFor</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1381.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1382.1">{inputId}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1383.1">&gt;</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1384.1">Render a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1385.1">checkbox</span></code><span class="koboSpan" id="kobo.1386.1"> field with the generated ID:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-tag"><span class="koboSpan" id="kobo.1387.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1388.1">input</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1389.1">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1390.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1391.1">{inputId}</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1392.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1393.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1394.1">'checkbox'</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1395.1"> /&gt;</span></span><span class="koboSpan" id="kobo.1396.1"> I agree to the Terms
        and Conditions.
      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1397.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1398.1">label</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1399.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1400.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1401.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1402.1">&gt;</span></span><span class="koboSpan" id="kobo.1403.1">
  )
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1404.1">Edit </span><code class="inlineCode"><span class="koboSpan" id="kobo.1405.1">src/pages/Demo.jsx</span></code><span class="koboSpan" id="kobo.1406.1"> and import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1407.1">AriaInput</span></code><span class="koboSpan" id="kobo.1408.1"> component:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1409.1">import</span></span><span class="koboSpan" id="kobo.1410.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1411.1">AriaInput</span></span><span class="koboSpan" id="kobo.1412.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1413.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1414.1">'@/components/demo/useId/AriaInput.jsx'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1415.1">Then, render the component on the Demo page:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="koboSpan" id="kobo.1416.1">      &lt;</span><span class="hljs-title"><span class="koboSpan" id="kobo.1417.1">Timer</span></span><span class="koboSpan" id="kobo.1418.1"> /&gt;
      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1419.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1420.1">h2</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1421.1">&gt;</span></span><span class="koboSpan" id="kobo.1422.1">useImperativeHandle</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1423.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1424.1">h2</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1425.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1426.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1427.1">HighlightFocus</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1428.1"> /&gt;</span></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1429.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.1430.1">h2</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1431.1">&gt;</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1432.1">useId</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1433.1">&lt;/</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.1434.1">h2</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1435.1">&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1436.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.1437.1">AriaInput</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1438.1"> /&gt;</span></strong></span><span class="koboSpan" id="kobo.1439.1">
    &lt;/div&gt;
  )
}
</span></code></pre>
</li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.1440.1">Now, go to </span><a id="_idIndexMarker458"/><span class="koboSpan" id="kobo.1441.1">the </span><strong class="screenText"><span class="koboSpan" id="kobo.1442.1">Demo</span></strong><span class="koboSpan" id="kobo.1443.1"> page and open the inspector on the input field; you will </span><a id="_idIndexMarker459"/><span class="koboSpan" id="kobo.1444.1">see that React generated an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1445.1">:r0:</span></code><span class="koboSpan" id="kobo.1446.1"> ID for us:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1447.1"><img alt="Figure 9.6 – A unique ID being generated automatically by React" src="../Images/B31327_09_06.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1448.1">Figure 9.6 – A unique ID being generated automatically by React</span></p>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.1449.1">In React 19.1, the format of IDs was changed from </span><code class="inlineCode"><span class="koboSpan" id="kobo.1450.1">:r123:</span></code><span class="koboSpan" id="kobo.1451.1"> to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1452.1">«r123»</span></code><span class="koboSpan" id="kobo.1453.1">, to ensure that they are valid CSS selectors.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.1454.1">In addition to connecting the label to the input field for screen readers (improving accessibility), using a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1455.1">&lt;label&gt;</span></code><span class="koboSpan" id="kobo.1456.1"> element has the added advantage of allowing us to click on the label to check/uncheck the checkbox.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1457.1">While we could </span><a id="_idIndexMarker460"/><span class="koboSpan" id="kobo.1458.1">manually set an ID in this case, for example, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1459.1">tos-check</span></code><span class="koboSpan" id="kobo.1460.1">, the ID needs </span><a id="_idIndexMarker461"/><span class="koboSpan" id="kobo.1461.1">to be unique across the whole page. </span><span class="koboSpan" id="kobo.1461.2">So, if we wanted to render the same input field again, the ID would already be invalid, as it is reused. </span><span class="koboSpan" id="kobo.1461.3">To prevent this issue, always prefer to use the Id Hook for these cases so that the component can be reused multiple times on the same page. </span><span class="koboSpan" id="kobo.1461.4">If you have multiple input fields in a single component, it is best practice to only use a single Id Hook in the component and then extend IDs by adding tags to the generated ID – for example: </span><code class="inlineCode"><span class="koboSpan" id="kobo.1462.1">`${id}-tos-check`</span></code><span class="koboSpan" id="kobo.1463.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1464.1">`${id}-username`</span></code><span class="koboSpan" id="kobo.1465.1">.</span></p>
<h2 class="heading-2" id="_idParaDest-212"><a id="_idTextAnchor228"/><span class="koboSpan" id="kobo.1466.1">useSyncExternalStore</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1467.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.1468.1">Sync External Store Hook</span></strong><span class="koboSpan" id="kobo.1469.1"> is used </span><a id="_idIndexMarker462"/><span class="koboSpan" id="kobo.1470.1">to subscribe to external stores, such as </span><a id="_idIndexMarker463"/><span class="koboSpan" id="kobo.1471.1">state management libraries or browser APIs. </span><span class="koboSpan" id="kobo.1471.2">Its signature looks as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1472.1">const</span></span><span class="koboSpan" id="kobo.1473.1"> snapshot = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1474.1">useSyncExternalStore</span></span><span class="koboSpan" id="kobo.1475.1">(subscribe, getSnapshot, getServerSnapshot)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1476.1">As we </span><a id="_idIndexMarker464"/><span class="koboSpan" id="kobo.1477.1">can see, the Sync External Store Hook accepts three parameters and returns the current snapshot of the store, which can be used to render information from it. </span><span class="koboSpan" id="kobo.1477.2">The parameters are as follows:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.1478.1">The first parameter, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1479.1">subscribe</span></code><span class="koboSpan" id="kobo.1480.1">, is a function that takes a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1481.1">callback</span></code><span class="koboSpan" id="kobo.1482.1"> function as an argument and </span><a id="_idIndexMarker465"/><span class="koboSpan" id="kobo.1483.1">subscribes it to the store. </span><span class="koboSpan" id="kobo.1483.2">When the store changes, the provided function should be called. </span><span class="koboSpan" id="kobo.1483.3">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1484.1">subscribe</span></code><span class="koboSpan" id="kobo.1485.1"> function should also return a function that cleans up the subscription.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.1486.1">The second parameter, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1487.1">getSnapshot</span></code><span class="koboSpan" id="kobo.1488.1">, is a function that returns a snapshot of the current state </span><a id="_idIndexMarker466"/><span class="koboSpan" id="kobo.1489.1">of the data in the store. </span><span class="koboSpan" id="kobo.1489.2">If the store changes (the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1490.1">callback</span></code><span class="koboSpan" id="kobo.1491.1"> function in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1492.1">subscribe</span></code><span class="koboSpan" id="kobo.1493.1"> function is called), React calls the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1494.1">getSnapshot</span></code><span class="koboSpan" id="kobo.1495.1"> function and checks whether the returned value is different. </span><span class="koboSpan" id="kobo.1495.2">If it is, the component will re-render.</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.1496.1">The third </span><a id="_idIndexMarker467"/><span class="koboSpan" id="kobo.1497.1">parameter, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1498.1">getServerSnapshot</span></code><span class="koboSpan" id="kobo.1499.1">, is an optional function that returns the initial snapshot of the current state of the data in the store. </span><span class="koboSpan" id="kobo.1499.2">This function is only called during server rendering and used to hydrate server-rendered content on the client.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.1500.1">In most cases, you will be better off using State and Reducer Hooks instead of this Hook. </span><span class="koboSpan" id="kobo.1500.2">Most state management libraries also provide their own Hooks. </span><span class="koboSpan" id="kobo.1500.3">This Hook is mostly useful when integrating with existing non-React code, but it can also be useful when interacting with certain browser APIs, which is what we are going to try out now.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1501.1">Let’s implement an indicator that checks whether a network connection is available or not, by subscribing to a browser API via </span><a id="_idTextAnchor229"/><span class="koboSpan" id="kobo.1502.1">the Sync External Store Hook:</span></p>
<ol>
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1503.1">Create a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.1504.1">src/components/demo/useSyncExternalStore/</span></code><span class="koboSpan" id="kobo.1505.1"> folder.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1506.1">Inside it, create a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.1507.1">src/components/demo/useSyncExternalStore/Onlin</span><a id="_idTextAnchor230"/><span class="koboSpan" id="kobo.1508.1">eIndicator.jsx</span></code><span class="koboSpan" id="kobo.1509.1"> file.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1510.1">Import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1511.1">useSyncExternalStore</span></code><span class="koboSpan" id="kobo.1512.1"> function:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1513.1">import</span></span><span class="koboSpan" id="kobo.1514.1"> { useSyncExternalStore } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1515.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1516.1">'react'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1517.1">Define a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1518.1">subscribe</span></code><span class="koboSpan" id="kobo.1519.1"> function that accepts a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1520.1">callback</span></code><span class="koboSpan" id="kobo.1521.1"> function as an argument:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1522.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1523.1">subscribe</span></span><span class="koboSpan" id="kobo.1524.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1525.1">callback</span></span><span class="koboSpan" id="kobo.1526.1">) {
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1527.1">Add event </span><a id="_idIndexMarker468"/><span class="koboSpan" id="kobo.1528.1">listeners for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1529.1">online</span></code><span class="koboSpan" id="kobo.1530.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1531.1">offline</span></code><span class="koboSpan" id="kobo.1532.1"> events </span><a id="_idIndexMarker469"/><span class="koboSpan" id="kobo.1533.1">from the browser:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-variable"><span class="koboSpan" id="kobo.1534.1">window</span></span><span class="koboSpan" id="kobo.1535.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1536.1">addEventListener</span></span><span class="koboSpan" id="kobo.1537.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1538.1">'online'</span></span><span class="koboSpan" id="kobo.1539.1">, callback)
  </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1540.1">window</span></span><span class="koboSpan" id="kobo.1541.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1542.1">addEventListener</span></span><span class="koboSpan" id="kobo.1543.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1544.1">'offline'</span></span><span class="koboSpan" id="kobo.1545.1">, callback)
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1546.1">Return a function that will clean up those event listeners:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1547.1">return</span></span> <span class="hljs-function"><span class="koboSpan" id="kobo.1548.1">() =&gt;</span></span><span class="koboSpan" id="kobo.1549.1"> {
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1550.1">window</span></span><span class="koboSpan" id="kobo.1551.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1552.1">removeEventListener</span></span><span class="koboSpan" id="kobo.1553.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1554.1">'online'</span></span><span class="koboSpan" id="kobo.1555.1">, callback)
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1556.1">window</span></span><span class="koboSpan" id="kobo.1557.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1558.1">removeEventListener</span></span><span class="koboSpan" id="kobo.1559.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1560.1">'offline'</span></span><span class="koboSpan" id="kobo.1561.1">, callback)
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1562.1">Now, define a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1563.1">getSnapshot</span></code><span class="koboSpan" id="kobo.1564.1"> function that returns the current online status:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1565.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1566.1">getSnapshot</span></span><span class="koboSpan" id="kobo.1567.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1568.1">return</span></span><span class="koboSpan" id="kobo.1569.1"> navigator.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1570.1">onLine</span></span><span class="koboSpan" id="kobo.1571.1">
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1572.1">Then, define the component and a Sync External Store Hook:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1573.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1574.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1575.1">OnlineIndicator</span></span><span class="koboSpan" id="kobo.1576.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1577.1">const</span></span><span class="koboSpan" id="kobo.1578.1"> isOnline = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1579.1">useSyncExternalStore</span></span><span class="koboSpan" id="kobo.1580.1">(subscribe, getSnapshot)
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1581.1">Define </span><a id="_idIndexMarker470"/><span class="koboSpan" id="kobo.1582.1">the status based on the result from </span><a id="_idIndexMarker471"/><span class="koboSpan" id="kobo.1583.1">the browser API:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1584.1">const</span></span><span class="koboSpan" id="kobo.1585.1"> status = isOnline ? </span><span class="hljs-string"><span class="koboSpan" id="kobo.1586.1">'online'</span></span><span class="koboSpan" id="kobo.1587.1"> : </span><span class="hljs-string"><span class="koboSpan" id="kobo.1588.1">'offline'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1589.1">Render the status:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1590.1">return</span></span><span class="koboSpan" id="kobo.1591.1"> (
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1592.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1593.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1594.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1595.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1596.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1597.1">&gt;</span></span><span class="koboSpan" id="kobo.1598.1">OnlineIndicator</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1599.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1600.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1601.1">&gt;</span></span><span class="koboSpan" id="kobo.1602.1">
      {status}
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1603.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1604.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1605.1">&gt;</span></span><span class="koboSpan" id="kobo.1606.1">
  )
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1607.1">Edit </span><code class="inlineCode"><span class="koboSpan" id="kobo.1608.1">src/pages/Demo.jsx</span></code><span class="koboSpan" id="kobo.1609.1"> and import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1610.1">OnlineIndicator</span></code><span class="koboSpan" id="kobo.1611.1"> component:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1612.1">import</span></span><span class="koboSpan" id="kobo.1613.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1614.1">OnlineIndicator</span></span><span class="koboSpan" id="kobo.1615.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1616.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1617.1">'@/components/demo/useSyncExternalStore/OnlineIndicator.jsx'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1618.1">Render the component on the Demo page:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="koboSpan" id="kobo.1619.1">      &lt;h2&gt;useId&lt;</span><span class="hljs-regexp"><span class="koboSpan" id="kobo.1620.1">/h2&gt;</span></span>
<span class="hljs-regexp"><span class="koboSpan" id="kobo.1621.1">      &lt;AriaInput /</span></span><span class="koboSpan" id="kobo.1622.1">&gt;
</span><span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1623.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.1624.1">h2</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1625.1">&gt;</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1626.1">useSyncExternalStore</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1627.1">&lt;/</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.1628.1">h2</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1629.1">&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1630.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.1631.1">OnlineIndicator</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1632.1"> /&gt;</span></strong></span><span class="koboSpan" id="kobo.1633.1">
    &lt;/div&gt;
  )
}
</span></code></pre>
</li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.1634.1">Now, go to the </span><strong class="screenText"><span class="koboSpan" id="kobo.1635.1">Demo</span></strong><span class="koboSpan" id="kobo.1636.1"> page and (if you are online) it should show </span><strong class="screenText"><span class="koboSpan" id="kobo.1637.1">online</span></strong><span class="koboSpan" id="kobo.1638.1">. </span><span class="koboSpan" id="kobo.1638.2">Turn all network connections off to see it change to </span><strong class="screenText"><span class="koboSpan" id="kobo.1639.1">offline</span></strong><span class="koboSpan" id="kobo.1640.1">.</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1641.1"><img alt="Figure 9.7 – Detecting that the user has gone offline via an external store (browser APIs)" src="../Images/B31327_09_07.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1642.1">Figure 9.7 – Detecting that the user has gone offline via an external store (browser APIs)</span></p>
<h2 class="heading-2" id="_idParaDest-213"><a id="_idTextAnchor231"/><span class="koboSpan" id="kobo.1643.1">useDebugValue</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1644.1">The Debug Value </span><a id="_idIndexMarker472"/><span class="koboSpan" id="kobo.1645.1">Hook is useful for developing custom Hooks that are part of </span><a id="_idIndexMarker473"/><span class="koboSpan" id="kobo.1646.1">shared libraries. </span><span class="koboSpan" id="kobo.1646.2">It can be used to show certain values for debugging in React DevTools. </span><span class="koboSpan" id="kobo.1646.3">Its signature is as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.1647.1">useDebugValue</span></span><span class="koboSpan" id="kobo.1648.1">(value, format)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1649.1">The first parameter, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1650.1">value</span></code><span class="koboSpan" id="kobo.1651.1">, is the value or message that should be logged. </span><span class="koboSpan" id="kobo.1651.2">The second, optional </span><code class="inlineCode"><span class="koboSpan" id="kobo.1652.1">format</span></code><span class="koboSpan" id="kobo.1653.1"> parameter is used to provide a format function that will format the value before being shown.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1654.1">Let’s briefly try it out by defining a custom Hook for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1655.1">OnlineIndicator</span></code><span class="koboSpan" id="kobo.1656.1"> component:</span></p>
<ol>
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1657.1">Edit </span><code class="inlineCode"><span class="koboSpan" id="kobo.1658.1">src/components/demo/useSyncExternalStore/OnlineIndicator.jsx</span></code><span class="koboSpan" id="kobo.1659.1"> and import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1660.1">useDebugValue</span></code><span class="koboSpan" id="kobo.1661.1"> function:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1662.1">import</span></span><span class="koboSpan" id="kobo.1663.1"> { useSyncExternalStore</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1664.1">, useDebugValue</span></strong></span><span class="koboSpan" id="kobo.1665.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1666.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1667.1">'react</span><a id="_idTextAnchor232"/><span class="koboSpan" id="kobo.1668.1">'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1669.1">Then, define a new Hook function before the component is defined:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1670.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1671.1">useOnlineStatus</span></span><span class="koboSpan" id="kobo.1672.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1673.1">const</span></span><span class="koboSpan" id="kobo.1674.1"> isOnline = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1675.1">useSyncExternalStore</span></span><span class="koboSpan" id="kobo.1676.1">(subscribe, getSnapshot)
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1677.1">const</span></span><span class="koboSpan" id="kobo.1678.1"> status = isOnline ? </span><span class="hljs-string"><span class="koboSpan" id="kobo.1679.1">'online'</span></span><span class="koboSpan" id="kobo.1680.1"> : </span><span class="hljs-string"><span class="koboSpan" id="kobo.1681.1">'offline'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1682.1">Add the Debug Value Hook, as follows:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-title"><span class="koboSpan" id="kobo.1683.1">useDebugValue</span></span><span class="koboSpan" id="kobo.1684.1">(status)
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1685.1">Return the status from the Hook:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1686.1">return</span></span><span class="koboSpan" id="kobo.1687.1"> status
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1688.1">Adjust the component to use the custom Hook instead:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1689.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1690.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1691.1">OnlineIndicator</span></span><span class="koboSpan" id="kobo.1692.1">() {
</span><span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1693.1">const</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1694.1"> status = </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1695.1">useOnlineStatus</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1696.1">()</span></strong></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1697.1">return</span></span><span class="koboSpan" id="kobo.1698.1"> (
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1699.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1700.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1701.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1702.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1703.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1704.1">&gt;</span></span><span class="koboSpan" id="kobo.1705.1">OnlineIndicator</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1706.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1707.1">h3</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1708.1">&gt;</span></span><span class="koboSpan" id="kobo.1709.1">
      {status}
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1710.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1711.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1712.1">&gt;</span></span><span class="koboSpan" id="kobo.1713.1">
  )
}
</span></code></pre>
</li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.1714.1">Now, go to </span><a id="_idIndexMarker474"/><span class="koboSpan" id="kobo.1715.1">the </span><strong class="screenText"><span class="koboSpan" id="kobo.1716.1">Demo</span></strong><span class="koboSpan" id="kobo.1717.1"> page. </span><span class="koboSpan" id="kobo.1717.2">If you haven’t already installed </span><a id="_idIndexMarker475"/><span class="koboSpan" id="kobo.1718.1">the </span><strong class="keyWord"><span class="koboSpan" id="kobo.1719.1">React Developer Tools</span></strong><span class="koboSpan" id="kobo.1720.1"> extension, please install it for your browser (follow the instructions at </span><a href="https://react.dev/learn/react-developer-tools"><span class="url"><span class="koboSpan" id="kobo.1721.1">https://react.dev/learn/react-developer-tools</span></span></a><span class="koboSpan" id="kobo.1722.1">). </span><span class="koboSpan" id="kobo.1722.2">Go to the </span><strong class="screenText"><span class="koboSpan" id="kobo.1723.1">Components</span></strong><span class="koboSpan" id="kobo.1724.1"> tab in the inspector of </span><a id="_idIndexMarker476"/><span class="koboSpan" id="kobo.1725.1">your browser and select the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1726.1">OnlineIndicator</span></code><span class="koboSpan" id="kobo.1727.1"> component. </span></p>
<p class="normal"><span class="koboSpan" id="kobo.1728.1">You will see the debug value of the custom Hook being shown there:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1729.1"><img alt="Figure 9.8 – The status of our custom Hook being shown in the React Developer Tools" src="../Images/B31327_09_08.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1730.1">Figure 9.8 – The status of our custom Hook being shown in the React Developer Tools</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1731.1">After learning about the various built-in utility Hooks that React provides, let’s move on to learning about using built-in Hooks for performance optimizations.</span></p>
<h1 class="heading-1" id="_idParaDest-214"><span class="koboSpan" id="kobo.1732.1">Using Hooks for performance optimizatio</span><a id="_idTextAnchor233"/><span class="koboSpan" id="kobo.1733.1">ns</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.1734.1">Certain Hooks </span><a id="_idIndexMarker477"/><span class="koboSpan" id="kobo.1735.1">can be used to optimize the performance of your app. </span><span class="koboSpan" id="kobo.1735.2">Generally, the rule of thumb is to not optimize prematurely. </span><span class="koboSpan" id="kobo.1735.3">This is especially true with the React Compiler, introduced in React 19. </span><span class="koboSpan" id="kobo.1735.4">Nowadays, the React Compiler optimizes most cases for us automatically. </span><span class="koboSpan" id="kobo.1735.5">So, keep in mind to only use these Hooks when you have identified a specific performance problem with your app. </span><span class="koboSpan" id="kobo.1735.6">Generally, the rule of thumb is to not optimize prematurely unless you know it will be an expensive computation.</span></p>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.1736.1">The React Compiler </span><a id="_idIndexMarker478"/><span class="koboSpan" id="kobo.1737.1">is a Babel plugin that can be manually installed, and it also ships with certain frameworks, such as Next.js. </span><span class="koboSpan" id="kobo.1737.2">For more information on the React Compiler, please read </span><a id="_idIndexMarker479"/><span class="koboSpan" id="kobo.1738.1">the following page in the React docs: </span><a href="https://react.dev/learn/react-compiler"><span class="url"><span class="koboSpan" id="kobo.1739.1">https://react.dev/learn/react-compiler</span></span></a><span class="koboSpan" id="kobo.1740.1">.</span></p>
</div>
<h2 class="heading-2" id="_idParaDest-215"><a id="_idTextAnchor234"/><span class="koboSpan" id="kobo.1741.1">useDeferredValue</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1742.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.1743.1">Deferred Value Hook</span></strong><span class="koboSpan" id="kobo.1744.1"> can be </span><a id="_idIndexMarker480"/><span class="koboSpan" id="kobo.1745.1">used to defer low-priority updates (such as filtering a list) so that higher-priority updates (such as updating the text entered in an input field) can be processed first.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1746.1">For example, if you </span><a id="_idIndexMarker481"/><span class="koboSpan" id="kobo.1747.1">have a search where text can be entered to filter items, the Deferred Value Hook can </span><a id="_idIndexMarker482"/><span class="koboSpan" id="kobo.1748.1">be used to defer updates to the filter. </span><span class="koboSpan" id="kobo.1748.2">Unlike debouncing, where we set a fixed time after which updates are persisted, deferring is dynamic and dependent on how fast the UI can be rendered. </span><span class="koboSpan" id="kobo.1748.3">On faster machines, it will update more frequently, while on slower machines, updates will not slow down the rest of the UI.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1749.1">The signature of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1750.1">useDeferredValue</span></code><span class="koboSpan" id="kobo.1751.1"> function looks as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1752.1">const</span></span><span class="koboSpan" id="kobo.1753.1"> deferredValue = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1754.1">useDeferredValue</span></span><span class="koboSpan" id="kobo.1755.1">(value, initialValue)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1756.1">The first parameter is a value to be deferred. </span><span class="koboSpan" id="kobo.1756.2">For example, this value can be from a State Hook that handles user input.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1757.1">The second parameter is an optional initial value used for the initial render of the component. </span><span class="koboSpan" id="kobo.1757.2">If no initial value is defined, the Hook will not defer during the initial render because there is no value that it can render until </span><code class="inlineCode"><span class="koboSpan" id="kobo.1758.1">value</span></code><span class="koboSpan" id="kobo.1759.1"> gets set (for example, by the user typing into an input field).</span></p>
<h3 class="heading-3" id="_idParaDest-216"><a id="_idTextAnchor235"/><span class="koboSpan" id="kobo.1760.1">Implementing a search without deferred values</span></h3>
<p class="normal"><span class="koboSpan" id="kobo.1761.1">Let’s </span><a id="_idIndexMarker483"/><span class="koboSpan" id="kobo.1762.1">first implement a </span><a id="_idIndexMarker484"/><span class="koboSpan" id="kobo.1763.1">search page where blog posts are searched, without using deferred values:</span></p>
<ol>
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1764.1">Edit </span><code class="inlineCode"><span class="koboSpan" id="kobo.1765.1">src/api.js</span></code><span class="koboSpan" id="kobo.1766.1"> and define a function to produce an artificial delay, so that we can simulate the search operation being slow:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1767.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1768.1">sleep</span></span><span class="koboSpan" id="kobo.1769.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1770.1">ms</span></span><span class="koboSpan" id="kobo.1771.1">) {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1772.1">return</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1773.1">new</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1774.1">Promise</span></span><span class="koboSpan" id="kobo.1775.1">(</span><span class="hljs-function"><span class="koboSpan" id="kobo.1776.1">(</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.1777.1">resolve</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1778.1">) =&gt;</span></span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.1779.1">setTimeout</span></span><span class="koboSpan" id="kobo.1780.1">(resolve, ms))
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1781.1">Next, define a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1782.1">sea</span><a id="_idTextAnchor236"/><span class="koboSpan" id="kobo.1783.1">rchPosts</span></code><span class="koboSpan" id="kobo.1784.1"> API function, which fetches all posts (featured and non-featured):
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1785.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1786.1">async</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1787.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1788.1">searchPosts</span></span><span class="koboSpan" id="kobo.1789.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1790.1">query</span></span><span class="koboSpan" id="kobo.1791.1">) {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1792.1">const</span></span><span class="koboSpan" id="kobo.1793.1"> res = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1794.1">await</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1795.1">fetch</span></span><span class="koboSpan" id="kobo.1796.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1797.1">'/api/posts'</span></span><span class="koboSpan" id="kobo.1798.1">)
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1799.1">const</span></span><span class="koboSpan" id="kobo.1800.1"> posts = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1801.1">await</span></span><span class="koboSpan" id="kobo.1802.1"> res.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1803.1">json</span></span><span class="koboSpan" id="kobo.1804.1">()
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1805.1">Then, filter the posts using a simple search (making both the title and query lowercase and then checking whether the query is included in the title):
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1806.1">const</span></span><span class="koboSpan" id="kobo.1807.1"> filteredPosts = posts.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1808.1">filter</span></span><span class="koboSpan" id="kobo.1809.1">(</span><span class="hljs-function"><span class="koboSpan" id="kobo.1810.1">(</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.1811.1">post</span></span><span class="hljs-function"><span class="koboSpan" id="kobo.1812.1">) =&gt;</span></span><span class="koboSpan" id="kobo.1813.1"> {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1814.1">const</span></span><span class="koboSpan" id="kobo.1815.1"> title = post.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1816.1">title</span></span><span class="koboSpan" id="kobo.1817.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1818.1">toLowerCase</span></span><span class="koboSpan" id="kobo.1819.1">()
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1820.1">return</span></span><span class="koboSpan" id="kobo.1821.1"> title.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1822.1">includes</span></span><span class="koboSpan" id="kobo.1823.1">(query.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1824.1">toLowerCase</span></span><span class="koboSpan" id="kobo.1825.1">())
  })
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1826.1">Add </span><a id="_idIndexMarker485"/><span class="koboSpan" id="kobo.1827.1">an artificial delay of one second:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1828.1">await</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1829.1">sleep</span></span><span class="koboSpan" id="kobo.1830.1">(</span><span class="hljs-number"><span class="koboSpan" id="kobo.1831.1">1000</span></span><span class="koboSpan" id="kobo.1832.1">)
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1833.1">Then, return </span><a id="_idIndexMarker486"/><span class="koboSpan" id="kobo.1834.1">the filtered posts:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1835.1">return</span></span><span class="koboSpan" id="kobo.1836.1"> filteredPosts
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1837.1">Create a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.1838.1">src</span><a id="_idTextAnchor237"/><span class="koboSpan" id="kobo.1839.1">/components/post/PostSearchResults.jsx</span></code><span class="koboSpan" id="kobo.1840.1"> file. </span><span class="koboSpan" id="kobo.1840.2">Inside it, import the following:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1841.1">import</span></span><span class="koboSpan" id="kobo.1842.1"> { useSuspenseQuery } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1843.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1844.1">'@tanstack/react-query'</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1845.1">import</span></span><span class="koboSpan" id="kobo.1846.1"> { searchPosts } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1847.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1848.1">'@/api.js'</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1849.1">import</span></span><span class="koboSpan" id="kobo.1850.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1851.1">PostList</span></span><span class="koboSpan" id="kobo.1852.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1853.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1854.1">'./PostList.jsx'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1855.1">Now, define a component that will display the search results for a given query using the Suspense Query Hook, our API function, and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1856.1">PostList</span></code><span class="koboSpan" id="kobo.1857.1"> component:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1858.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1859.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1860.1">PostSearchResults</span></span><span class="koboSpan" id="kobo.1861.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1862.1">{ query }</span></span><span class="koboSpan" id="kobo.1863.1">) {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1864.1">const</span></span><span class="koboSpan" id="kobo.1865.1"> { data } = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1866.1">useSuspenseQuery</span></span><span class="koboSpan" id="kobo.1867.1">({
    </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1868.1">queryKey</span></span><span class="koboSpan" id="kobo.1869.1">: [</span><span class="hljs-string"><span class="koboSpan" id="kobo.1870.1">'posts'</span></span><span class="koboSpan" id="kobo.1871.1">, query],
    </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1872.1">queryFn</span></span><span class="koboSpan" id="kobo.1873.1">: </span><span class="hljs-function"><span class="koboSpan" id="kobo.1874.1">() =&gt;</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1875.1">searchPosts</span></span><span class="koboSpan" id="kobo.1876.1">(query),
  })
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1877.1">return</span></span> <span class="hljs-tag"><span class="koboSpan" id="kobo.1878.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1879.1">PostList</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1880.1">posts</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1881.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1882.1">{data}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1883.1"> /&gt;</span></span><span class="koboSpan" id="kobo.1884.1">
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1885.1">Next, create a </span><a id="_idTextAnchor238"/><span class="koboSpan" id="kobo.1886.1">new </span><code class="inlineCode"><span class="koboSpan" id="kobo.1887.1">src/components/post/PostSearch.jsx</span></code><span class="koboSpan" id="kobo.1888.1"> file. </span><span class="koboSpan" id="kobo.1888.2">Inside it, import the following:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1889.1">import</span></span><span class="koboSpan" id="kobo.1890.1"> { useState, </span><span class="hljs-title"><span class="koboSpan" id="kobo.1891.1">Suspense</span></span><span class="koboSpan" id="kobo.1892.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1893.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1894.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1895.1">react'</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1896.1">import</span></span><span class="koboSpan" id="kobo.1897.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1898.1">PostSearchResults</span></span><span class="koboSpan" id="kobo.1899.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1900.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1901.1">'./PostSearchResults.jsx'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1902.1">Define a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1903.1">PostSearch</span></code><span class="koboSpan" id="kobo.1904.1"> component </span><a id="_idIndexMarker487"/><span class="koboSpan" id="kobo.1905.1">that uses a State Hook and an input field to handle the query:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1906.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1907.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1908.1">PostSearch</span></span><span class="koboSpan" id="kobo.1909.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1910.1">const</span></span><span class="koboSpan" id="kobo.1911.1"> [query, setQuery] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1912.1">useState</span></span><span class="koboSpan" id="kobo.1913.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1914.1">''</span></span><span class="koboSpan" id="kobo.1915.1">)
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1916.1">return</span></span><span class="koboSpan" id="kobo.1917.1"> (
    &lt;div&gt;
      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1918.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1919.1">input</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1920.1">value</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1921.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1922.1">{query}</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1923.1">onChange</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1924.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1925.1">{(e)</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1926.1"> =&gt;</span></span><span class="koboSpan" id="kobo.1927.1">setQuery(e.target.value)} /&gt;
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1928.1">Define </span><a id="_idIndexMarker488"/><span class="koboSpan" id="kobo.1929.1">a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1930.1">Suspense</span></code><span class="koboSpan" id="kobo.1931.1"> boundary and, inside it, render the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1932.1">PostSearchResults</span></code><span class="koboSpan" id="kobo.1933.1"> component:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-tag"><span class="koboSpan" id="kobo.1934.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1935.1">Suspense</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1936.1">fallback</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1937.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1938.1">{</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1939.1">&lt;</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.1940.1">h4</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1941.1">&gt;</span></span><span class="koboSpan" id="kobo.1942.1">loading...</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1943.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1944.1">h4</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1945.1">&gt;</span></span><span class="koboSpan" id="kobo.1946.1">}&gt;
        </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1947.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1948.1">PostSearchResults</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1949.1">query</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1950.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1951.1">{query}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1952.1"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1953.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1954.1">Suspense</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1955.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1956.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1957.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1958.1">&gt;</span></span><span class="koboSpan" id="kobo.1959.1">
  )
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1960.1">Crea</span><a id="_idTextAnchor239"/><span class="koboSpan" id="kobo.1961.1">te a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.1962.1">src/pages/Search.jsx</span></code><span class="koboSpan" id="kobo.1963.1"> file. </span><span class="koboSpan" id="kobo.1963.2">Inside it, import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1964.1">PostSearch</span></code><span class="koboSpan" id="kobo.1965.1"> component:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1966.1">import</span></span><span class="koboSpan" id="kobo.1967.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1968.1">PostSearch</span></span><span class="koboSpan" id="kobo.1969.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1970.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1971.1">'@/components/post/PostSearch.jsx'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1972.1">Render a page with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1973.1">PostSearch</span></code><span class="koboSpan" id="kobo.1974.1"> component, as follows:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1975.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1976.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1977.1">Search</span></span><span class="koboSpan" id="kobo.1978.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1979.1">return</span></span><span class="koboSpan" id="kobo.1980.1"> (
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1981.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1982.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1983.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1984.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1985.1">h1</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1986.1">&gt;</span></span><span class="koboSpan" id="kobo.1987.1">Search posts</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1988.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1989.1">h1</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1990.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1991.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1992.1">PostSearch</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1993.1"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1994.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1995.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1996.1">&gt;</span></span><span class="koboSpan" id="kobo.1997.1">
  )
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1998.1">Edit </span><code class="inlineCode"><span class="koboSpan" id="kobo.1999.1">src/App.jsx</span></code><span class="koboSpan" id="kobo.2000.1"> and import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2001.1">Search</span></code><span class="koboSpan" id="kobo.2002.1"> page:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2003.1">import</span></span><span class="koboSpan" id="kobo.2004.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.2005.1">Search</span></span><span class="koboSpan" id="kobo.2006.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2007.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2008.1">'./pages/Search.jsx'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2009.1">Add </span><a id="_idIndexMarker489"/><span class="koboSpan" id="kobo.2010.1">a link to </span><a id="_idIndexMarker490"/><span class="koboSpan" id="kobo.2011.1">the page, as follows:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="koboSpan" id="kobo.2012.1">          &lt;</span><span class="hljs-title"><span class="koboSpan" id="kobo.2013.1">BrowserRouter</span></span><span class="koboSpan" id="kobo.2014.1">&gt;
            </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2015.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2016.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2017.1">style</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2018.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2019.1">{{</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2020.1">padding:</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2021.1">8</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2022.1"> }}&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2023.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2024.1">NavBarLink</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2025.1">to</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2026.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2027.1">'/'</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2028.1">&gt;</span></span><span class="koboSpan" id="kobo.2029.1">Home</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2030.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2031.1">NavBarLink</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2032.1">&gt;</span></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2033.1">              {' | '}</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2034.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2035.1">NavBarLink</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2036.1">to</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2037.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2038.1">'/search'</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2039.1">&gt;</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2040.1">Search</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2041.1">&lt;/</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2042.1">NavBarLink</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2043.1">&gt;</span></strong></span><span class="koboSpan" id="kobo.2044.1">
              {' | '}
              </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2045.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2046.1">NavBarLink</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2047.1">to</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2048.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2049.1">'/demo'</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2050.1">&gt;</span></span><span class="koboSpan" id="kobo.2051.1">Demo</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2052.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2053.1">NavBarLink</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2054.1">&gt;</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2055.1">Finally, define the route:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="koboSpan" id="kobo.2056.1">                    &lt;</span><span class="hljs-title"><span class="koboSpan" id="kobo.2057.1">Routes</span></span><span class="koboSpan" id="kobo.2058.1">&gt;
                      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2059.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2060.1">Route</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2061.1">index</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2062.1">element</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2063.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2064.1">{</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2065.1">&lt;</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2066.1">Home</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2067.1"> /&gt;</span></span><span class="koboSpan" id="kobo.2068.1">} /&gt;
                      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2069.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2070.1">Route</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2071.1">path</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2072.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2073.1">'post/:id'</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2074.1">element</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2075.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2076.1">{</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2077.1">&lt;</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2078.1">ViewPost</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2079.1"> /&gt;</span></span><span class="koboSpan" id="kobo.2080.1">} /&gt;
                      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2081.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2082.1">Route</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2083.1">path</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2084.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2085.1">'demo'</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2086.1">element</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2087.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2088.1">{</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2089.1">&lt;</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2090.1">Demo</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2091.1"> /&gt;</span></span><span class="koboSpan" id="kobo.2092.1">} /&gt;
</span><span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2093.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2094.1">Route</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2095.1">path</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2096.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2097.1">'search'</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2098.1">element</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2099.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2100.1">{</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2101.1">&lt;</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2102.1">Search</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2103.1"> /&gt;</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2104.1">} /&gt;</span></strong></span><span class="koboSpan" id="kobo.2105.1">
                    &lt;/</span><span class="hljs-title"><span class="koboSpan" id="kobo.2106.1">Routes</span></span><span class="koboSpan" id="kobo.2107.1">&gt;
</span></code></pre>
</li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.2108.1">Now go to the </span><strong class="screenText"><span class="koboSpan" id="kobo.2109.1">Search</span></strong><span class="koboSpan" id="kobo.2110.1"> page and enter a query into the search; you will see that it shows </span><strong class="screenText"><span class="koboSpan" id="kobo.2111.1">loading…</span></strong><span class="koboSpan" id="kobo.2112.1"> for a second before showing the new results.</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2113.1"><img alt="Figure 9.9 – Waiting for the new results to load" src="../Images/B31327_09_09.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2114.1">Figure 9.9 – Waiting for the new results to load</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2115.1">While this </span><a id="_idIndexMarker491"/><span class="koboSpan" id="kobo.2116.1">search works, it’s not a great </span><a id="_idIndexMarker492"/><span class="koboSpan" id="kobo.2117.1">user experience to replace all results with a </span><strong class="screenText"><span class="koboSpan" id="kobo.2118.1">loading…</span></strong><span class="koboSpan" id="kobo.2119.1"> message while the user is typing a query.</span></p>
<h3 class="heading-3" id="_idParaDest-217"><a id="_idTextAnchor240"/><span class="koboSpan" id="kobo.2120.1">Introducing deferred values</span></h3>
<p class="normal"><span class="koboSpan" id="kobo.2121.1">With the Deferred Value Hook, we can improve this behavior by showing the old query results while the </span><a id="_idIndexMarker493"/><span class="koboSpan" id="kobo.2122.1">new results are being fetched, and then seamlessly replace them with the new results once they are ready.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2123.1">Let’s get started using the Deferred Value Hook now:</span></p>
<ol>
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.2124.1">Edit </span><code class="inlineCode"><span class="koboSpan" id="kobo.2125.1">src/components/post/PostSearch.jsx</span></code><span class="koboSpan" id="kobo.2126.1"> and import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2127.1">useDeferredValue</span></code><span class="koboSpan" id="kobo.2128.1"> function:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2129.1">import</span></span><span class="koboSpan" id="kobo.2130.1"> { useState, </span><span class="hljs-title"><span class="koboSpan" id="kobo.2131.1">Suspense</span></span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2132.1">, useDeferredValue</span></strong></span><span class="koboSpan" id="kobo.2133.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2134.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2135.1">'react'</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2136.1">Define the Deferred Value Hook inside the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2137.1">PostSearch</span></code><span class="koboSpan" id="kobo.2138.1"> component:
        </span><pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2139.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2140.1">function</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2141.1">PostSearch</span></span><span class="koboSpan" id="kobo.2142.1">() {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2143.1">const</span></span><span class="koboSpan" id="kobo.2144.1"> [query, setQuery] = </span><span class="hljs-title"><span class="koboSpan" id="kobo.2145.1">useState</span></span><span class="koboSpan" id="kobo.2146.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.2147.1">''</span></span><span class="koboSpan" id="kobo.2148.1">)
</span><span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.2149.1">const</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2150.1"> deferredQuery = </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2151.1">useDeferredValue</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2152.1">(query)</span></strong></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2153.1">Now, replace the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2154.1">query</span></code><span class="koboSpan" id="kobo.2155.1"> for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2156.1">SearchResults</span></code><span class="koboSpan" id="kobo.2157.1"> component with </span><code class="inlineCode"><span class="koboSpan" id="kobo.2158.1">deferredQuery</span></code><span class="koboSpan" id="kobo.2159.1">:
        </span><pre class="programlisting code-one"><code class="hljs-code"> <span class="hljs-tag"><span class="koboSpan" id="kobo.2160.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2161.1">Suspense</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2162.1">fallback</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2163.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2164.1">{</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2165.1">&lt;</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2166.1">h4</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2167.1">&gt;</span></span><span class="koboSpan" id="kobo.2168.1">loading...</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2169.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2170.1">h4</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2171.1">&gt;</span></span><span class="koboSpan" id="kobo.2172.1">}&gt;
        </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2173.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2174.1">SearchResults</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2175.1">query</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2176.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2177.1">{</span></span><span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2178.1">deferredQuery</span></strong></span><span class="hljs-string"><span class="koboSpan" id="kobo.2179.1">}</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2180.1"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2181.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2182.1">Suspense</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2183.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2184.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2185.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2186.1">&gt;</span></span><span class="koboSpan" id="kobo.2187.1">
  )
}
</span></code></pre>
</li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.2188.1">Go to the </span><strong class="screenText"><span class="koboSpan" id="kobo.2189.1">Search</span></strong><span class="koboSpan" id="kobo.2190.1"> page and enter a query into the search input field; you will see that the previous results </span><a id="_idIndexMarker494"/><span class="koboSpan" id="kobo.2191.1">are shown until the new results come in. </span><span class="koboSpan" id="kobo.2191.2">The </span><strong class="screenText"><span class="koboSpan" id="kobo.2192.1">loading…</span></strong><span class="koboSpan" id="kobo.2193.1"> message is now only displayed initially before the first query is entered!</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2194.1"><img alt="Figure 9.10 – Showing stale results while the new results are loading" src="../Images/B31327_09_10.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2195.1">Figure 9.10 – Showing stale results while the new results are loading</span></p>
<h2 class="heading-2" id="_idParaDest-218"><a id="_idTextAnchor241"/><span class="koboSpan" id="kobo.2196.1">useMemo</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2197.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.2198.1">Memo Hook</span></strong><span class="koboSpan" id="kobo.2199.1"> takes the </span><a id="_idIndexMarker495"/><span class="koboSpan" id="kobo.2200.1">result of a function and memoizes it. </span><span class="koboSpan" id="kobo.2200.2">This means that it will </span><a id="_idIndexMarker496"/><span class="koboSpan" id="kobo.2201.1">not be recomputed every time. </span><span class="koboSpan" id="kobo.2201.2">This Hook can be used for performance optimizations:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2202.1">const</span></span><span class="koboSpan" id="kobo.2203.1"> memoizedVal = </span><span class="hljs-title"><span class="koboSpan" id="kobo.2204.1">useMemo</span></span><span class="koboSpan" id="kobo.2205.1">(
  </span><span class="hljs-function"><span class="koboSpan" id="kobo.2206.1">() =&gt;</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2207.1">computeVal</span></span><span class="koboSpan" id="kobo.2208.1">(a, b, c),
  [a, b, c]
)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2209.1">In the </span><a id="_idIndexMarker497"/><span class="koboSpan" id="kobo.2210.1">previous example, </span><code class="inlineCode"><span class="koboSpan" id="kobo.2211.1">computeVal</span></code><span class="koboSpan" id="kobo.2212.1"> is a performance-heavy function that computes a result from </span><code class="inlineCode"><span class="koboSpan" id="kobo.2213.1">a</span></code><span class="koboSpan" id="kobo.2214.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.2215.1">b</span></code><span class="koboSpan" id="kobo.2216.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.2217.1">c</span></code><span class="koboSpan" id="kobo.2218.1">.</span></p>
<div class="note">
<p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.2219.1">useMemo</span></code><span class="koboSpan" id="kobo.2220.1"> runs during rendering, so make sure the computation function does not cause any side effects, such as resource requests. </span><span class="koboSpan" id="kobo.2220.2">Side effects should be put into a </span><code class="inlineCode"><span class="koboSpan" id="kobo.2221.1">useEffect</span></code><span class="koboSpan" id="kobo.2222.1"> Hook.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.2223.1">The array passed as the second argument specifies the dependencies of the function. </span><span class="koboSpan" id="kobo.2223.2">If any of these values change, the function will be recomputed; otherwise, the stored result will be used. </span><span class="koboSpan" id="kobo.2223.3">If no array is provided, a new value will be computed on every render. </span><span class="koboSpan" id="kobo.2223.4">If an empty array is passed, the value will only be computed once.</span></p>
<div class="packt_tip">
<p class="normal"><span class="koboSpan" id="kobo.2224.1">Do not rely on </span><code class="inlineCode"><span class="koboSpan" id="kobo.2225.1">useMemo</span></code><span class="koboSpan" id="kobo.2226.1"> to only compute things once. </span><span class="koboSpan" id="kobo.2226.2">React may forget some previously memoized values if they are not used for a long time, for example, to free up memory. </span><span class="koboSpan" id="kobo.2226.3">Use it only for performance optimizations.</span></p>
</div>
<p class="normal"><span class="koboSpan" id="kobo.2227.1">Since React 19, the React Compiler attempts to memoize values as much as possible automatically. </span><span class="koboSpan" id="kobo.2227.2">In most cases, it should not be necessary to manually wrap values with </span><code class="inlineCode"><span class="koboSpan" id="kobo.2228.1">useMemo</span></code><span class="koboSpan" id="kobo.2229.1"> anymore. </span><span class="koboSpan" id="kobo.2229.2">Only use this Hook if you find a performance problem that the React Compiler does not memoize in a satisfying way. </span><span class="koboSpan" id="kobo.2229.3">As a rule of thumb, try not to prematurely optimize your components, and do not use Memo Hooks unless you have a very good reason for doing so.</span></p>
<h2 class="heading-2" id="_idParaDest-219"><a id="_idTextAnchor242"/><span class="koboSpan" id="kobo.2230.1">useCallback</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2231.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.2232.1">useCallback</span></code><span class="koboSpan" id="kobo.2233.1"> Hook works </span><a id="_idIndexMarker498"/><span class="koboSpan" id="kobo.2234.1">similarly to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2235.1">useMemo</span></code><span class="koboSpan" id="kobo.2236.1"> Hook. </span><span class="koboSpan" id="kobo.2236.2">However, it returns a </span><a id="_idIndexMarker499"/><span class="koboSpan" id="kobo.2237.1">memoized callback function instead of a value:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2238.1">const</span></span><span class="koboSpan" id="kobo.2239.1"> memoizedCallback = </span><span class="hljs-title"><span class="koboSpan" id="kobo.2240.1">useCallback</span></span><span class="koboSpan" id="kobo.2241.1">(
  </span><span class="hljs-function"><span class="koboSpan" id="kobo.2242.1">() =&gt;</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2243.1">doSomething</span></span><span class="koboSpan" id="kobo.2244.1">(a, b, c),
  [a, b, c]
)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2245.1">The previous code is similar to the following </span><code class="inlineCode"><span class="koboSpan" id="kobo.2246.1">useMemo</span></code><span class="koboSpan" id="kobo.2247.1"> Hook:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2248.1">const</span></span><span class="koboSpan" id="kobo.2249.1"> memoizedCallback = </span><span class="hljs-title"><span class="koboSpan" id="kobo.2250.1">useMemo</span></span><span class="koboSpan" id="kobo.2251.1">(
  </span><span class="hljs-function"><span class="koboSpan" id="kobo.2252.1">() =&gt;</span></span> <span class="hljs-function"><span class="koboSpan" id="kobo.2253.1">() =&gt;</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2254.1">doSomething</span></span><span class="koboSpan" id="kobo.2255.1">(a, b, c),
  [a, b, c]
)
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2256.1">The function returned will only be redefined if one of the values passed in the dependency array changes.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2257.1">Similarly to the Memo Hook, the Callback Hook should only be used if you have identified a specific performance problem that the React Compiler does not handle in a satisfying way, such as infinite re-render loops or too many renders.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2258.1">Now that we have learned about using built-in Hooks for performance optimization, let’s briefly cover the final few built-in Hooks provided by React: advanced versions of the Effect Hook.</span></p>
<h1 class="heading-1" id="_idParaDest-220"><a id="_idTextAnchor243"/><span class="koboSpan" id="kobo.2259.1">Using Hooks for advanced effects</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.2260.1">There are </span><a id="_idIndexMarker500"/><span class="koboSpan" id="kobo.2261.1">two special versions of the Effect Hook: the </span><strong class="keyWord"><span class="koboSpan" id="kobo.2262.1">Layout Effect Hook</span></strong><span class="koboSpan" id="kobo.2263.1"> and </span><a id="_idIndexMarker501"/><span class="koboSpan" id="kobo.2264.1">the </span><strong class="keyWord"><span class="koboSpan" id="kobo.2265.1">Insertion Effect Hook</span></strong><span class="koboSpan" id="kobo.2266.1">. </span><span class="koboSpan" id="kobo.2266.2">These are only needed </span><a id="_idIndexMarker502"/><span class="koboSpan" id="kobo.2267.1">for very specific use cases, so we are only briefly covering them here.</span></p>
<h2 class="heading-2" id="_idParaDest-221"><a id="_idTextAnchor244"/><span class="koboSpan" id="kobo.2268.1">useLayoutEffect</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2269.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.2270.1">Layout </span></strong><strong class="keyWord"><a id="_idIndexMarker503"/></strong><strong class="keyWord"><span class="koboSpan" id="kobo.2271.1">Effect Hook</span></strong><span class="koboSpan" id="kobo.2272.1"> is identical to the Effect Hook, but it </span><a id="_idIndexMarker504"/><span class="koboSpan" id="kobo.2273.1">fires synchronously after all DOM mutations are completed and before the component is rendered in the browser. </span><span class="koboSpan" id="kobo.2273.2">It can be used to read information from the DOM and adjust the appearance of components before rendering. </span><span class="koboSpan" id="kobo.2273.3">Updates inside this Hook will be processed synchronously before the browser renders the component.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2274.1">Do not use this Hook unless it is really needed, which is only in certain edge cases. </span><code class="inlineCode"><span class="koboSpan" id="kobo.2275.1">useLayoutEffect</span></code><span class="koboSpan" id="kobo.2276.1"> will block visual updates in the browser, and thus, is slower than </span><code class="inlineCode"><span class="koboSpan" id="kobo.2277.1">useEffect</span></code><span class="koboSpan" id="kobo.2278.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2279.1">The rule </span><a id="_idIndexMarker505"/><span class="koboSpan" id="kobo.2280.1">here is to use </span><code class="inlineCode"><span class="koboSpan" id="kobo.2281.1">useEffect</span></code><span class="koboSpan" id="kobo.2282.1"> first. </span><span class="koboSpan" id="kobo.2282.2">If your mutation </span><a id="_idIndexMarker506"/><span class="koboSpan" id="kobo.2283.1">changes the appearance of the DOM node, which can cause it to flicker, you should use </span><code class="inlineCode"><span class="koboSpan" id="kobo.2284.1">useLayoutEffect</span></code><span class="koboSpan" id="kobo.2285.1"> instead.</span></p>
<h2 class="heading-2" id="_idParaDest-222"><a id="_idTextAnchor245"/><span class="koboSpan" id="kobo.2286.1">useInsertionEffect</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2287.1">The </span><strong class="keyWord"><span class="koboSpan" id="kobo.2288.1">Insertion Effect Hook</span></strong><span class="koboSpan" id="kobo.2289.1"> is similar to the Effect Hook, but it fires before any layout effects fire. </span><span class="koboSpan" id="kobo.2289.2">This Hook </span><a id="_idIndexMarker507"/><span class="koboSpan" id="kobo.2290.1">is intended to be used only by CSS-in-JS library authors, so you </span><a id="_idIndexMarker508"/><span class="koboSpan" id="kobo.2291.1">will most likely not need it.</span></p>
<div class="note">
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.2292.1">Example code</span></strong></p>
<p class="normal"><span class="koboSpan" id="kobo.2293.1">The example code for this chapter can be found in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2294.1">Chapter09/Chapter09_1</span></code><span class="koboSpan" id="kobo.2295.1"> folder. </span><span class="koboSpan" id="kobo.2295.2">Check the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2296.1">README.md</span></code><span class="koboSpan" id="kobo.2297.1"> file inside the folder for instructions on how to set up and run the example.</span></p>
</div>
<h1 class="heading-1" id="_idParaDest-223"><a id="_idTextAnchor246"/><span class="koboSpan" id="kobo.2298.1">Summary</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.2299.1">In this chapter, we learned about all Hooks provided by React as of version 19.1. </span><span class="koboSpan" id="kobo.2299.2">We started by giving an overview of the built-in Hooks and then learned about various utility Hooks. </span><span class="koboSpan" id="kobo.2299.3">Next, we moved on to learning about Hooks for performance optimization. </span><span class="koboSpan" id="kobo.2299.4">Finally, we learned about advanced Effect Hooks.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2300.1">We now have an overview of all the different built-in Hooks that React provides.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2301.1">In the next chapter, we are going to learn about using various Hooks developed by the React community, as well as where to find more of them.</span></p>
<h1 class="heading-1" id="_idParaDest-224"><a id="_idTextAnchor247"/><span class="koboSpan" id="kobo.2302.1">Questions</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.2303.1">To recap what we have learned in this chapter, try to answer the following questions:</span></p>
<ol>
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.2304.1">What are the different use cases of the Ref Hook?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2305.1">Which functionality does the Imperative Handle Hook add?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2306.1">When should we use the Id Hook?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2307.1">Which use case does the Sync External Store Hook cover?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2308.1">How can we use the Debug Value Hook?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2309.1">What advantages does using the Deferred Value Hook give us?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2310.1">When should we use Memo and Callback Hooks?</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2311.1">In most cases, is it still necessary to use Memo and Callback Hooks?</span></li>
</ol>
<h1 class="heading-1" id="_idParaDest-225"><a id="_idTextAnchor248"/><span class="koboSpan" id="kobo.2312.1">Further reading</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.2313.1">If you are interested in more information about the concepts that we have learned in th</span><a id="_idTextAnchor249"/><span class="koboSpan" id="kobo.2314.1">is chapter, take a look at the following links:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.2315.1">The Built-in React Hooks section of the React docs: </span><a href="https://react.dev/reference/react/hooks"><span class="url"><span class="koboSpan" id="kobo.2316.1">https://react.dev/reference/react/hooks</span></span></a></li>
<li class="bulletList"><span class="koboSpan" id="kobo.2317.1">More information about the React Compiler: </span><a href="https://react.dev/learn/react-compiler"><span class="url"><span class="koboSpan" id="kobo.2318.1">https://react.dev/learn/react-compiler</span></span></a></li>
</ul>
<h1 class="heading-1"><span class="koboSpan" id="kobo.2319.1">Learn more on Discord</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.2320.1">To join the Discord community for this book – where you can share feedback, ask questions to the author, and learn about new releases – follow the QR code below:</span></p>
<p class="normal"><a href="Chapter_09.xhtml"><span class="url"><span class="koboSpan" id="kobo.2321.1">https://packt.link/wnXT0</span></span></a></p>
<p class="normal"><span class="koboSpan" id="kobo.2322.1"><img alt="" src="../Images/image_%283%29.png"/></span></p>
</div>
</body></html>
<html><head></head><body>
  <div class="Basic-Text-Frame" id="_idContainer354">
   <h1 class="chapterNumber">
    <span class="koboSpan" id="kobo.1.1">
     15
    </span>
   </h1>
   <h1 class="chapterTitle" id="_idParaDest-266">
    <span class="koboSpan" id="kobo.2.1">
     Optimizing Application Performance
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.3.1">
     As developers and technical professionals, we play a crucial role in building and deploying Angular applications, ensuring their continued performance and delivering a superior user experience.
    </span>
    <span class="koboSpan" id="kobo.3.2">
     Our efforts are instrumental in the success of our applications.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.4.1">
     The behavior of a web application and how it performs during runtime are key considerations for monitoring and optimization.
    </span>
    <span class="koboSpan" id="kobo.4.2">
     We should monitor and measure application performance in case our application starts to degrade.
    </span>
    <span class="koboSpan" id="kobo.4.3">
     One of the most popular metrics for identifying issues in web applications
    </span>
    <a id="_idIndexMarker883">
    </a>
    <span class="koboSpan" id="kobo.5.1">
     is
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.6.1">
      Core Web Vitals
     </span>
    </strong>
    <span class="koboSpan" id="kobo.7.1">
     (
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.8.1">
      CWV
     </span>
    </strong>
    <span class="koboSpan" id="kobo.9.1">
     ).
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.10.1">
     After determining the causes of degradation, we can apply various optimization techniques.
    </span>
    <span class="koboSpan" id="kobo.10.2">
     The Angular framework provides various tools for optimizing Angular applications, including
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.11.1">
      Server-Side Rendering
     </span>
    </strong>
    <span class="koboSpan" id="kobo.12.1">
     (
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.13.1">
      SSR
     </span>
    </strong>
    <span class="koboSpan" id="kobo.14.1">
     ), image optimization, and deferred view loading.
    </span>
    <span class="koboSpan" id="kobo.14.2">
     If we know that the application will be performance intensive beforehand, using any of the preceding tools is also highly encouraged early in development.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.15.1">
     In this chapter, we will explore the following Angular concepts regarding optimization:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.16.1">
      Introducing Core Web Vitals
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.17.1">
      Rendering SSR applications
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.18.1">
      Optimizing image loading
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.19.1">
      Deferring components
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.20.1">
      Prerendering SSG applications
     </span>
    </li>
   </ul>
   <h1 class="heading-1" id="_idParaDest-267">
    <span class="koboSpan" id="kobo.21.1">
     Technical requirements
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.22.1">
     The chapter contains various code samples to walk you through the concept of optimizing Angular applications.
    </span>
    <span class="koboSpan" id="kobo.22.2">
     You can find the related source code in the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.23.1">
      ch15
     </span>
    </code>
    <span class="koboSpan" id="kobo.24.1">
     folder of the following GitHub repository:
    </span>
   </p>
   <p class="normal">
    <a href="https://github.com/PacktPublishing/Learning-Angular-Fifth-Edition ">
     <span class="url">
      <span class="koboSpan" id="kobo.25.1">
       https://github.com/PacktPublishing/Learning-Angular-Fifth-Edition
      </span>
     </span>
    </a>
   </p>
   <h1 class="heading-1" id="_idParaDest-268">
    <span class="koboSpan" id="kobo.26.1">
     Introducing Core Web Vitals
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.27.1">
     CWV
    </span>
    <a id="_idIndexMarker884">
    </a>
    <span class="koboSpan" id="kobo.28.1">
     is a set of metrics that helps us measure the performance of a web application.
    </span>
    <span class="koboSpan" id="kobo.28.2">
     It is part of
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.29.1">
      Web Vitals
     </span>
    </strong>
    <span class="koboSpan" id="kobo.30.1">
     , an initiative led by Google that unifies various guides and tools for measuring performance on web pages.
    </span>
    <span class="koboSpan" id="kobo.30.2">
     Each metric focuses on a specific aspect of user experience, including the loading, interactivity, and visual stability of a web page:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.31.1">
       Largest Contentful Paint
      </span>
     </strong>
     <span class="koboSpan" id="kobo.32.1">
      (
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.33.1">
       LCP
      </span>
     </strong>
     <span class="koboSpan" id="kobo.34.1">
      ): This
     </span>
     <a id="_idIndexMarker885">
     </a>
     <span class="koboSpan" id="kobo.35.1">
      measures the load speed of a web page by calculating how long it takes for the largest element on the page to render.
     </span>
     <span class="koboSpan" id="kobo.35.2">
      A fast LCP
     </span>
     <a id="_idIndexMarker886">
     </a>
     <span class="koboSpan" id="kobo.36.1">
      value indicates that the page becomes available to the user quickly.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.37.1">
       Interaction to Next Paint
      </span>
     </strong>
     <span class="koboSpan" id="kobo.38.1">
      (
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.39.1">
       INP
      </span>
     </strong>
     <span class="koboSpan" id="kobo.40.1">
      ): This
     </span>
     <a id="_idIndexMarker887">
     </a>
     <span class="koboSpan" id="kobo.41.1">
      measures the responsiveness of a web page by calculating how long
     </span>
     <a id="_idIndexMarker888">
     </a>
     <span class="koboSpan" id="kobo.42.1">
      it takes to respond to user interactions and provide visual feedback.
     </span>
     <span class="koboSpan" id="kobo.42.2">
      A low INP value indicates that the page responds to the user quickly.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.43.1">
       Cumulative Layout Shift
      </span>
     </strong>
     <span class="koboSpan" id="kobo.44.1">
      (
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.45.1">
       CLS
      </span>
     </strong>
     <span class="koboSpan" id="kobo.46.1">
      ): This measures the stability of the UI on a web page by calculating how
     </span>
     <a id="_idIndexMarker889">
     </a>
     <span class="koboSpan" id="kobo.47.1">
      often unwanted layout shifts occur.
     </span>
     <span class="koboSpan" id="kobo.47.2">
      A layout shift usually happens when HTML elements are moved in the
     </span>
     <a id="_idIndexMarker890">
     </a>
     <span class="koboSpan" id="kobo.48.1">
      DOM due to dynamic or asynchronous loading.
     </span>
     <span class="koboSpan" id="kobo.48.2">
      A low CLS value indicates that the page is visually stable.
     </span>
     <div class="note">
      <p class="normal">
       <span class="koboSpan" id="kobo.49.1">
        Web Vitals contains additional metrics that contribute to the
       </span>
       <a id="_idIndexMarker891">
       </a>
       <span class="koboSpan" id="kobo.50.1">
        existing CWV set by measuring a
       </span>
       <a id="_idIndexMarker892">
       </a>
       <span class="koboSpan" id="kobo.51.1">
        wider or more niche area of UX, such as
       </span>
       <strong class="keyWord">
        <span class="koboSpan" id="kobo.52.1">
         First Contentful Paint
        </span>
       </strong>
       <span class="koboSpan" id="kobo.53.1">
        (
       </span>
       <strong class="keyWord">
        <span class="koboSpan" id="kobo.54.1">
         FCP
        </span>
       </strong>
       <span class="koboSpan" id="kobo.55.1">
        ) and
       </span>
       <strong class="keyWord">
        <span class="koboSpan" id="kobo.56.1">
         Time to First Byte
        </span>
       </strong>
       <span class="koboSpan" id="kobo.57.1">
        (
       </span>
       <strong class="keyWord">
        <span class="koboSpan" id="kobo.58.1">
         TTFB
        </span>
       </strong>
       <span class="koboSpan" id="kobo.59.1">
        ).
       </span>
      </p>
     </div>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.60.1">
     The value of each CWV metric falls into the following categories:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.61.1">
       GOOD
      </span>
     </strong>
     <span class="koboSpan" id="kobo.62.1">
      (green)
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.63.1">
       NEEDS IMPROVEMENT
      </span>
     </strong>
     <span class="koboSpan" id="kobo.64.1">
      (orange)
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.65.1">
       POOR
      </span>
     </strong>
     <span class="koboSpan" id="kobo.66.1">
      (red)
     </span>
    </li>
   </ul>
   <div class="note">
    <p class="normal">
     <span class="koboSpan" id="kobo.67.1">
      You can find out more about
     </span>
     <a id="_idIndexMarker893">
     </a>
     <span class="koboSpan" id="kobo.68.1">
      CWV categories and their thresholds at
     </span>
     <a href="https://web.dev/articles/vitals#core-web-vitals">
      <span class="url">
       <span class="koboSpan" id="kobo.69.1">
        https://web.dev/articles/vitals#core-web-vitals
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.70.1">
      .
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.71.1">
     We can measure CWV in the following ways:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.72.1">
       In the field
      </span>
     </strong>
     <span class="koboSpan" id="kobo.73.1">
      : We
     </span>
     <a id="_idIndexMarker894">
     </a>
     <span class="koboSpan" id="kobo.74.1">
      can use tools
     </span>
     <a id="_idIndexMarker895">
     </a>
     <span class="koboSpan" id="kobo.75.1">
      like
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.76.1">
       PageSpeed Insights
      </span>
     </strong>
     <span class="koboSpan" id="kobo.77.1">
      and
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.78.1">
       Chrome User Experience Report
      </span>
     </strong>
     <span class="koboSpan" id="kobo.79.1">
      while
     </span>
     <a id="_idIndexMarker896">
     </a>
     <span class="koboSpan" id="kobo.80.1">
      the web application runs in production.
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.81.1">
       Programmatically in JavaScript
      </span>
     </strong>
     <span class="koboSpan" id="kobo.82.1">
      : We can
     </span>
     <a id="_idIndexMarker897">
     </a>
     <span class="koboSpan" id="kobo.83.1">
      use standard web APIs or third-party libraries such as
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.84.1">
       web-vitals
      </span>
     </strong>
     <span class="koboSpan" id="kobo.85.1">
      .
     </span>
    </li>
    <li class="bulletList">
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.86.1">
       In the lab
      </span>
     </strong>
     <span class="koboSpan" id="kobo.87.1">
      : We can use tools such
     </span>
     <a id="_idIndexMarker898">
     </a>
     <span class="koboSpan" id="kobo.88.1">
      as
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.89.1">
       Chrome DevTools
      </span>
     </strong>
     <span class="koboSpan" id="kobo.90.1">
      and
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.91.1">
       Lighthouse
      </span>
     </strong>
     <span class="koboSpan" id="kobo.92.1">
      while
     </span>
     <a id="_idIndexMarker899">
     </a>
     <span class="koboSpan" id="kobo.93.1">
      building the web application during development.
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.94.1">
     In this chapter, we will learn how to use Chrome DevTools to measure the performance of our
    </span>
    <a id="_idIndexMarker900">
    </a>
    <span class="koboSpan" id="kobo.95.1">
     e-shop application:
    </span>
   </p>
   <ol>
    <li class="numberedList" value="1">
     <span class="koboSpan" id="kobo.96.1">
      Copy the source code from
     </span>
     <em class="chapterRef">
      <span class="koboSpan" id="kobo.97.1">
       Chapter 12
      </span>
     </em>
     <span class="koboSpan" id="kobo.98.1">
      ,
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.99.1">
       Introduction to Angular Material
      </span>
     </em>
     <span class="koboSpan" id="kobo.100.1">
      , into a new folder.
     </span>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.101.1">
      Run the following command inside the new folder to install package dependencies:
     </span>
     <pre class="programlisting con-one"><code class="hljs-con"><span class="koboSpan" id="kobo.102.1">npm install
</span></code></pre>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.103.1">
      Run the following command to start the Angular application:
     </span>
     <pre class="programlisting con-one"><code class="hljs-con"><span class="koboSpan" id="kobo.104.1">ng serve
</span></code></pre>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.105.1">
      Open
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.106.1">
       Google Chrome
      </span>
     </strong>
     <span class="koboSpan" id="kobo.107.1">
      and navigate to
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.108.1">
       http://localhost:4200
      </span>
     </code>
     <span class="koboSpan" id="kobo.109.1">
      .
     </span>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.110.1">
      Toggle the developer tools and select the
     </span>
     <strong class="screenText">
      <span class="koboSpan" id="kobo.111.1">
       Lighthouse
      </span>
     </strong>
     <span class="koboSpan" id="kobo.112.1">
      tab.
     </span>
     <span class="koboSpan" id="kobo.112.2">
      Lighthouse is a tool for measuring various performance aspects of a web page, including CWV.
     </span>
     <span class="koboSpan" id="kobo.112.3">
      Google Chrome has an embedded version of Lighthouse that we can use to benchmark our application:
     </span>
    </li>
   </ol>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.113.1">
     <img alt="Εικόνα που περιέχει κείμενο, στιγμιότυπο οθόνης, λογισμικό, εικονίδιο υπολογιστή  Περιγραφή που δημιουργήθηκε αυτόματα" src="../Images/B21418_15_01.png"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.114.1">
     Figure 15.1: Lighthouse tab
    </span>
   </p>
   <p class="normal-one">
    <span class="koboSpan" id="kobo.115.1">
     On the screen shown in the
    </span>
    <a id="_idIndexMarker901">
    </a>
    <span class="koboSpan" id="kobo.116.1">
     preceding image, we can generate a Lighthouse performance report by selecting various options, including the
    </span>
    <strong class="screenText">
     <span class="koboSpan" id="kobo.117.1">
      Device
     </span>
    </strong>
    <span class="koboSpan" id="kobo.118.1">
     and
    </span>
    <strong class="screenText">
     <span class="koboSpan" id="kobo.119.1">
      Categories
     </span>
    </strong>
    <span class="koboSpan" id="kobo.120.1">
     sections.
    </span>
    <span class="koboSpan" id="kobo.120.2">
     The
    </span>
    <strong class="screenText">
     <span class="koboSpan" id="kobo.121.1">
      Device
     </span>
    </strong>
    <span class="koboSpan" id="kobo.122.1">
     section allows us to specify the environment in which we want to measure our application.
    </span>
    <span class="koboSpan" id="kobo.122.2">
     The
    </span>
    <strong class="screenText">
     <span class="koboSpan" id="kobo.123.1">
      Categories
     </span>
    </strong>
    <span class="koboSpan" id="kobo.124.1">
     section allows us to evaluate different metrics, including
    </span>
    <strong class="screenText">
     <span class="koboSpan" id="kobo.125.1">
      Performance
     </span>
    </strong>
    <span class="koboSpan" id="kobo.126.1">
     , related to CWV.
    </span>
   </p>
   <ol>
    <li class="numberedList" value="6">
     <span class="koboSpan" id="kobo.127.1">
      Select the
     </span>
     <strong class="screenText">
      <span class="koboSpan" id="kobo.128.1">
       Desktop
      </span>
     </strong>
     <span class="koboSpan" id="kobo.129.1">
      option in the
     </span>
     <strong class="screenText">
      <span class="koboSpan" id="kobo.130.1">
       Device
      </span>
     </strong>
     <span class="koboSpan" id="kobo.131.1">
      section, check only the
     </span>
     <strong class="screenText">
      <span class="koboSpan" id="kobo.132.1">
       Performance
      </span>
     </strong>
     <span class="koboSpan" id="kobo.133.1">
      option
     </span>
     <a id="_idIndexMarker902">
     </a>
     <span class="koboSpan" id="kobo.134.1">
      in the
     </span>
     <strong class="screenText">
      <span class="koboSpan" id="kobo.135.1">
       Categories
      </span>
     </strong>
     <span class="koboSpan" id="kobo.136.1">
      section, and click the
     </span>
     <strong class="screenText">
      <span class="koboSpan" id="kobo.137.1">
       Analyze page load
      </span>
     </strong>
     <span class="koboSpan" id="kobo.138.1">
      button:
     </span>
    </li>
   </ol>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.139.1">
     <img alt="img" src="../Images/B21418_15_02.png"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.140.1">
     Figure 15.2: Lighthouse report
    </span>
   </p>
   <p class="normal-one">
    <span class="koboSpan" id="kobo.141.1">
     In the preceding image, we can see the individual score from CWV metrics and the overall performance score.
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <span class="koboSpan" id="kobo.142.1">
      The overall performance score is an estimation and may vary depending on the capabilities of your computer or any installed browser extensions.
     </span>
     <span class="koboSpan" id="kobo.142.2">
      It is preferable to run the benchmark in
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.143.1">
       incognito or private
      </span>
     </strong>
     <span class="koboSpan" id="kobo.144.1">
      mode to simulate an environment closer to a real-world scenario.
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.145.1">
     In the following sections, we will explore ways to improve the performance score by applying Angular best practices.
    </span>
    <span class="koboSpan" id="kobo.145.2">
     We will start with SSR.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-269">
    <span class="koboSpan" id="kobo.146.1">
     Rendering SSR applications
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.147.1">
     SSR
    </span>
    <a id="_idIndexMarker903">
    </a>
    <span class="koboSpan" id="kobo.148.1">
     is a technique in web development that improves application performance and security in the following ways:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.149.1">
      It improves the loading performance by rendering the application on the server and eliminating the initial HTML content delivered to the client.
     </span>
     <span class="koboSpan" id="kobo.149.2">
      The server delivers the initial HTML to the client, which can parse and load while it waits for the JavaScript content to be downloaded.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.150.1">
      It improves
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.151.1">
       Search Engine Optimization
      </span>
     </strong>
     <span class="koboSpan" id="kobo.152.1">
      (
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.153.1">
       SEO
      </span>
     </strong>
     <span class="koboSpan" id="kobo.154.1">
      ) by making the application discoverable and indexable by web crawlers.
     </span>
     <span class="koboSpan" id="kobo.154.2">
      SEO
     </span>
     <a id="_idIndexMarker904">
     </a>
     <span class="koboSpan" id="kobo.155.1">
      provides meaningful content when shared in third-party applications such as social media platforms.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.156.1">
      It improves CWV metrics related to loading speed and UI stability, such as LCP, FCP, and CLS.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.157.1">
      It improves security by adding CSP nonces to Angular applications.
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.158.1">
     As we saw in
    </span>
    <em class="chapterRef">
     <span class="koboSpan" id="kobo.159.1">
      Chapter 1
     </span>
    </em>
    <span class="koboSpan" id="kobo.160.1">
     ,
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.161.1">
      Building Your First Angular Application
     </span>
    </em>
    <span class="koboSpan" id="kobo.162.1">
     , when we created a new application using the
    </span>
    <a id="_idIndexMarker905">
    </a>
    <span class="koboSpan" id="kobo.163.1">
     Angular CLI, it prompted us to enable SSR:
    </span>
   </p>
   <pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.164.1">Do you want to enable Server-Side Rendering (SSR) and Static Site Generation (SSG/Prerendering)? </span><span class="koboSpan" id="kobo.164.2">(y/N)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.165.1">
     In our case, we have already created an Angular application using the Angular CLI.
    </span>
    <span class="koboSpan" id="kobo.165.2">
     To add SSR in an existing Angular application, run the following command in a terminal window inside the Angular CLI workspace:
    </span>
   </p>
   <pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.166.1">ng add @angular/ssr
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.167.1">
     The preceding command will ask us the following question:
    </span>
   </p>
   <pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.168.1">Would you like to use the Server Routing and App Engine APIs (Developer Preview) for this server application? </span><span class="koboSpan" id="kobo.168.2">(y/N)
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.169.1">
     Accept the default
    </span>
    <a id="_idIndexMarker906">
    </a>
    <span class="koboSpan" id="kobo.170.1">
     value,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.171.1">
      No
     </span>
    </code>
    <span class="koboSpan" id="kobo.172.1">
     , by pressing
    </span>
    <em class="keystroke">
     <span class="koboSpan" id="kobo.173.1">
      Enter
     </span>
    </em>
    <span class="koboSpan" id="kobo.174.1">
     and the Angular CLI will prompt us to install the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.175.1">
      @angular/ssr
     </span>
    </code>
    <span class="koboSpan" id="kobo.176.1">
     npm package.
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <span class="koboSpan" id="kobo.177.1">
      A feature in
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.178.1">
       Developer Preview
      </span>
     </strong>
     <span class="koboSpan" id="kobo.179.1">
      means that it is not ready yet for production but you can test it in your development environment.
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.180.1">
     After installation completes, the Angular CLI creates the following files:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.181.1">
       main.server.ts
      </span>
     </code>
     <span class="koboSpan" id="kobo.182.1">
      : This is used to bootstrap the application in the server using a specific configuration.
     </span>
    </li>
    <li class="bulletList">
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.183.1">
       app.config.server.ts
      </span>
     </code>
     <span class="koboSpan" id="kobo.184.1">
      : This contains the configuration for the application rendered on the server.
     </span>
     <span class="koboSpan" id="kobo.184.2">
      It exports a
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.185.1">
       config
      </span>
     </code>
     <span class="koboSpan" id="kobo.186.1">
      variable, which contains a merged version of the client and server application configuration files.
     </span>
    </li>
    <li class="bulletList">
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.187.1">
       server.ts
      </span>
     </code>
     <span class="koboSpan" id="kobo.188.1">
      : This configures and starts a Node.js
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.189.1">
       Express
      </span>
     </strong>
     <span class="koboSpan" id="kobo.190.1">
      server that renders the Angular application on the server.
     </span>
     <span class="koboSpan" id="kobo.190.2">
      It uses the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.191.1">
       CommonEngine
      </span>
     </code>
     <span class="koboSpan" id="kobo.192.1">
      class from the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.193.1">
       @angular/ssr
      </span>
     </code>
     <span class="koboSpan" id="kobo.194.1">
      package to start the Angular application.
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.195.1">
     Additionally, the command will make the following modifications in the Angular CLI workspace:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.196.1">
      It will add the necessary options in the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.197.1">
       build
      </span>
     </code>
     <span class="koboSpan" id="kobo.198.1">
      section of the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.199.1">
       angular.json
      </span>
     </code>
     <span class="koboSpan" id="kobo.200.1">
      file to run the Angular application in SSR and SSG.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.201.1">
      It will add the necessary entries in the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.202.1">
       files
      </span>
     </code>
     <span class="koboSpan" id="kobo.203.1">
      and
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.204.1">
       types
      </span>
     </code>
     <span class="koboSpan" id="kobo.205.1">
      property of the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.206.1">
       tsconfig.app.json
      </span>
     </code>
     <span class="koboSpan" id="kobo.207.1">
      file so that the TypeScript compiler can identify the files created for the server.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.208.1">
      It will add the necessary scripts and dependencies in the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.209.1">
       package.json
      </span>
     </code>
     <span class="koboSpan" id="kobo.210.1">
      file.
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.211.1">
      It will add
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.212.1">
       provideClientHydration
      </span>
     </code>
     <span class="koboSpan" id="kobo.213.1">
      in the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.214.1">
       src\app\app.config.ts
      </span>
     </code>
     <span class="koboSpan" id="kobo.215.1">
      file to enable
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.216.1">
       hydration
      </span>
     </strong>
     <span class="koboSpan" id="kobo.217.1">
      in the
     </span>
     <a id="_idIndexMarker907">
     </a>
     <span class="koboSpan" id="kobo.218.1">
      Angular application.
     </span>
     <span class="koboSpan" id="kobo.218.2">
      Hydration is the process of restoring the server-side-rendered application to the client.
     </span>
     <span class="koboSpan" id="kobo.218.3">
      We will learn more about hydration later in the chapter.
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.219.1">
     Now that we have installed Angular SSR in our application, let’s see how to use it:
    </span>
   </p>
   <ol>
    <li class="numberedList" value="1">
     <span class="koboSpan" id="kobo.220.1">
      Open the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.221.1">
       app.config.ts
      </span>
     </code>
     <span class="koboSpan" id="kobo.222.1">
      file and modify the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.223.1">
       import
      </span>
     </code>
     <span class="koboSpan" id="kobo.224.1">
      statement of the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.225.1">
       @angular/common/http
      </span>
     </code>
     <span class="koboSpan" id="kobo.226.1">
      namespace as follows:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.227.1">import</span></span><span class="koboSpan" id="kobo.228.1"> { provideHttpClient, </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.229.1">withFetch</span></strong></span><span class="koboSpan" id="kobo.230.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.231.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.232.1">'@angular/common/http'</span></span><span class="koboSpan" id="kobo.233.1">;
</span></code></pre>
    </li>
   </ol>
   <p class="normal-one">
    <span class="koboSpan" id="kobo.234.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.235.1">
      withFetch
     </span>
    </code>
    <span class="koboSpan" id="kobo.236.1">
     method is used to configure the Angular HTTP client so that it uses the native
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.237.1">
      fetch
     </span>
    </code>
    <span class="koboSpan" id="kobo.238.1">
     API for making requests.
    </span>
   </p>
   <p class="normal-one">
    <span class="koboSpan" id="kobo.239.1">
     It’s strongly recommended to enable
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.240.1">
      fetch
     </span>
    </code>
    <span class="koboSpan" id="kobo.241.1">
     for applications that use SSR for better performance and compatibility.
    </span>
   </p>
   <ol>
    <li class="numberedList" value="2">
     <span class="koboSpan" id="kobo.242.1">
      Pass the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.243.1">
       withFetch
      </span>
     </code>
     <span class="koboSpan" id="kobo.244.1">
      method as a parameter in the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.245.1">
       provideHttpClient
      </span>
     </code>
     <span class="koboSpan" id="kobo.246.1">
      method:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.247.1">provideHttpClient</span></span><span class="koboSpan" id="kobo.248.1">(</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.249.1">withFetch()</span></strong></span><span class="koboSpan" id="kobo.250.1">)
</span></code></pre>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.251.1">
      Run the following
     </span>
     <a id="_idIndexMarker908">
     </a>
     <span class="koboSpan" id="kobo.252.1">
      command to build the Angular application:
     </span>
     <pre class="programlisting con-one"><code class="hljs-con"><span class="koboSpan" id="kobo.253.1">ng build
</span></code></pre>
    </li>
   </ol>
   <p class="normal-one">
    <span class="koboSpan" id="kobo.254.1">
     The preceding command generates
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.255.1">
      browser
     </span>
    </code>
    <span class="koboSpan" id="kobo.256.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.257.1">
      server
     </span>
    </code>
    <span class="koboSpan" id="kobo.258.1">
     bundles inside the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.259.1">
      dist\my-app
     </span>
    </code>
    <span class="koboSpan" id="kobo.260.1">
     folder and prerenders static routes.
    </span>
    <span class="koboSpan" id="kobo.260.2">
     We will learn more about prerendering in the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.261.1">
      Prerendering SSG applications
     </span>
    </em>
    <span class="koboSpan" id="kobo.262.1">
     section.
    </span>
   </p>
   <ol>
    <li class="numberedList" value="4">
     <span class="koboSpan" id="kobo.263.1">
      Run the following command to run the SSR application:
     </span>
     <pre class="programlisting con-one"><code class="hljs-con"><span class="koboSpan" id="kobo.264.1">npm run serve:ssr:my-app
</span></code></pre>
    </li>
   </ol>
   <p class="normal-one">
    <span class="koboSpan" id="kobo.265.1">
     The preceding command will start the Express server locally at port
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.266.1">
      4000
     </span>
    </code>
    <span class="koboSpan" id="kobo.267.1">
     and serve the SSR application.
    </span>
   </p>
   <ol>
    <li class="numberedList" value="5">
     <span class="koboSpan" id="kobo.268.1">
      Open Google Chrome and navigate to
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.269.1">
       http://localhost:4000
      </span>
     </code>
     <span class="koboSpan" id="kobo.270.1">
      .
     </span>
     <span class="koboSpan" id="kobo.270.2">
      You should see the e-shop application on the web page.
     </span>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.271.1">
      Repeat the process we learned in the previous section to run a performance benchmark using Lighthouse.
     </span>
     <span class="koboSpan" id="kobo.271.2">
      The overall score and CWV metrics should have been improved dramatically:
     </span>
    </li>
   </ol>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.272.1">
     <img alt="Εικόνα που περιέχει κείμενο, στιγμιότυπο οθόνης, λογισμικό, γραμματοσειρά  Περιγραφή που δημιουργήθηκε αυτόματα" src="../Images/B21418_15_03.png"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.273.1">
     Figure 15.3: Lighthouse report (SSR)
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.274.1">
     The performance of our
    </span>
    <a id="_idIndexMarker909">
    </a>
    <span class="koboSpan" id="kobo.275.1">
     application has been improved by more than 20% just by installing SSR in our Angular application!
    </span>
    <span class="koboSpan" id="kobo.275.2">
     As we will learn later in the chapter, we can apply various Angular techniques to improve performance further more.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.276.1">
     Angular SSR is a good fit when we need to fetch data from the server and display it statically on a website.
    </span>
    <span class="koboSpan" id="kobo.276.2">
     However, there are cases where SSR is not beneficial, such as when an application is based on data entry and has a lot of user inputs.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.277.1">
     In the following section, we will learn how to override SSR or skip it completely for certain parts of an Angular application.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-270">
    <span class="koboSpan" id="kobo.278.1">
     Overriding SSR in Angular applications
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.279.1">
     Hydration is an
    </span>
    <a id="_idIndexMarker910">
    </a>
    <span class="koboSpan" id="kobo.280.1">
     important feature enabled by default in Angular SSR applications.
    </span>
    <span class="koboSpan" id="kobo.280.2">
     It improves the overall performance of the application by handling the creation of the DOM on the client efficiently.
    </span>
    <span class="koboSpan" id="kobo.280.3">
     The client can reuse the DOM structure of the server-side-rendered application instead of creating it from scratch and forcing a UI flicker, which affects CWV metrics
    </span>
    <a id="_idIndexMarker911">
    </a>
    <span class="koboSpan" id="kobo.281.1">
     such as LCP and CLS.
    </span>
    <span class="koboSpan" id="kobo.281.2">
     The hydration process will fail in the following cases:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.282.1">
      When we try to manipulate the DOM through a native browser API such as
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.283.1">
       window
      </span>
     </code>
     <span class="koboSpan" id="kobo.284.1">
      or
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.285.1">
       document
      </span>
     </code>
     <span class="koboSpan" id="kobo.286.1">
      either directly or using a third-party library
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.287.1">
      When our component templates do not have a valid HTML syntax
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.288.1">
     We can overcome the preceding problems by applying the following best practices:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.289.1">
      Use Angular APIs to detect the platform on which our application is running before interacting with the DOM
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.290.1">
      Skip hydration for specific Angular components
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.291.1">
     Let’s see how to use both with an example:
    </span>
   </p>
   <ol>
    <li class="numberedList" value="1">
     <span class="koboSpan" id="kobo.292.1">
      Run the SSR version of the Angular application, as shown in the previous section.
     </span>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.293.1">
      Notice the text that is displayed in the application footer:
     </span>
    </li>
   </ol>
   <p class="normal-one">
    <strong class="screenText">
     <span class="koboSpan" id="kobo.294.1">
      - v1.0
     </span>
    </strong>
   </p>
   <p class="normal-one">
    <span class="koboSpan" id="kobo.295.1">
     The copyright information is not displayed correctly.
    </span>
   </p>
   <ol>
    <li class="numberedList" value="3">
     <span class="koboSpan" id="kobo.296.1">
      Open the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.297.1">
       copyright.directive.ts
      </span>
     </code>
     <span class="koboSpan" id="kobo.298.1">
      file and focus on the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.299.1">
       constructor
      </span>
     </code>
     <span class="koboSpan" id="kobo.300.1">
      code:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.301.1">constructor</span></span><span class="koboSpan" id="kobo.302.1">(</span><span class="hljs-attr"><span class="koboSpan" id="kobo.303.1">el</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.304.1">: </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.305.1">ElementRef</span></span><span class="koboSpan" id="kobo.306.1">) {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.307.1">const</span></span><span class="koboSpan" id="kobo.308.1"> currentYear = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.309.1">new</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.310.1">Date</span></span><span class="koboSpan" id="kobo.311.1">().</span><span class="hljs-title"><span class="koboSpan" id="kobo.312.1">getFullYear</span></span><span class="koboSpan" id="kobo.313.1">();
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.314.1">const</span></span> <span class="hljs-attr"><span class="koboSpan" id="kobo.315.1">targetEl</span></span><span class="koboSpan" id="kobo.316.1">: </span><span class="hljs-title"><span class="koboSpan" id="kobo.317.1">HTMLElement</span></span><span class="koboSpan" id="kobo.318.1"> = el.</span><span class="hljs-property"><span class="koboSpan" id="kobo.319.1">nativeElement</span></span><span class="koboSpan" id="kobo.320.1">;
  targetEl.</span><span class="hljs-property"><span class="koboSpan" id="kobo.321.1">classList</span></span><span class="koboSpan" id="kobo.322.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.323.1">add</span></span><span class="koboSpan" id="kobo.324.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.325.1">'copyright'</span></span><span class="koboSpan" id="kobo.326.1">);
  targetEl.</span><span class="hljs-property"><span class="koboSpan" id="kobo.327.1">textContent</span></span><span class="koboSpan" id="kobo.328.1"> = </span><span class="hljs-string"><span class="koboSpan" id="kobo.329.1">`Copyright ©</span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.330.1">${currentYear}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.331.1"> All Rights Reserved`</span></span><span class="koboSpan" id="kobo.332.1">;
}
</span></code></pre>
    </li>
   </ol>
   <p class="normal-one">
    <span class="koboSpan" id="kobo.333.1">
     The preceding code uses the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.334.1">
      nativeElement
     </span>
    </code>
    <span class="koboSpan" id="kobo.335.1">
     property to manipulate the DOM by adding a CSS class and setting
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.336.1">
      textContent
     </span>
    </code>
    <span class="koboSpan" id="kobo.337.1">
     of the HTML element.
    </span>
    <span class="koboSpan" id="kobo.337.2">
     However, as mentioned, the code breaks our application because there is no DOM on the server.
    </span>
    <span class="koboSpan" id="kobo.337.3">
     Let’s fix that!
    </span>
   </p>
   <ol>
    <li class="numberedList" value="4">
     <span class="koboSpan" id="kobo.338.1">
      Open the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.339.1">
       app.component.html
      </span>
     </code>
     <span class="koboSpan" id="kobo.340.1">
      file and add the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.341.1">
       ngSkipHydration
      </span>
     </code>
     <span class="koboSpan" id="kobo.342.1">
      attribute on the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.343.1">
       &lt;mat-toolbar&gt;
      </span>
     </code>
     <span class="koboSpan" id="kobo.344.1">
      element of the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.345.1">
       &lt;footer&gt;
      </span>
     </code>
     <span class="koboSpan" id="kobo.346.1">
      HTML tag:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.347.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.348.1">footer</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.349.1">&gt;</span></span>
  <span class="hljs-tag"><span class="koboSpan" id="kobo.350.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.351.1">mat-toolbar</span></span><span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.352.1">ngSkipHydration</span></strong></span><span class="hljs-tag"><span class="koboSpan" id="kobo.353.1">&gt;</span></span>
    <span class="hljs-tag"><span class="koboSpan" id="kobo.354.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.355.1">mat-toolbar-row</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.356.1">&gt;</span></span>
      <span class="hljs-tag"><span class="koboSpan" id="kobo.357.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.358.1">span</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.359.1">appCopyright</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.360.1">&gt;</span></span><span class="koboSpan" id="kobo.361.1"> - v{{ settings.version }}</span><span class="hljs-tag"><span class="koboSpan" id="kobo.362.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.363.1">span</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.364.1">&gt;</span></span> 
    <span class="hljs-tag"><span class="koboSpan" id="kobo.365.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.366.1">mat-toolbar-row</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.367.1">&gt;</span></span>
  <span class="hljs-tag"><span class="koboSpan" id="kobo.368.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.369.1">mat-toolbar</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.370.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.371.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.372.1">footer</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.373.1">&gt;</span></span>
</code></pre>
     <div class="note-one">
      <p class="normal">
       <code class="inlineCode">
        <span class="koboSpan" id="kobo.374.1">
         ngSkipHydration
        </span>
       </code>
       <span class="koboSpan" id="kobo.375.1">
        is an HTML attribute, not an Angular directive.
       </span>
       <span class="koboSpan" id="kobo.375.2">
        It can only be used in other Angular components, not native HTML elements.
       </span>
       <span class="koboSpan" id="kobo.375.3">
        It would not work if we had added it in the
       </span>
       <code class="inlineCode">
        <span class="koboSpan" id="kobo.376.1">
         &lt;footer&gt;
        </span>
       </code>
       <span class="koboSpan" id="kobo.377.1">
        tag instead.
       </span>
      </p>
     </div>
    </li>
   </ol>
   <p class="normal-one">
    <span class="koboSpan" id="kobo.378.1">
     In the
    </span>
    <a id="_idIndexMarker912">
    </a>
    <span class="koboSpan" id="kobo.379.1">
     preceding snippet, the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.380.1">
      &lt;mat-toolbar&gt;
     </span>
    </code>
    <span class="koboSpan" id="kobo.381.1">
     component and its child components will not be hydrated.
    </span>
    <span class="koboSpan" id="kobo.381.2">
     This effectively means that Angular will create them from scratch when the SSR version of the application is ready.
    </span>
   </p>
   <ol>
    <li class="numberedList" value="5">
     <span class="koboSpan" id="kobo.382.1">
      Run step 1 again and observe the output in the application footer:
     </span>
    </li>
   </ol>
   <p class="normal-one">
    <strong class="screenText">
     <span class="koboSpan" id="kobo.383.1">
      Copyright ©2024 All Rights Reserved - v1.0
     </span>
    </strong>
   </p>
   <div class="note-one">
    <p class="normal">
     <span class="koboSpan" id="kobo.384.1">
      Skipping hydration should be considered a workaround.
     </span>
     <span class="koboSpan" id="kobo.384.2">
      We use it temporarily in cases where hydration cannot be enabled.
     </span>
     <span class="koboSpan" id="kobo.384.3">
      It is recommended to refactor your code so your application can benefit from hydration capabilities.
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.385.1">
     An alternate and better approach is to refactor our code so that it executes client code conditionally:
    </span>
   </p>
   <ol>
    <li class="numberedList" value="1">
     <span class="koboSpan" id="kobo.386.1">
      Modify the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.387.1">
       import
      </span>
     </code>
     <span class="koboSpan" id="kobo.388.1">
      statements in the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.389.1">
       copyright.directive.ts
      </span>
     </code>
     <span class="koboSpan" id="kobo.390.1">
      file as follows:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.391.1">import { isPlatformBrowser } from '@angular/common';</span></strong></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.392.1">import</span></span><span class="koboSpan" id="kobo.393.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.394.1">Directive</span></span><span class="koboSpan" id="kobo.395.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.396.1">ElementRef</span></span><span class="koboSpan" id="kobo.397.1">, </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.398.1">inject, OnInit, PLATFORM_ID</span></strong></span><span class="koboSpan" id="kobo.399.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.400.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.401.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.402.1">;
</span></code></pre>
    </li>
   </ol>
   <p class="normal-one">
    <span class="koboSpan" id="kobo.403.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.404.1">
      PLATFORM_ID
     </span>
    </code>
    <span class="koboSpan" id="kobo.405.1">
     is an
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.406.1">
      InjectionToken
     </span>
    </code>
    <span class="koboSpan" id="kobo.407.1">
     that indicates the type of platform our application is currently running on.
    </span>
    <span class="koboSpan" id="kobo.407.2">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.408.1">
      isPlatformBrowser
     </span>
    </code>
    <span class="koboSpan" id="kobo.409.1">
     function checks if a given platform ID is the browser.
    </span>
   </p>
   <p class="normal-one">
    <span class="koboSpan" id="kobo.410.1">
     Add the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.411.1">
      OnInit
     </span>
    </code>
    <span class="koboSpan" id="kobo.412.1">
     interface to the list of implemented interfaces of the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.413.1">
      CopyrightDirective
     </span>
    </code>
    <span class="koboSpan" id="kobo.414.1">
     class:
    </span>
   </p>
   <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.415.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.416.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.417.1">CopyrightDirective</span></span> <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.418.1">implements OnInit</span></strong></span>
</code></pre>
   <ol>
    <li class="numberedList" value="2">
     <span class="koboSpan" id="kobo.419.1">
      Add the following class properties:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.420.1">private</span></span><span class="koboSpan" id="kobo.421.1"> platform = </span><span class="hljs-title"><span class="koboSpan" id="kobo.422.1">inject</span></span><span class="koboSpan" id="kobo.423.1">(</span><span class="hljs-variable"><span class="koboSpan" id="kobo.424.1">PLATFORM_ID</span></span><span class="koboSpan" id="kobo.425.1">);
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.426.1">private</span></span><span class="koboSpan" id="kobo.427.1"> el = </span><span class="hljs-title"><span class="koboSpan" id="kobo.428.1">inject</span></span><span class="koboSpan" id="kobo.429.1">(</span><span class="hljs-title"><span class="koboSpan" id="kobo.430.1">ElementRef</span></span><span class="koboSpan" id="kobo.431.1">);
</span></code></pre>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.432.1">
      Remove
     </span>
     <a id="_idIndexMarker913">
     </a>
     <span class="koboSpan" id="kobo.433.1">
      the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.434.1">
       constructor
      </span>
     </code>
     <span class="koboSpan" id="kobo.435.1">
      and add the following
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.436.1">
       ngOnInit
      </span>
     </code>
     <span class="koboSpan" id="kobo.437.1">
      method:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.438.1">ngOnInit</span></span><span class="koboSpan" id="kobo.439.1">(): </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.440.1">void</span></span><span class="koboSpan" id="kobo.441.1"> {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.442.1">if</span></span><span class="koboSpan" id="kobo.443.1"> (</span><span class="hljs-title"><span class="koboSpan" id="kobo.444.1">isPlatformBrowser</span></span><span class="koboSpan" id="kobo.445.1">(</span><span class="hljs-variable"><span class="koboSpan" id="kobo.446.1">this</span></span><span class="koboSpan" id="kobo.447.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.448.1">platform</span></span><span class="koboSpan" id="kobo.449.1">)) {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.450.1">const</span></span><span class="koboSpan" id="kobo.451.1"> currentYear = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.452.1">new</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.453.1">Date</span></span><span class="koboSpan" id="kobo.454.1">().</span><span class="hljs-title"><span class="koboSpan" id="kobo.455.1">getFullYear</span></span><span class="koboSpan" id="kobo.456.1">();
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.457.1">const</span></span> <span class="hljs-attr"><span class="koboSpan" id="kobo.458.1">targetEl</span></span><span class="koboSpan" id="kobo.459.1">: </span><span class="hljs-title"><span class="koboSpan" id="kobo.460.1">HTMLElement</span></span><span class="koboSpan" id="kobo.461.1"> = </span><span class="hljs-variable"><span class="koboSpan" id="kobo.462.1">this</span></span><span class="koboSpan" id="kobo.463.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.464.1">el</span></span><span class="koboSpan" id="kobo.465.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.466.1">nativeElement</span></span><span class="koboSpan" id="kobo.467.1">;
    targetEl.</span><span class="hljs-property"><span class="koboSpan" id="kobo.468.1">classList</span></span><span class="koboSpan" id="kobo.469.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.470.1">add</span></span><span class="koboSpan" id="kobo.471.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.472.1">'copyright'</span></span><span class="koboSpan" id="kobo.473.1">);
    targetEl.</span><span class="hljs-property"><span class="koboSpan" id="kobo.474.1">textContent</span></span><span class="koboSpan" id="kobo.475.1"> = </span><span class="hljs-string"><span class="koboSpan" id="kobo.476.1">`Copyright ©</span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.477.1">${currentYear}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.478.1"> All Rights Reserved </span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.479.1">${targetEl.textContent}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.480.1">`</span></span><span class="koboSpan" id="kobo.481.1">;
  }
}
</span></code></pre>
    </li>
   </ol>
   <p class="normal-one">
    <span class="koboSpan" id="kobo.482.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.483.1">
      isPlatformBrowser
     </span>
    </code>
    <span class="koboSpan" id="kobo.484.1">
     function accepts the platform ID as a parameter.
    </span>
   </p>
   <div class="packt_tip-one">
    <p class="normal">
     <span class="koboSpan" id="kobo.485.1">
      Angular also provides the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.486.1">
       isPlatformServer
      </span>
     </code>
     <span class="koboSpan" id="kobo.487.1">
      function, a counterpart of the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.488.1">
       isPlatformBrowser
      </span>
     </code>
     <span class="koboSpan" id="kobo.489.1">
      function, which checks if the current platform is the server.
     </span>
    </p>
   </div>
   <ol>
    <li class="numberedList" value="4">
     <span class="koboSpan" id="kobo.490.1">
      Build and run the application in server-side mode to verify that the copyright message is still visible.
     </span>
    </li>
   </ol>
   <p class="normal">
    <span class="koboSpan" id="kobo.491.1">
     To sum up, it is recommended that you use Angular SSR throughout your application and refactor parts of the application code that must run on the browser.
    </span>
    <span class="koboSpan" id="kobo.491.2">
     This will allow you to reap all the benefits of a server-side-rendered application.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.492.1">
     In the preceding section, we showed that adding SSR to an Angular application dramatically improves its overall performance score.
    </span>
    <span class="koboSpan" id="kobo.492.2">
     As we will learn in the following section, we can do even better by applying optimization techniques to product images.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-271">
    <span class="koboSpan" id="kobo.493.1">
     Optimizing image loading
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.494.1">
     The product list, which is the landing
    </span>
    <a id="_idIndexMarker914">
    </a>
    <span class="koboSpan" id="kobo.495.1">
     component of our application, displays an image of each product on the list.
    </span>
    <span class="koboSpan" id="kobo.495.2">
     How images are loaded in an Angular application can affect CWV metrics such as LCP and CLS.
    </span>
    <span class="koboSpan" id="kobo.495.3">
     Our application currently loads images as received from the Fake Store API.
    </span>
    <span class="koboSpan" id="kobo.495.4">
     However, we can use specific Angular artifacts to enforce best practices while loading images.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.496.1">
     The Angular framework provides us with the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.497.1">
      NgOptimizedImage
     </span>
    </code>
    <span class="koboSpan" id="kobo.498.1">
     directive, which we can attach to
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.499.1">
      &lt;img&gt;
     </span>
    </code>
    <span class="koboSpan" id="kobo.500.1">
     HTML elements:
    </span>
   </p>
   <ol>
    <li class="numberedList" value="1">
     <span class="koboSpan" id="kobo.501.1">
      Open the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.502.1">
       product-list.component.ts
      </span>
     </code>
     <span class="koboSpan" id="kobo.503.1">
      file and import the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.504.1">
       NgOptimizedImage
      </span>
     </code>
     <span class="koboSpan" id="kobo.505.1">
      class from the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.506.1">
       @angular/common
      </span>
     </code>
     <span class="koboSpan" id="kobo.507.1">
      npm package:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.508.1">import</span></span><span class="koboSpan" id="kobo.509.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.510.1">AsyncPipe</span></span><span class="koboSpan" id="kobo.511.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.512.1">CurrencyPipe</span></span><span class="koboSpan" id="kobo.513.1">, </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.514.1">NgOptimizedImage</span></strong></span><span class="koboSpan" id="kobo.515.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.516.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.517.1">'@angular/common'</span></span><span class="koboSpan" id="kobo.518.1">;
</span></code></pre>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.519.1">
      Add the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.520.1">
       NgOptimizedImage
      </span>
     </code>
     <span class="koboSpan" id="kobo.521.1">
      class in the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.522.1">
       imports
      </span>
     </code>
     <span class="koboSpan" id="kobo.523.1">
      array of the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.524.1">
       @Component
      </span>
     </code>
     <span class="koboSpan" id="kobo.525.1">
      decorator:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-meta"><span class="koboSpan" id="kobo.526.1">@Component</span></span><span class="koboSpan" id="kobo.527.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.528.1">selector</span></span><span class="koboSpan" id="kobo.529.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.530.1">'app-product-list'</span></span><span class="koboSpan" id="kobo.531.1">,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.532.1">imports</span></span><span class="koboSpan" id="kobo.533.1">: [
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.534.1">SortPipe</span></span><span class="koboSpan" id="kobo.535.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.536.1">AsyncPipe</span></span><span class="koboSpan" id="kobo.537.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.538.1">CurrencyPipe</span></span><span class="koboSpan" id="kobo.539.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.540.1">RouterLink</span></span><span class="koboSpan" id="kobo.541.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.542.1">MatMiniFabButton</span></span><span class="koboSpan" id="kobo.543.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.544.1">MatIcon</span></span><span class="koboSpan" id="kobo.545.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.546.1">MatCardModule</span></span><span class="koboSpan" id="kobo.547.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.548.1">MatTableModule</span></span><span class="koboSpan" id="kobo.549.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.550.1">MatButtonToggle</span></span><span class="koboSpan" id="kobo.551.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.552.1">MatButtonToggleGroup</span></span><span class="koboSpan" id="kobo.553.1">,
    </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.554.1">NgOptimizedImage</span></strong></span><span class="koboSpan" id="kobo.555.1">
  ],
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.556.1">templateUrl</span></span><span class="koboSpan" id="kobo.557.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.558.1">'./product-list.component.html'</span></span><span class="koboSpan" id="kobo.559.1">,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.560.1">styleUrl</span></span><span class="koboSpan" id="kobo.561.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.562.1">'./product-list.component.css'</span></span><span class="koboSpan" id="kobo.563.1">
})
</span></code></pre>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.564.1">
      Open
     </span>
     <a id="_idIndexMarker915">
     </a>
     <span class="koboSpan" id="kobo.565.1">
      the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.566.1">
       product-list.component.html
      </span>
     </code>
     <span class="koboSpan" id="kobo.567.1">
      file and replace the binding of the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.568.1">
       src
      </span>
     </code>
     <span class="koboSpan" id="kobo.569.1">
      property with the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.570.1">
       ngSrc
      </span>
     </code>
     <span class="koboSpan" id="kobo.571.1">
      directive:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.572.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.573.1">mat-card-title-group</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.574.1">&gt;</span></span>
  <span class="hljs-tag"><span class="koboSpan" id="kobo.575.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.576.1">mat-card-title</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.577.1">&gt;</span></span><span class="koboSpan" id="kobo.578.1">{{ product.title }}</span><span class="hljs-tag"><span class="koboSpan" id="kobo.579.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.580.1">mat-card-title</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.581.1">&gt;</span></span>
  <span class="hljs-tag"><span class="koboSpan" id="kobo.582.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.583.1">mat-card-subtitle</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.584.1">&gt;</span></span><span class="koboSpan" id="kobo.585.1">{{ product.category }}</span><span class="hljs-tag"><span class="koboSpan" id="kobo.586.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.587.1">mat-card-subtitle</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.588.1">&gt;</span></span>
  <span class="hljs-tag"><span class="koboSpan" id="kobo.589.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.590.1">img</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.591.1">mat-card-sm-image</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.592.1"> [</span></span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.593.1">ngSrc</span></strong></span><span class="hljs-tag"><span class="koboSpan" id="kobo.594.1">]=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.595.1">"product.image"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.596.1"> /&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.597.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.598.1">mat-card-title-group</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.599.1">&gt;</span></span>
</code></pre>
    </li>
   </ol>
   <p class="normal-one">
    <span class="koboSpan" id="kobo.600.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.601.1">
      ngSrc
     </span>
    </code>
    <span class="koboSpan" id="kobo.602.1">
     directive is insufficient to prevent layout shifts while loading the image.
    </span>
    <span class="koboSpan" id="kobo.602.2">
     We must also set the image size by defining the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.603.1">
      width
     </span>
    </code>
    <span class="koboSpan" id="kobo.604.1">
     ,
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.605.1">
      height
     </span>
    </code>
    <span class="koboSpan" id="kobo.606.1">
     , or
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.607.1">
      fill
     </span>
    </code>
    <span class="koboSpan" id="kobo.608.1">
     attributes.
    </span>
    <span class="koboSpan" id="kobo.608.2">
     In this case, we will use the latter because the size of each image is not the same for all products:
    </span>
   </p>
   <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.609.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.610.1">img</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.611.1">mat-card-sm-image</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.612.1"> [</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.613.1">ngSrc</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.614.1">]=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.615.1">"product.image"</span></span><span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.616.1">fill</span></strong></span><span class="hljs-tag"><span class="koboSpan" id="kobo.617.1"> /&gt;</span></span>
</code></pre>
   <ol>
    <li class="numberedList" value="4">
     <span class="koboSpan" id="kobo.618.1">
      Open the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.619.1">
       product-list.component.css
      </span>
     </code>
     <span class="koboSpan" id="kobo.620.1">
      file and add the following CSS styles to position the image at the top right of the container:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-selector-tag"><span class="koboSpan" id="kobo.621.1">img</span></span><span class="koboSpan" id="kobo.622.1"> {
  </span><span class="hljs-attribute"><span class="koboSpan" id="kobo.623.1">object-fit</span></span><span class="koboSpan" id="kobo.624.1">: contain;
  </span><span class="hljs-attribute"><span class="koboSpan" id="kobo.625.1">object-position</span></span><span class="koboSpan" id="kobo.626.1">: right </span><span class="hljs-number"><span class="koboSpan" id="kobo.627.1">5px</span></span><span class="koboSpan" id="kobo.628.1"> top </span><span class="hljs-number"><span class="koboSpan" id="kobo.629.1">0</span></span><span class="koboSpan" id="kobo.630.1">;
}
</span></code></pre>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.631.1">
      Run the following command to start the application:
     </span>
     <pre class="programlisting con-one"><code class="hljs-con"><span class="koboSpan" id="kobo.632.1">ng serve
</span></code></pre>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.633.1">
      Navigate to
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.634.1">
       http://localhost:4200
      </span>
     </code>
     <span class="koboSpan" id="kobo.635.1">
      and verify that the product list is shown correctly.
     </span>
    </li>
   </ol>
   <p class="normal">
    <span class="koboSpan" id="kobo.636.1">
     The benefits acquired from using the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.637.1">
      NgOptimizedImage
     </span>
    </code>
    <span class="koboSpan" id="kobo.638.1">
     directive are not noticeable in the UI at once.
    </span>
    <span class="koboSpan" id="kobo.638.2">
     The directive works in the background and automatically improves the LCP metric of CWV by:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.639.1">
      Setting fetch priority on the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.640.1">
       &lt;img&gt;
      </span>
     </code>
     <span class="koboSpan" id="kobo.641.1">
      HTML element
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.642.1">
      Lazy loading images
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.643.1">
      Setting
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.644.1">
       preconnect
      </span>
     </code>
     <span class="koboSpan" id="kobo.645.1">
      link tags and preload hints in the case of SSR
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.646.1">
      Generating
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.647.1">
       srcset
      </span>
     </code>
     <span class="koboSpan" id="kobo.648.1">
      attributes for responsive images
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.649.1">
     Additionally, it helps developers to follow best practices regarding image loading, such as:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.650.1">
      Setting the size of the image if it is known beforehand
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.651.1">
      Loading images through a CDN
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.652.1">
      Displaying appropriate warnings in the console window for different metrics
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.653.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.654.1">
      NgOptimizedImage
     </span>
    </code>
    <span class="koboSpan" id="kobo.655.1">
     directive
    </span>
    <a id="_idIndexMarker916">
    </a>
    <span class="koboSpan" id="kobo.656.1">
     contains many other features we can enable to achieve powerful performance improvements, such as setting up image loaders, using placeholders, and
    </span>
    <a id="_idIndexMarker917">
    </a>
    <span class="koboSpan" id="kobo.657.1">
     defining priority images to load.
    </span>
    <span class="koboSpan" id="kobo.657.2">
     You can find more information at
    </span>
    <a href="https://angular.dev/guide/image-optimization">
     <span class="url">
      <span class="koboSpan" id="kobo.658.1">
       https://angular.dev/guide/image-optimization
      </span>
     </span>
    </a>
    <span class="koboSpan" id="kobo.659.1">
     .
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.660.1">
     We have already learned about various
    </span>
    <a id="_idIndexMarker918">
    </a>
    <span class="koboSpan" id="kobo.661.1">
     tools for improving application performance.
    </span>
    <span class="koboSpan" id="kobo.661.2">
     One of the most performant tools is
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.662.1">
      deferrable views
     </span>
    </strong>
    <span class="koboSpan" id="kobo.663.1">
     , which we will learn about in the following section.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-272">
    <span class="koboSpan" id="kobo.664.1">
     Deferring components
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.665.1">
     Introducing the new control
    </span>
    <a id="_idIndexMarker919">
    </a>
    <span class="koboSpan" id="kobo.666.1">
     flow syntax enabled Angular to integrate new primitives in the framework, improving the ergonomics, DX, and performance of Angular applications.
    </span>
    <span class="koboSpan" id="kobo.666.2">
     One such primitive is deferrable views, which allow lazily loading an Angular component and its dependencies.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-273">
    <span class="koboSpan" id="kobo.667.1">
     Introducing deferrable views
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.668.1">
     We have already learned how to use the Angular router for lazy loading a component based on a specific route.
    </span>
    <span class="koboSpan" id="kobo.668.2">
     Deferrable views
    </span>
    <a id="_idIndexMarker920">
    </a>
    <span class="koboSpan" id="kobo.669.1">
     provide a new API that supplements the preceding one.
    </span>
    <span class="koboSpan" id="kobo.669.2">
     Combining it with lazy-load routing guarantees the development of high-performance and powerful web applications.
    </span>
    <span class="koboSpan" id="kobo.669.3">
     Deferrable views allow us to lazy load a component based on an event or the component state and have the following characteristics:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.670.1">
      They are simple to use and easy to reason about the enclosed code
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.671.1">
      We define them in a declarative way
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.672.1">
      They minimize the initial application load and final bundle size, improving CWV metrics such as LCP and TTFB
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.673.1">
     Each deferrable view is split into a separate chunk, similar to the individual chunk files generated by lazy-loaded routes.
    </span>
    <span class="koboSpan" id="kobo.673.2">
     They consist of the following HTML blocks:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.674.1">
       @defer
      </span>
     </code>
     <span class="koboSpan" id="kobo.675.1">
      : Indicates the HTML content that will be loaded.
     </span>
    </li>
    <li class="bulletList">
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.676.1">
       @placeholder
      </span>
     </code>
     <span class="koboSpan" id="kobo.677.1">
      : Indicates the HTML content shown before the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.678.1">
       @defer
      </span>
     </code>
     <span class="koboSpan" id="kobo.679.1">
      block starts loading.
     </span>
     <span class="koboSpan" id="kobo.679.2">
      It is particularly useful when the application is loaded over a slow network or when we want to avoid UI flickering.
     </span>
    </li>
    <li class="bulletList">
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.680.1">
       @loading
      </span>
     </code>
     <span class="koboSpan" id="kobo.681.1">
      : Indicates the HTML content that will be visible while the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.682.1">
       @defer
      </span>
     </code>
     <span class="koboSpan" id="kobo.683.1">
      block is loading.
     </span>
    </li>
    <li class="bulletList">
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.684.1">
       @error
      </span>
     </code>
     <span class="koboSpan" id="kobo.685.1">
      : Indicates
     </span>
     <a id="_idIndexMarker921">
     </a>
     <span class="koboSpan" id="kobo.686.1">
      the HTML content shown if an error occurs while the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.687.1">
       @defer
      </span>
     </code>
     <span class="koboSpan" id="kobo.688.1">
      block is loading.
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.689.1">
     We will learn how to use each block in the following section.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-274">
    <span class="koboSpan" id="kobo.690.1">
     Using deferrable blocks
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.691.1">
     We will integrate
    </span>
    <a id="_idIndexMarker922">
    </a>
    <span class="koboSpan" id="kobo.692.1">
     deferrable views in our e-shop application by creating a component that displays a featured product from the Fake Store API that is not currently in the product list.
    </span>
    <span class="koboSpan" id="kobo.692.2">
     Let’s start:
    </span>
   </p>
   <ol>
    <li class="numberedList" value="1">
     <span class="koboSpan" id="kobo.693.1">
      Run the following command to create the new component:
     </span>
     <pre class="programlisting con-one"><code class="hljs-con"><span class="koboSpan" id="kobo.694.1">ng generate component featured
</span></code></pre>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.695.1">
      Open the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.696.1">
       products.service.ts
      </span>
     </code>
     <span class="koboSpan" id="kobo.697.1">
      file and add the following method, which gets a specific product with ID
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.698.1">
       20
      </span>
     </code>
     <span class="koboSpan" id="kobo.699.1">
      from the Fake Store API:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.700.1">getFeatured</span></span><span class="koboSpan" id="kobo.701.1">(): </span><span class="hljs-title"><span class="koboSpan" id="kobo.702.1">Observable</span></span><span class="koboSpan" id="kobo.703.1">&lt;</span><span class="hljs-title"><span class="koboSpan" id="kobo.704.1">Product</span></span><span class="koboSpan" id="kobo.705.1">&gt; {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.706.1">return</span></span> <span class="hljs-variable"><span class="koboSpan" id="kobo.707.1">this</span></span><span class="koboSpan" id="kobo.708.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.709.1">http</span></span><span class="koboSpan" id="kobo.710.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.711.1">get</span></span><span class="koboSpan" id="kobo.712.1">&lt;</span><span class="hljs-title"><span class="koboSpan" id="kobo.713.1">Product</span></span><span class="koboSpan" id="kobo.714.1">&gt;(</span><span class="hljs-variable"><span class="koboSpan" id="kobo.715.1">this</span></span><span class="koboSpan" id="kobo.716.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.717.1">productsUrl</span></span><span class="koboSpan" id="kobo.718.1"> + </span><span class="hljs-string"><span class="koboSpan" id="kobo.719.1">'/20'</span></span><span class="koboSpan" id="kobo.720.1">);
}
</span></code></pre>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.721.1">
      Open the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.722.1">
       featured.component.ts
      </span>
     </code>
     <span class="koboSpan" id="kobo.723.1">
      file and modify the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.724.1">
       import
      </span>
     </code>
     <span class="koboSpan" id="kobo.725.1">
      statements as follows:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.726.1">import</span></span><span class="koboSpan" id="kobo.727.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.728.1">Component</span></span><span class="koboSpan" id="kobo.729.1">, </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.730.1">OnInit</span></strong></span><span class="koboSpan" id="kobo.731.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.732.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.733.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.734.1">;
</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.735.1">import { CommonModule } from '@angular/common';</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.736.1">import { MatButton } from '@angular/material/button';</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.737.1">import { MatCardModule } from '@angular/material/card';</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.738.1">import { Observable } from 'rxjs';</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.739.1">import { Product } from '../product';</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.740.1">import { ProductsService } from '../products.service';</span></strong></span>
</code></pre>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.741.1">
      Modify the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.742.1">
       imports
      </span>
     </code>
     <span class="koboSpan" id="kobo.743.1">
      array of the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.744.1">
       @Component
      </span>
     </code>
     <span class="koboSpan" id="kobo.745.1">
      decorator as follows:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-meta"><span class="koboSpan" id="kobo.746.1">@Component</span></span><span class="koboSpan" id="kobo.747.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.748.1">selector</span></span><span class="koboSpan" id="kobo.749.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.750.1">'app-featured'</span></span><span class="koboSpan" id="kobo.751.1">,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.752.1">imports</span></span><span class="koboSpan" id="kobo.753.1">: [</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.754.1">CommonModule, MatButton, MatCardModule</span></strong></span><span class="koboSpan" id="kobo.755.1">],
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.756.1">templateUrl</span></span><span class="koboSpan" id="kobo.757.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.758.1">'./featured.component.html'</span></span><span class="koboSpan" id="kobo.759.1">,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.760.1">styleUrl</span></span><span class="koboSpan" id="kobo.761.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.762.1">'./featured.component.css'</span></span><span class="koboSpan" id="kobo.763.1">
})
</span></code></pre>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.764.1">
      Modify the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.765.1">
       FeaturedComponent
      </span>
     </code>
     <span class="koboSpan" id="kobo.766.1">
      class as follows:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.767.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.768.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.769.1">FeaturedComponent</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.770.1">implements</span></span> <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.771.1">OnInit</span></strong></span><span class="koboSpan" id="kobo.772.1"> {
  </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.773.1">product$: Observable&lt;Product&gt; | undefined;</span></strong></span>
  
  <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.774.1">constructor(private productService: ProductsService) {}</span></strong></span>
  <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.775.1">ngOnInit() {</span></strong></span>
    <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.776.1">this.product$ = this.productService.getFeatured();</span></strong></span>
  <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.777.1">}</span></strong></span><span class="koboSpan" id="kobo.778.1">
}
</span></code></pre>
    </li>
   </ol>
   <p class="normal-one">
    <span class="koboSpan" id="kobo.779.1">
     In the preceding TypeScript class, we have declared the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.780.1">
      product$
     </span>
    </code>
    <span class="koboSpan" id="kobo.781.1">
     observable and assigned it to the returned value of the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.782.1">
      getFeatured
     </span>
    </code>
    <span class="koboSpan" id="kobo.783.1">
     method from the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.784.1">
      ProductsService
     </span>
    </code>
    <span class="koboSpan" id="kobo.785.1">
     class.
    </span>
   </p>
   <ol>
    <li class="numberedList" value="6">
     <span class="koboSpan" id="kobo.786.1">
      Open
     </span>
     <a id="_idIndexMarker923">
     </a>
     <span class="koboSpan" id="kobo.787.1">
      the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.788.1">
       featured.component.html
      </span>
     </code>
     <span class="koboSpan" id="kobo.789.1">
      file and replace its contents with the following HTML code:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="koboSpan" id="kobo.790.1">@if (product$ | async; as product) {
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.791.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.792.1">mat-card</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.793.1">&gt;</span></span>
    <span class="hljs-tag"><span class="koboSpan" id="kobo.794.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.795.1">mat-card-header</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.796.1">&gt;</span></span>
      <span class="hljs-tag"><span class="koboSpan" id="kobo.797.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.798.1">mat-card-title</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.799.1">&gt;</span></span><span class="koboSpan" id="kobo.800.1">MEGA DEAL</span><span class="hljs-tag"><span class="koboSpan" id="kobo.801.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.802.1">mat-card-title</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.803.1">&gt;</span></span>
      <span class="hljs-tag"><span class="koboSpan" id="kobo.804.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.805.1">mat-card-subtitle</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.806.1">&gt;</span></span><span class="koboSpan" id="kobo.807.1">{{ product.title }}</span><span class="hljs-tag"><span class="koboSpan" id="kobo.808.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.809.1">mat-card-subtitle</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.810.1">&gt;</span></span>
    <span class="hljs-tag"><span class="koboSpan" id="kobo.811.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.812.1">mat-card-header</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.813.1">&gt;</span></span>
    <span class="hljs-tag"><span class="koboSpan" id="kobo.814.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.815.1">img</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.816.1">mat-card-image</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.817.1"> [</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.818.1">src</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.819.1">]=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.820.1">"product.image"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.821.1"> /&gt;</span></span>
    <span class="hljs-tag"><span class="koboSpan" id="kobo.822.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.823.1">mat-card-actions</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.824.1">&gt;</span></span>
      <span class="hljs-tag"><span class="koboSpan" id="kobo.825.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.826.1">button</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.827.1">mat-flat-button</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.828.1">color</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.829.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.830.1">"primary"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.831.1">&gt;</span></span><span class="koboSpan" id="kobo.832.1">Buy now</span><span class="hljs-tag"><span class="koboSpan" id="kobo.833.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.834.1">button</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.835.1">&gt;</span></span>
    <span class="hljs-tag"><span class="koboSpan" id="kobo.836.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.837.1">mat-card-actions</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.838.1">&gt;</span></span>
  <span class="hljs-tag"><span class="koboSpan" id="kobo.839.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.840.1">mat-card</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.841.1">&gt;</span></span><span class="koboSpan" id="kobo.842.1">
}
</span></code></pre>
    </li>
   </ol>
   <p class="normal-one">
    <span class="koboSpan" id="kobo.843.1">
     In the preceding snippet, we use the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.844.1">
      async
     </span>
    </code>
    <span class="koboSpan" id="kobo.845.1">
     pipe to subscribe to the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.846.1">
      product$
     </span>
    </code>
    <span class="koboSpan" id="kobo.847.1">
     observable inside the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.848.1">
      @if
     </span>
    </code>
    <span class="koboSpan" id="kobo.849.1">
     block.
    </span>
    <span class="koboSpan" id="kobo.849.2">
     The HTML content of the block displays product details as an Angular Material card component.
    </span>
   </p>
   <ol>
    <li class="numberedList" value="7">
     <span class="koboSpan" id="kobo.850.1">
      Open the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.851.1">
       featured.component.css
      </span>
     </code>
     <span class="koboSpan" id="kobo.852.1">
      file and add the following CSS styles for the card and the button components:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="koboSpan" id="kobo.853.1">mat-card {
  </span><span class="hljs-attribute"><span class="koboSpan" id="kobo.854.1">max-width</span></span><span class="koboSpan" id="kobo.855.1">: </span><span class="hljs-number"><span class="koboSpan" id="kobo.856.1">350px</span></span><span class="koboSpan" id="kobo.857.1">;
}
</span><span class="hljs-selector-tag"><span class="koboSpan" id="kobo.858.1">button</span></span><span class="koboSpan" id="kobo.859.1"> {
  </span><span class="hljs-attribute"><span class="koboSpan" id="kobo.860.1">width</span></span><span class="koboSpan" id="kobo.861.1">: </span><span class="hljs-number"><span class="koboSpan" id="kobo.862.1">100%</span></span><span class="koboSpan" id="kobo.863.1">;
}
</span></code></pre>
    </li>
   </ol>
   <p class="normal">
    <span class="koboSpan" id="kobo.864.1">
     The new Angular
    </span>
    <a id="_idIndexMarker924">
    </a>
    <span class="koboSpan" id="kobo.865.1">
     component is in place.
    </span>
    <span class="koboSpan" id="kobo.865.2">
     We must add it to the main component of the application and use a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.866.1">
      @defer
     </span>
    </code>
    <span class="koboSpan" id="kobo.867.1">
     block to load it:
    </span>
   </p>
   <ol>
    <li class="numberedList" value="1">
     <span class="koboSpan" id="kobo.868.1">
      Open the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.869.1">
       app.component.ts
      </span>
     </code>
     <span class="koboSpan" id="kobo.870.1">
      file and add the following
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.871.1">
       import
      </span>
     </code>
     <span class="koboSpan" id="kobo.872.1">
      statement:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.873.1">import</span></span><span class="koboSpan" id="kobo.874.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.875.1">FeaturedComponent</span></span><span class="koboSpan" id="kobo.876.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.877.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.878.1">'./featured/featured.component'</span></span><span class="koboSpan" id="kobo.879.1">;
</span></code></pre>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.880.1">
      Add the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.881.1">
       FeaturedComponent
      </span>
     </code>
     <span class="koboSpan" id="kobo.882.1">
      class in the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.883.1">
       imports
      </span>
     </code>
     <span class="koboSpan" id="kobo.884.1">
      array of the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.885.1">
       @Component
      </span>
     </code>
     <span class="koboSpan" id="kobo.886.1">
      decorator:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-meta"><span class="koboSpan" id="kobo.887.1">@Component</span></span><span class="koboSpan" id="kobo.888.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.889.1">selector</span></span><span class="koboSpan" id="kobo.890.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.891.1">'app-root'</span></span><span class="koboSpan" id="kobo.892.1">,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.893.1">imports</span></span><span class="koboSpan" id="kobo.894.1">: [
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.895.1">RouterOutlet</span></span><span class="koboSpan" id="kobo.896.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.897.1">RouterLink</span></span><span class="koboSpan" id="kobo.898.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.899.1">CopyrightDirective</span></span><span class="koboSpan" id="kobo.900.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.901.1">AuthComponent</span></span><span class="koboSpan" id="kobo.902.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.903.1">MatToolbarRow</span></span><span class="koboSpan" id="kobo.904.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.905.1">MatToolbar</span></span><span class="koboSpan" id="kobo.906.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.907.1">MatButton</span></span><span class="koboSpan" id="kobo.908.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.909.1">MatBadge</span></span><span class="koboSpan" id="kobo.910.1">,
    </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.911.1">FeaturedComponent</span></strong></span><span class="koboSpan" id="kobo.912.1">
  ],
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.913.1">templateUrl</span></span><span class="koboSpan" id="kobo.914.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.915.1">'./app.component.html'</span></span><span class="koboSpan" id="kobo.916.1">,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.917.1">styleUrl</span></span><span class="koboSpan" id="kobo.918.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.919.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.920.1">./app.component.css'</span></span><span class="koboSpan" id="kobo.921.1">
})
</span></code></pre>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.922.1">
      Open the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.923.1">
       app.component.html
      </span>
     </code>
     <span class="koboSpan" id="kobo.924.1">
      file and add the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.925.1">
       &lt;app-featured&gt;
      </span>
     </code>
     <span class="koboSpan" id="kobo.926.1">
      component inside the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.927.1">
       &lt;main&gt;
      </span>
     </code>
     <span class="koboSpan" id="kobo.928.1">
      HTML tag:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.929.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.930.1">main</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.931.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.932.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.933.1">"main"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.934.1">&gt;</span></span>
  <span class="hljs-tag"><span class="koboSpan" id="kobo.935.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.936.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.937.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.938.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.939.1">"content"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.940.1">&gt;</span></span>
    <span class="hljs-tag"><span class="koboSpan" id="kobo.941.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.942.1">router-outlet</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.943.1"> /&gt;</span></span>
  <span class="hljs-tag"><span class="koboSpan" id="kobo.944.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.945.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.946.1">&gt;</span></span>
  <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.947.1">@defer() {</span></strong></span>
    <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.948.1">&lt;app-featured /&gt;</span></strong></span>
  <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.949.1">}</span></strong></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.950.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.951.1">main</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.952.1">&gt;</span></span>
</code></pre>
    </li>
   </ol>
   <p class="normal-one">
    <span class="koboSpan" id="kobo.953.1">
     In the preceding snippet, we use the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.954.1">
      @defer
     </span>
    </code>
    <span class="koboSpan" id="kobo.955.1">
     block to declare the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.956.1">
      &lt;app-featured&gt;
     </span>
    </code>
    <span class="koboSpan" id="kobo.957.1">
     component using the self-enclosing tag syntax.
    </span>
   </p>
   <ol>
    <li class="numberedList" value="4">
     <span class="koboSpan" id="kobo.958.1">
      Run the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.959.1">
       ng serve
      </span>
     </code>
     <span class="koboSpan" id="kobo.960.1">
      command to
     </span>
     <a id="_idIndexMarker925">
     </a>
     <span class="koboSpan" id="kobo.961.1">
      start the application and observe the
     </span>
     <strong class="screenText">
      <span class="koboSpan" id="kobo.962.1">
       Lazy chunk files
      </span>
     </strong>
     <span class="koboSpan" id="kobo.963.1">
      section in the terminal window:
     </span>
     <pre class="programlisting con-one"><code class="hljs-con"><span class="koboSpan" id="kobo.964.1">Lazy chunk files     | Names              |  Raw size
chunk-OP24QI45.mjs   | featured-component |   2.88 kB | 
chunk-4T4L5V7V.mjs   | user-routes        |   1.19 kB |
</span></code></pre>
    </li>
   </ol>
   <p class="normal-one">
    <span class="koboSpan" id="kobo.965.1">
     The source code of the featured component is split into a chunk file.
    </span>
   </p>
   <ol>
    <li class="numberedList" value="5">
     <span class="koboSpan" id="kobo.966.1">
      Navigate to
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.967.1">
       http://localhost:4200
      </span>
     </code>
     <span class="koboSpan" id="kobo.968.1">
      and observe the new component on the right side of the product list:
     </span>
    </li>
   </ol>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.969.1">
     <img alt="img" src="../Images/B21418_15_04.png"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.970.1">
     Figure 15.4: Featured product
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.971.1">
     Try to reload the browser, and you
    </span>
    <a id="_idIndexMarker926">
    </a>
    <span class="koboSpan" id="kobo.972.1">
     will notice a UI flickering while loading the featured product.
    </span>
    <span class="koboSpan" id="kobo.972.2">
     We will use the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.973.1">
      @placeholder
     </span>
    </code>
    <span class="koboSpan" id="kobo.974.1">
     block to display an outline image before the featured component starts loading:
    </span>
   </p>
   <ol>
    <li class="numberedList" value="1">
     <span class="koboSpan" id="kobo.975.1">
      Copy the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.976.1">
       placeholder.png
      </span>
     </code>
     <span class="koboSpan" id="kobo.977.1">
      image from the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.978.1">
       public
      </span>
     </code>
     <span class="koboSpan" id="kobo.979.1">
      folder of the GitHub repository described in the
     </span>
     <em class="italic">
      <span class="koboSpan" id="kobo.980.1">
       Technical requirements
      </span>
     </em>
     <span class="koboSpan" id="kobo.981.1">
      section to the respective folder of your workspace.
     </span>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.982.1">
      Add a
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.983.1">
       @placeholder
      </span>
     </code>
     <span class="koboSpan" id="kobo.984.1">
      block following the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.985.1">
       @defer
      </span>
     </code>
     <span class="koboSpan" id="kobo.986.1">
      block as follows:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-meta"><span class="koboSpan" id="kobo.987.1">@defer</span></span><span class="koboSpan" id="kobo.988.1">() {
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.989.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.990.1">app-featured</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.991.1"> /&gt;</span></span><span class="koboSpan" id="kobo.992.1">
} </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.993.1">@placeholder(minimum 1s) {</span></strong></span>
  <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.994.1">&lt;img src="placeholder.png" /&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.995.1">}</span></strong></span>
</code></pre>
    </li>
   </ol>
   <p class="normal-one">
    <span class="koboSpan" id="kobo.996.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.997.1">
      @placeholder
     </span>
    </code>
    <span class="koboSpan" id="kobo.998.1">
     block accepts an optional parameter defining the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.999.1">
      minimum
     </span>
    </code>
    <span class="koboSpan" id="kobo.1000.1">
     time the placeholder will be visible.
    </span>
    <span class="koboSpan" id="kobo.1000.2">
     In this case, we have defined the minimum time as
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1001.1">
      1
     </span>
    </code>
    <span class="koboSpan" id="kobo.1002.1">
     second.
    </span>
   </p>
   <ol>
    <li class="numberedList" value="3">
     <span class="koboSpan" id="kobo.1003.1">
      Run the application using the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1004.1">
       ng serve
      </span>
     </code>
     <span class="koboSpan" id="kobo.1005.1">
      command and verify that the following placeholder image is visible for 1 second before the actual content is loaded:
     </span>
    </li>
   </ol>
   <figure class="mediaobject">
    <span class="koboSpan" id="kobo.1006.1">
     <img alt="Εικόνα που περιέχει ορθογώνιο παραλληλόγραμμο, στιγμιότυπο οθόνης  Περιγραφή που δημιουργήθηκε αυτόματα" src="../Images/B21418_15_05.png"/>
    </span>
   </figure>
   <p class="packt_figref">
    <span class="koboSpan" id="kobo.1007.1">
     Figure 15.5: Placeholder image
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1008.1">
     An alternate
    </span>
    <a id="_idIndexMarker927">
    </a>
    <span class="koboSpan" id="kobo.1009.1">
     approach would be to use the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1010.1">
      @loading
     </span>
    </code>
    <span class="koboSpan" id="kobo.1011.1">
     block and display a loading indicator, such as a spinner, while the featured component is loading:
    </span>
   </p>
   <ol>
    <li class="numberedList" value="1">
     <span class="koboSpan" id="kobo.1012.1">
      Open the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1013.1">
       app.component.ts
      </span>
     </code>
     <span class="koboSpan" id="kobo.1014.1">
      file and add the following
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1015.1">
       import
      </span>
     </code>
     <span class="koboSpan" id="kobo.1016.1">
      statement:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1017.1">import</span></span><span class="koboSpan" id="kobo.1018.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1019.1">MatProgressSpinner</span></span><span class="koboSpan" id="kobo.1020.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1021.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1022.1">'@angular/material/progress-spinner'</span></span><span class="koboSpan" id="kobo.1023.1">;
</span></code></pre>
    </li>
   </ol>
   <p class="normal-one">
    <span class="koboSpan" id="kobo.1024.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1025.1">
      MatProgressSpinner
     </span>
    </code>
    <span class="koboSpan" id="kobo.1026.1">
     class is a spinner component from the Angular Material library.
    </span>
   </p>
   <ol>
    <li class="numberedList" value="2">
     <span class="koboSpan" id="kobo.1027.1">
      Add the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1028.1">
       MatProgressSpinner
      </span>
     </code>
     <span class="koboSpan" id="kobo.1029.1">
      class in the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1030.1">
       imports
      </span>
     </code>
     <span class="koboSpan" id="kobo.1031.1">
      array of the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1032.1">
       @Component
      </span>
     </code>
     <span class="koboSpan" id="kobo.1033.1">
      decorator:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-meta"><span class="koboSpan" id="kobo.1034.1">@Component</span></span><span class="koboSpan" id="kobo.1035.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1036.1">selector</span></span><span class="koboSpan" id="kobo.1037.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1038.1">'app-root'</span></span><span class="koboSpan" id="kobo.1039.1">,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1040.1">imports</span></span><span class="koboSpan" id="kobo.1041.1">: [
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1042.1">RouterOutlet</span></span><span class="koboSpan" id="kobo.1043.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1044.1">RouterLink</span></span><span class="koboSpan" id="kobo.1045.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1046.1">CopyrightDirective</span></span><span class="koboSpan" id="kobo.1047.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1048.1">AuthComponent</span></span><span class="koboSpan" id="kobo.1049.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1050.1">MatToolbarRow</span></span><span class="koboSpan" id="kobo.1051.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1052.1">MatToolbar</span></span><span class="koboSpan" id="kobo.1053.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1054.1">MatButton</span></span><span class="koboSpan" id="kobo.1055.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1056.1">MatBadge</span></span><span class="koboSpan" id="kobo.1057.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1058.1">FeaturedComponent</span></span><span class="koboSpan" id="kobo.1059.1">,
    </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1060.1">MatProgressSpinner</span></strong></span><span class="koboSpan" id="kobo.1061.1">
  ],
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1062.1">templateUrl</span></span><span class="koboSpan" id="kobo.1063.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1064.1">'./app.component.html'</span></span><span class="koboSpan" id="kobo.1065.1">,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1066.1">styleUrl</span></span><span class="koboSpan" id="kobo.1067.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1068.1">'./app.component.css'</span></span><span class="koboSpan" id="kobo.1069.1">
})
</span></code></pre>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.1070.1">
      Add the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1071.1">
       @loading
      </span>
     </code>
     <span class="koboSpan" id="kobo.1072.1">
      block in
     </span>
     <a id="_idIndexMarker928">
     </a>
     <span class="koboSpan" id="kobo.1073.1">
      the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1074.1">
       app.component.html
      </span>
     </code>
     <span class="koboSpan" id="kobo.1075.1">
      file as follows:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-meta"><span class="koboSpan" id="kobo.1076.1">@defer</span></span><span class="koboSpan" id="kobo.1077.1">() {
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1078.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1079.1">app-featured</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1080.1"> /&gt;</span></span><span class="koboSpan" id="kobo.1081.1">
} </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1082.1">@loading(minimum 1s) {</span></strong></span>
  <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1083.1">&lt;mat-spinner ngSkipHydration&gt;&lt;/mat-spinner&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1084.1">}</span></strong></span>
</code></pre>
    </li>
   </ol>
   <p class="normal-one">
    <span class="koboSpan" id="kobo.1085.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1086.1">
      @loading
     </span>
    </code>
    <span class="koboSpan" id="kobo.1087.1">
     block accepts the same optional parameters as the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1088.1">
      @placeholder
     </span>
    </code>
    <span class="koboSpan" id="kobo.1089.1">
     block.
    </span>
    <span class="koboSpan" id="kobo.1089.2">
     In this case, we show the spinner component for
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1090.1">
      1
     </span>
    </code>
    <span class="koboSpan" id="kobo.1091.1">
     second minimum.
    </span>
   </p>
   <div class="note-one">
    <p class="normal">
     <span class="koboSpan" id="kobo.1092.1">
      We added the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1093.1">
       ngSkipHydration
      </span>
     </code>
     <span class="koboSpan" id="kobo.1094.1">
      attribute because the spinner component interacts with the browser DOM and cannot be hydrated.
     </span>
    </p>
   </div>
   <ol>
    <li class="numberedList" value="4">
     <span class="koboSpan" id="kobo.1095.1">
      If we run the application using the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1096.1">
       ng serve
      </span>
     </code>
     <span class="koboSpan" id="kobo.1097.1">
      command, we should see a spinner indication for 1 second while the featured component is loading.
     </span>
    </li>
   </ol>
   <p class="normal">
    <span class="koboSpan" id="kobo.1098.1">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1099.1">
      @error
     </span>
    </code>
    <span class="koboSpan" id="kobo.1100.1">
     block in deferrable views works similarly to the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1101.1">
      @placeholder
     </span>
    </code>
    <span class="koboSpan" id="kobo.1102.1">
     and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1103.1">
      @loading
     </span>
    </code>
    <span class="koboSpan" id="kobo.1104.1">
     blocks.
    </span>
    <span class="koboSpan" id="kobo.1104.2">
     The HTML content inside it will be visible when an error occurs while loading the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1105.1">
      @defer
     </span>
    </code>
    <span class="koboSpan" id="kobo.1106.1">
     block contents:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-meta"><span class="koboSpan" id="kobo.1107.1">@defer</span></span><span class="koboSpan" id="kobo.1108.1">() {
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1109.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1110.1">app-featured</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1111.1"> /&gt;</span></span><span class="koboSpan" id="kobo.1112.1">
} </span><span class="hljs-meta"><span class="koboSpan" id="kobo.1113.1">@placeholder</span></span><span class="koboSpan" id="kobo.1114.1">(minimum 1s) {
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1115.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1116.1">img</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1117.1">src</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1118.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1119.1">"placeholder.png"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1120.1"> /&gt;</span></span><span class="koboSpan" id="kobo.1121.1">
} </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1122.1">@error() {</span></strong></span>
  <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1123.1">&lt;span&gt;An error occurred while loading the featured product&lt;/span&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1124.1">}</span></strong></span>
</code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1125.1">
     As we have seen, the
    </span>
    <a id="_idIndexMarker929">
    </a>
    <span class="koboSpan" id="kobo.1126.1">
     contents of a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1127.1">
      @defer
     </span>
    </code>
    <span class="koboSpan" id="kobo.1128.1">
     block start loading immediately when the component that it belongs to is rendered.
    </span>
    <span class="koboSpan" id="kobo.1128.2">
     However, the deferrable views API provides us with ergonomic tools to control when the block will be loaded, as we will see in the following section.
    </span>
   </p>
   <h2 class="heading-2" id="_idParaDest-275">
    <span class="koboSpan" id="kobo.1129.1">
     Loading patterns in @defer blocks
    </span>
   </h2>
   <p class="normal">
    <span class="koboSpan" id="kobo.1130.1">
     Using
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.1131.1">
      triggers
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1132.1">
     and
    </span>
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.1133.1">
      prefetch
     </span>
    </strong>
    <span class="koboSpan" id="kobo.1134.1">
     mechanisms, we can
    </span>
    <a id="_idIndexMarker930">
    </a>
    <span class="koboSpan" id="kobo.1135.1">
     control how and when a
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1136.1">
      @defer
     </span>
    </code>
    <span class="koboSpan" id="kobo.1137.1">
     block will load:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.1138.1">
      Triggers define when the block’s contents start loading
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.1139.1">
      Prefetch defines whether Angular will fetch the contents beforehand so that they are available when needed
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.1140.1">
     We can define a trigger as an optional parameter inside the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1141.1">
      @defer
     </span>
    </code>
    <span class="koboSpan" id="kobo.1142.1">
     block using the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1143.1">
      on
     </span>
    </code>
    <span class="koboSpan" id="kobo.1144.1">
     keyword and the name of the trigger:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-meta"><span class="koboSpan" id="kobo.1145.1">@defer</span></span><span class="koboSpan" id="kobo.1146.1">(</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1147.1">on viewport</span></strong></span><span class="koboSpan" id="kobo.1148.1">) {
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1149.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1150.1">app-featured</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1151.1"> /&gt;</span></span><span class="koboSpan" id="kobo.1152.1">
} </span><span class="hljs-meta"><span class="koboSpan" id="kobo.1153.1">@placeholder</span></span><span class="koboSpan" id="kobo.1154.1">(minimum 1s) {
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1155.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1156.1">img</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1157.1">src</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1158.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1159.1">"placeholder.png"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1160.1"> /&gt;</span></span><span class="koboSpan" id="kobo.1161.1">
} </span><span class="hljs-meta"><span class="koboSpan" id="kobo.1162.1">@error</span></span><span class="koboSpan" id="kobo.1163.1">() {
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1164.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1165.1">span</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1166.1">&gt;</span></span><span class="koboSpan" id="kobo.1167.1">An error occurred while loading the featured product</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1168.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1169.1">span</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1170.1">&gt;</span></span><span class="koboSpan" id="kobo.1171.1">
}
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1172.1">
     The Angular framework contains the following built-in triggers:
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1173.1">
       viewport
      </span>
     </code>
     <span class="koboSpan" id="kobo.1174.1">
      : This will trigger the block when the content enters the browser
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.1175.1">
       viewport
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1176.1">
      , which is
     </span>
     <a id="_idIndexMarker931">
     </a>
     <span class="koboSpan" id="kobo.1177.1">
      the part of the browser that is currently visible.
     </span>
    </li>
   </ul>
   <div class="packt_tip-one">
    <p class="normal">
     <span class="koboSpan" id="kobo.1178.1">
      You can learn more about the
     </span>
     <a id="_idIndexMarker932">
     </a>
     <span class="koboSpan" id="kobo.1179.1">
      viewport at
     </span>
     <a href="https://developer.mozilla.org/docs/Glossary/Viewport">
      <span class="url">
       <span class="koboSpan" id="kobo.1180.1">
        https://developer.mozilla.org/docs/Glossary/Viewport
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.1181.1">
      .
     </span>
    </p>
   </div>
   <ul>
    <li class="bulletList">
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1182.1">
       interaction
      </span>
     </code>
     <span class="koboSpan" id="kobo.1183.1">
      : This will trigger the block when the user interacts with the content.
     </span>
    </li>
    <li class="bulletList">
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1184.1">
       hover
      </span>
     </code>
     <span class="koboSpan" id="kobo.1185.1">
      : This will trigger the block when users hover over the area covered by the content with their mouse.
     </span>
    </li>
    <li class="bulletList">
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1186.1">
       idle
      </span>
     </code>
     <span class="koboSpan" id="kobo.1187.1">
      : This will trigger the block when the browser has entered an
     </span>
     <strong class="keyWord">
      <span class="koboSpan" id="kobo.1188.1">
       idle
      </span>
     </strong>
     <span class="koboSpan" id="kobo.1189.1">
      state, which is the default behavior of deferrable views.
     </span>
     <span class="koboSpan" id="kobo.1189.2">
      The idle state of the browser is triggered by the native
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1190.1">
       requestIdleCallback
      </span>
     </code>
     <span class="koboSpan" id="kobo.1191.1">
      API.
     </span>
    </li>
   </ul>
   <div class="packt_tip-one">
    <p class="normal">
     <span class="koboSpan" id="kobo.1192.1">
      You can learn more about the idle state at
     </span>
     <a href="https://developer.mozilla.org/docs/Web/API/Window/requestIdleCallback">
      <span class="url">
       <span class="koboSpan" id="kobo.1193.1">
        https://developer.mozilla.org/docs/Web/API/Window/requestIdleCallback
       </span>
      </span>
     </a>
     <span class="koboSpan" id="kobo.1194.1">
      .
     </span>
    </p>
   </div>
   <ul>
    <li class="bulletList">
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1195.1">
       immediate
      </span>
     </code>
     <span class="koboSpan" id="kobo.1196.1">
      : This will trigger the block when the client renders the page.
     </span>
    </li>
   </ul>
   <div class="packt_tip-one">
    <p class="normal">
     <span class="koboSpan" id="kobo.1197.1">
      The difference between not using the block and using it with the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1198.1">
       immediate
      </span>
     </code>
     <span class="koboSpan" id="kobo.1199.1">
      trigger is that we benefit from the code-splitting features of deferrable views and deliver less JavaScript to the client.
     </span>
    </p>
   </div>
   <ul>
    <li class="bulletList">
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1200.1">
       timer
      </span>
     </code>
     <span class="koboSpan" id="kobo.1201.1">
      : This will
     </span>
     <a id="_idIndexMarker933">
     </a>
     <span class="koboSpan" id="kobo.1202.1">
      trigger the block after a specified duration.
     </span>
     <span class="koboSpan" id="kobo.1202.2">
      The duration is a required parameter of the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1203.1">
       timer
      </span>
     </code>
     <span class="koboSpan" id="kobo.1204.1">
      function:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-meta"><span class="koboSpan" id="kobo.1205.1">@defer</span></span><span class="koboSpan" id="kobo.1206.1">(</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1207.1">on timer(2s)</span></strong></span><span class="koboSpan" id="kobo.1208.1">) {
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1209.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1210.1">app-featured</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1211.1"> /&gt;</span></span><span class="koboSpan" id="kobo.1212.1">
}
</span></code></pre>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.1213.1">
      The preceding snippet will start loading the featured component after
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1214.1">
       2
      </span>
     </code>
     <span class="koboSpan" id="kobo.1215.1">
      seconds.
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.1216.1">
     We can achieve better loading granularity by combining triggers:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-meta"><span class="koboSpan" id="kobo.1217.1">@defer</span></span><span class="koboSpan" id="kobo.1218.1">(</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1219.1">on timer(2s); on idle</span></strong></span><span class="koboSpan" id="kobo.1220.1">) {
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1221.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1222.1">app-featured</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1223.1"> /&gt;</span></span><span class="koboSpan" id="kobo.1224.1">
}
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1225.1">
     The preceding snippet will load the featured component when the browser is
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1226.1">
      idle
     </span>
    </code>
    <em class="italic">
     <span class="koboSpan" id="kobo.1227.1">
      or
     </span>
    </em>
    <span class="koboSpan" id="kobo.1228.1">
     after
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1229.1">
      2
     </span>
    </code>
    <span class="koboSpan" id="kobo.1230.1">
     seconds.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1231.1">
     In addition to the built-in triggers, we can create custom triggers by ourselves using the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1232.1">
      when
     </span>
    </code>
    <span class="koboSpan" id="kobo.1233.1">
     keyword.
    </span>
    <span class="koboSpan" id="kobo.1233.2">
     The
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1234.1">
      when
     </span>
    </code>
    <span class="koboSpan" id="kobo.1235.1">
     keyword is followed by an expression that evaluates to a boolean:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-meta"><span class="koboSpan" id="kobo.1236.1">@defer</span></span><span class="koboSpan" id="kobo.1237.1">(</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1238.1">when isActive === true</span></strong></span><span class="koboSpan" id="kobo.1239.1">) {
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1240.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1241.1">app-featured</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1242.1"> /&gt;</span></span><span class="koboSpan" id="kobo.1243.1">
}
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1244.1">
     In the preceding snippet, the featured component will be loaded when the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1245.1">
      isActive
     </span>
    </code>
    <span class="koboSpan" id="kobo.1246.1">
     component property is
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1247.1">
      true
     </span>
    </code>
    <span class="koboSpan" id="kobo.1248.1">
     .
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1249.1">
     Triggers
    </span>
    <a id="_idIndexMarker934">
    </a>
    <span class="koboSpan" id="kobo.1250.1">
     in deferrable
    </span>
    <a id="_idIndexMarker935">
    </a>
    <span class="koboSpan" id="kobo.1251.1">
     views are powerful and ergonomic tools that can give amazing results in speed and performance.
    </span>
    <span class="koboSpan" id="kobo.1251.2">
     When combined with prefetching, they can achieve great performance improvements in Angular applications.
    </span>
    <span class="koboSpan" id="kobo.1251.3">
     Prefetching allows us to specify the condition in which we can prefetch a deferrable view to be ready when needed.
    </span>
    <span class="koboSpan" id="kobo.1251.4">
     Prefetching supports all built-in triggers of deferrable views:
    </span>
   </p>
   <pre class="programlisting code"><code class="hljs-code"><span class="hljs-meta"><span class="koboSpan" id="kobo.1252.1">@defer</span></span><span class="koboSpan" id="kobo.1253.1">(on </span><span class="hljs-title"><span class="koboSpan" id="kobo.1254.1">timer</span></span><span class="koboSpan" id="kobo.1255.1">(2s); </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1256.1">prefetch on idle</span></strong></span><span class="koboSpan" id="kobo.1257.1">) {
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1258.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1259.1">app-featured</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1260.1"> /&gt;</span></span><span class="koboSpan" id="kobo.1261.1">
}
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1262.1">
     The preceding snippet will prefetch the content when the browser is
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1263.1">
      idle
     </span>
    </code>
    <span class="koboSpan" id="kobo.1264.1">
     and load it after
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1265.1">
      2
     </span>
    </code>
    <span class="koboSpan" id="kobo.1266.1">
     seconds.
    </span>
    <span class="koboSpan" id="kobo.1266.2">
     It can also define when it will prefetch the content using the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1267.1">
      when
     </span>
    </code>
    <span class="koboSpan" id="kobo.1268.1">
     keyword or create custom triggers.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1269.1">
     Triggers and prefetching allow us to create sophisticated and complex scenarios for loading deferrable views.
    </span>
    <span class="koboSpan" id="kobo.1269.2">
     The versatility that the deferrable views API provides makes it a very useful tool in developing highly sophisticated and performant Angular applications.
    </span>
   </p>
   <div class="note">
    <p class="normal">
     <span class="koboSpan" id="kobo.1270.1">
      Deferrable views should not be used for content that must be rendered immediately.
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.1271.1">
     In the following section, we will conclude our journey to optimizing application performance with Angular SSG.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-276">
    <span class="koboSpan" id="kobo.1272.1">
     Prerendering SSG applications
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.1273.1">
     SSG or build-time prerendering is the
    </span>
    <a id="_idIndexMarker936">
    </a>
    <span class="koboSpan" id="kobo.1274.1">
     process of creating static generated HTML files for an Angular application.
    </span>
    <span class="koboSpan" id="kobo.1274.2">
     It happens by default when we build an Angular SSR application using the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1275.1">
      ng build
     </span>
    </code>
    <span class="koboSpan" id="kobo.1276.1">
     Angular CLI command.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1277.1">
     The main benefit of an SSG application is that it does not require round-trip times between the server and client for each request.
    </span>
    <span class="koboSpan" id="kobo.1277.2">
     Instead, every page is served as static content, eliminating the time it takes to load the application, as measured by the TTFB CWV metric.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1278.1">
     In the
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.1279.1">
      Rendering SSR applications
     </span>
    </em>
    <span class="koboSpan" id="kobo.1280.1">
     section, the output of the Angular CLI build command included the following message:
    </span>
   </p>
   <pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1281.1">Prerendered 4 static routes.
</span></code></pre>
   <p class="normal">
    <span class="koboSpan" id="kobo.1282.1">
     Let’s see how SSG
    </span>
    <a id="_idIndexMarker937">
    </a>
    <span class="koboSpan" id="kobo.1283.1">
     works and what the preceding output means:
    </span>
   </p>
   <ol>
    <li class="numberedList" value="1">
     <span class="koboSpan" id="kobo.1284.1">
      Run the following command to build the Angular application:
     </span>
     <pre class="programlisting con-one"><code class="hljs-con"><span class="koboSpan" id="kobo.1285.1">ng build
</span></code></pre>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.1286.1">
      The
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1287.1">
       ng build
      </span>
     </code>
     <span class="koboSpan" id="kobo.1288.1">
      command will create the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1289.1">
       dist\my-app\browser
      </span>
     </code>
     <span class="koboSpan" id="kobo.1290.1">
      folder.
     </span>
    </li>
   </ol>
   <div class="note-one">
    <p class="normal">
     <span class="koboSpan" id="kobo.1291.1">
      The preceding folder should not be confused with the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1292.1">
       browser
      </span>
     </code>
     <span class="koboSpan" id="kobo.1293.1">
      folder generated when building a non-SSR Angular application.
     </span>
    </p>
   </div>
   <ol>
    <li class="numberedList" value="3">
     <span class="koboSpan" id="kobo.1294.1">
      Navigate to the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1295.1">
       dist\my-app
      </span>
     </code>
     <span class="koboSpan" id="kobo.1296.1">
      folder and open the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1297.1">
       prerendered-routes.json
      </span>
     </code>
     <span class="koboSpan" id="kobo.1298.1">
      file:
     </span>
     <pre class="programlisting code-one"><code class="hljs-code"><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1299.1">{</span></span>
  <span class="hljs-attr"><span class="koboSpan" id="kobo.1300.1">"routes"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1301.1">:</span></span> <span class="hljs-punctuation"><span class="koboSpan" id="kobo.1302.1">[</span></span>
    <span class="hljs-string"><span class="koboSpan" id="kobo.1303.1">"/cart"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1304.1">,</span></span>
    <span class="hljs-string"><span class="koboSpan" id="kobo.1305.1">"/products"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1306.1">,</span></span>
    <span class="hljs-string"><span class="koboSpan" id="kobo.1307.1">"/products/new"</span></span><span class="hljs-punctuation"><span class="koboSpan" id="kobo.1308.1">,</span></span>
    <span class="hljs-string"><span class="koboSpan" id="kobo.1309.1">"/user"</span></span>
  <span class="hljs-punctuation"><span class="koboSpan" id="kobo.1310.1">]</span></span>
<span class="hljs-punctuation"><span class="koboSpan" id="kobo.1311.1">}</span></span>
</code></pre>
    </li>
   </ol>
   <p class="normal-one">
    <span class="koboSpan" id="kobo.1312.1">
     It lists the application routes that Angular SSG prerendered.
    </span>
    <span class="koboSpan" id="kobo.1312.2">
     It has also created one folder and
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1313.1">
      index.html
     </span>
    </code>
    <span class="koboSpan" id="kobo.1314.1">
     file for each route inside the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1315.1">
      browser
     </span>
    </code>
    <span class="koboSpan" id="kobo.1316.1">
     folder.
    </span>
   </p>
   <ol>
    <li class="numberedList" value="4">
     <span class="koboSpan" id="kobo.1317.1">
      Open the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1318.1">
       products\index.html
      </span>
     </code>
     <span class="koboSpan" id="kobo.1319.1">
      file, and you will see that Angular has added all CSS and HTML files, and it has even rendered the product data as fetched from the Fake Store API.
     </span>
    </li>
    <li class="numberedList">
     <span class="koboSpan" id="kobo.1320.1">
      To preview how SSG works, run the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1321.1">
       ng serve
      </span>
     </code>
     <span class="koboSpan" id="kobo.1322.1">
      command to start the application and navigate to
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1323.1">
       http://localhost:4200/products
      </span>
     </code>
     <span class="koboSpan" id="kobo.1324.1">
      .
     </span>
     <span class="koboSpan" id="kobo.1324.2">
      The product list loads instantly without waiting for the application to fetch data from the Fake Store API.
     </span>
    </li>
   </ol>
   <div class="packt_tip">
    <p class="normal">
     <span class="koboSpan" id="kobo.1325.1">
      The
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1326.1">
       ng serve
      </span>
     </code>
     <span class="koboSpan" id="kobo.1327.1">
      command serves the SSG version of our application because it executes the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1328.1">
       ng build
      </span>
     </code>
     <span class="koboSpan" id="kobo.1329.1">
      command under the hood.
     </span>
     <span class="koboSpan" id="kobo.1329.2">
      To disable SSG, open the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1330.1">
       angular.json
      </span>
     </code>
     <span class="koboSpan" id="kobo.1331.1">
      file and set the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1332.1">
       prerender
      </span>
     </code>
     <span class="koboSpan" id="kobo.1333.1">
      property to
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1334.1">
       false
      </span>
     </code>
     <span class="koboSpan" id="kobo.1335.1">
      inside the
     </span>
     <code class="inlineCode">
      <span class="koboSpan" id="kobo.1336.1">
       build
      </span>
     </code>
     <span class="koboSpan" id="kobo.1337.1">
      section.
     </span>
    </p>
   </div>
   <p class="normal">
    <span class="koboSpan" id="kobo.1338.1">
     SSG is enabled by
    </span>
    <a id="_idIndexMarker938">
    </a>
    <span class="koboSpan" id="kobo.1339.1">
     default in Angular SSR applications and can dramatically improve their loading time and runtime performance.
    </span>
    <span class="koboSpan" id="kobo.1339.2">
     It can be particularly useful for low-end devices with poor performance.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-277">
    <span class="koboSpan" id="kobo.1340.1">
     Summary
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.1341.1">
     In this chapter, we learned different ways to optimize and improve the performance of an Angular application.
    </span>
    <span class="koboSpan" id="kobo.1341.2">
     We introduced the concept of CWV and how it can affect a web application.
    </span>
    <span class="koboSpan" id="kobo.1341.3">
     We explored how to measure and improve CWV metrics using SSR and hydration in Angular applications.
    </span>
    <span class="koboSpan" id="kobo.1341.4">
     We also investigated different aspects of performance optimizations, such as the
    </span>
    <code class="inlineCode">
     <span class="koboSpan" id="kobo.1342.1">
      NgOptimizedImage
     </span>
    </code>
    <span class="koboSpan" id="kobo.1343.1">
     directive and deferrable views.
    </span>
    <span class="koboSpan" id="kobo.1343.2">
     Finally, we saw an overview of SSG in Angular applications.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1344.1">
     Our journey with the Angular framework ends with this chapter.
    </span>
    <span class="koboSpan" id="kobo.1344.2">
     However, the possibilities of what we can do are endless.
    </span>
    <span class="koboSpan" id="kobo.1344.3">
     The Angular framework is updated with new features in each release, giving web developers a powerful tool for everyday development.
    </span>
    <span class="koboSpan" id="kobo.1344.4">
     We were delighted to have you on board, and we hope this book has helped you to broaden your ideas on what you can achieve with such an excellent tool!
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-278">
    <span class="koboSpan" id="kobo.1345.1">
     Join us on Discord
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.1346.1">
     Join our community’s Discord space for discussions with the author and other readers:
    </span>
   </p>
   <p class="normal">
    <a href="https://packt.link/LearningAngular5e">
     <span class="url">
      <span class="koboSpan" id="kobo.1347.1">
       https://packt.link/LearningAngular5e
      </span>
     </span>
    </a>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.1348.1">
     <img alt="img" src="../Images/QR_Code1314413148229661500.png"/>
    </span>
   </p>
  </div>
 

  <div id="_idContainer359">
   <p class="BM-packtLogo">
    <span class="koboSpan" id="kobo.1.1">
     <img alt="img" src="../Images/New_Packt_Logo1.png"/>
    </span>
   </p>
   <p class="normal">
    <a href="https://www.packt.com">
     <span class="url">
      <span class="koboSpan" id="kobo.2.1">
       packt.com
      </span>
     </span>
    </a>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.3.1">
     Subscribe to our online digital library for full access to over 7,000 books and videos, as well as industry leading tools to help you plan your personal development and advance your career.
    </span>
    <span class="koboSpan" id="kobo.3.2">
     For more information, please visit our website.
    </span>
   </p>
   <h1 class="heading-1" id="_idParaDest-279">
    <span class="koboSpan" id="kobo.4.1">
     Why Subscribe?
    </span>
   </h1>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.5.1">
      Spend less time learning and more time coding with practical eBooks and Videos from over 4,000 industry professionals
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.6.1">
      Improve your learning with Skill Plans built especially for you
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.7.1">
      Get a free eBook or video every month
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.8.1">
      Fully searchable for easy access to vital information
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.9.1">
      Copy and paste, print, and bookmark content
     </span>
    </li>
   </ul>
   <p class="normal">
    <span class="koboSpan" id="kobo.10.1">
     At
    </span>
    <a href="https://www.packt.com">
     <span class="url">
      <span class="koboSpan" id="kobo.11.1">
       www.packt.com
      </span>
     </span>
    </a>
    <span class="koboSpan" id="kobo.12.1">
     , you can also read a collection of free technical articles, sign up for a range of free newsletters, and receive exclusive discounts and offers on Packt books and eBooks.
    </span>
   </p>
   <p class="eop">
   </p>
   <h1 class="mainHeading" id="_idParaDest-280">
    <span class="koboSpan" id="kobo.13.1">
     Other Books You May Enjoy
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.14.1">
     If you enjoyed this book, you may be interested in these other books by Packt:
    </span>
   </p>
   <p class="BM-bookCover">
    <a href="https://www.packtpub.com/en-us/product/effective-angular-9781805123002">
     <span class="koboSpan" id="kobo.15.1">
      <img alt="img" src="../Images/978-1-80512-553-2.jpg"/>
     </span>
    </a>
   </p>
   <p class="normal">
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.16.1">
      Effective Angular
     </span>
    </strong>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.17.1">
     Roberto Heckers
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.18.1">
     ISBN: 978-1-80512-553-2
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.19.1">
      Create Nx monorepos ready to handle hundreds of Angular applications
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.20.1">
      Reduce complexity in Angular with the standalone API, inject function, control flow, and Signals
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.21.1">
      Effectively manage application state using Signals, RxJS, and NgRx
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.22.1">
      Build dynamic components with projection, TemplateRef, and defer blocks
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.23.1">
      Perform end-to-end and unit testing in Angular with Cypress and Jest
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.24.1">
      Optimize Angular performance, prevent bad practices, and automate deployments
     </span>
    </li>
   </ul>
   <p class="eop">
   </p>
   <p class="BM-bookCover">
    <a href="https://www.packtpub.com/en-us/product/reactive-patterns-with-rxjs-and-angular-signals-9781835083185">
     <span class="koboSpan" id="kobo.25.1">
      <img alt="img" src="../Images/978-1-83508-770-1.jpg"/>
     </span>
    </a>
   </p>
   <p class="normal">
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.26.1">
      Reactive Patterns with RxJS and Angular Signals
     </span>
    </strong>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.27.1">
     Lamis Chebbi
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.28.1">
     ISBN: 978-1-83508-770-1
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.29.1">
      Get to grips with RxJS core concepts such as Observables, subjects, and operators
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.30.1">
      Use the marble diagram in reactive patterns
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.31.1">
      Delve into stream manipulation, including transforming and combining them
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.32.1">
      Understand memory leak problems using RxJS and best practices to avoid them
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.33.1">
      Build reactive patterns using Angular Signals and RxJS
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.34.1">
      Explore different testing strategies for RxJS apps
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.35.1">
      Discover multicasting in RxJS and how it can resolve complex problems
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.36.1">
      Build a complete Angular app reactively using the latest features of RxJS and Angular
     </span>
    </li>
   </ul>
   <p class="eop">
   </p>
   <p class="BM-bookCover">
    <a href="https://www.packtpub.com/en-us/product/angular-for-enterprise-applications-9781805125037">
     <span class="koboSpan" id="kobo.37.1">
      <img alt="img" src="../Images/978-1-80512-712-3.jpg"/>
     </span>
    </a>
   </p>
   <p class="normal">
    <strong class="keyWord">
     <span class="koboSpan" id="kobo.38.1">
      Angular for Enterprise Applications, Third Edition
     </span>
    </strong>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.39.1">
     Doguhan Uluca
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.40.1">
     ISBN: 978-1-80512-712-3
    </span>
   </p>
   <ul>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.41.1">
      Best practices for architecting and leading enterprise projects
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.42.1">
      Minimalist, value-first approach to delivering web apps
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.43.1">
      How standalone components, services, providers, modules, lazy loading, and directives work in Angular
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.44.1">
      Manage your app’s data reactivity using Signals or RxJS
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.45.1">
      State management for your Angular apps with NgRx
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.46.1">
      Angular ecosystem to build and deliver enterprise applications
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.47.1">
      Automated testing and CI/CD to deliver high quality apps
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.48.1">
      Authentication and authorization
     </span>
    </li>
    <li class="bulletList">
     <span class="koboSpan" id="kobo.49.1">
      Building role-based access control with REST and GraphQL
     </span>
    </li>
   </ul>
   <p class="eop">
   </p>
   <h1 class="heading-1" id="_idParaDest-281">
    <span class="koboSpan" id="kobo.50.1">
     Packt is searching for authors like you
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.51.1">
     If you’re interested in becoming an author for Packt, please visit
    </span>
    <a href="https://authors.packtpub.com">
     <span class="url">
      <span class="koboSpan" id="kobo.52.1">
       authors.packtpub.com
      </span>
     </span>
    </a>
    <span class="koboSpan" id="kobo.53.1">
     and apply today.
    </span>
    <span class="koboSpan" id="kobo.53.2">
     We have worked with thousands of developers and tech professionals, just like you, to help them share their insight with the global tech community.
    </span>
    <span class="koboSpan" id="kobo.53.3">
     You can make a general application, apply for a specific hot topic that we are recruiting an author for, or submit your own idea.
    </span>
   </p>
  </div>
  <div class="Basic-Text-Frame" id="_idContainer360">
   <p class="eop">
   </p>
   <h1 class="heading-1" id="_idParaDest-282">
    <span class="koboSpan" id="kobo.54.1">
     Share your thoughts
    </span>
   </h1>
   <p class="normal">
    <span class="koboSpan" id="kobo.55.1">
     Now you’ve finished
    </span>
    <em class="italic">
     <span class="koboSpan" id="kobo.56.1">
      Learning Angular, Fifth Edition
     </span>
    </em>
    <span class="koboSpan" id="kobo.57.1">
     , we’d love to hear your thoughts!
    </span>
    <span class="koboSpan" id="kobo.57.2">
     If you purchased the book from Amazon, please
    </span>
    <a href="https://packt.link/r/1835087485">
     <span class="url">
      <span class="koboSpan" id="kobo.58.1">
       click here to go straight to the Amazon review page
      </span>
     </span>
    </a>
    <span class="koboSpan" id="kobo.59.1">
     for this book and share your feedback or leave a review on the site that you purchased it from.
    </span>
   </p>
   <p class="normal">
    <span class="koboSpan" id="kobo.60.1">
     Your review is important to us and the tech community and will help us make sure we’re delivering excellent quality content.
    </span>
   </p>
  </div>
 </body></html>
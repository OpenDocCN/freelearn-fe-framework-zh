<html><head></head><body>
<div class="Basic-Text-Frame" id="_idContainer073">
<h1 class="chapterNumber"><span class="koboSpan" id="kobo.1.1">3</span></h1>
<h1 class="chapterTitle" id="_idParaDest-88"><span class="koboSpan" id="kobo.2.1">The Magic of Dependency Injection in Angular</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.3.1">This chapter is all about the magic of </span><strong class="keyWord"><span class="koboSpan" id="kobo.4.1">Dependency Injection</span></strong><span class="koboSpan" id="kobo.5.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.6.1">DI</span></strong><span class="koboSpan" id="kobo.7.1">) in Angular. </span><span class="koboSpan" id="kobo.7.2">Here, you’ll learn some detailed information about the concept of DI in Angular. </span><span class="koboSpan" id="kobo.7.3">DI is the process that Angular uses to inject different dependencies into components, directives, and services. </span><span class="koboSpan" id="kobo.7.4">You’ll work with several examples, using services and providers to get some hands-on experience that you can utilize in your later Angular projects.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.8.1">In this chapter, we’re going to cover the following recipes:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.9.1">Using Angular DI tokens</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.10.1">Optional dependencies</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.11.1">Creating a singleton service using </span><code class="inlineCode"><span class="koboSpan" id="kobo.12.1">providedIn</span></code></li>
<li class="bulletList"><span class="koboSpan" id="kobo.13.1">Creating a singleton service using </span><code class="inlineCode"><span class="koboSpan" id="kobo.14.1">forRoot()</span></code></li>
<li class="bulletList"><span class="koboSpan" id="kobo.15.1">Providing alternate classes against the same DI token</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.16.1">Dynamic configurations using value providers</span></li>
</ul>
<h1 class="heading-1" id="_idParaDest-89"><span class="koboSpan" id="kobo.17.1">Technical requirements</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.18.1">For the recipes in this chapter, ensure your setup is complete as per the 'Technical Requirements' in the 'Angular-Cookbook-2E' GitHub repository. </span><span class="koboSpan" id="kobo.18.2">For setup details, visit: </span><a href="https://github.com/PacktPublishing/Angular-Cookbook-2E/tree/main/docs/technical-requirements.md"><span class="url"><span class="koboSpan" id="kobo.19.1">https://github.com/PacktPublishing/Angular-Cookbook-2E/tree/main/docs/technical-requirements.md</span></span></a><span class="koboSpan" id="kobo.20.1">. </span><span class="koboSpan" id="kobo.20.2">The starter code for this chapter is located at </span><a href="https://github.com/PacktPublishing/Angular-Cookbook-2E/tree/main/start/apps/chapter03"><span class="url"><span class="koboSpan" id="kobo.21.1">https://github.com/PacktPublishing/Angular-Cookbook-2E/tree/main/start/apps/chapter03</span></span></a><span class="koboSpan" id="kobo.22.1">.</span></p>
<h1 class="heading-1" id="_idParaDest-90"><span class="koboSpan" id="kobo.23.1">Using Angular DI tokens</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.24.1">In this recipe, you’ll learn how to create a basic DI token. </span><span class="koboSpan" id="kobo.24.2">We will create it for a regular TypeScript class, to be used as an Angular service using DI. </span><span class="koboSpan" id="kobo.24.3">We have a class named </span><code class="inlineCode"><span class="koboSpan" id="kobo.25.1">Jokes</span></code><span class="koboSpan" id="kobo.26.1"> in our application, which is</span><a id="_idIndexMarker172"/><span class="koboSpan" id="kobo.27.1"> used in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.28.1">AppComponent</span></code><span class="koboSpan" id="kobo.29.1"> by manually creating a new instance of the class. </span><span class="koboSpan" id="kobo.29.2">This makes our code tightly coupled and hard to test, since the </span><code class="inlineCode"><span class="koboSpan" id="kobo.30.1">AppComponent</span></code><span class="koboSpan" id="kobo.31.1"> class directly uses the </span><code class="inlineCode"><span class="koboSpan" id="kobo.32.1">Jokes</span></code><span class="koboSpan" id="kobo.33.1"> class. </span></p>
<p class="normal"><span class="koboSpan" id="kobo.34.1">In other words, when running the tests for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.35.1">App</span></code><span class="koboSpan" id="kobo.36.1"> component, we now rely on the </span><code class="inlineCode"><span class="koboSpan" id="kobo.37.1">Jokes</span></code><span class="koboSpan" id="kobo.38.1"> class, and if something changes in that class, our test will break. </span><span class="koboSpan" id="kobo.38.2">Since Angular is all about </span><strong class="keyWord"><span class="koboSpan" id="kobo.39.1">DI</span></strong><span class="koboSpan" id="kobo.40.1"> and </span><strong class="keyWord"><span class="koboSpan" id="kobo.41.1">services</span></strong><span class="koboSpan" id="kobo.42.1">, we’ll use a DI token to use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.43.1">Jokes</span></code><span class="koboSpan" id="kobo.44.1"> class as an Angular service. </span><span class="koboSpan" id="kobo.44.2">We’ll use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.45.1">InjectionToken</span></code><span class="koboSpan" id="kobo.46.1"> method to create a DI token, and then the </span><code class="inlineCode"><span class="koboSpan" id="kobo.47.1">@Inject</span></code><span class="koboSpan" id="kobo.48.1"> decorator to enable us to use the class in our service.</span></p>
<h2 class="heading-2" id="_idParaDest-91"><span class="koboSpan" id="kobo.49.1">Getting ready</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.50.1">The app that we are going to work with resides in </span><code class="inlineCode"><span class="koboSpan" id="kobo.51.1">start/apps/chapter03/ng-di-token</span></code><span class="koboSpan" id="kobo.52.1"> inside the cloned repository:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.53.1">Open the code repository in your code editor.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.54.1">Open the terminal, navigate to the code repository directory, and run the following command to serve the project:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.55.1">npm run serve ng-di-token
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.56.1">This should open the app in a new browser tab, and you should see the following:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.57.1"><img alt="" role="presentation" src="../Images/B18469_03_01.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.58.1">Figure 3.1: The ng-di-token app running on http://localhost:4200</span></p></li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.59.1">Now that we have the app running, we can move on to the steps for the recipe.</span></p>
<h2 class="heading-2" id="_idParaDest-92"><span class="koboSpan" id="kobo.60.1">How to do it...</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.61.1">The app we have right now shows a greeting message to a random user that has been retrieved from a TypeScript class, named </span><code class="inlineCode"><span class="koboSpan" id="kobo.62.1">Jokes</span></code><span class="koboSpan" id="kobo.63.1">. </span><span class="koboSpan" id="kobo.63.2">We create an instance of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.64.1">Jokes</span></code><span class="koboSpan" id="kobo.65.1"> class in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.66.1">AppComponent</span></code><span class="koboSpan" id="kobo.67.1"> class by using the statement </span><code class="inlineCode"><span class="koboSpan" id="kobo.68.1">jokes = new Jokes();</span></code><span class="koboSpan" id="kobo.69.1">. </span><span class="koboSpan" id="kobo.69.2">However, Angular has a built-in way </span><a id="_idIndexMarker173"/><span class="koboSpan" id="kobo.70.1">of using classes as services using DI. </span><span class="koboSpan" id="kobo.70.2">So instead of using it as a class, we will use it as an Angular service using DI. </span><span class="koboSpan" id="kobo.70.3">We will start by creating an </span><code class="inlineCode"><span class="koboSpan" id="kobo.71.1">InjectionToken</span></code><span class="koboSpan" id="kobo.72.1"> for our </span><code class="inlineCode"><span class="koboSpan" id="kobo.73.1">Jokes</span></code><span class="koboSpan" id="kobo.74.1"> class, and then we will inject it into our </span><code class="inlineCode"><span class="koboSpan" id="kobo.75.1">AppComponent</span></code><span class="koboSpan" id="kobo.76.1"> class. </span><span class="koboSpan" id="kobo.76.2">Perform these steps to follow along:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.77.1">We’ll create an </span><code class="inlineCode"><span class="koboSpan" id="kobo.78.1">InjectionToken</span></code><span class="koboSpan" id="kobo.79.1"> in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.80.1">jokes.class.ts</span></code><span class="koboSpan" id="kobo.81.1"> file. </span><span class="koboSpan" id="kobo.81.2">We will name the token </span><code class="inlineCode"><span class="koboSpan" id="kobo.82.1">'Jokes'</span></code><span class="koboSpan" id="kobo.83.1">, using a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.84.1">InjectionToken</span></code><span class="koboSpan" id="kobo.85.1"> instance. </span><span class="koboSpan" id="kobo.85.2">Finally, we will export this token from the file:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.86.1">import</span></span><span class="koboSpan" id="kobo.87.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.88.1">InjectionToken</span></span><span class="koboSpan" id="kobo.89.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.90.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.91.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.92.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.93.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.94.1">const</span></span> <span class="hljs-variable"><span class="koboSpan" id="kobo.95.1">JOKES</span></span><span class="koboSpan" id="kobo.96.1"> = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.97.1">new</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.98.1">InjectionToken</span></span><span class="koboSpan" id="kobo.99.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.100.1">'Jokes'</span></span><span class="koboSpan" id="kobo.101.1">, {
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.102.1">providedIn</span></span><span class="koboSpan" id="kobo.103.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.104.1">'root'</span></span><span class="koboSpan" id="kobo.105.1">,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.106.1">factory</span></span><span class="koboSpan" id="kobo.107.1">: </span><span class="hljs-function"><span class="koboSpan" id="kobo.108.1">() =&gt;</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.109.1">new</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.110.1">Jokes</span></span><span class="koboSpan" id="kobo.111.1">(),
});
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.112.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.113.1">Jokes</span></span><span class="koboSpan" id="kobo.114.1"> {...}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.115.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.116.1">default</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.117.1">Jokes</span></span><span class="koboSpan" id="kobo.118.1">;
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.119.1">Now, we’ll use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.120.1">inject</span></code><span class="koboSpan" id="kobo.121.1"> method from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.122.1">@angular/core</span></code><span class="koboSpan" id="kobo.123.1"> package and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.124.1">JOKES</span></code><span class="koboSpan" id="kobo.125.1"> token from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.126.1">jokes.class.ts</span></code><span class="koboSpan" id="kobo.127.1"> file in order to use the class, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.128.1">import</span></span><span class="koboSpan" id="kobo.129.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.130.1">Component</span></span><span class="koboSpan" id="kobo.131.1">, </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.132.1">inject</span></strong></span><span class="koboSpan" id="kobo.133.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.134.1">OnInit</span></span><span class="koboSpan" id="kobo.135.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.136.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.137.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.138.1">;
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.139.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.140.1"> { </span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.141.1">JOKES</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.142.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.143.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.144.1">'./classes/jokes.class'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.145.1">;</span></strong></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.146.1">import</span></span><span class="koboSpan" id="kobo.147.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.148.1">IJoke</span></span><span class="koboSpan" id="kobo.149.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.150.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.151.1">'./interfaces/joke.interface'</span></span><span class="koboSpan" id="kobo.152.1">;
</span><span class="hljs-meta"><span class="koboSpan" id="kobo.153.1">@Component</span></span><span class="koboSpan" id="kobo.154.1">({...})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.155.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.156.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.157.1">AppComponent</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.158.1">implements</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.159.1">OnInit</span></span><span class="koboSpan" id="kobo.160.1"> {
  joke!: </span><span class="hljs-title"><span class="koboSpan" id="kobo.161.1">IJoke</span></span><span class="koboSpan" id="kobo.162.1">;
  </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.163.1">jokes = </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.164.1">inject</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.165.1">(</span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.166.1">JOKES</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.167.1">);</span></strong></span><span class="koboSpan" id="kobo.168.1">
  ...
</span><span class="koboSpan" id="kobo.168.2">}
</span></code></pre>
</li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.169.1">And that is it. </span><span class="koboSpan" id="kobo.169.2">You should see the app works the same as before. </span><span class="koboSpan" id="kobo.169.3">The only difference is that instead of instantiating the instance of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.170.1">Jokes</span></code><span class="koboSpan" id="kobo.171.1"> class manually ourselves, we are relying on the injection token to instantiate it. </span><span class="koboSpan" id="kobo.171.2">This not only comes with the ease of not having to create instances, but if the </span><code class="inlineCode"><span class="koboSpan" id="kobo.172.1">Jokes</span></code><span class="koboSpan" id="kobo.173.1"> class uses other classes as dependencies via Angular DI and any of those are missing, we will get the appropriate errors to fix the issues. </span><span class="koboSpan" id="kobo.173.2">As a result, we have a more robust architecture of our services and components, which ensures the dependencies are met before our application is run/built. </span><span class="koboSpan" id="kobo.173.3">Now that we know the recipe, let us take a closer look at how it works.</span></p>
<h2 class="heading-2" id="_idParaDest-93"><span class="koboSpan" id="kobo.174.1">How it works…</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.175.1">Angular does not recognize regular TypeScript classes as injectables. </span><span class="koboSpan" id="kobo.175.2">However, we can create our own injection tokens and use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.176.1">inject</span></code><span class="koboSpan" id="kobo.177.1"> method from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.178.1">@angular/core</span></code><span class="koboSpan" id="kobo.179.1"> package to inject the relevant</span><a id="_idIndexMarker174"/><span class="koboSpan" id="kobo.180.1"> classes and values wherever necessary. </span><span class="koboSpan" id="kobo.180.2">Angular recognizes these tokens behind the scenes and finds their corresponding definition, which is usually in the form of a </span><code class="inlineCode"><span class="koboSpan" id="kobo.181.1">factory</span></code><span class="koboSpan" id="kobo.182.1"> function. </span><span class="koboSpan" id="kobo.182.2">Notice that we are using </span><code class="inlineCode"><span class="koboSpan" id="kobo.183.1">providedIn: 'root'</span></code><span class="koboSpan" id="kobo.184.1"> within the token definition. </span><span class="koboSpan" id="kobo.184.2">This means there will be only one instance of the class in the entire application.</span></p>
<h2 class="heading-2" id="_idParaDest-94"><span class="koboSpan" id="kobo.185.1">See also</span></h2>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.186.1">DI in</span><a id="_idIndexMarker175"/><span class="koboSpan" id="kobo.187.1"> Angular (</span><a href="https://angular.io/guide/dependency-injection"><span class="url"><span class="koboSpan" id="kobo.188.1">https://angular.io/guide/dependency-injection</span></span></a><span class="koboSpan" id="kobo.189.1">)</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.190.1">InjectionToken</span></code> <a id="_idIndexMarker176"/><span class="koboSpan" id="kobo.191.1">documentation (</span><a href="https://angular.io/api/core/InjectionToken"><span class="url"><span class="koboSpan" id="kobo.192.1">https://angular.io/api/core/InjectionToken</span></span></a><span class="koboSpan" id="kobo.193.1">)</span></li>
</ul>
<h1 class="heading-1" id="_idParaDest-95"><span class="koboSpan" id="kobo.194.1">Optional dependencies</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.195.1">Optional dependencies in Angular are powerful when you use or configure a dependency that may or may </span><a id="_idIndexMarker177"/><span class="koboSpan" id="kobo.196.1">not exist or has not been provided within an Angular application. </span><span class="koboSpan" id="kobo.196.2">In this recipe, we will learn how to use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.197.1">@Optional</span></code><span class="koboSpan" id="kobo.198.1"> decorator to configure optional dependencies in our components and services. </span><span class="koboSpan" id="kobo.198.2">We will work with </span><code class="inlineCode"><span class="koboSpan" id="kobo.199.1">LoggerService</span></code><span class="koboSpan" id="kobo.200.1"> and ensure our components do not break if they have not already been provided with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.201.1">LoggerService</span></code><span class="koboSpan" id="kobo.202.1">.</span></p>
<h2 class="heading-2" id="_idParaDest-96"><span class="koboSpan" id="kobo.203.1">Getting ready</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.204.1">The app that we are going to work with resides in </span><code class="inlineCode"><span class="koboSpan" id="kobo.205.1">start/apps/chapter03/ng-optional-dependencies</span></code><span class="koboSpan" id="kobo.206.1"> inside the cloned repository:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.207.1">Open the code repository in your code editor.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.208.1">Open the terminal, navigate to the code repository directory, and run the following command to serve the project:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.209.1">npm run serve ng-optional-dependencies
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.210.1">This should open the app in a new browser tab, and you should see the following:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.211.1"><img alt="" role="presentation" src="../Images/B18469_03_02.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.212.1">Figure 3.2: The ng-optional-dependencies app running on http://localhost:4200</span></p> </li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.213.1">Now that we have the app</span><a id="_idIndexMarker178"/><span class="koboSpan" id="kobo.214.1"> running, we can move on to the steps for the recipe.</span></p>
<h2 class="heading-2" id="_idParaDest-97"><span class="koboSpan" id="kobo.215.1">How to do it…</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.216.1">We’ll have an app containing a </span><code class="inlineCode"><span class="koboSpan" id="kobo.217.1">LoggerService</span></code><span class="koboSpan" id="kobo.218.1">, which is provided using </span><code class="inlineCode"><span class="koboSpan" id="kobo.219.1">providedIn: 'root'</span></code><span class="koboSpan" id="kobo.220.1"> as its injectable configuration. </span><span class="koboSpan" id="kobo.220.2">We’ll see what happens when we don’t provide this service anywhere. </span><span class="koboSpan" id="kobo.220.3">Then, we’ll identify and fix the issues using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.221.1">@Optional</span></code><span class="koboSpan" id="kobo.222.1"> decorator. </span><span class="koboSpan" id="kobo.222.2">Follow these</span><a id="_idIndexMarker179"/><span class="koboSpan" id="kobo.223.1"> steps:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.224.1">First, let’s run the app, enter a new version number, </span><code class="inlineCode"><span class="koboSpan" id="kobo.225.1">0.0.1</span></code><span class="koboSpan" id="kobo.226.1">, and hit the </span><strong class="screenText"><span class="koboSpan" id="kobo.227.1">Submit</span></strong><span class="koboSpan" id="kobo.228.1"> button.
    </span><p class="normal"><span class="koboSpan" id="kobo.229.1">This will result in the logs being saved in </span><code class="inlineCode"><span class="koboSpan" id="kobo.230.1">localStorage</span></code><span class="koboSpan" id="kobo.231.1"> via </span><code class="inlineCode"><span class="koboSpan" id="kobo.232.1">LoggerService</span></code><span class="koboSpan" id="kobo.233.1">. </span><span class="koboSpan" id="kobo.233.2">Open </span><strong class="screenText"><span class="koboSpan" id="kobo.234.1">Chrome Dev Tools</span></strong><span class="koboSpan" id="kobo.235.1">, navigate to </span><strong class="screenText"><span class="koboSpan" id="kobo.236.1">Application</span></strong><span class="koboSpan" id="kobo.237.1">, select </span><strong class="screenText"><span class="koboSpan" id="kobo.238.1">Local Storage</span></strong><span class="koboSpan" id="kobo.239.1">, and then click on </span><code class="inlineCode"><span class="koboSpan" id="kobo.240.1">http://localhost:4200</span></code><span class="koboSpan" id="kobo.241.1">. </span><span class="koboSpan" id="kobo.241.2">You will see the key </span><code class="inlineCode"><span class="koboSpan" id="kobo.242.1">vc_logs_ng_od</span></code><span class="koboSpan" id="kobo.243.1"> with log values, as follows:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.244.1"><img alt="" role="presentation" src="../Images/B18469_03_03.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.245.1">Figure 3.3: The logs are saved in localStorage for http://localhost:4200</span></p></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="2"><span class="koboSpan" id="kobo.246.1">Let’s try to remove the</span><a id="_idIndexMarker180"/><span class="koboSpan" id="kobo.247.1"> configuration provided in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.248.1">@Injectable</span></code><span class="koboSpan" id="kobo.249.1"> decorator for </span><code class="inlineCode"><span class="koboSpan" id="kobo.250.1">LoggerService</span></code><span class="koboSpan" id="kobo.251.1">, in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.252.1">logger.service.ts</span></code><span class="koboSpan" id="kobo.253.1"> file. </span><span class="koboSpan" id="kobo.253.2">The change should be as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.254.1">import</span></span><span class="koboSpan" id="kobo.255.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.256.1">Injectable</span></span><span class="koboSpan" id="kobo.257.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.258.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.259.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.260.1">; 
</span><span class="code-highlight"><strong class="hljs-comment-slc"><span class="koboSpan" id="kobo.261.1">// &lt;-- remove the above import</span></strong></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.262.1">import</span></span><span class="koboSpan" id="kobo.263.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.264.1">Logger</span></span><span class="koboSpan" id="kobo.265.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.266.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.267.1">'../interfaces/logger'</span></span><span class="koboSpan" id="kobo.268.1">;
</span><span class="hljs-meta"><span class="koboSpan" id="kobo.269.1">@Injectable</span></span><span class="koboSpan" id="kobo.270.1">(</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.271.1">{</span></strong><strong class="hljs-comment-slc"><span class="koboSpan" id="kobo.272.1">//&lt;-- remove this object</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.273.1">providedIn: 'root'</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.274.1">})</span></strong></span><span class="koboSpan" id="kobo.275.1">
export class LoggerService implements Logger {
  ...
</span><span class="koboSpan" id="kobo.275.2">}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.276.1">This will result in Angular not being able to recognize it and throwing an error in the console, as follows:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.277.1"><img alt="" role="presentation" src="../Images/B18469_03_04.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.278.1">Figure 3.4: An error reflecting that Angular doesn’t recognize the LoggerService</span></p> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="3"><span class="koboSpan" id="kobo.279.1">We can now use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.280.1">@Optional</span></code><span class="koboSpan" id="kobo.281.1"> decorator to mark the dependency as optional. </span><span class="koboSpan" id="kobo.281.2">Let’s import it </span><a id="_idIndexMarker181"/><span class="koboSpan" id="kobo.282.1">from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.283.1">@angular/core</span></code><span class="koboSpan" id="kobo.284.1"> package and use the decorator in the constructor of </span><code class="inlineCode"><span class="koboSpan" id="kobo.285.1">VcLogsComponent</span></code><span class="koboSpan" id="kobo.286.1">, in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.287.1">vc-logs.component.ts</span></code><span class="koboSpan" id="kobo.288.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.289.1">import</span></span><span class="koboSpan" id="kobo.290.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.291.1">Component</span></span><span class="koboSpan" id="kobo.292.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.293.1">OnInit</span></span><span class="koboSpan" id="kobo.294.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.295.1">Input</span></span><span class="koboSpan" id="kobo.296.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.297.1">OnChanges</span></span><span class="koboSpan" id="kobo.298.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.299.1">SimpleChanges</span></span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.300.1">, </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.301.1">Optional</span></strong></span><span class="koboSpan" id="kobo.302.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.303.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.304.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.305.1">;
...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.306.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.307.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.308.1">VcLogsComponent</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.309.1">implements</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.310.1">OnInit</span></span><span class="koboSpan" id="kobo.311.1"> {
  ...
  </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.312.1">constructor</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.313.1">(</span></strong><strong class="hljs-meta-slc"><span class="koboSpan" id="kobo.314.1">@Optional</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.315.1">() </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.316.1">private</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.317.1"> logger: LoggerService</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.318.1">) {</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.319.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.320.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.321.1">logs</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.322.1"> = </span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.323.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.324.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.325.1">logger</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.326.1">?.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.327.1">retrieveLogs</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.328.1">() || [];</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.329.1">}</span></strong></span><span class="koboSpan" id="kobo.330.1">
  ...
</span><span class="koboSpan" id="kobo.330.2">}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.331.1">Great! </span><span class="koboSpan" id="kobo.331.2">Now, if you refresh the app and view the console, there should be a different error. </span><span class="koboSpan" id="kobo.331.3">Yay, progress!</span></p>
<p class="normal"><em class="italic"><span class="koboSpan" id="kobo.332.1">Figure 3.5</span></em><span class="koboSpan" id="kobo.333.1"> shows that we have a new error because we’re trying to call the </span><code class="inlineCode"><span class="koboSpan" id="kobo.334.1">this.logger.log()</span></code><span class="koboSpan" id="kobo.335.1"> statement inside the </span><code class="inlineCode"><span class="koboSpan" id="kobo.336.1">ngOnChanges</span></code><span class="koboSpan" id="kobo.337.1"> method.</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.338.1"><img alt="" role="presentation" src="../Images/B18469_03_05.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.339.1">Figure 3.5: An error detailing that this.logger is essentially null now</span></p></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="4"><span class="koboSpan" id="kobo.340.1">To fix this issue, we can either decide not to log anything at all, or we can fall back to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.341.1">console.*</span></code><span class="koboSpan" id="kobo.342.1"> methods if </span><code class="inlineCode"><span class="koboSpan" id="kobo.343.1">LoggerService</span></code><span class="koboSpan" id="kobo.344.1"> is not provided. </span><span class="koboSpan" id="kobo.344.2">The code falls back to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.345.1">console.*</span></code><span class="koboSpan" id="kobo.346.1"> method is as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.347.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.348.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.349.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.350.1">VcLogsComponent</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.351.1">implements</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.352.1">OnInit</span></span><span class="koboSpan" id="kobo.353.1"> {
  ...
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.354.1">constructor</span></span><span class="koboSpan" id="kobo.355.1">(</span><span class="hljs-meta"><span class="koboSpan" id="kobo.356.1">@Optional</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.357.1">() </span></span><span class="hljs-keyword"><span class="koboSpan" id="kobo.358.1">private</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.359.1"> loggerService: </span></span>
<span class="hljs-params"><span class="koboSpan" id="kobo.360.1">LoggerService</span></span><span class="koboSpan" id="kobo.361.1">) {
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.362.1">this</span></span><span class="koboSpan" id="kobo.363.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.364.1">logs</span></span><span class="koboSpan" id="kobo.365.1"> = </span><span class="hljs-variable"><span class="koboSpan" id="kobo.366.1">this</span></span><span class="koboSpan" id="kobo.367.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.368.1">logger</span></span><span class="koboSpan" id="kobo.369.1">?.</span><span class="hljs-title"><span class="koboSpan" id="kobo.370.1">retrieveLogs</span></span><span class="koboSpan" id="kobo.371.1">() || [];
  }
  </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.372.1">get</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.373.1">log</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.374.1">() {</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.375.1">return</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.376.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.377.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.378.1">logger</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.379.1">?.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.380.1">log</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.381.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.382.1">bind</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.383.1">(</span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.384.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.385.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.386.1">logger</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.387.1">) ||</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.388.1">console</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.389.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.390.1">log</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.391.1">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.392.1">}</span></strong></span><span class="koboSpan" id="kobo.393.1">
  ...
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.394.1">Let’s also update the ngOnChanges block to use this log (getter) function:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.395.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.396.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.397.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.398.1">VcLogsComponent</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.399.1">implements</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.400.1">OnInit</span></span><span class="koboSpan" id="kobo.401.1"> {
  ...
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.402.1">constructor</span></span><span class="koboSpan" id="kobo.403.1">(</span><span class="hljs-meta"><span class="koboSpan" id="kobo.404.1">@Optional</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.405.1">() </span></span><span class="hljs-keyword"><span class="koboSpan" id="kobo.406.1">private</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.407.1"> logger: LoggerService</span></span><span class="koboSpan" id="kobo.408.1">) { }
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.409.1">get</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.410.1">log</span></span><span class="koboSpan" id="kobo.411.1">() {}
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.412.1">ngOnChanges</span></span><span class="koboSpan" id="kobo.413.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.414.1">changes: SimpleChanges</span></span><span class="koboSpan" id="kobo.415.1">) {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.416.1">const</span></span><span class="koboSpan" id="kobo.417.1"> currValue = changes[</span><span class="hljs-string"><span class="koboSpan" id="kobo.418.1">'vName'</span></span><span class="koboSpan" id="kobo.419.1">].</span><span class="hljs-property"><span class="koboSpan" id="kobo.420.1">currentValue</span></span><span class="koboSpan" id="kobo.421.1">;
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.422.1">let</span></span><span class="koboSpan" id="kobo.423.1"> message;
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.424.1">if</span></span><span class="koboSpan" id="kobo.425.1"> (changes[</span><span class="hljs-string"><span class="koboSpan" id="kobo.426.1">'vName'</span></span><span class="koboSpan" id="kobo.427.1">].</span><span class="hljs-title"><span class="koboSpan" id="kobo.428.1">isFirstChange</span></span><span class="koboSpan" id="kobo.429.1">()) {
      message = </span><span class="hljs-string"><span class="koboSpan" id="kobo.430.1">`initial version is </span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.431.1">${currValue.trim()}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.432.1">`</span></span><span class="koboSpan" id="kobo.433.1">;
      </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.434.1">if</span></span><span class="koboSpan" id="kobo.435.1"> (!</span><span class="hljs-variable"><span class="koboSpan" id="kobo.436.1">this</span></span><span class="koboSpan" id="kobo.437.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.438.1">logs</span></span><span class="koboSpan" id="kobo.439.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.440.1">length</span></span><span class="koboSpan" id="kobo.441.1">) {
        </span><span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.442.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.443.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.444.1">log</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.445.1">(message);</span></strong></span>
<span class="hljs-variable"><span class="koboSpan" id="kobo.446.1">this</span></span><span class="koboSpan" id="kobo.447.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.448.1">logs</span></span><span class="koboSpan" id="kobo.449.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.450.1">push</span></span><span class="koboSpan" id="kobo.451.1">(message);
      }
    } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.452.1">else</span></span><span class="koboSpan" id="kobo.453.1"> {
        message = </span><span class="hljs-string"><span class="koboSpan" id="kobo.454.1">`version changed to </span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.455.1">${currValue.trim()}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.456.1">`</span></span><span class="koboSpan" id="kobo.457.1">;
        </span><span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.458.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.459.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.460.1">log</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.461.1">(message);</span></strong></span>
<span class="hljs-variable"><span class="koboSpan" id="kobo.462.1">this</span></span><span class="koboSpan" id="kobo.463.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.464.1">logs</span></span><span class="koboSpan" id="kobo.465.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.466.1">push</span></span><span class="koboSpan" id="kobo.467.1">(message);
    }
  }
  ...
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.468.1">Now, if you update the</span><a id="_idIndexMarker182"/><span class="koboSpan" id="kobo.469.1"> version and hit </span><strong class="screenText"><span class="koboSpan" id="kobo.470.1">Submit</span></strong><span class="koboSpan" id="kobo.471.1">, you should see the logs on the console, as follows:
    </span><figure class="mediaobject"><span class="koboSpan" id="kobo.472.1"><img alt="" role="presentation" src="../Images/B18469_03_06.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.473.1">Figure 3.6: The logs being printed on the console as a fallback to LoggerService not being provided</span></p></li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.474.1">Great! </span><span class="koboSpan" id="kobo.474.2">We’ve finished the</span><a id="_idIndexMarker183"/><span class="koboSpan" id="kobo.475.1"> recipe, and everything looks great. </span><span class="koboSpan" id="kobo.475.2">Please refer to the next section to understand how it works.</span></p>
<h2 class="heading-2" id="_idParaDest-98"><span class="koboSpan" id="kobo.476.1">How it works</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.477.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.478.1">@Optional</span></code><span class="koboSpan" id="kobo.479.1"> decorator is a special one from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.480.1">@angular/core</span></code><span class="koboSpan" id="kobo.481.1"> package, which allows you to mark a dependency as optional. </span><span class="koboSpan" id="kobo.481.2">Behind the scenes, when used in the constructor method of a</span><a id="_idIndexMarker184"/><span class="koboSpan" id="kobo.482.1"> class with a dependency, Angular will provide the value as </span><code class="inlineCode"><span class="koboSpan" id="kobo.483.1">null</span></code><span class="koboSpan" id="kobo.484.1"> when the dependency doesn’t exist or is not provided to the app. </span><span class="koboSpan" id="kobo.484.2">Since we remove the configuration object from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.485.1">@Injectable()</span></code><span class="koboSpan" id="kobo.486.1"> decorator from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.487.1">LoggerService</span></code><span class="koboSpan" id="kobo.488.1"> class, it isn’t provided in Angular for DI. </span><span class="koboSpan" id="kobo.488.2">As a result, our </span><code class="inlineCode"><span class="koboSpan" id="kobo.489.1">@Optional()</span></code><span class="koboSpan" id="kobo.490.1"> decorator makes it </span><code class="inlineCode"><span class="koboSpan" id="kobo.491.1">null</span></code><span class="koboSpan" id="kobo.492.1"> when injected and doesn’t cause Angular to throw the </span><code class="inlineCode"><span class="koboSpan" id="kobo.493.1">NullInjectorError</span></code><span class="koboSpan" id="kobo.494.1"> shown in </span><em class="italic"><span class="koboSpan" id="kobo.495.1">Figure 3.4</span></em><span class="koboSpan" id="kobo.496.1">. </span><span class="koboSpan" id="kobo.496.2">In </span><em class="italic"><span class="koboSpan" id="kobo.497.1">step 4</span></em><span class="koboSpan" id="kobo.498.1">, we create a </span><code class="inlineCode"><span class="koboSpan" id="kobo.499.1">log</span></code><span class="koboSpan" id="kobo.500.1"> getter function in our component’s class </span><code class="inlineCode"><span class="koboSpan" id="kobo.501.1">VcLogsComponent</span></code><span class="koboSpan" id="kobo.502.1">, so we can use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.503.1">LoggerService</span></code><span class="koboSpan" id="kobo.504.1">'s method named </span><code class="inlineCode"><span class="koboSpan" id="kobo.505.1">log</span></code><span class="koboSpan" id="kobo.506.1"> when the service is provided; and </span><code class="inlineCode"><span class="koboSpan" id="kobo.507.1">console.log</span></code><span class="koboSpan" id="kobo.508.1"> otherwise. </span><span class="koboSpan" id="kobo.508.2">Then, in the following steps, we just use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.509.1">log</span></code><span class="koboSpan" id="kobo.510.1"> method we created. </span><span class="koboSpan" id="kobo.510.2">If you go back to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.511.1">logger.service.ts</span></code><span class="koboSpan" id="kobo.512.1"> file and provide the service as </span><code class="inlineCode"><span class="koboSpan" id="kobo.513.1">providedIn: 'root'</span></code><span class="koboSpan" id="kobo.514.1"> again, you won’t see any console logs now and will see that now the app uses the service, i.e., the </span><code class="inlineCode"><span class="koboSpan" id="kobo.515.1">LoggerService</span></code><span class="koboSpan" id="kobo.516.1"> that uses the </span><code class="inlineCode"><span class="koboSpan" id="kobo.517.1">localStorage</span></code><span class="koboSpan" id="kobo.518.1">.</span></p>
<h2 class="heading-2" id="_idParaDest-99"><span class="koboSpan" id="kobo.519.1">See also</span></h2>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.520.1">Optional dependencies </span><a id="_idIndexMarker185"/><span class="koboSpan" id="kobo.521.1">in Angular (</span><a href="https://angular.io/guide/dependency-injection#optional-dependencies"><span class="url"><span class="koboSpan" id="kobo.522.1">https://angular.io/guide/dependency-injection#optional-dependencies</span></span></a><span class="koboSpan" id="kobo.523.1">)</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.524.1">Hierarchical injectors in</span><a id="_idIndexMarker186"/><span class="koboSpan" id="kobo.525.1"> Angular (</span><a href="https://angular.io/guide/hierarchical-dependency-injection"><span class="url"><span class="koboSpan" id="kobo.526.1">https://angular.io/guide/hierarchical-dependency-injection</span></span></a><span class="koboSpan" id="kobo.527.1">)</span></li>
</ul>
<h1 class="heading-1" id="_idParaDest-100"><span class="koboSpan" id="kobo.528.1">Creating a singleton service using providedIn</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.529.1">In this recipe, you’ll learn several tips </span><a id="_idIndexMarker187"/><span class="koboSpan" id="kobo.530.1">on how to ensure your Angular service is being used as a singleton. </span><span class="koboSpan" id="kobo.530.2">This means that there will only be one instance of </span><a id="_idIndexMarker188"/><span class="koboSpan" id="kobo.531.1">your service in the entire application. </span><span class="koboSpan" id="kobo.531.2">We’ll use a couple of techniques, including the </span><code class="inlineCode"><span class="koboSpan" id="kobo.532.1">providedIn: 'root'</span></code><span class="koboSpan" id="kobo.533.1"> statement, making sure we only provide the service once in the entire app by using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.534.1">@Optional()</span></code><span class="koboSpan" id="kobo.535.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.536.1">@SkipSelf()</span></code><span class="koboSpan" id="kobo.537.1"> decorators.</span></p>
<h2 class="heading-2" id="_idParaDest-101"><span class="koboSpan" id="kobo.538.1">Getting ready</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.539.1">The app that we are going to work with resides in </span><code class="inlineCode"><span class="koboSpan" id="kobo.540.1">start/apps/chapter03/ng-singleton-service</span></code><span class="koboSpan" id="kobo.541.1"> inside the cloned repository:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.542.1">Open the code repository in your code editor.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.543.1">Open the terminal, navigate to the code repository directory, and run the following command to serve the project:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.544.1">npm run serve ng-singleton-service
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.545.1">This should open the app in a new browser tab, and you should see the following:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.546.1"><img alt="" role="presentation" src="../Images/B18469_03_07.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.547.1">Figure 3.7: The ng-singleton-service app running on http://localhost:4200</span></p></li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.548.1">Now that we have the app running, we can move on to the steps for the recipe.</span></p>
<h2 class="heading-2" id="_idParaDest-102"><span class="koboSpan" id="kobo.549.1">How to do it</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.550.1">The problem with the app is that if you add or remove any notifications, the count on the bell icon in the header does not change. </span><span class="koboSpan" id="kobo.550.2">That’s due to us having multiple instances of </span><code class="inlineCode"><span class="koboSpan" id="kobo.551.1">NotificationsService</span></code><span class="koboSpan" id="kobo.552.1"> provided </span><a id="_idIndexMarker189"/><span class="koboSpan" id="kobo.553.1">in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.554.1">AppModule</span></code><span class="koboSpan" id="kobo.555.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.556.1">HomeModule</span></code><span class="koboSpan" id="kobo.557.1"> classes. </span><span class="koboSpan" id="kobo.557.2">Please refer to the following steps</span><a id="_idIndexMarker190"/><span class="koboSpan" id="kobo.558.1"> to ensure we only have a single instance of the service in the app:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.559.1">We will use </span><code class="inlineCode"><span class="koboSpan" id="kobo.560.1">providedIn: 'root'</span></code><span class="koboSpan" id="kobo.561.1"> for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.562.1">NotificationService</span></code><span class="koboSpan" id="kobo.563.1"> to tell Angular that it is only provided in the root module, and it should only have one instance in the entire app. </span><span class="koboSpan" id="kobo.563.2">So, let’s go to </span><code class="inlineCode"><span class="koboSpan" id="kobo.564.1">notifications.service.ts</span></code><span class="koboSpan" id="kobo.565.1"> and pass </span><code class="inlineCode"><span class="koboSpan" id="kobo.566.1">providedIn: 'root'</span></code><span class="koboSpan" id="kobo.567.1"> in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.568.1">@Injectable</span></code><span class="koboSpan" id="kobo.569.1"> decorator parameters, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.570.1">import</span></span><span class="koboSpan" id="kobo.571.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.572.1">Injectable</span></span><span class="koboSpan" id="kobo.573.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.574.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.575.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.576.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.577.1">import</span></span><span class="koboSpan" id="kobo.578.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.579.1">BehaviorSubject</span></span><span class="koboSpan" id="kobo.580.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.581.1">Observable</span></span><span class="koboSpan" id="kobo.582.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.583.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.584.1">'rxjs'</span></span><span class="koboSpan" id="kobo.585.1">;
</span><span class="hljs-meta"><span class="koboSpan" id="kobo.586.1">@Injectable</span></span><span class="koboSpan" id="kobo.587.1">(</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.588.1">{</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.589.1">providedIn</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.590.1">: </span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.591.1">'root'</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.592.1">}</span></strong></span><span class="koboSpan" id="kobo.593.1">)
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.594.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.595.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.596.1">NotificationsService</span></span><span class="koboSpan" id="kobo.597.1"> {
  ...
</span><span class="koboSpan" id="kobo.597.2">}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.598.1">Great! </span><span class="koboSpan" id="kobo.598.2">Now, even if you refresh and try adding or removing notifications, you’ll still see that the count in the header doesn’t change. </span><em class="italic"><span class="koboSpan" id="kobo.599.1">“But why is this, Ahsan?”</span></em><span class="koboSpan" id="kobo.600.1"> Well, I’m glad you asked. </span><span class="koboSpan" id="kobo.600.2">It’s because we’re still providing the service in </span><code class="inlineCode"><span class="koboSpan" id="kobo.601.1">AppModule</span></code><span class="koboSpan" id="kobo.602.1"> as well as in </span><code class="inlineCode"><span class="koboSpan" id="kobo.603.1">HomeModule</span></code><span class="koboSpan" id="kobo.604.1"> classes.</span></p></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="2"><span class="koboSpan" id="kobo.605.1">First, let’s remove </span><code class="inlineCode"><span class="koboSpan" id="kobo.606.1">NotificationsService</span></code><span class="koboSpan" id="kobo.607.1"> from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.608.1">providers</span></code><span class="koboSpan" id="kobo.609.1"> array in </span><code class="inlineCode"><span class="koboSpan" id="kobo.610.1">app.module.ts</span></code><span class="koboSpan" id="kobo.611.1">, as highlighted in the following code block:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.612.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.613.1">import</span></span><span class="koboSpan" id="kobo.614.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.615.1">NotificationsButtonComponent</span></span><span class="koboSpan" id="kobo.616.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.617.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.618.1">'./components/notifications-button/notifications-button.component'</span></span><span class="koboSpan" id="kobo.619.1">;
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.620.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.621.1"> { </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.622.1">NotificationsService</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.623.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.624.1">from </span></strong></span><span class="hljs-string"><span class="koboSpan" id="kobo.625.1">'./services/notifications.service'</span></span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.626.1">;</span></strong></span>
<span class="hljs-comment"><span class="koboSpan" id="kobo.627.1">// &lt;-- Remove the import above</span></span>
<span class="hljs-meta"><span class="koboSpan" id="kobo.628.1">@NgModule</span></span><span class="koboSpan" id="kobo.629.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.630.1">declarations</span></span><span class="koboSpan" id="kobo.631.1">: [... </span><span class="koboSpan" id="kobo.631.2">],
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.632.1">imports</span></span><span class="koboSpan" id="kobo.633.1">: [...],
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.634.1">providers</span></span><span class="koboSpan" id="kobo.635.1">: [
    </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.636.1">NotificationsService</span></strong><strong class="hljs-comment-slc"><span class="koboSpan" id="kobo.637.1"> // &lt;-- Remove this</span></strong></span><span class="koboSpan" id="kobo.638.1">
  ],
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.639.1">bootstrap</span></span><span class="koboSpan" id="kobo.640.1">: [</span><span class="hljs-title"><span class="koboSpan" id="kobo.641.1">AppComponent</span></span><span class="koboSpan" id="kobo.642.1">]
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.643.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.644.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.645.1">AppModule</span></span><span class="koboSpan" id="kobo.646.1"> { }
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.647.1">Now, we’ll remove </span><code class="inlineCode"><span class="koboSpan" id="kobo.648.1">NotificationsService</span></code><span class="koboSpan" id="kobo.649.1"> from </span><code class="inlineCode"><span class="koboSpan" id="kobo.650.1">home.module.ts</span></code><span class="koboSpan" id="kobo.651.1">, as highlighted in the following code block:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.652.1">...
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.653.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.654.1"> { </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.655.1">NotificationsService</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.656.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.657.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.658.1">'../services/notifications.service'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.659.1">; </span></strong></span>
<span class="code-highlight"><strong class="hljs-comment-slc"><span class="koboSpan" id="kobo.660.1">// &lt;-- Remove the import above</span></strong></span>
<span class="hljs-meta"><span class="koboSpan" id="kobo.661.1">@NgModule</span></span><span class="koboSpan" id="kobo.662.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.663.1">declarations</span></span><span class="koboSpan" id="kobo.664.1">: [...],
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.665.1">imports</span></span><span class="koboSpan" id="kobo.666.1">: [...],
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.667.1">providers</span></span><span class="koboSpan" id="kobo.668.1">: [
    </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.669.1">NotificationsService</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-comment-slc"><span class="koboSpan" id="kobo.670.1">// &lt;-- Remove this</span></strong></span><span class="koboSpan" id="kobo.671.1">
  ]
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.672.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.673.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.674.1">HomeModule</span></span><span class="koboSpan" id="kobo.675.1"> { }
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.676.1">Awesome! </span><span class="koboSpan" id="kobo.676.2">Now, you </span><a id="_idIndexMarker191"/><span class="koboSpan" id="kobo.677.1">should be able to see the</span><a id="_idIndexMarker192"/><span class="koboSpan" id="kobo.678.1"> count in the header change according to whether you add/remove notifications. </span><span class="koboSpan" id="kobo.678.2">However, what happens if someone still provides it in another lazily loaded module by mistake?</span></p> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="4"><span class="koboSpan" id="kobo.679.1">Let’s put </span><code class="inlineCode"><span class="koboSpan" id="kobo.680.1">NotificationsService</span></code><span class="koboSpan" id="kobo.681.1"> back in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.682.1">home.module.ts</span></code><span class="koboSpan" id="kobo.683.1"> file:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.684.1">...
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.685.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.686.1"> { </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.687.1">NotificationsService</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.688.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.689.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.690.1">'../services/notifications.service'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.691.1">;</span></strong></span>
<span class="hljs-meta"><span class="koboSpan" id="kobo.692.1">@NgModule</span></span><span class="koboSpan" id="kobo.693.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.694.1">declarations</span></span><span class="koboSpan" id="kobo.695.1">: [</span><span class="hljs-title"><span class="koboSpan" id="kobo.696.1">HomeComponent</span></span><span class="koboSpan" id="kobo.697.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.698.1">NotificationsManagerComponent</span></span><span class="koboSpan" id="kobo.699.1">],
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.700.1">imports</span></span><span class="koboSpan" id="kobo.701.1">: [</span><span class="hljs-title"><span class="koboSpan" id="kobo.702.1">CommonModule</span></span><span class="koboSpan" id="kobo.703.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.704.1">HomeRoutingModule</span></span><span class="koboSpan" id="kobo.705.1">],
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.706.1">providers</span></span><span class="koboSpan" id="kobo.707.1">: [</span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.708.1">NotificationsService</span></strong></span><span class="koboSpan" id="kobo.709.1">],
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.710.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.711.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.712.1">HomeModule</span></span><span class="koboSpan" id="kobo.713.1"> {}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.714.1">Boom! </span><span class="koboSpan" id="kobo.714.2">We don’t have any errors on the console or during compile time. </span><span class="koboSpan" id="kobo.714.3">However, we do have the issue of the count not updating in the header. </span><span class="koboSpan" id="kobo.714.4">So, how do we alert the developers if they make such a mistake?</span></p> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="5"><span class="koboSpan" id="kobo.715.1">In order to alert the developer about potential duplicate providers, we will use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.716.1">@SkipSelf</span></code><span class="koboSpan" id="kobo.717.1"> decorator</span><a id="_idIndexMarker193"/><span class="koboSpan" id="kobo.718.1"> from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.719.1">@angular/core</span></code><span class="koboSpan" id="kobo.720.1"> package</span><a id="_idIndexMarker194"/><span class="koboSpan" id="kobo.721.1"> in our </span><code class="inlineCode"><span class="koboSpan" id="kobo.722.1">NotificationsService</span></code><span class="koboSpan" id="kobo.723.1">, and throw an error to notify and modify </span><code class="inlineCode"><span class="koboSpan" id="kobo.724.1">NotificationsService</span></code><span class="koboSpan" id="kobo.725.1">, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.726.1">import</span></span><span class="koboSpan" id="kobo.727.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.728.1">Injectable</span></span><span class="koboSpan" id="kobo.729.1">, </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.730.1">SkipSelf</span></strong></span><span class="koboSpan" id="kobo.731.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.732.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.733.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.734.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.735.1">import</span></span><span class="koboSpan" id="kobo.736.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.737.1">BehaviorSubject</span></span><span class="koboSpan" id="kobo.738.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.739.1">Observable</span></span><span class="koboSpan" id="kobo.740.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.741.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.742.1">'rxjs'</span></span><span class="koboSpan" id="kobo.743.1">;
</span><span class="hljs-meta"><span class="koboSpan" id="kobo.744.1">@Injectable</span></span><span class="koboSpan" id="kobo.745.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.746.1">providedIn</span></span><span class="koboSpan" id="kobo.747.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.748.1">'root'</span></span><span class="koboSpan" id="kobo.749.1">,
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.750.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.751.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.752.1">NotificationsService</span></span><span class="koboSpan" id="kobo.753.1"> {
  ...
  </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.754.1">constructor</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.755.1">(</span></strong><strong class="hljs-meta-slc"><span class="koboSpan" id="kobo.756.1">@SkipSelf</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.757.1">() existingService:</span></strong></span>
<span class="code-highlight"><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.758.1">NotificationsService</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.759.1">) {</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.760.1">if</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.761.1"> (existingService) {</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.762.1">throw</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.763.1">Error</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.764.1">(</span></strong></span>
<span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.765.1">'The service has already been provided in the</span></strong></span>
<span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.766.1">app.</span></strong></span>
<span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.767.1">Avoid providing it again in child  modules'</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.768.1">);</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.769.1">}</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.770.1">}</span></strong></span><span class="koboSpan" id="kobo.771.1">
  ...
</span><span class="koboSpan" id="kobo.771.2">}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.772.1">With the previous step now complete, you’ll notice that we have a problem, which is that we have failed to provide </span><code class="inlineCode"><span class="koboSpan" id="kobo.773.1">NotificationsService</span></code><span class="koboSpan" id="kobo.774.1"> to our app. </span><span class="koboSpan" id="kobo.774.2">You should see this in the console:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.775.1"><img alt="" role="presentation" src="../Images/B18469_03_08.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.776.1">Figure 3.8: An error detailing that NotificationsService can’t be injected into NotificationsService</span></p>
<p class="normal"><span class="koboSpan" id="kobo.777.1">The reason for this is that </span><code class="inlineCode"><span class="koboSpan" id="kobo.778.1">NotificationsService</span></code><span class="koboSpan" id="kobo.779.1"> is now a dependency of </span><code class="inlineCode"><span class="koboSpan" id="kobo.780.1">NotificationsService</span></code><span class="koboSpan" id="kobo.781.1"> itself. </span><span class="koboSpan" id="kobo.781.2">This can’t work as it has not already been resolved by Angular. </span><span class="koboSpan" id="kobo.781.3">To fix </span><a id="_idIndexMarker195"/><span class="koboSpan" id="kobo.782.1">this, we’ll also use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.783.1">@Optional()</span></code><span class="koboSpan" id="kobo.784.1"> decorator in the next step.</span></p> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="6"><span class="koboSpan" id="kobo.785.1">All right – now, we’ll use</span><a id="_idIndexMarker196"/><span class="koboSpan" id="kobo.786.1"> the </span><code class="inlineCode"><span class="koboSpan" id="kobo.787.1">@Optional()</span></code><span class="koboSpan" id="kobo.788.1"> decorator in </span><code class="inlineCode"><span class="koboSpan" id="kobo.789.1">notifications.service.ts,</span></code><span class="koboSpan" id="kobo.790.1"> which is in the constructor for the dependency alongside the </span><code class="inlineCode"><span class="koboSpan" id="kobo.791.1">@SkipSelf</span></code><span class="koboSpan" id="kobo.792.1"> decorator. </span><span class="koboSpan" id="kobo.792.2">The code should appear as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.793.1">import</span></span><span class="koboSpan" id="kobo.794.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.795.1">Injectable</span></span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.796.1">, </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.797.1">Optional</span></strong></span><span class="koboSpan" id="kobo.798.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.799.1">SkipSelf</span></span><span class="koboSpan" id="kobo.800.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.801.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.802.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.803.1">;
...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.804.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.805.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.806.1">NotificationsService</span></span><span class="koboSpan" id="kobo.807.1"> {
  ...
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.808.1">constructor</span></span><span class="koboSpan" id="kobo.809.1">(</span><span class="code-highlight"><strong class="hljs-meta-slc"><span class="koboSpan" id="kobo.810.1">@Optional</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.811.1">() </span></strong></span><span class="hljs-meta"><span class="koboSpan" id="kobo.812.1">@SkipSelf</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.813.1">() existingService:</span></span>
<span class="hljs-params"><span class="koboSpan" id="kobo.814.1">NotificationsService</span></span><span class="koboSpan" id="kobo.815.1">) {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.816.1">if</span></span><span class="koboSpan" id="kobo.817.1"> (existingService) {
      </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.818.1">throw</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.819.1">Error</span></span><span class="koboSpan" id="kobo.820.1"> (</span><span class="hljs-string"><span class="koboSpan" id="kobo.821.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.822.1">The service has already been provided in</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.823.1">the app. </span><span class="koboSpan" id="kobo.823.2">Avoid providing it again in child</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.824.1">modules'</span></span><span class="koboSpan" id="kobo.825.1">);
    }
  }
  ...
</span><span class="koboSpan" id="kobo.825.2">}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.826.1">We have now fixed the </span><code class="inlineCode"><span class="koboSpan" id="kobo.827.1">NotificationsService</span></code><span class="koboSpan" id="kobo.828.1"> -&gt; </span><code class="inlineCode"><span class="koboSpan" id="kobo.829.1">NotificationsService</span></code><span class="koboSpan" id="kobo.830.1"> dependency issue. </span><span class="koboSpan" id="kobo.830.2">You should see the proper error for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.831.1">NotificationsService</span></code><span class="koboSpan" id="kobo.832.1"> being provided multiple times in the console, as follows:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.833.1"><img alt="" role="presentation" src="../Images/B18469_03_09.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.834.1">Figure 3.9: An error detailing that NotificationsService is already provided in the app</span></p></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="7"><span class="koboSpan" id="kobo.835.1">Now, we’ll safely remove the provided </span><code class="inlineCode"><span class="koboSpan" id="kobo.836.1">NotificationsService</span></code><span class="koboSpan" id="kobo.837.1"> from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.838.1">providers</span></code><span class="koboSpan" id="kobo.839.1"> array in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.840.1">home.module.ts</span></code><span class="koboSpan" id="kobo.841.1"> file, as shown in </span><em class="italic"><span class="koboSpan" id="kobo.842.1">step 3</span></em><span class="koboSpan" id="kobo.843.1">, and check whether the app is working correctly</span></li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.844.1">Bam! </span><span class="koboSpan" id="kobo.844.2">We now have a singleton </span><a id="_idIndexMarker197"/><span class="koboSpan" id="kobo.845.1">service using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.846.1">providedIn</span></code><span class="koboSpan" id="kobo.847.1"> strategy. </span><span class="koboSpan" id="kobo.847.2">In the next section, let’s discuss how it works.</span></p>
<h2 class="heading-2" id="_idParaDest-103"><span class="koboSpan" id="kobo.848.1">How it works</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.849.1">Whenever we try to inject a service somewhere, by default, it tries to find a service inside the associated module of where you’re injecting the service. </span><span class="koboSpan" id="kobo.849.2">When we use </span><code class="inlineCode"><span class="koboSpan" id="kobo.850.1">providedIn: 'root'</span></code><span class="koboSpan" id="kobo.851.1"> to declare a </span><a id="_idIndexMarker198"/><span class="koboSpan" id="kobo.852.1">service, whenever the service is injected anywhere in the app, Angular knows that it simply must find the service definition in the root scope, instead of trying to find it in the feature modules or anywhere else.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.853.1">However, you must make sure that the service is only provided once in the entire application. </span><span class="koboSpan" id="kobo.853.2">If you provide it in multiple modules, then even with </span><code class="inlineCode"><span class="koboSpan" id="kobo.854.1">providedIn: 'root'</span></code><span class="koboSpan" id="kobo.855.1">, you’ll have multiple instances of the service. </span><span class="koboSpan" id="kobo.855.2">To avoid providing a service in multiple modules or multiple places in the app, we can use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.856.1">@SkipSelf()</span></code><span class="koboSpan" id="kobo.857.1"> decorator with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.858.1">@Optional()</span></code><span class="koboSpan" id="kobo.859.1"> decorator in the services’ constructor to check whether the service has already been provided in the app.</span></p>
<h2 class="heading-2" id="_idParaDest-104"><span class="koboSpan" id="kobo.860.1">See also</span></h2>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.861.1">Hierarchical DI in Angular (</span><a href="https://angular.io/guide/hierarchical-dependency-injection"><span class="url"><span class="koboSpan" id="kobo.862.1">https://angular.io/guide/hierarchical-dependency-injection</span></span></a><span class="koboSpan" id="kobo.863.1">)</span></li>
</ul>
<h1 class="heading-1" id="_idParaDest-105"><span class="koboSpan" id="kobo.864.1">Creating a singleton service using forRoot()</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.865.1">In this recipe, you’ll learn how to use </span><code class="inlineCode"><span class="koboSpan" id="kobo.866.1">ModuleWithProviders</span></code><span class="koboSpan" id="kobo.867.1"> and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.868.1">forRoot()</span></code><span class="koboSpan" id="kobo.869.1"> statement to ensure your Angular </span><a id="_idIndexMarker199"/><span class="koboSpan" id="kobo.870.1">service is used as a singleton in the entire app. </span><span class="koboSpan" id="kobo.870.2">We’ll start with an app that has multiple instances of </span><code class="inlineCode"><span class="koboSpan" id="kobo.871.1">NotificationsService</span></code><span class="koboSpan" id="kobo.872.1">, and </span><a id="_idIndexMarker200"/><span class="koboSpan" id="kobo.873.1">we’ll implement the necessary code to make sure we end up with a single instance of the service in our application.</span></p>
<h2 class="heading-2" id="_idParaDest-106"><span class="koboSpan" id="kobo.874.1">Getting ready</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.875.1">The app that we are going to work with resides in </span><code class="inlineCode"><span class="koboSpan" id="kobo.876.1">start/apps/chapter03/ng-singleton-service-forroot</span></code><span class="koboSpan" id="kobo.877.1">, inside the cloned repository:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.878.1">Open the code repository in your code editor.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.879.1">Open the Terminal, navigate to the code repository directory, and run the following command to serve the project:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.880.1">npm run serve ng-singleton-service-forroot
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.881.1">This should open the app in a new browser tab, and you should see the following:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.882.1"><img alt="" role="presentation" src="../Images/B18469_03_10.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.883.1">Figure 3.10: The ng-singleton-service-forroot app running on http://localhost:4200</span></p></li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.884.1">Now that we have the app running, in the next section, we can move on to the steps for the recipe.</span></p>
<h2 class="heading-2" id="_idParaDest-107"><span class="koboSpan" id="kobo.885.1">How to do it</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.886.1">In order to make sure you only have a singleton service in the app with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.887.1">forRoot</span></code><span class="koboSpan" id="kobo.888.1"> method, you need to </span><a id="_idIndexMarker201"/><span class="koboSpan" id="kobo.889.1">understand how </span><code class="inlineCode"><span class="koboSpan" id="kobo.890.1">ModuleWithProviders</span></code><span class="koboSpan" id="kobo.891.1"> and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.892.1">static forRoot()</span></code><span class="koboSpan" id="kobo.893.1"> method are created and implemented. </span><span class="koboSpan" id="kobo.893.2">Perform the following steps:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.894.1">First, we’ll make sure that the service has its own module. </span><span class="koboSpan" id="kobo.894.2">In many Angular applications, you’ll probably see </span><code class="inlineCode"><span class="koboSpan" id="kobo.895.1">CoreModule</span></code><span class="koboSpan" id="kobo.896.1"> where the services are provided (given we’re not using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.897.1">providedIn: 'root'</span></code><span class="koboSpan" id="kobo.898.1"> syntax for some reason). </span><span class="koboSpan" id="kobo.898.2">To begin, we’ll create a module, named </span><code class="inlineCode"><span class="koboSpan" id="kobo.899.1">ServicesModule</span></code><span class="koboSpan" id="kobo.900.1">, using the following command from the project root:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.901.1">cd start &amp;&amp; nx g m services --project ng-singleton-service-forroot
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.902.1">Let’s create a static</span><a id="_idIndexMarker202"/><span class="koboSpan" id="kobo.903.1"> method </span><code class="inlineCode"><span class="koboSpan" id="kobo.904.1">forRoot()</span></code><span class="koboSpan" id="kobo.905.1"> inside the </span><code class="inlineCode"><span class="koboSpan" id="kobo.906.1">ServicesModule</span></code><span class="koboSpan" id="kobo.907.1"> class in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.908.1">services.module.ts</span></code><span class="koboSpan" id="kobo.909.1"> file. </span><span class="koboSpan" id="kobo.909.2">We’ll name the method </span><code class="inlineCode"><span class="koboSpan" id="kobo.910.1">forRoot</span></code><span class="koboSpan" id="kobo.911.1"> and return a </span><code class="inlineCode"><span class="koboSpan" id="kobo.912.1">ModuleWithProviders</span></code><span class="koboSpan" id="kobo.913.1"> object that contains the </span><code class="inlineCode"><span class="koboSpan" id="kobo.914.1">NotificationsService</span></code><span class="koboSpan" id="kobo.915.1">, provided in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.916.1">providers</span></code><span class="koboSpan" id="kobo.917.1"> array, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.918.1">import</span></span><span class="koboSpan" id="kobo.919.1"> { </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.920.1">ModuleWithProviders</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.921.1">, </span></strong></span><span class="hljs-title"><span class="koboSpan" id="kobo.922.1">NgModule</span></span><span class="koboSpan" id="kobo.923.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.924.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.925.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.926.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.927.1">import</span></span><span class="koboSpan" id="kobo.928.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.929.1">CommonModule</span></span><span class="koboSpan" id="kobo.930.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.931.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.932.1">'@angular/common'</span></span><span class="koboSpan" id="kobo.933.1">;
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.934.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.935.1"> { </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.936.1">NotificationsService</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.937.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.938.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.939.1">'./notifications.service'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.940.1">;</span></strong></span>
<span class="hljs-meta"><span class="koboSpan" id="kobo.941.1">@NgModule</span></span><span class="koboSpan" id="kobo.942.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.943.1">declarations</span></span><span class="koboSpan" id="kobo.944.1">: [],
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.945.1">imports</span></span><span class="koboSpan" id="kobo.946.1">: [</span><span class="hljs-title"><span class="koboSpan" id="kobo.947.1">CommonModule</span></span><span class="koboSpan" id="kobo.948.1">],
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.949.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.950.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.951.1">ServicesModule</span></span><span class="koboSpan" id="kobo.952.1"> {
  </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.953.1">static</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.954.1">forRoot</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.955.1">(): </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.956.1">ModuleWithProviders</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.957.1">&lt;</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.958.1">ServicesModule</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.959.1">&gt; {</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.960.1">return</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.961.1"> {</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.962.1">ngModule</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.963.1">: </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.964.1">ServicesModule</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.965.1">,</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.966.1">providers</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.967.1">: [</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.968.1">NotificationsService</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.969.1">],</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.970.1">};</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.971.1">}</span></strong></span><span class="koboSpan" id="kobo.972.1">
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.973.1">Now, we’ll remove the </span><code class="inlineCode"><span class="koboSpan" id="kobo.974.1">NotificationsService</span></code><span class="koboSpan" id="kobo.975.1"> from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.976.1">app.module.ts</span></code><span class="koboSpan" id="kobo.977.1"> file’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.978.1">providers</span></code><span class="koboSpan" id="kobo.979.1"> array and include </span><code class="inlineCode"><span class="koboSpan" id="kobo.980.1">ServicesModule</span></code><span class="koboSpan" id="kobo.981.1"> in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.982.1">app.module.ts</span></code><span class="koboSpan" id="kobo.983.1"> file. </span><span class="koboSpan" id="kobo.983.2">In particular, we’ll add </span><code class="inlineCode"><span class="koboSpan" id="kobo.984.1">ServicesModule</span></code><span class="koboSpan" id="kobo.985.1"> in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.986.1">imports</span></code><span class="koboSpan" id="kobo.987.1"> array using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.988.1">forRoot()</span></code><span class="koboSpan" id="kobo.989.1"> method, as highlighted </span><a id="_idIndexMarker203"/><span class="koboSpan" id="kobo.990.1">in the following code block.
    </span><p class="normal"><span class="koboSpan" id="kobo.991.1">This is because</span><a id="_idIndexMarker204"/><span class="koboSpan" id="kobo.992.1"> it injects </span><code class="inlineCode"><span class="koboSpan" id="kobo.993.1">ServicesModule</span></code><span class="koboSpan" id="kobo.994.1"> with the providers in </span><code class="inlineCode"><span class="koboSpan" id="kobo.995.1">AppModule</span></code><span class="koboSpan" id="kobo.996.1">, for instance, with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.997.1">NotificationsService</span></code><span class="koboSpan" id="kobo.998.1"> being provided, as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.999.1">...
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1000.1">import </span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1001.1">{ </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1002.1">NotificationsService </span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1003.1">}</span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1004.1"> from </span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1005.1">'./services/notifications.service'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1006.1">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-comment-slc"><span class="koboSpan" id="kobo.1007.1">// &lt;-- Remove the import above</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1008.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1009.1"> { </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1010.1">ServicesModule</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1011.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1012.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1013.1">'./services/services.module'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1014.1">;</span></strong></span>
<span class="hljs-meta"><span class="koboSpan" id="kobo.1015.1">@NgModule</span></span><span class="koboSpan" id="kobo.1016.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1017.1">declarations</span></span><span class="koboSpan" id="kobo.1018.1">: [...],
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1019.1">imports</span></span><span class="koboSpan" id="kobo.1020.1">: [
    ...,
    </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1021.1">ServicesModule</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1022.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1023.1">forRoot</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1024.1">()</span></strong></span><span class="koboSpan" id="kobo.1025.1">
  ],
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1026.1">providers</span></span><span class="koboSpan" id="kobo.1027.1">: [
    </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1028.1">NotificationsService</span></strong><strong class="hljs-slc"> </strong></span><span class="hljs-comment"><span class="koboSpan" id="kobo.1029.1">// &lt;--</span></span><span class="code-highlight"><strong class="hljs-comment-slc"><span class="koboSpan" id="kobo.1030.1"> Remove this</span></strong></span><span class="koboSpan" id="kobo.1031.1">
  ],
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1032.1">bootstrap</span></span><span class="koboSpan" id="kobo.1033.1">: [</span><span class="hljs-title"><span class="koboSpan" id="kobo.1034.1">AppComponent</span></span><span class="koboSpan" id="kobo.1035.1">]
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1036.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1037.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1038.1">AppModule</span></span><span class="koboSpan" id="kobo.1039.1"> { }
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1040.1">You’ll notice that when adding/removing notifications, the count in the header still doesn’t change. </span><span class="koboSpan" id="kobo.1040.2">This is because we’re still providing the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1041.1">NotificationsService</span></code><span class="koboSpan" id="kobo.1042.1"> in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1043.1">home.module.ts</span></code><span class="koboSpan" id="kobo.1044.1"> file.</span></p></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="4"><span class="koboSpan" id="kobo.1045.1">We’ll remove the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1046.1">NotificationsService</span></code><span class="koboSpan" id="kobo.1047.1"> from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1048.1">providers</span></code><span class="koboSpan" id="kobo.1049.1"> array in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1050.1">home.module.ts</span></code><span class="koboSpan" id="kobo.1051.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1052.1">...
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1053.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1054.1"> { </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1055.1">NotificationsService</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1056.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1057.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1058.1">'../services/notifications.service'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1059.1">; </span></strong></span>
<span class="code-highlight"><strong class="hljs-comment-slc"><span class="koboSpan" id="kobo.1060.1">//  &lt;-- Remove the above import</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1061.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1062.1"> { </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1063.1">ServicesModule</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1064.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1065.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1066.1">'../services/services.module'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1067.1">;</span></strong></span>
<span class="hljs-meta"><span class="koboSpan" id="kobo.1068.1">@NgModule</span></span><span class="koboSpan" id="kobo.1069.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1070.1">declarations</span></span><span class="koboSpan" id="kobo.1071.1">: [</span><span class="hljs-title"><span class="koboSpan" id="kobo.1072.1">HomeComponent</span></span><span class="koboSpan" id="kobo.1073.1">,
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1074.1">NotificationsManagerComponent</span></span><span class="koboSpan" id="kobo.1075.1">],
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1076.1">imports</span></span><span class="koboSpan" id="kobo.1077.1">: [</span><span class="hljs-title"><span class="koboSpan" id="kobo.1078.1">CommonModule</span></span><span class="koboSpan" id="kobo.1079.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.1080.1">HomeRoutingModule</span></span><span class="koboSpan" id="kobo.1081.1">,
    </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1082.1">ServicesModule</span></strong></span><span class="koboSpan" id="kobo.1083.1">],
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1084.1">providers</span></span><span class="koboSpan" id="kobo.1085.1">: [
    </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1086.1">NotificationsService</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-comment-slc"><span class="koboSpan" id="kobo.1087.1">// &lt;-- Remove this</span></strong></span><span class="koboSpan" id="kobo.1088.1">
  ],
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1089.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1090.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1091.1">HomeModule</span></span><span class="koboSpan" id="kobo.1092.1"> {}
</span></code></pre>
</li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.1093.1">Great job. </span><span class="koboSpan" id="kobo.1093.2">Now that we</span><a id="_idIndexMarker205"/><span class="koboSpan" id="kobo.1094.1"> have finished the recipe, in the next section, let’s discuss how it works.</span></p>
<h2 class="heading-2" id="_idParaDest-108"><span class="koboSpan" id="kobo.1095.1">How it works</span></h2>
<p class="normal"><code class="inlineCode"><span class="koboSpan" id="kobo.1096.1">ModuleWithProviders </span></code><span class="koboSpan" id="kobo.1097.1">acts as a wrapper for an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1098.1">NgModule</span></code><span class="koboSpan" id="kobo.1099.1">, bundling it with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1100.1">providers</span></code><span class="koboSpan" id="kobo.1101.1"> array. </span><span class="koboSpan" id="kobo.1101.2">It’s used to configure an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1102.1">NgModule</span></code><span class="koboSpan" id="kobo.1103.1"> along with its providers, ensuring that when the module is imported </span><a id="_idIndexMarker206"/><span class="koboSpan" id="kobo.1104.1">elsewhere, it brings along its providers, too. </span><span class="koboSpan" id="kobo.1104.2">In our </span><code class="inlineCode"><span class="koboSpan" id="kobo.1105.1">ServicesModule</span></code><span class="koboSpan" id="kobo.1106.1">, we’ve created a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1107.1">forRoot</span></code><span class="koboSpan" id="kobo.1108.1"> method that returns a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1109.1">ModuleWithProviders</span></code><span class="koboSpan" id="kobo.1110.1">. </span><span class="koboSpan" id="kobo.1110.2">It includes our </span><code class="inlineCode"><span class="koboSpan" id="kobo.1111.1">NotificationsService</span></code><span class="koboSpan" id="kobo.1112.1">, which allows us to have a single instance of this service throughout the app, avoiding multiple instances that would normally occur if </span><code class="inlineCode"><span class="koboSpan" id="kobo.1113.1">NotificationsService</span></code><span class="koboSpan" id="kobo.1114.1"> was provided in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1115.1">providers</span></code><span class="koboSpan" id="kobo.1116.1"> array of </span><code class="inlineCode"><span class="koboSpan" id="kobo.1117.1">ServicesModule</span></code><span class="koboSpan" id="kobo.1118.1"> and imported into various modules. </span><span class="koboSpan" id="kobo.1118.2">Therefore, to ensure a single instance, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1119.1">ServicesModule</span></code><span class="koboSpan" id="kobo.1120.1"> should be imported using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1121.1">ModuleWithProviders</span></code><span class="koboSpan" id="kobo.1122.1"> approach, not in the standard way. </span><span class="koboSpan" id="kobo.1122.2">That is why when using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1123.1">ModuleWithProviders</span></code><span class="koboSpan" id="kobo.1124.1"> approach, we don’t import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1125.1">ServicesModule</span></code><span class="koboSpan" id="kobo.1126.1"> in the regular way, as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-meta"><span class="koboSpan" id="kobo.1127.1">@NgModule</span></span><span class="koboSpan" id="kobo.1128.1">({
  ...
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1129.1">imports</span></span><span class="koboSpan" id="kobo.1130.1">: [..., </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1131.1">ServicesModule</span></strong></span><span class="koboSpan" id="kobo.1132.1">],
})
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1133.1">Instead, we import it using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1134.1">forRoot</span></code><span class="koboSpan" id="kobo.1135.1"> method which ensures the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1136.1">NotificationService</span></code><span class="koboSpan" id="kobo.1137.1"> is only provided once in the entire app as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-meta"><span class="koboSpan" id="kobo.1138.1">@NgModule</span></span><span class="koboSpan" id="kobo.1139.1">({
...
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1140.1">imports</span></span><span class="koboSpan" id="kobo.1141.1">: [..., </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1142.1">ServicesModule</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1143.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1144.1">forRoot</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1145.1">()</span></strong></span><span class="koboSpan" id="kobo.1146.1">],
})
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1147.1">Now that you understand how</span><a id="_idIndexMarker207"/><span class="koboSpan" id="kobo.1148.1"> the recipe works, see the</span><a id="_idIndexMarker208"/><span class="koboSpan" id="kobo.1149.1"> next section for some useful links.</span></p>
<h2 class="heading-2" id="_idParaDest-109"><span class="koboSpan" id="kobo.1150.1">See also</span></h2>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.1151.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1152.1">ModuleWithProviders</span></code><span class="koboSpan" id="kobo.1153.1"> Angular </span><a id="_idIndexMarker209"/><span class="koboSpan" id="kobo.1154.1">documentation (</span><a href="https://angular.io/api/core/ModuleWithProviders"><span class="url"><span class="koboSpan" id="kobo.1155.1">https://angular.io/api/core/ModuleWithProviders</span></span></a><span class="koboSpan" id="kobo.1156.1">)</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.1157.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1158.1">ModuleWithProviders</span></code><span class="koboSpan" id="kobo.1159.1"> migration </span><a id="_idIndexMarker210"/><span class="koboSpan" id="kobo.1160.1">documentation (</span><a href="https://angular.io/guide/migration-module-with-providers%20"><span class="url"><span class="koboSpan" id="kobo.1161.1">https://angular.io/guide/migration-module-with-providers%20</span></span></a><span class="koboSpan" id="kobo.1162.1">)</span></li>
</ul>
<h1 class="heading-1" id="_idParaDest-110"><span class="koboSpan" id="kobo.1163.1">Providing alternate classes against the same DI Token</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.1164.1">In this recipe, you’ll learn how to provide two different services to the app using </span><strong class="keyWord"><span class="koboSpan" id="kobo.1165.1">Aliased class providers</span></strong><span class="koboSpan" id="kobo.1166.1">. </span><span class="koboSpan" id="kobo.1166.2">This is extremely helpful in complex applications where you need to narrow down the implementation</span><a id="_idIndexMarker211"/><span class="koboSpan" id="kobo.1167.1"> of the service/class for some components/modules, that is, providing different classes against the same DI token to have a polymorphic behavior. </span><span class="koboSpan" id="kobo.1167.2">Additionally, aliasing is used in component/service unit tests to mock the dependent service’s actual implementation so that we don’t rely on it.</span></p>
<h2 class="heading-2" id="_idParaDest-111"><span class="koboSpan" id="kobo.1168.1">Getting ready</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1169.1">The app that we are going to work with resides in </span><code class="inlineCode"><span class="koboSpan" id="kobo.1170.1">start/apps/chapter03/ng-aliased-class-providers</span></code><span class="koboSpan" id="kobo.1171.1">, inside the cloned repository:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1172.1">Open the code repository in your code editor.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1173.1">Open the Terminal, navigate to the code repository directory, and run the following command to serve the project:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1174.1">npm run serve ng-aliased-class-providers
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1175.1">This should open the app in a new browser tab, and you should see the app as shown in </span><em class="italic"><span class="koboSpan" id="kobo.1176.1">Figure 3.11</span></em><span class="koboSpan" id="kobo.1177.1">.</span></p></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="3"><span class="koboSpan" id="kobo.1178.1">Click on the </span><strong class="screenText"><span class="koboSpan" id="kobo.1179.1">Login as Admin</span></strong><span class="koboSpan" id="kobo.1180.1"> button. </span><span class="koboSpan" id="kobo.1180.2">You should see something similar to the following screenshot:
    </span><figure class="mediaobject"><span class="koboSpan" id="kobo.1181.1"><img alt="" role="presentation" src="../Images/B18469_03_11.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1182.1">Figure 3.11: The ng-aliased-class-providers app running on http://localhost:4200</span></p></li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.1183.1">Now that we have the app running, let’s move to the next section to follow the steps for the recipe.</span></p>
<h2 class="heading-2" id="_idParaDest-112"><span class="koboSpan" id="kobo.1184.1">How to do it</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1185.1">We have a standalone </span><a id="_idIndexMarker212"/><span class="koboSpan" id="kobo.1186.1">component named </span><code class="inlineCode"><span class="koboSpan" id="kobo.1187.1">BucketComponent</span></code><span class="koboSpan" id="kobo.1188.1">, which is being used in both the admin and employee components. </span><code class="inlineCode"><span class="koboSpan" id="kobo.1189.1">BucketComponent</span></code><span class="koboSpan" id="kobo.1190.1"> uses </span><code class="inlineCode"><span class="koboSpan" id="kobo.1191.1">BucketService</span></code><span class="koboSpan" id="kobo.1192.1"> behind the scenes to add/remove items from and to a bucket. </span><span class="koboSpan" id="kobo.1192.2">For the employee, we’ll restrict the ability to remove an item by providing an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1193.1">aliased</span></code><span class="koboSpan" id="kobo.1194.1"> class provider and a replacement of </span><code class="inlineCode"><span class="koboSpan" id="kobo.1195.1">BucketService</span></code><span class="koboSpan" id="kobo.1196.1"> named </span><code class="inlineCode"><span class="koboSpan" id="kobo.1197.1">EmployeeBucketService</span></code><span class="koboSpan" id="kobo.1198.1">. </span><span class="koboSpan" id="kobo.1198.2">This is so that we can override the remove item functionality. </span><span class="koboSpan" id="kobo.1198.3">Perform the following steps to get started:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1199.1">We’ll start by creating </span><code class="inlineCode"><span class="koboSpan" id="kobo.1200.1">EmployeeBucketService</span></code><span class="koboSpan" id="kobo.1201.1"> within the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1202.1">employee</span></code><span class="koboSpan" id="kobo.1203.1"> folder. </span><span class="koboSpan" id="kobo.1203.2">Run the following command from the workspace root:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1204.1">cd start &amp;&amp; nx g service employee/employee-bucket --project ng-aliased-class-providers
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1205.1">Next, we’ll extend </span><code class="inlineCode"><span class="koboSpan" id="kobo.1206.1">EmployeeBucketService</span></code><span class="koboSpan" id="kobo.1207.1"> from </span><code class="inlineCode"><span class="koboSpan" id="kobo.1208.1">BucketService</span></code><span class="koboSpan" id="kobo.1209.1"> so that we get all the goodness of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1210.1">BucketService</span></code><span class="koboSpan" id="kobo.1211.1"> class. </span><span class="koboSpan" id="kobo.1211.2">Let’s modify the code as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1212.1">import</span></span><span class="koboSpan" id="kobo.1213.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1214.1">Injectable</span></span><span class="koboSpan" id="kobo.1215.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1216.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1217.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.1218.1">;
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1219.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1220.1"> { </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1221.1">BucketService</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1222.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1223.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1224.1">'../bucket/bucket.service'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1225.1">;</span></strong></span><span class="koboSpan" id="kobo.1226.1">
...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1227.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1228.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1229.1">EmployeeBucketService</span></span><span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1230.1">extends</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1231.1">BucketService</span></strong></span><span class="koboSpan" id="kobo.1232.1"> {
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.1233.1">constructor</span></span><span class="koboSpan" id="kobo.1234.1">() {
    </span><span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1235.1">super</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1236.1">();</span></strong></span><span class="koboSpan" id="kobo.1237.1">
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1238.1">We will now override the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1239.1">removeItem</span></code><span class="koboSpan" id="kobo.1240.1"> method to display a simple </span><code class="inlineCode"><span class="koboSpan" id="kobo.1241.1">alert</span></code><span class="koboSpan" id="kobo.1242.1">, mentioning that the employees can’t remove items from the bucket. </span><span class="koboSpan" id="kobo.1242.2">Your code should appear as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1243.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1244.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1245.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1246.1">EmployeeBucketService</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1247.1">extends</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1248.1">BucketService</span></span><span class="koboSpan" id="kobo.1249.1"> {
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.1250.1">constructor</span></span><span class="koboSpan" id="kobo.1251.1">() {...}
  </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1252.1">override</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1253.1">removeItem</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1254.1">() {</span></strong></span>
<span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1255.1">alert</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1256.1">(</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1257.1">'Employees can not delete items'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1258.1">);</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1259.1">}</span></strong></span><span class="koboSpan" id="kobo.1260.1">
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1261.1">As a final step, we</span><a id="_idIndexMarker213"/><span class="koboSpan" id="kobo.1262.1"> need to provide the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1263.1">aliased</span></code><span class="koboSpan" id="kobo.1264.1"> class provider to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1265.1">employee.component.ts</span></code><span class="koboSpan" id="kobo.1266.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1267.1">...
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1268.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1269.1"> { </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1270.1">BucketService</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1271.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1272.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1273.1">'../bucket/bucket.service'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1274.1">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1275.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1276.1"> { </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1277.1">EmployeeBucketService</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1278.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1279.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1280.1">'</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1281.1">./employee-bucket.service'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1282.1">;</span></strong></span>
<span class="hljs-meta"><span class="koboSpan" id="kobo.1283.1">@Component</span></span><span class="koboSpan" id="kobo.1284.1">({
  ...
  </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1285.1">providers</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1286.1">: [{</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1287.1">provide</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1288.1">: </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1289.1">BucketService</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1290.1">,</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1291.1">useClass</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1292.1">: </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1293.1">EmployeeBucketService</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1294.1">,</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1295.1">}],</span></strong></span><span class="koboSpan" id="kobo.1296.1">
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1297.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1298.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1299.1">EmployeeComponent</span></span><span class="koboSpan" id="kobo.1300.1"> {}
</span></code></pre>
</li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.1301.1">If you now log in as an employee in the app and try to remove an item, you’ll see an alert pop up, which says </span><code class="inlineCode"><span class="koboSpan" id="kobo.1302.1">Employees cannot delete items</span></code><span class="koboSpan" id="kobo.1303.1">.</span></p>
<h2 class="heading-2" id="_idParaDest-113"><span class="koboSpan" id="kobo.1304.1">How it works</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1305.1">When we inject a service into a component, Angular tries to find that component inside the component/module we’ve provided the dependency for and then by moving up the hierarchy of components and modules. </span><span class="koboSpan" id="kobo.1305.2">Our </span><code class="inlineCode"><span class="koboSpan" id="kobo.1306.1">BucketService</span></code><span class="koboSpan" id="kobo.1307.1"> is provided in </span><code class="inlineCode"><span class="koboSpan" id="kobo.1308.1">'root'</span></code><span class="koboSpan" id="kobo.1309.1">, using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1310.1">providedIn: 'root'</span></code><span class="koboSpan" id="kobo.1311.1"> syntax. </span><span class="koboSpan" id="kobo.1311.2">Therefore, it resides at the top of the hierarchy. </span><span class="koboSpan" id="kobo.1311.3">However, since, in this</span><a id="_idIndexMarker214"/><span class="koboSpan" id="kobo.1312.1"> recipe, we use an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1313.1">aliased</span></code><span class="koboSpan" id="kobo.1314.1"> class provider in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1315.1">EmployeeComponent</span></code><span class="koboSpan" id="kobo.1316.1"> class against the DI token </span><code class="inlineCode"><span class="koboSpan" id="kobo.1317.1">BucketService</span></code><span class="koboSpan" id="kobo.1318.1">, when Angular searches for </span><code class="inlineCode"><span class="koboSpan" id="kobo.1319.1">BucketService</span></code><span class="koboSpan" id="kobo.1320.1"> for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1321.1">EmployeeComponent</span></code><span class="koboSpan" id="kobo.1322.1">, it quickly finds the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1323.1">EmployeeBucketService</span></code><span class="koboSpan" id="kobo.1324.1"> against the token in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1325.1">EmployeeComponent</span></code><span class="koboSpan" id="kobo.1326.1"> and stops there – i.e., it doesn’t reach the “root” to get the actual </span><code class="inlineCode"><span class="koboSpan" id="kobo.1327.1">BucketService</span></code><span class="koboSpan" id="kobo.1328.1">. </span><span class="koboSpan" id="kobo.1328.2">This is what we intended.</span></p>
<h2 class="heading-2" id="_idParaDest-114"><span class="koboSpan" id="kobo.1329.1">See also</span></h2>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.1330.1">DI in Angular (</span><a href="https://angular.io/guide/dependency-injection"><span class="url"><span class="koboSpan" id="kobo.1331.1">https://angular.io/guide/dependency-injection</span></span></a><span class="koboSpan" id="kobo.1332.1">)</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.1333.1">Hierarchical injectors in </span><a id="_idIndexMarker215"/><span class="koboSpan" id="kobo.1334.1">Angular (</span><a href="https://angular.io/guide/hierarchical-dependency-injection"><span class="url"><span class="koboSpan" id="kobo.1335.1">https://angular.io/guide/hierarchical-dependency-injection</span></span></a><span class="koboSpan" id="kobo.1336.1">)</span></li>
</ul>
<h1 class="heading-1" id="_idParaDest-115"><span class="koboSpan" id="kobo.1337.1">Dynamic configurations using value providers</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.1338.1">In this recipe, you’ll learn how to use value providers in Angular to provide constants and config values to your app. </span><span class="koboSpan" id="kobo.1338.2">We’ll start with the same example from the previous recipe, which involves </span><code class="inlineCode"><span class="koboSpan" id="kobo.1339.1">EmployeeComponent</span></code><span class="koboSpan" id="kobo.1340.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1341.1">AdminComponent</span></code><span class="koboSpan" id="kobo.1342.1"> using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1343.1">BucketComponent</span></code><span class="koboSpan" id="kobo.1344.1"> to manage a bucket of </span><a id="_idIndexMarker216"/><span class="koboSpan" id="kobo.1345.1">fruits. </span><span class="koboSpan" id="kobo.1345.2">We will restrict the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1346.1">EmployeeComponent</span></code><span class="koboSpan" id="kobo.1347.1"> from deleting items from the bucket by using the configuration </span><a id="_idIndexMarker217"/><span class="koboSpan" id="kobo.1348.1">with a value provider. </span><span class="koboSpan" id="kobo.1348.2">As a result, the employees won’t even see the </span><strong class="screenText"><span class="koboSpan" id="kobo.1349.1">Delete</span></strong><span class="koboSpan" id="kobo.1350.1"> button.</span></p>
<h2 class="heading-2" id="_idParaDest-116"><span class="koboSpan" id="kobo.1351.1">Getting ready</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1352.1">The app that we are going to work with resides in </span><code class="inlineCode"><span class="koboSpan" id="kobo.1353.1">start/apps/chapter03/ng-value-providers</span></code><span class="koboSpan" id="kobo.1354.1"> inside the cloned repository:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1355.1">Open the code repository in your code editor.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1356.1">Open the terminal, navigate to the code repository directory, and run the following command to serve the project:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1357.1">npm run serve ng-value-providers
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1358.1">This should open the </span><a id="_idIndexMarker218"/><span class="koboSpan" id="kobo.1359.1">app in a new browser tab, and you should see the app as shown in </span><em class="italic"><span class="koboSpan" id="kobo.1360.1">Figure 3.12</span></em><span class="koboSpan" id="kobo.1361.1">.</span></p> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="3"><span class="koboSpan" id="kobo.1362.1">Click on the </span><strong class="screenText"><span class="koboSpan" id="kobo.1363.1">Login as Admin</span></strong><span class="koboSpan" id="kobo.1364.1"> button. </span><span class="koboSpan" id="kobo.1364.2">You should see something like the following screenshot:
    </span><figure class="mediaobject"><span class="koboSpan" id="kobo.1365.1"><img alt="" role="presentation" src="../Images/B18469_03_12.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1366.1">Figure 3.12: The ng-value-providers app running on http://localhost:4200</span></p></li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.1367.1">Now that you see the app running, let’s look at the next section to follow the recipe.</span></p>
<h2 class="heading-2" id="_idParaDest-117"><span class="koboSpan" id="kobo.1368.1">How to do it</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1369.1">We have a standalone</span><a id="_idIndexMarker219"/><span class="koboSpan" id="kobo.1370.1"> component named </span><code class="inlineCode"><span class="koboSpan" id="kobo.1371.1">BucketComponent</span></code><span class="koboSpan" id="kobo.1372.1">, which is being used in both the admin and employee components. </span><code class="inlineCode"><span class="koboSpan" id="kobo.1373.1">BucketComponent</span></code><span class="koboSpan" id="kobo.1374.1"> uses </span><code class="inlineCode"><span class="koboSpan" id="kobo.1375.1">BucketService</span></code><span class="koboSpan" id="kobo.1376.1"> behind the scenes to add/remove items from and to a bucket. </span><span class="koboSpan" id="kobo.1376.2">For the employee, we’ll restrict the ability to remove an item by providing a value provider. </span><span class="koboSpan" id="kobo.1376.3">This is so that we can override the remove item functionality. </span><span class="koboSpan" id="kobo.1376.4">Let’s begin with the following steps:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1377.1">First, we’ll start by creating the value provider with </span><code class="inlineCode"><span class="koboSpan" id="kobo.1378.1">InjectionToken</span></code><span class="koboSpan" id="kobo.1379.1"> within a new file, named </span><code class="inlineCode"><span class="koboSpan" id="kobo.1380.1">app-config.ts</span></code><span class="koboSpan" id="kobo.1381.1">, in the root of the project. </span><span class="koboSpan" id="kobo.1381.2">The code should appear as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1382.1">import</span></span><span class="koboSpan" id="kobo.1383.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1384.1">InjectionToken</span></span><span class="koboSpan" id="kobo.1385.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1386.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1387.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.1388.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1389.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1390.1">interface</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1391.1">IAppConfig</span></span><span class="koboSpan" id="kobo.1392.1"> {
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1393.1">canDeleteItems</span></span><span class="koboSpan" id="kobo.1394.1">: </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1395.1">boolean</span></span><span class="koboSpan" id="kobo.1396.1">;
}
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1397.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1398.1">const</span></span> <span class="hljs-variable"><span class="koboSpan" id="kobo.1399.1">APP_CONFIG</span></span><span class="koboSpan" id="kobo.1400.1"> = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1401.1">new</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1402.1">InjectionToken</span></span><span class="koboSpan" id="kobo.1403.1">&lt;</span><span class="hljs-title"><span class="koboSpan" id="kobo.1404.1">IAppConfig</span></span><span class="koboSpan" id="kobo.1405.1">&gt;(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1406.1">'APP_CONFIG'</span></span><span class="koboSpan" id="kobo.1407.1">);
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1408.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1409.1">const</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1410.1">AppConfig</span></span><span class="koboSpan" id="kobo.1411.1">: </span><span class="hljs-title"><span class="koboSpan" id="kobo.1412.1">IAppConfig</span></span><span class="koboSpan" id="kobo.1413.1"> = {
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1414.1">canDeleteItems</span></span><span class="koboSpan" id="kobo.1415.1">: </span><span class="hljs-literal"><span class="koboSpan" id="kobo.1416.1">true</span></span><span class="koboSpan" id="kobo.1417.1">,
};
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1418.1">Before we can</span><a id="_idIndexMarker220"/><span class="koboSpan" id="kobo.1419.1"> actually use this </span><code class="inlineCode"><span class="koboSpan" id="kobo.1420.1">AppConfig</span></code><span class="koboSpan" id="kobo.1421.1"> constant in our </span><code class="inlineCode"><span class="koboSpan" id="kobo.1422.1">BucketComponent</span></code><span class="koboSpan" id="kobo.1423.1">, we need to register it to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1424.1">AppModule</span></code><span class="koboSpan" id="kobo.1425.1"> so that </span><a id="_idIndexMarker221"/><span class="koboSpan" id="kobo.1426.1">when we inject this in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1427.1">BucketComponent</span></code><span class="koboSpan" id="kobo.1428.1">, the value of the provider is resolved.</span></p> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="2"><span class="koboSpan" id="kobo.1429.1">Let’s add the provider to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1430.1">app.module.ts</span></code><span class="koboSpan" id="kobo.1431.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1432.1">...
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1433.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1434.1"> { </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1435.1">AppConfig</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1436.1">, </span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1437.1">APP_CONFIG</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1438.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1439.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1440.1">'./app-config'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1441.1">;</span></strong></span>
<span class="hljs-meta"><span class="koboSpan" id="kobo.1442.1">@NgModule</span></span><span class="koboSpan" id="kobo.1443.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1444.1">declarations</span></span><span class="koboSpan" id="kobo.1445.1">: [</span><span class="hljs-title"><span class="koboSpan" id="kobo.1446.1">AppComponent</span></span><span class="koboSpan" id="kobo.1447.1">],
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1448.1">imports</span></span><span class="koboSpan" id="kobo.1449.1">: [...],
  </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1450.1">providers</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1451.1">: [{</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1452.1">provide</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1453.1">: </span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1454.1">APP_CONFIG</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1455.1">,</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1456.1">useValue</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1457.1">: </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1458.1">AppConfig</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1459.1">,</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1460.1">}],</span></strong></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.1461.1">bootstrap</span></span><span class="koboSpan" id="kobo.1462.1">: [</span><span class="hljs-title"><span class="koboSpan" id="kobo.1463.1">AppComponent</span></span><span class="koboSpan" id="kobo.1464.1">],
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1465.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1466.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1467.1">AppModule</span></span><span class="koboSpan" id="kobo.1468.1"> {}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1469.1">Now, the app knows about the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1470.1">AppConfig</span></code><span class="koboSpan" id="kobo.1471.1"> constants. </span><span class="koboSpan" id="kobo.1471.2">The next step is to use this constant in </span><code class="inlineCode"><span class="koboSpan" id="kobo.1472.1">BucketComponent</span></code><span class="koboSpan" id="kobo.1473.1">.</span></p></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="3"><span class="koboSpan" id="kobo.1474.1">We’ll use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1475.1">inject</span></code><span class="koboSpan" id="kobo.1476.1"> method to inject it inside the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1477.1">BucketComponent</span></code><span class="koboSpan" id="kobo.1478.1"> class, in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1479.1">bucket/bucket.component.ts</span></code><span class="koboSpan" id="kobo.1480.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1481.1">import</span></span><span class="koboSpan" id="kobo.1482.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1483.1">Component</span></span><span class="koboSpan" id="kobo.1484.1">, i</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1485.1">nject,</span></strong></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1486.1">OnInit</span></span><span class="koboSpan" id="kobo.1487.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1488.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1489.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.1490.1">;
...
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1491.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1492.1"> { </span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1493.1">APP_CONFIG</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1494.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1495.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1496.1">'../app-config'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1497.1">;</span></strong></span><span class="koboSpan" id="kobo.1498.1">
...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1499.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1500.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1501.1">BucketComponent</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1502.1">implements</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1503.1">OnInit</span></span><span class="koboSpan" id="kobo.1504.1"> {
  bucketService = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1505.1">inject</span></span><span class="koboSpan" id="kobo.1506.1">(</span><span class="hljs-title"><span class="koboSpan" id="kobo.1507.1">BucketService</span></span><span class="koboSpan" id="kobo.1508.1">);
  </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1509.1">appConfig = </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1510.1">inject</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1511.1">(</span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1512.1">APP_CONFIG</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1513.1">);</span></strong></span><span class="koboSpan" id="kobo.1514.1">
  ...
</span><span class="koboSpan" id="kobo.1514.2">}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1515.1">Great! </span><span class="koboSpan" id="kobo.1515.2">The constant has been injected. </span><span class="koboSpan" id="kobo.1515.3">Now, if you refresh the app, you shouldn’t get any errors. </span><span class="koboSpan" id="kobo.1515.4">The next step is to use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1516.1">canDeleteItems</span></code><span class="koboSpan" id="kobo.1517.1"> property from </span><code class="inlineCode"><span class="koboSpan" id="kobo.1518.1">config</span></code><span class="koboSpan" id="kobo.1519.1"> in </span><code class="inlineCode"><span class="koboSpan" id="kobo.1520.1">BucketComponent</span></code><span class="koboSpan" id="kobo.1521.1"> to show/hide the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1522.1">delete</span></code><span class="koboSpan" id="kobo.1523.1"> button.</span></p></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="4"><span class="koboSpan" id="kobo.1524.1">Now, we’ll add an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1525.1">*ngIf</span></code><span class="koboSpan" id="kobo.1526.1"> directive in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1527.1">bucket/ bucket.component.html</span></code><span class="koboSpan" id="kobo.1528.1"> file to only show the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1529.1">delete</span></code><span class="koboSpan" id="kobo.1530.1"> button if the</span><a id="_idIndexMarker222"/><span class="koboSpan" id="kobo.1531.1"> value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.1532.1">appConfig.canDeleteItems</span></code><span class="koboSpan" id="kobo.1533.1"> is </span><code class="inlineCode"><span class="koboSpan" id="kobo.1534.1">true</span></code><span class="koboSpan" id="kobo.1535.1">. </span><span class="koboSpan" id="kobo.1535.2">Update the element </span><a id="_idIndexMarker223"/><span class="koboSpan" id="kobo.1536.1">with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1537.1">fruites__item__delete-icon</span></code><span class="koboSpan" id="kobo.1538.1"> class, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1539.1">...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1540.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1541.1">div</span></span><span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1542.1">*</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1543.1">ngIf</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1544.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1545.1">"appConfig.canDeleteItems"</span></strong></span>
<span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1546.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1547.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1548.1">"fruites__item__delete-icon"</span></span>
<span class="hljs-attr"> </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1549.1"> (</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.1550.1">click</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1551.1">)=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1552.1">"deleteFromBucket(item)"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1553.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1554.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1555.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1556.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1557.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1558.1">"material-symbols-outlined"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1559.1">&gt;</span></span><span class="koboSpan" id="kobo.1560.1">delete</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1561.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1562.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1563.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1564.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1565.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1566.1">&gt;</span></span><span class="koboSpan" id="kobo.1567.1">
...
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1568.1">You can test whether everything works by setting the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1569.1">AppConfig</span></code><span class="koboSpan" id="kobo.1570.1"> constant’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.1571.1">canDeleteItems</span></code><span class="koboSpan" id="kobo.1572.1"> property to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1573.1">false</span></code><span class="koboSpan" id="kobo.1574.1">. </span><span class="koboSpan" id="kobo.1574.2">Note that the </span><strong class="screenText"><span class="koboSpan" id="kobo.1575.1">Delete</span></strong><span class="koboSpan" id="kobo.1576.1"> button is now hidden for both the admin and employee. </span><span class="koboSpan" id="kobo.1576.2">Once tested, set the value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.1577.1">canDeleteItems</span></code><span class="koboSpan" id="kobo.1578.1"> back to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1579.1">true</span></code><span class="koboSpan" id="kobo.1580.1"> again.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1581.1">Now, we have everything set up. </span><span class="koboSpan" id="kobo.1581.2">Let’s add a new constant so that we can hide the </span><strong class="screenText"><span class="koboSpan" id="kobo.1582.1">Delete</span></strong><span class="koboSpan" id="kobo.1583.1"> button for the employee only.</span></p> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="5"><span class="koboSpan" id="kobo.1584.1">Let’s create an employee configuration object now. </span><span class="koboSpan" id="kobo.1584.2">We’ll create an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1585.1">employee.config.ts</span></code><span class="koboSpan" id="kobo.1586.1"> file inside the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1587.1">employee</span></code><span class="koboSpan" id="kobo.1588.1"> folder, and we will add the following code to it:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1589.1">import</span></span><span class="koboSpan" id="kobo.1590.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1591.1">IAppConfig</span></span><span class="koboSpan" id="kobo.1592.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1593.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1594.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1595.1">../app-config'</span></span><span class="koboSpan" id="kobo.1596.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1597.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1598.1">const</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1599.1">EmployeeConfig</span></span><span class="koboSpan" id="kobo.1600.1">: </span><span class="hljs-title"><span class="koboSpan" id="kobo.1601.1">IAppConfig</span></span><span class="koboSpan" id="kobo.1602.1"> = {
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1603.1">canDeleteItems</span></span><span class="koboSpan" id="kobo.1604.1">: </span><span class="hljs-literal"><span class="koboSpan" id="kobo.1605.1">false</span></span><span class="koboSpan" id="kobo.1606.1">,
};
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1607.1">Now, we’ll provide this </span><code class="inlineCode"><span class="koboSpan" id="kobo.1608.1">EmployeeConfig</span></code><span class="koboSpan" id="kobo.1609.1"> constant to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1610.1">EmployeeComponent</span></code><span class="koboSpan" id="kobo.1611.1"> for the same </span><code class="inlineCode"><span class="koboSpan" id="kobo.1612.1">APP_CONFIG</span></code><span class="koboSpan" id="kobo.1613.1"> injection token. </span><span class="koboSpan" id="kobo.1613.2">The code in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1614.1">employee.component.ts</span></code><span class="koboSpan" id="kobo.1615.1"> file should look as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1616.1">...
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1617.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1618.1"> { </span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1619.1">APP_CONFIG</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1620.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1621.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1622.1">'../app-config'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1623.1">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1624.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1625.1"> { </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1626.1">EmployeeConfig</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1627.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1628.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1629.1">'./employee.config'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1630.1">;</span></strong></span>
<span class="hljs-meta"><span class="koboSpan" id="kobo.1631.1">@Component</span></span><span class="koboSpan" id="kobo.1632.1">({
  ...
  </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1633.1">providers</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1634.1">: [{</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1635.1">provide</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1636.1">: </span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1637.1">APP_CONFIG</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1638.1">,</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1639.1">useValue</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1640.1">: </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1641.1">EmployeeConfig</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1642.1">,</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1643.1">}],</span></strong></span><span class="koboSpan" id="kobo.1644.1">
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1645.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1646.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1647.1">EmployeeComponent</span></span><span class="koboSpan" id="kobo.1648.1"> {}
</span></code></pre>
</li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.1649.1">And we’re done! </span><span class="koboSpan" id="kobo.1649.2">The recipe is now complete. </span><span class="koboSpan" id="kobo.1649.3">You can see that the </span><strong class="screenText"><span class="koboSpan" id="kobo.1650.1">Delete</span></strong><span class="koboSpan" id="kobo.1651.1"> button is visible to the admin but hidden for the</span><a id="_idIndexMarker224"/><span class="koboSpan" id="kobo.1652.1"> employee. </span><span class="koboSpan" id="kobo.1652.2">It’s all thanks to the magic of value providers.</span></p>
<h2 class="heading-2" id="_idParaDest-118"><span class="koboSpan" id="kobo.1653.1">How it works</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1654.1">When we inject a token into a </span><a id="_idIndexMarker225"/><span class="koboSpan" id="kobo.1655.1">component, Angular tries to find the resolved value of the token in the injected place and then by moving up the hierarchy of components and modules. </span><span class="koboSpan" id="kobo.1655.2">We provided the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1656.1">EmployeeConfig</span></code><span class="koboSpan" id="kobo.1657.1"> object against the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1658.1">APP_CONFIG</span></code><span class="koboSpan" id="kobo.1659.1"> token in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1660.1">EmployeeComponent </span></code><span class="koboSpan" id="kobo.1661.1">class. </span><span class="koboSpan" id="kobo.1661.2">When Angular tries to resolve the token’s value for </span><code class="inlineCode"><span class="koboSpan" id="kobo.1662.1">BucketComponent</span></code><span class="koboSpan" id="kobo.1663.1">, it finds it early as </span><code class="inlineCode"><span class="koboSpan" id="kobo.1664.1">EmployeeConfig</span></code><span class="koboSpan" id="kobo.1665.1">, within the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1666.1">EmployeeComponent</span></code><span class="koboSpan" id="kobo.1667.1"> instead of the value provided in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1668.1">AppModule</span></code><span class="koboSpan" id="kobo.1669.1"> as </span><code class="inlineCode"><span class="koboSpan" id="kobo.1670.1">AppConfig</span></code><span class="koboSpan" id="kobo.1671.1">. </span><span class="koboSpan" id="kobo.1671.2">Therefore, Angular stops right there and doesn’t reach </span><code class="inlineCode"><span class="koboSpan" id="kobo.1672.1">AppModule</span></code><span class="koboSpan" id="kobo.1673.1">. </span><span class="koboSpan" id="kobo.1673.2">This is amazing, as we can now have a global configuration and override the configuration within nested modules/components.</span></p>
<h2 class="heading-2" id="_idParaDest-119"><span class="koboSpan" id="kobo.1674.1">See also</span></h2>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.1675.1">DI in Angular (</span><a href="https://angular.io/guide/dependency-injection"><span class="url"><span class="koboSpan" id="kobo.1676.1">https://angular.io/guide/dependency-injection</span></span></a><span class="koboSpan" id="kobo.1677.1">)</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.1678.1">Hierarchical injectors in Angular (</span><a href="https://angular.io/guide/hierarchical-dependency-injection"><span class="url"><span class="koboSpan" id="kobo.1679.1">https://angular.io/guide/hierarchical-dependency-injection</span></span></a><span class="koboSpan" id="kobo.1680.1">)</span></li>
</ul>
<h1 class="heading-1"><span class="koboSpan" id="kobo.1681.1">Learn more on Discord</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.1682.1">To join the Discord community for this book – where you can share feedback, ask questions to the author, and learn about new releases – follow the QR code below:</span></p>
<p class="normal"><a href="Chapter_3.xhtml"><span class="url"><span class="koboSpan" id="kobo.1683.1">https://packt.link/AngularCookbook2e</span></span></a></p>
<p class="normal"><span class="koboSpan" id="kobo.1684.1"><img alt="" role="presentation" src="../Images/QR_Code1388317275422265.png"/></span></p>
</div>
</body></html>
<html><head></head><body>
		<div id="_idContainer127">
			<h1 id="_idParaDest-203" class="chapter-number"><a id="_idTextAnchor205"/>8</h1>
			<h1 id="_idParaDest-204"><a id="_idTextAnchor206"/>State Management</h1>
			<p>In this chapter, we’ll learn about <strong class="bold">shared state</strong>, which is state that is used by several different components. We will explore three <a id="_idIndexMarker607"/>approaches to managing shared state, discussing the pros and cons of <span class="No-Break">each approach.</span></p>
			<p>To do this, we will build a simple app containing a header that displays the user’s name, with the main content also referencing the user’s name. The user’s name will be stored in state that needs to be accessed by <span class="No-Break">several components.</span></p>
			<p>We will start with the simplest state solution. This is to use one of React’s state hooks to store the state and pass it to other components<a id="_idIndexMarker608"/> using props. This approach is often referred to as <span class="No-Break"><strong class="bold">prop drilling</strong></span><span class="No-Break">.</span></p>
			<p>The second approach we will learn about is a feature in React called <strong class="bold">context</strong>. We will learn how to create a context containing a state and let other components <span class="No-Break">access it.</span></p>
			<p>The last approach we will cover is a popular library called <strong class="bold">Redux</strong>. We will take the time to understand what Redux is and its concepts before refactoring the app to <span class="No-Break">use it.</span></p>
			<p>So, we’ll cover the <span class="No-Break">following topics:</span></p>
			<ul>
				<li>Creating <span class="No-Break">the project</span></li>
				<li>Using <span class="No-Break">prop drilling</span></li>
				<li>Using <span class="No-Break">React context</span></li>
				<li><span class="No-Break">Using Redux</span></li>
			</ul>
			<h1 id="_idParaDest-205"><a id="_idTextAnchor207"/>Technical requirements</h1>
			<p>We will use the following technologies in <span class="No-Break">this chapter:</span></p>
			<ul>
				<li><strong class="bold">Node.js</strong> and <strong class="bold">npm</strong>: You can install them <span class="No-Break">from </span><a href="https://nodejs.org/en/download/"><span class="No-Break">https://nodejs.org/en/download/</span></a></li>
				<li><strong class="bold">Visual Studio Code</strong>: You can install it <span class="No-Break">from </span><a href="https://code.visualstudio.com/"><span class="No-Break">https://code.visualstudio.com/</span></a></li>
			</ul>
			<p>All the code snippets in this chapter can be found online <span class="No-Break">at </span><a href="https://github.com/PacktPublishing/Learn-React-with-TypeScript-2nd-Edition/tree/main/Chapter8"><span class="No-Break">https://github.com/PacktPublishing/Learn-React-with-TypeScript-2nd-Edition/tree/main/Chapter8</span></a><span class="No-Break">.</span></p>
			<h1 id="_idParaDest-206"><a id="_idTextAnchor208"/>Creating the project</h1>
			<p>We will develop our form using Visual Studio Code and a new Create React App-based project setup. We’ve previously covered this several times, so we will not cover the steps in this chapter – instead, see <a href="B19051_03.xhtml#_idTextAnchor072"><span class="No-Break"><em class="italic">Chapter 3</em></span></a>, <em class="italic">Setting Up React </em><span class="No-Break"><em class="italic">and TypeScript</em></span><span class="No-Break">.</span></p>
			<p>We will style the form with <a id="_idIndexMarker609"/>Tailwind CSS. We also previously covered how to install and configure Tailwind in Create React App in <a href="B19051_05.xhtml#_idTextAnchor127"><span class="No-Break"><em class="italic">Chapter 5</em></span></a>, <em class="italic">Approaches to Styling Frontends</em>. So, after you have created the React and TypeScript project, install and <span class="No-Break">configure Tailwind.</span></p>
			<p>We will also use the <strong class="source-inline">@tailwindcss/forms</strong> plugin to style the form. So, install this plugin as well – see <a href="B19051_07.xhtml#_idTextAnchor188"><span class="No-Break"><em class="italic">Chapter 7</em></span></a>, <em class="italic">Working with Forms</em>, for information on how to <span class="No-Break">do this.</span></p>
			<p>The app we will build will contain a header and some content beneath it. Here is the component structure we <span class="No-Break">will create:</span></p>
			<div>
				<div id="_idContainer124" class="IMG---Figure">
					<img src="image/B19051_08_01.jpg" alt="Figure 8.1 – App component structure"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.1 – App component structure</p>
			<p>The header will have a <strong class="bold">Sign in</strong> button to authenticate and authorize a user to get their name and permissions. Once authenticated, the <a id="_idIndexMarker610"/>user’s name will be displayed in the<a id="_idIndexMarker611"/> app header, and the user will be welcomed in the content. If the user has admin permissions, important content will <span class="No-Break">be shown.</span></p>
			<p>So, carry out the following steps to create the initial versions of the files that we need in the app without any statement management (some of the code snippets are lengthy – don’t forget you can copy them <span class="No-Break">from </span><a href="https://github.com/PacktPublishing/Learn-React-with-TypeScript-2nd-Edition/tree/main/Chapter8/prop-drilling"><span class="No-Break">https://github.com/PacktPublishing/Learn-React-with-TypeScript-2nd-Edition/tree/main/Chapter8/prop-drilling</span></a><span class="No-Break">):</span></p>
			<ol>
				<li>We will start by creating a file containing a function to authenticate a user. Create a folder called <strong class="source-inline">api</strong> in the <strong class="source-inline">src</strong> folder. Then, create a file called <strong class="source-inline">authenticate.ts</strong> in the <strong class="source-inline">api</strong> folder with the <span class="No-Break">following content:</span><pre class="source-code">
export type User = {</pre><pre class="source-code">
  id: string;</pre><pre class="source-code">
  name: string;</pre><pre class="source-code">
};</pre><pre class="source-code">
export function authenticate(): Promise&lt;User | undefined&gt; {</pre><pre class="source-code">
  return new Promise((resolve) =&gt;</pre><pre class="source-code">
    setTimeout(() =&gt; resolve({ id: "1", name: "Bob" }),       1000)</pre><pre class="source-code">
  );</pre><pre class="source-code">
}</pre></li>
			</ol>
			<p>The function simulates successful authentication for a user <span class="No-Break">called Bob.</span></p>
			<ol>
				<li value="2">Next, we will create<a id="_idIndexMarker612"/> a file containing a function to authorize a user. So, create a file called <strong class="source-inline">authorize.ts</strong> in the <strong class="source-inline">api</strong> folder with the <span class="No-Break">following content:</span><pre class="source-code">
export function authorize(id: string): Promise&lt;string[]&gt; {</pre><pre class="source-code">
  return new Promise((resolve) =&gt;</pre><pre class="source-code">
    setTimeout(() =&gt; resolve(["admin"]), 1000)</pre><pre class="source-code">
  );</pre><pre class="source-code">
}</pre></li>
			</ol>
			<p>The function simulates a user being authorized to have <span class="No-Break">admin permissions.</span></p>
			<ol>
				<li value="3">Next, we will create a component for the app header. Create a file called <strong class="source-inline">Header.tsx</strong> in the <strong class="source-inline">src</strong> folder with the <span class="No-Break">following content:</span><pre class="source-code">
import { User } from './api/authenticate';</pre><pre class="source-code">
type Props = {</pre><pre class="source-code">
  user: undefined | User;</pre><pre class="source-code">
  onSignInClick: () =&gt; void;</pre><pre class="source-code">
  loading: boolean;</pre><pre class="source-code">
};</pre></li>
			</ol>
			<p>The component has a prop for the user, which will be <strong class="source-inline">undefined</strong> if the user isn’t authenticated yet. The component also has a prop called <strong class="source-inline">onSignInClick</strong> for a <strong class="bold">Sign in</strong> button click handler. The last component prop is called <strong class="source-inline">loading</strong> and it determines whether the app is in a loading state when the user is authenticated <span class="No-Break">or authorized.</span></p>
			<ol>
				<li value="4">Add the following<a id="_idIndexMarker613"/> component implementation <span class="No-Break">into </span><span class="No-Break"><strong class="source-inline">Header.tsx</strong></span><span class="No-Break">:</span><pre class="source-code">
export function Header({</pre><pre class="source-code">
  user,</pre><pre class="source-code">
  onSignInClick,</pre><pre class="source-code">
  loading,</pre><pre class="source-code">
}: Props) {</pre><pre class="source-code">
  return (</pre><pre class="source-code">
    &lt;header className="flex justify-between items-center       border-b-2 border-gray-100 py-6"&gt;</pre><pre class="source-code">
      {user ? (</pre><pre class="source-code">
        &lt;span className="ml-auto font-bold"&gt;</pre><pre class="source-code">
          {user.name} has signed in</pre><pre class="source-code">
        &lt;/span&gt;</pre><pre class="source-code">
      ) : (</pre><pre class="source-code">
        &lt;button</pre><pre class="source-code">
          onClick={onSignInClick}</pre><pre class="source-code">
          className="whitespace-nowrap inline-flex items-            center justify-center ml-auto px-4 py-2 w-36             border border-transparent rounded-md             shadow-sm text-base font-medium text-white             bg-indigo-600 hover:bg-indigo-700"</pre><pre class="source-code">
          disabled={loading}</pre><pre class="source-code">
        &gt;</pre><pre class="source-code">
          {loading ? '...' : 'Sign in'}</pre><pre class="source-code">
        &lt;/button&gt;</pre><pre class="source-code">
      )}</pre><pre class="source-code">
    &lt;/header&gt;</pre><pre class="source-code">
  );</pre><pre class="source-code">
}</pre></li>
			</ol>
			<p>The component<a id="_idIndexMarker614"/> informs the user that they have signed in if they have been authenticated. If the user is unauthenticated, the component displays a <strong class="bold">Sign </strong><span class="No-Break"><strong class="bold">in</strong></span><span class="No-Break"> button.</span></p>
			<ol>
				<li value="5">Next, we will implement a component for the main app content. Create a file called <strong class="source-inline">Main.tsx</strong> in the <strong class="source-inline">src</strong> folder with the <span class="No-Break">following content:</span><pre class="source-code">
import { User } from './api/authenticate';</pre><pre class="source-code">
import { Content } from './Content';</pre><pre class="source-code">
type Props = {</pre><pre class="source-code">
  user: undefined | User;</pre><pre class="source-code">
  permissions: undefined | string[];</pre><pre class="source-code">
};</pre></li>
			</ol>
			<p>The component has a prop for the user and their permissions. We have imported a component called <strong class="source-inline">Content</strong>, which we will create in <span class="No-Break"><em class="italic">step 7</em></span><span class="No-Break">.</span></p>
			<ol>
				<li value="6">Now, add the following component implementation <span class="No-Break">in </span><span class="No-Break"><strong class="source-inline">Main.tsx</strong></span><span class="No-Break">:</span><pre class="source-code">
export function Main({ user, permissions }: Props) {</pre><pre class="source-code">
  return (</pre><pre class="source-code">
    &lt;main className="py-8"&gt;</pre><pre class="source-code">
      &lt;h1 className="text-3xl text-center font-bold         underline"&gt;Welcome&lt;/h1&gt;</pre><pre class="source-code">
      &lt;p className="mt-8 text-xl text-center"&gt;</pre><pre class="source-code">
        {user ? `Hello ${user.name}!` : "Please sign in"}</pre><pre class="source-code">
      &lt;/p&gt;</pre><pre class="source-code">
      &lt;Content permissions={permissions} /&gt;</pre><pre class="source-code">
    &lt;/main&gt;</pre><pre class="source-code">
  );</pre><pre class="source-code">
}</pre></li>
			</ol>
			<p>The component instructs the <a id="_idIndexMarker615"/>user to sign in if they are unauthenticated or shows a <strong class="bold">Hello</strong> message if they are authenticated. The content also references a <strong class="source-inline">Content</strong> component passing it the <span class="No-Break">user’s permissions.</span></p>
			<ol>
				<li value="7">The last file to create in the <strong class="source-inline">src</strong> folder is called <strong class="source-inline">Content.tsx</strong>. Add the following content to <span class="No-Break">the file:</span><pre class="source-code">
type Props = {</pre><pre class="source-code">
  permissions: undefined | string[];</pre><pre class="source-code">
};</pre><pre class="source-code">
export function Content({ permissions }: Props) {</pre><pre class="source-code">
  if (permissions === undefined) {</pre><pre class="source-code">
    return null;</pre><pre class="source-code">
  }</pre><pre class="source-code">
  return permissions.includes('admin') ? (</pre><pre class="source-code">
    &lt;p className="mt-4 text-l text-center"&gt;</pre><pre class="source-code">
      Some important stuff that only an admin can do</pre><pre class="source-code">
    &lt;/p&gt;</pre><pre class="source-code">
  ) : (</pre><pre class="source-code">
    &lt;p className="mt-4 text-l text-center"&gt;</pre><pre class="source-code">
      Insufficient permissions</pre><pre class="source-code">
    &lt;/p&gt;</pre><pre class="source-code">
  );</pre><pre class="source-code">
}</pre></li>
			</ol>
			<p>If the user is unauthorized, the component displays nothing. If the user has admin permissions, it displays some important stuff. Otherwise, it informs the user that they <span class="No-Break">lack permissions.</span></p>
			<p>That completes the project <a id="_idIndexMarker616"/>setup. The app will compile and run but won’t show any of the components we created yet because we haven’t referenced them in the <strong class="source-inline">App</strong> component. We will do this next when we share the user and permission information across <span class="No-Break">several components.</span></p>
			<h1 id="_idParaDest-207"><a id="_idTextAnchor209"/>Using prop drilling</h1>
			<p>In this first state management approach, we will store the <strong class="source-inline">user</strong>, <strong class="source-inline">permissions</strong>, and <strong class="source-inline">loading</strong> state in the <strong class="source-inline">App</strong> component. The <strong class="source-inline">App</strong> component will then pass this state to the <strong class="source-inline">Header</strong> and <strong class="source-inline">Main</strong> components <span class="No-Break">using props.</span></p>
			<p>So, this approach uses React features that we are already aware of. The approach is referred to as <strong class="bold">prop drilling</strong> because the <a id="_idIndexMarker617"/>state is passed down the component tree <span class="No-Break">using props.</span></p>
			<p>Carry out the following steps to rework the <strong class="source-inline">App</strong> component to store the <strong class="source-inline">user</strong>, <strong class="source-inline">permissions</strong>, and <strong class="source-inline">loading</strong> state, and pass this state down to the <strong class="source-inline">Header</strong> and <span class="No-Break"><strong class="source-inline">Main</strong></span><span class="No-Break"> components:</span></p>
			<ol>
				<li value="1">Open <strong class="source-inline">App.tsx</strong> and start by removing all the existing code and adding the following <span class="No-Break">import</span><span class="No-Break"><a id="_idIndexMarker618"/></span><span class="No-Break"> statements:</span><pre class="source-code">
import { useReducer } from 'react';</pre><pre class="source-code">
import { Header } from './Header';</pre><pre class="source-code">
import { Main } from './Main';</pre><pre class="source-code">
import { authenticate, User } from './api/authenticate';</pre><pre class="source-code">
import { authorize } from './api/authorize';</pre></li>
			</ol>
			<p>We have imported <strong class="source-inline">useReducer</strong> from React to store the state. We have also imported the <strong class="source-inline">Header</strong> and <strong class="source-inline">Main</strong> components so that we can render them with the state values. Lastly, we’ve imported the <strong class="source-inline">authenticate</strong> and <strong class="source-inline">authorize</strong> functions because we will create the <strong class="bold">Sign in</strong> handler in <span class="No-Break">this component.</span></p>
			<ol>
				<li value="2">After the import statements, add a type for the state and create a variable for the initial <span class="No-Break">state values:</span><pre class="source-code">
type State = {</pre><pre class="source-code">
  user: undefined | User,</pre><pre class="source-code">
  permissions: undefined | string[],</pre><pre class="source-code">
  loading: boolean,</pre><pre class="source-code">
};</pre><pre class="source-code">
const initialState: State = {</pre><pre class="source-code">
  user: undefined,</pre><pre class="source-code">
  permissions: undefined,</pre><pre class="source-code">
  loading: false,</pre><pre class="source-code">
};</pre></li>
				<li>Next, create a type for the different actions that can update <span class="No-Break">the state:</span><pre class="source-code">
type Action =</pre><pre class="source-code">
  | {</pre><pre class="source-code">
      type: "authenticate",</pre><pre class="source-code">
    }</pre><pre class="source-code">
  | {</pre><pre class="source-code">
      type: "authenticated",</pre><pre class="source-code">
      user: User | undefined,</pre><pre class="source-code">
    }</pre><pre class="source-code">
  | {</pre><pre class="source-code">
      type: "authorize",</pre><pre class="source-code">
    }</pre><pre class="source-code">
  | {</pre><pre class="source-code">
      type: "authorized",</pre><pre class="source-code">
      permissions: string[],</pre><pre class="source-code">
    };</pre></li>
			</ol>
			<p>The <strong class="source-inline">"authenticate"</strong> action will start the authentication process, and <strong class="source-inline">"authenticated"</strong> happens when it has been completed. Likewise, the <strong class="source-inline">"authorize"</strong> action will <a id="_idIndexMarker619"/>start the authorization process, and <strong class="source-inline">"authorized"</strong> happens when it has <span class="No-Break">been completed.</span></p>
			<ol>
				<li value="4">Next, add a <strong class="source-inline">reducer</strong> function that updates <span class="No-Break">the state:</span><pre class="source-code">
function reducer(state: State, action: Action): State {</pre><pre class="source-code">
  switch (action.type) {</pre><pre class="source-code">
    case "authenticate":</pre><pre class="source-code">
      return { ...state, loading: true };</pre><pre class="source-code">
    case "authenticated":</pre><pre class="source-code">
      return { ...state, loading: false, user: action.        user };</pre><pre class="source-code">
    case "authorize":</pre><pre class="source-code">
      return { ...state, loading: true };</pre><pre class="source-code">
    case "authorized":</pre><pre class="source-code">
      return {</pre><pre class="source-code">
        ...state,</pre><pre class="source-code">
        loading: false,</pre><pre class="source-code">
        permissions: action.permissions,</pre><pre class="source-code">
      };</pre><pre class="source-code">
    default:</pre><pre class="source-code">
      return state;</pre><pre class="source-code">
  }</pre><pre class="source-code">
}</pre></li>
			</ol>
			<p>The function takes in the<a id="_idIndexMarker620"/> existing state and the action as parameters. The function uses a switch statement on the action type to create a new version of the state in <span class="No-Break">each branch.</span></p>
			<ol>
				<li value="5">Now, let’s define the <strong class="source-inline">App</strong> component <span class="No-Break">as follows:</span><pre class="source-code">
function App() {</pre><pre class="source-code">
  const [{ user, permissions, loading }, dispatch] =</pre><pre class="source-code">
    useReducer(reducer, initialState);</pre><pre class="source-code">
  return (</pre><pre class="source-code">
    &lt;div className="max-w-7xl mx-auto px-4"&gt;</pre><pre class="source-code">
      &lt;Header</pre><pre class="source-code">
        user={user}</pre><pre class="source-code">
        onSignInClick={handleSignInClick}</pre><pre class="source-code">
        loading={loading}</pre><pre class="source-code">
      /&gt;</pre><pre class="source-code">
      &lt;Main user={user} permissions={permissions} /&gt;</pre><pre class="source-code">
    &lt;/div&gt;</pre><pre class="source-code">
  );</pre><pre class="source-code">
}</pre><pre class="source-code">
export default App;</pre></li>
			</ol>
			<p>The component uses <strong class="source-inline">useReducer</strong> with the <strong class="source-inline">reducer</strong> function and the <strong class="source-inline">initialState</strong> variable <a id="_idIndexMarker621"/>we defined earlier. We have destructured the <strong class="source-inline">user</strong>, <strong class="source-inline">permissions</strong>, and <strong class="source-inline">loading</strong> state values from <strong class="source-inline">useReducer</strong>. In the JSX, we have rendered both the <strong class="source-inline">Header</strong> and <strong class="source-inline">Main</strong> components passing the appropriate state values <span class="No-Break">as props.</span></p>
			<ol>
				<li value="6">The <strong class="source-inline">Header</strong> element in the JSX references a handler called <strong class="source-inline">handleSignInClick</strong>, which needs implementation. Create this above the return statement <span class="No-Break">as follows:</span><pre class="source-code">
async function handleSignInClick() {</pre><pre class="source-code">
  dispatch({ type: "authenticate" });</pre><pre class="source-code">
  const authenticatedUser = await authenticate();</pre><pre class="source-code">
  dispatch({</pre><pre class="source-code">
    type: "authenticated",</pre><pre class="source-code">
    user: authenticatedUser,</pre><pre class="source-code">
  });</pre><pre class="source-code">
  if (authenticatedUser !== undefined) {</pre><pre class="source-code">
    dispatch({ type: "authorize" });</pre><pre class="source-code">
    const authorizedPermissions = await authorize(</pre><pre class="source-code">
      authenticatedUser.id</pre><pre class="source-code">
    );</pre><pre class="source-code">
    dispatch({</pre><pre class="source-code">
      type: "authorized",</pre><pre class="source-code">
      permissions: authorizedPermissions,</pre><pre class="source-code">
    });</pre><pre class="source-code">
  }</pre><pre class="source-code">
}</pre></li>
			</ol>
			<p>The sign-in handler authenticates and authorizes the user and dispatches the necessary actions along <span class="No-Break">the way.</span></p>
			<ol>
				<li value="7">Run the app in development<a id="_idIndexMarker622"/> mode by running <strong class="source-inline">npm start</strong> in the terminal. The app appears as shown in <span class="No-Break">the screenshot:</span></li>
			</ol>
			<div>
				<div id="_idContainer125" class="IMG---Figure">
					<img src="image/B19051_08_02.jpg" alt="Figure 8.2 – App before signing in"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.2 – App before signing in</p>
			<ol>
				<li value="8">Click the <strong class="bold">Sign in</strong> button. The authentication and authorization processes then happen, and after a couple of seconds, the following <span class="No-Break">screen appears:</span></li>
			</ol>
			<div>
				<div id="_idContainer126" class="IMG---Figure">
					<img src="image/B19051_08_03.jpg" alt="Figure 8.3 – App after signing in"/>
				</div>
			</div>
			<p class="IMG---Caption" lang="en-US" xml:lang="en-US">Figure 8.3 – App after signing in</p>
			<p>That completes the prop <span class="No-Break">drilling approach.</span></p>
			<p>A nice thing about this approach is that it is simple and uses React features we are already familiar with. A downside of this approach is that it forces all components between the component providing state and components accessing the state to have a prop for that state. So, some<a id="_idIndexMarker623"/> components that do not need access to the state are forced to access it. An example is the <strong class="source-inline">Main</strong> component – the <strong class="source-inline">permissions</strong> state is forced to pass through it to the <span class="No-Break"><strong class="source-inline">Content</strong></span><span class="No-Break"> component.</span></p>
			<p>The key point in this section is that it is fine to share state across a few adjacent components using props but isn’t ideal for sharing across lots of components far apart in the <span class="No-Break">component tree.</span></p>
			<p>Next, keep the app running, and we will look at a more appropriate solution for sharing state across <span class="No-Break">many components.</span></p>
			<h1 id="_idParaDest-208"><a id="_idTextAnchor210"/>Using React context</h1>
			<p>In this section, we will learn <a id="_idIndexMarker624"/>a feature in React called <strong class="bold">context</strong>. We will then refactor the app from the last section to use <span class="No-Break">React context.</span></p>
			<h2 id="_idParaDest-209"><a id="_idTextAnchor211"/>Understanding React context</h2>
			<p>React context is an object that can be accessed by components. This object can contain state values, so it provides a mechanism for sharing state <span class="No-Break">across components.</span></p>
			<p>A context is created using a <strong class="source-inline">createContext</strong> function <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
const SomeContext = createContext&lt;ContextType&gt;(defaultValue);</pre>
			<p>A default value for the<a id="_idIndexMarker625"/> context must be passed into <strong class="source-inline">createContext</strong>. It also has a generic type parameter for the type that represents the object created <span class="No-Break">by </span><span class="No-Break"><strong class="source-inline">createContext</strong></span><span class="No-Break">.</span></p>
			<p>The context also contains a <strong class="source-inline">Provider</strong> component that needs to be placed above components requiring access to the context object in the component tree. A provider wrapper component can be created that stores the shared state and passes it to the context <strong class="source-inline">Provider</strong> component <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
export function SomeProvider({ children }: Props) {
  const [someState, setSomeState] = useState(initialState);
  return (
    &lt;SomeContext.Provider value={{ someState }}&gt;
      {children}
    &lt;/SomeContext.Provider&gt;
  );
}</pre>
			<p><strong class="source-inline">useState</strong> has been used for the state in the preceding example, but <strong class="source-inline">useReducer</strong> could also <span class="No-Break">be used.</span></p>
			<p>The provider wrapper component can then be placed appropriately in the component tree, above components requiring the <span class="No-Break">shared state:</span></p>
			<pre class="source-code">
function App() {
  return (
    <strong class="bold">&lt;SomeProvider&gt;</strong>
      &lt;Header /&gt;
      &lt;Main /&gt;
<strong class="bold">    &lt;/SomeProvider&gt;</strong>
  );
}</pre>
			<p>React also contains a <strong class="source-inline">useContext</strong> hook that can be used so that the context values can be consumed as a hook, <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
const { someState } = useContext(SomeContext);</pre>
			<p>The context must be <a id="_idIndexMarker626"/>passed into <strong class="source-inline">useContext</strong> and properties from the context object can be destructured from <span class="No-Break">its result.</span></p>
			<p>So, components that want access to the shared state can access it using <strong class="source-inline">useContext</strong> <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
export function SomeComponent() {
  const { <strong class="bold">someState</strong> } = <strong class="bold">useContext(SomeContext)</strong>;
  return &lt;div&gt;I have access to {<strong class="bold">someState</strong>}&lt;/div&gt;;
}</pre>
			<p>For more information on React context, see the following <span class="No-Break">link: </span><a href="https://reactjs.org/docs/context.html"><span class="No-Break">https://reactjs.org/docs/context.html</span></a><span class="No-Break">.</span></p>
			<p>Now that we understand React context, we will use it in the app we created in the <span class="No-Break">previous section.</span></p>
			<h2 id="_idParaDest-210"><a id="_idTextAnchor212"/>Using React context</h2>
			<p>We will refactor the app from the last section to use React context. We will start by creating a file containing the context and the provider wrapper. Then, we will use <strong class="source-inline">useReducer</strong> in the provider wrapper to store the state. We will also create a wrapper for <strong class="source-inline">useContext</strong> to make consuming <span class="No-Break">it easy.</span></p>
			<p>So, to do this, carry out the <span class="No-Break">following steps:</span></p>
			<ol>
				<li value="1">Start by creating a file <a id="_idIndexMarker627"/>called <strong class="source-inline">AppContext.tsx</strong> in the <strong class="source-inline">src</strong> folder. This will contain the context, the provider wrapper, and the <span class="No-Break"><strong class="source-inline">useContext</strong></span><span class="No-Break"> wrapper.</span></li>
				<li>Add the following import statements <span class="No-Break">to </span><span class="No-Break"><strong class="source-inline">AppContext.tsx</strong></span><span class="No-Break">:</span><pre class="source-code">
import {</pre><pre class="source-code">
  createContext,</pre><pre class="source-code">
  useContext,</pre><pre class="source-code">
  useReducer,</pre><pre class="source-code">
  ReactNode,</pre><pre class="source-code">
} from 'react';</pre><pre class="source-code">
import { User } from './api/authenticate';</pre></li>
			</ol>
			<p>We have imported all the functions we need from React along with the <strong class="source-inline">ReactNode</strong> type that we will need for the provider wrapper <strong class="source-inline">children</strong> prop. We have also imported<a id="_idIndexMarker628"/> the <strong class="source-inline">User</strong> type, which we will need for the user <span class="No-Break">state type.</span></p>
			<ol>
				<li value="3">We need to add a type for the state and a variable for the initial state values. We already have these in <strong class="source-inline">App.tsx</strong>, so the following lines can be moved from <strong class="source-inline">App.tsx</strong> <span class="No-Break">to </span><span class="No-Break"><strong class="source-inline">AppContext.tsx</strong></span><span class="No-Break">:</span><pre class="source-code">
type State = {</pre><pre class="source-code">
  user: undefined | User,</pre><pre class="source-code">
  permissions: undefined | string[],</pre><pre class="source-code">
  loading: boolean,</pre><pre class="source-code">
};</pre><pre class="source-code">
const initialState = {</pre><pre class="source-code">
  user: undefined,</pre><pre class="source-code">
  permissions: undefined,</pre><pre class="source-code">
  loading: false,</pre><pre class="source-code">
};</pre></li>
				<li>Similarly, the <strong class="source-inline">Action</strong> type and the <strong class="source-inline">reducer</strong> function can be moved from <strong class="source-inline">App.tsx</strong> to <strong class="source-inline">AppContext.tsx</strong>. Here are the lines <span class="No-Break">to move:</span><pre class="source-code">
type Action =</pre><pre class="source-code">
  | {</pre><pre class="source-code">
      type: "authenticate",</pre><pre class="source-code">
    }</pre><pre class="source-code">
  | {</pre><pre class="source-code">
      type: "authenticated",</pre><pre class="source-code">
      user: User | undefined,</pre><pre class="source-code">
    }</pre><pre class="source-code">
  | {</pre><pre class="source-code">
      type: "authorize",</pre><pre class="source-code">
    }</pre><pre class="source-code">
  | {</pre><pre class="source-code">
      type: "authorized",</pre><pre class="source-code">
      permissions: string[],</pre><pre class="source-code">
    };</pre><pre class="source-code">
function reducer(state: State, action: Action): State {</pre><pre class="source-code">
  switch (action.type) {</pre><pre class="source-code">
    case "authenticate":</pre><pre class="source-code">
      return { ...state, loading: true };</pre><pre class="source-code">
    case "authenticated":</pre><pre class="source-code">
      return { ...state, loading: false, user: action.        user };</pre><pre class="source-code">
    case "authorize":</pre><pre class="source-code">
      return { ...state, loading: true };</pre><pre class="source-code">
    case "authorized":</pre><pre class="source-code">
      return { ...state, loading: false, permissions:         action.permissions };</pre><pre class="source-code">
    default:</pre><pre class="source-code">
      return state;</pre><pre class="source-code">
  }</pre><pre class="source-code">
}</pre></li>
			</ol>
			<p>Note that the <strong class="source-inline">App.tsx</strong> file will raise a compile error after moving this function. We will resolve this in the<a id="_idIndexMarker629"/> next set <span class="No-Break">of instructions.</span></p>
			<ol>
				<li value="5">Next, we will create a type for the context <span class="No-Break">in </span><span class="No-Break"><strong class="source-inline">AppContext.tsx</strong></span><span class="No-Break">:</span><pre class="source-code">
type AppContextType = State &amp; {</pre><pre class="source-code">
  dispatch: React.Dispatch&lt;Action&gt;,</pre><pre class="source-code">
};</pre></li>
			</ol>
			<p>The context will consist of the state values and a <strong class="source-inline">dispatch</strong> function to <span class="No-Break">dispatch actions.</span></p>
			<ol>
				<li value="6">Now we can create the context <span class="No-Break">as follows:</span><pre class="source-code">
const AppContext = createContext&lt;AppContextType&gt;({</pre><pre class="source-code">
  ...initialState,</pre><pre class="source-code">
  dispatch: () =&gt; {},</pre><pre class="source-code">
});</pre></li>
			</ol>
			<p>We have called the context <strong class="source-inline">AppContext</strong>. We use the <strong class="source-inline">initialState</strong> variable and a dummy <strong class="source-inline">dispatch</strong> function as the default <span class="No-Break">context value.</span></p>
			<ol>
				<li value="7">Next, we can implement the provider wrapper <span class="No-Break">as follows:</span><pre class="source-code">
type Props = {</pre><pre class="source-code">
  children: ReactNode;</pre><pre class="source-code">
};</pre><pre class="source-code">
export function AppProvider({ children }: Props) {</pre><pre class="source-code">
  const [{ user, permissions, loading }, dispatch] =</pre><pre class="source-code">
    useReducer(reducer, initialState);</pre><pre class="source-code">
  return (</pre><pre class="source-code">
    &lt;AppContext.Provider</pre><pre class="source-code">
      value={{</pre><pre class="source-code">
        user,</pre><pre class="source-code">
        permissions,</pre><pre class="source-code">
        loading,</pre><pre class="source-code">
        dispatch,</pre><pre class="source-code">
      }}</pre><pre class="source-code">
    &gt;</pre><pre class="source-code">
      {children}</pre><pre class="source-code">
    &lt;/AppContext.Provider&gt;</pre><pre class="source-code">
  );</pre><pre class="source-code">
}</pre></li>
			</ol>
			<p>We have called the component <strong class="source-inline">AppProvider</strong>, and it returns the context’s <strong class="source-inline">Provider</strong> component<a id="_idIndexMarker630"/> with the state values and the <strong class="source-inline">dispatch</strong> function <span class="No-Break">from </span><span class="No-Break"><strong class="source-inline">useReducer</strong></span><span class="No-Break">.</span></p>
			<ol>
				<li value="8">The last thing to do in <strong class="source-inline">AppContext.tsx</strong> is to create a wrapper for <strong class="source-inline">useContext</strong> <span class="No-Break">as follows:</span><pre class="source-code">
export const useAppContext = () =&gt; useContext(AppContext);</pre></li>
			</ol>
			<p>That completes the work we need to do <span class="No-Break">in </span><span class="No-Break"><strong class="source-inline">AppContext.tsx</strong></span><span class="No-Break">.</span></p>
			<p>So, <strong class="source-inline">AppContext.tsx</strong> exports an <strong class="source-inline">AppProvider</strong> component that can be placed above <strong class="source-inline">Header</strong> and <strong class="source-inline">Main</strong> in the component tree so that they can access the user and permissions information. <strong class="source-inline">AppContext.tsx</strong> also exports <strong class="source-inline">useAppContext</strong> so that the <strong class="source-inline">Header</strong>, <strong class="source-inline">Main</strong>, and <strong class="source-inline">Content</strong> components can use it to get access to the user and <span class="No-Break">permissions information.</span></p>
			<p>Now, carry out the following steps to make the necessary changes to the <strong class="source-inline">App</strong>, <strong class="source-inline">Header</strong>, <strong class="source-inline">Main</strong>, and <strong class="source-inline">Content</strong> components to<a id="_idIndexMarker631"/> access the user and permissions information <span class="No-Break">from </span><span class="No-Break"><strong class="source-inline">AppContext</strong></span><span class="No-Break">:</span></p>
			<ol>
				<li value="1">We will start with <strong class="source-inline">Header.tsx</strong>. Begin by importing the <strong class="source-inline">authenticate</strong>, <strong class="source-inline">authorize</strong>, and <strong class="source-inline">useAppContext</strong> functions. Also, remove the <strong class="source-inline">User</strong> type and the props for the <span class="No-Break"><strong class="source-inline">Header</strong></span><span class="No-Break"> component:</span><pre class="source-code">
<strong class="bold">import { authenticate } from './api/authenticate';</strong></pre><pre class="source-code">
<strong class="bold">import { authorize } from './api/authorize';</strong></pre><pre class="source-code">
<strong class="bold">import { useAppContext } from './AppContext';</strong></pre><pre class="source-code">
export function Header() {</pre><pre class="source-code">
  return ...</pre><pre class="source-code">
}</pre></li>
				<li><strong class="source-inline">Header</strong> will now handle the sign-in process instead of <strong class="source-inline">App</strong>. So, move the <strong class="source-inline">handleSignInClick</strong> handler from <strong class="source-inline">App</strong> in <strong class="source-inline">App.tsx</strong> to <strong class="source-inline">Header.tsx</strong> and place it above the return statement <span class="No-Break">as follows:</span><pre class="source-code">
export function Header() {</pre><pre class="source-code">
  <strong class="bold">async function handleSignInClick() {</strong></pre><pre class="source-code">
<strong class="bold">    dispatch({ type: 'authenticate' });</strong></pre><pre class="source-code">
<strong class="bold">    const authenticatedUser = await authenticate();</strong></pre><pre class="source-code">
<strong class="bold">    dispatch({</strong></pre><pre class="source-code">
<strong class="bold">      type: 'authenticated',</strong></pre><pre class="source-code">
<strong class="bold">      user: authenticatedUser,</strong></pre><pre class="source-code">
<strong class="bold">    });</strong></pre><pre class="source-code">
<strong class="bold">    if (authenticatedUser !== undefined) {</strong></pre><pre class="source-code">
<strong class="bold">      dispatch({ type: 'authorize' });</strong></pre><pre class="source-code">
<strong class="bold">      const authorizedPermissions = await authorize(</strong></pre><pre class="source-code">
<strong class="bold">        authenticatedUser.id</strong></pre><pre class="source-code">
<strong class="bold">      );</strong></pre><pre class="source-code">
<strong class="bold">      dispatch({</strong></pre><pre class="source-code">
<strong class="bold">        type: 'authorized',</strong></pre><pre class="source-code">
<strong class="bold">        permissions: authorizedPermissions,</strong></pre><pre class="source-code">
<strong class="bold">      });</strong></pre><pre class="source-code">
<strong class="bold">    }</strong></pre><pre class="source-code">
<strong class="bold">  }</strong></pre><pre class="source-code">
  return ...</pre><pre class="source-code">
}</pre></li>
				<li>Update <a id="_idIndexMarker632"/>the sign-in click handler to reference the function we <span class="No-Break">just added:</span><pre class="source-code">
&lt;button</pre><pre class="source-code">
  onClick={<strong class="bold">handleSignInClick</strong>}</pre><pre class="source-code">
  className=...</pre><pre class="source-code">
  disabled={loading}</pre><pre class="source-code">
&gt;</pre><pre class="source-code">
  {loading ? '...' : 'Sign in'}</pre><pre class="source-code">
&lt;/button&gt;</pre></li>
				<li>The last thing to do in <strong class="source-inline">Header.tsx</strong> is to get <strong class="source-inline">user</strong>, <strong class="source-inline">loading</strong>, and <strong class="source-inline">dispatch</strong> from the<a id="_idIndexMarker633"/> context. Add the following call to <strong class="source-inline">useAppContext</strong> at the top of <span class="No-Break">the component:</span><pre class="source-code">
export function Header() {</pre><pre class="source-code">
  <strong class="bold">const { user, loading, dispatch } = useAppContext();</strong></pre><pre class="source-code">
  ...</pre><pre class="source-code">
}</pre></li>
				<li>Let’s move on to <strong class="source-inline">Main.tsx</strong>. Remove the import statement for the <strong class="source-inline">User</strong> type and add an import statement <span class="No-Break">for </span><span class="No-Break"><strong class="source-inline">useAppContext</strong></span><span class="No-Break">:</span><pre class="source-code">
import { Content } from './Content';</pre><pre class="source-code">
<strong class="bold">import { useAppContext } from './AppContext';</strong></pre></li>
				<li>Remove the props for the <strong class="source-inline">Main</strong> component and get <strong class="source-inline">user</strong> <span class="No-Break">from </span><span class="No-Break"><strong class="source-inline">useAppContext</strong></span><span class="No-Break">:</span><pre class="source-code">
export function Main() {</pre><pre class="source-code">
<strong class="bold">  const { user } = useAppContext();</strong></pre><pre class="source-code">
  return ...</pre><pre class="source-code">
}</pre></li>
				<li>In the JSX in <strong class="source-inline">Main</strong>, remove the <strong class="source-inline">permissions</strong> attribute on the <span class="No-Break"><strong class="source-inline">Content</strong></span><span class="No-Break"> element:</span><pre class="source-code">
&lt;Content /&gt;</pre></li>
				<li>Now, open <strong class="source-inline">Content.tsx</strong> and add an import statement <span class="No-Break">for </span><span class="No-Break"><strong class="source-inline">useAppContext</strong></span><span class="No-Break">:</span><pre class="source-code">
import { useAppContext } from './AppContext';</pre></li>
				<li>Remove the props for the <strong class="source-inline">Content</strong> component and get <strong class="source-inline">permissions</strong> <span class="No-Break">from </span><span class="No-Break"><strong class="source-inline">useAppContext</strong></span><span class="No-Break">:</span><pre class="source-code">
export function Content() {</pre><pre class="source-code">
<strong class="bold">  const { permissions } = useAppContext();</strong></pre><pre class="source-code">
  if (permissions === undefined) {</pre><pre class="source-code">
    return null;</pre><pre class="source-code">
  }</pre><pre class="source-code">
  return ...</pre><pre class="source-code">
}</pre></li>
				<li>Lastly, we will <a id="_idIndexMarker634"/>modify <strong class="source-inline">App.tsx</strong>. Remove the import statements except for <strong class="source-inline">Header</strong> and <strong class="source-inline">Main</strong>, and add an import statement <span class="No-Break">for </span><span class="No-Break"><strong class="source-inline">AppProvider</strong></span><span class="No-Break">:</span><pre class="source-code">
import { Header } from './Header';</pre><pre class="source-code">
import { Main } from './Main';</pre><pre class="source-code">
<strong class="bold">import { AppProvider } from './AppContext';</strong></pre></li>
				<li>Still in <strong class="source-inline">App.tsx</strong>, remove the call to <strong class="source-inline">useReducer</strong> and remove all the attributes passed to <strong class="source-inline">Header</strong> <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">Main</strong></span><span class="No-Break">:</span><pre class="source-code">
function App() {</pre><pre class="source-code">
  return (</pre><pre class="source-code">
    &lt;div className="max-w-7xl mx-auto px-4"&gt;</pre><pre class="source-code">
      &lt;Header /&gt;</pre><pre class="source-code">
      &lt;Main /&gt;</pre><pre class="source-code">
    &lt;/div&gt;</pre><pre class="source-code">
  );</pre><pre class="source-code">
}</pre></li>
				<li>Wrap <strong class="source-inline">AppProvider</strong> around <strong class="source-inline">Header</strong> and <strong class="source-inline">Main</strong> so that they can access <span class="No-Break">the context:</span><pre class="source-code">
function App() {</pre><pre class="source-code">
  return (</pre><pre class="source-code">
    &lt;div className="max-w-7xl mx-auto px-4"&gt;</pre><pre class="source-code">
<strong class="bold">      &lt;AppProvider&gt;</strong></pre><pre class="source-code">
        &lt;Header /&gt;</pre><pre class="source-code">
        &lt;Main /&gt;</pre><pre class="source-code">
      <strong class="bold">&lt;/AppProvider&gt;</strong></pre><pre class="source-code">
    &lt;/div&gt;</pre><pre class="source-code">
  );</pre><pre class="source-code">
}</pre></li>
			</ol>
			<p>The compile errors will <a id="_idIndexMarker635"/>now be resolved and the running app will look and behave <span class="No-Break">like before.</span></p>
			<ol>
				<li value="13">Stop the app running by pressing <em class="italic">Ctrl</em> + <span class="No-Break"><em class="italic">C</em></span><span class="No-Break">.</span></li>
			</ol>
			<p>That completes the refactoring of the app to use React context instead of <span class="No-Break">prop drilling.</span></p>
			<p>In comparison to prop drilling, React context requires more code to be written. However, it allows components to access shared state using a hook rather than passing it through components using props. It’s an elegant, shared-state solution, particularly when many components <span class="No-Break">share state.</span></p>
			<p>Next, we will learn about a popular third-party library that can be used to <span class="No-Break">share state.</span></p>
			<h1 id="_idParaDest-211"><a id="_idTextAnchor213"/>Using Redux</h1>
			<p>In this section, we will learn <a id="_idIndexMarker636"/>about Redux before using it to refactor the app we have been working on to <span class="No-Break">use it.</span></p>
			<h2 id="_idParaDest-212"><a id="_idTextAnchor214"/>Understanding Redux</h2>
			<p><strong class="bold">Redux</strong> is a mature state<a id="_idIndexMarker637"/> management library that was first released in 2015. It was released before React context and became a popular approach for shared <span class="No-Break">state management.</span></p>
			<h3>Creating a store</h3>
			<p>In Redux, the state lives<a id="_idIndexMarker638"/> in a centralized immutable object referred to as a <strong class="bold">store</strong>. There is only a single store for the whole app. Like <strong class="source-inline">useReducer</strong>, the state in a<a id="_idIndexMarker639"/> store is updated by dispatching an <strong class="bold">action</strong>, which is an object containing the type of change and any data required to make the change. An action is handled by a <strong class="source-inline">reducer</strong> function, which creates a new version of <span class="No-Break">the state.</span></p>
			<p>In the past, a lot of code was needed to set up a Redux store and consume it in a React component. Today, a companion library called <a id="_idIndexMarker640"/>Redux Toolkit reduces the code required to use Redux. A Redux store can be created using the Redux Toolkit’s <strong class="source-inline">configureStore</strong> function <span class="No-Break">as follows:</span></p>
			<pre class="source-code">
export const store = configureStore({
  reducer: {
    someFeature: someFeatureReducer,
    anotherFeature: anotherFeatureReducer
  },
});</pre>
			<p>The <strong class="source-inline">configureStore</strong> function takes in the store’s reducers. Each feature in the app can have its own area of state and reducer to change the state. The different areas of state are often referred to as <strong class="bold">slices</strong>. In the preceding example, there are two slices called <strong class="source-inline">someFeature</strong> <span class="No-Break">and </span><span class="No-Break"><strong class="source-inline">anotherFeature</strong></span><span class="No-Break">.</span></p>
			<p>The Redux Toolkit has a function to<a id="_idIndexMarker641"/> create slices, <span class="No-Break">called </span><span class="No-Break"><strong class="source-inline">createSlice</strong></span><span class="No-Break">:</span></p>
			<pre class="source-code">
export const someSlice = createSlice({
  name: "someFeature",
  initialState,
  reducers: {
    someAction: (state) =&gt; {
      state.someValue = "something";
    },
    anotherAction: (state) =&gt; {
      state.someOtherValue = "something else";
    },
  },
});</pre>
			<p>The <strong class="source-inline">createSlice</strong> function<a id="_idIndexMarker642"/> takes in an object parameter containing the slice name, the initial state, and functions to handle the different actions and update <span class="No-Break">the state.</span></p>
			<p>The slice created from <strong class="source-inline">createSlice</strong> contains a <strong class="source-inline">reducer</strong> function that wraps the action handlers. This <strong class="source-inline">reducer</strong> function can be referenced in the <strong class="source-inline">reducer</strong> property of <strong class="source-inline">configureStore</strong> when the store <span class="No-Break">is created:</span></p>
			<pre class="source-code">
export const store = configureStore({
  reducer: {
    someFeature: <strong class="bold">someSlice.reducer,</strong>
    ...
  },
});</pre>
			<p>In the preceding code snippet, the reducer from <strong class="source-inline">someSlice</strong> has been added to <span class="No-Break">the store.</span></p>
			<h3>Providing the store to React components</h3>
			<p>The Redux store is <a id="_idIndexMarker643"/>defined in the component tree using its <strong class="source-inline">Provider</strong> component. The value of the Redux store (from <strong class="source-inline">configureStore</strong>) needs to be specified on the <strong class="source-inline">Provider</strong> component. The <strong class="source-inline">Provider</strong> component must be placed above the components requiring access to <span class="No-Break">the store:</span></p>
			<pre class="source-code">
<strong class="bold">&lt;Provider store={store}&gt;</strong>
  &lt;SomeComponent /&gt;
  &lt;AnotherComponent /&gt;
<strong class="bold">&lt;/Provider&gt;</strong></pre>
			<p>In the preceding <a id="_idIndexMarker644"/>example, <strong class="source-inline">SomeComponent</strong> and <strong class="source-inline">AnotherComponent</strong> have access to <span class="No-Break">the store.</span></p>
			<h3>Accessing the store from a component</h3>
			<p>Components can access<a id="_idIndexMarker645"/> state from the Redux store using a <strong class="source-inline">useSelector</strong> hook from React Redux. A function that selects the relevant state in the store is passed <span class="No-Break">into </span><span class="No-Break"><strong class="source-inline">useSelector</strong></span><span class="No-Break">:</span></p>
			<pre class="source-code">
const someValue = useSelector(
  (state: RootState) =&gt; state.someFeature.someValue
);</pre>
			<p>In the preceding example, <strong class="source-inline">someValue</strong> is selected from the <strong class="source-inline">someFeature</strong> slice in <span class="No-Break">the store.</span></p>
			<h3>Dispatching actions to the store from a component</h3>
			<p>React Redux also<a id="_idIndexMarker646"/> has a <strong class="source-inline">useDispatch</strong> hook that returns a <strong class="source-inline">dispatch</strong> function that can be used to dispatch actions. The action is a function from the slice created <span class="No-Break">using </span><span class="No-Break"><strong class="source-inline">createSlice</strong></span><span class="No-Break">:</span></p>
			<pre class="source-code">
<strong class="bold">const dispatch = useDispatch();</strong>
return (
  &lt;button onClick={() =&gt; <strong class="bold">dispatch(someSlice.actions.someAction())</strong>}&gt;
    Some button
  &lt;/button&gt;
);</pre>
			<p>In the preceding example, <strong class="source-inline">someAction</strong> in <strong class="source-inline">someSlice</strong> is dispatched when the button <span class="No-Break">is clicked.</span></p>
			<p>For more information on Redux, see the following link: <a href="https://redux.js.org/">https://redux.js.org/</a>. And for more information on the<a id="_idIndexMarker647"/> Redux Toolkit, see the following <span class="No-Break">link: </span><a href="https://redux-toolkit.js.org/"><span class="No-Break">https://redux-toolkit.js.org/</span></a><span class="No-Break">.</span></p>
			<p>Now that we understand Redux, we will use it in the app we created in the <span class="No-Break">previous section.</span></p>
			<h2 id="_idParaDest-213"><a id="_idTextAnchor215"/>Installing Redux</h2>
			<p>First, we must install <a id="_idIndexMarker648"/>Redux and the Redux Toolkit into our project. Run the following command in <span class="No-Break">the terminal:</span></p>
			<pre class="source-code">
npm i @reduxjs/toolkit react-redux</pre>
			<p>This will install all the Redux bits we need, including its <span class="No-Break">TypeScript types.</span></p>
			<h2 id="_idParaDest-214"><a id="_idTextAnchor216"/>Using Redux</h2>
			<p>Now, we can refactor <a id="_idIndexMarker649"/>the app to use Redux instead of React context. First, we will create a Redux slice for the user information before creating a Redux store with this slice. We will then move on to add the store to the React component tree and consume it in the <strong class="source-inline">Header</strong>, <strong class="source-inline">Main</strong>, and <span class="No-Break"><strong class="source-inline">Content</strong></span><span class="No-Break"> components.</span></p>
			<h3>Creating a Redux Slice</h3>
			<p>We will start by creating a<a id="_idIndexMarker650"/> Redux slice for the state for a user. Carry out the <span class="No-Break">following steps:</span></p>
			<ol>
				<li value="1">Create a folder called <strong class="source-inline">store</strong> in the <strong class="source-inline">src</strong> folder and then a file called <strong class="source-inline">userSlice.ts</strong> <span class="No-Break">within it.</span></li>
				<li>Add the following import statements <span class="No-Break">to </span><span class="No-Break"><strong class="source-inline">userSlice.ts</strong></span><span class="No-Break">:</span><pre class="source-code">
import { createSlice } from '@reduxjs/toolkit';</pre><pre class="source-code">
import type { PayloadAction } from '@reduxjs/toolkit';</pre><pre class="source-code">
import { User } from '../api/authenticate';</pre></li>
			</ol>
			<p>We will eventually use <strong class="source-inline">createSlice</strong> to create the Redux slice. <strong class="source-inline">PayloadAction</strong> is a type that we can use for action objects. We will need the <strong class="source-inline">User</strong> type when defining the type for <span class="No-Break">the state.</span></p>
			<ol>
				<li value="3">Copy the following <strong class="source-inline">State</strong> type and initial state value from <strong class="source-inline">AppContext.tsx</strong> <span class="No-Break">into </span><span class="No-Break"><strong class="source-inline">userSlice.ts</strong></span><span class="No-Break">:</span><pre class="source-code">
type State = {</pre><pre class="source-code">
  user: undefined | User;</pre><pre class="source-code">
  permissions: undefined | string[];</pre><pre class="source-code">
  loading: boolean;</pre><pre class="source-code">
};</pre><pre class="source-code">
const initialState: State = {</pre><pre class="source-code">
  user: undefined,</pre><pre class="source-code">
  permissions: undefined,</pre><pre class="source-code">
  loading: false,</pre><pre class="source-code">
};</pre></li>
				<li>Next, start to create<a id="_idIndexMarker651"/> the slice in <strong class="source-inline">userSlice.ts</strong>, <span class="No-Break">as follows:</span><pre class="source-code">
export const userSlice = createSlice({</pre><pre class="source-code">
  name: 'user',</pre><pre class="source-code">
  initialState,</pre><pre class="source-code">
  reducers: {</pre><pre class="source-code">
  }</pre><pre class="source-code">
});</pre></li>
			</ol>
			<p>We have named the slice <strong class="source-inline">user</strong> and passed in the initial state value. We export the slice so that we can use it later to create the <span class="No-Break">Redux store.</span></p>
			<ol>
				<li value="5">Now, define the <a id="_idIndexMarker652"/>following action handlers inside the <span class="No-Break"><strong class="source-inline">reducers</strong></span><span class="No-Break"> object:</span><pre class="source-code">
reducers: {</pre><pre class="source-code">
<strong class="bold">  authenticateAction: (state) =&gt; {</strong></pre><pre class="source-code">
<strong class="bold">    state.loading = true;</strong></pre><pre class="source-code">
<strong class="bold">  },</strong></pre><pre class="source-code">
<strong class="bold">  authenticatedAction: (</strong></pre><pre class="source-code">
<strong class="bold">    state,</strong></pre><pre class="source-code">
<strong class="bold">    action: PayloadAction&lt;User | undefined&gt;</strong></pre><pre class="source-code">
<strong class="bold">  ) =&gt; {</strong></pre><pre class="source-code">
<strong class="bold">    state.user = action.payload;</strong></pre><pre class="source-code">
<strong class="bold">    state.loading = false;</strong></pre><pre class="source-code">
<strong class="bold">  },</strong></pre><pre class="source-code">
<strong class="bold">  authorizeAction: (state) =&gt; {</strong></pre><pre class="source-code">
<strong class="bold">    state.loading = true;</strong></pre><pre class="source-code">
<strong class="bold">  },</strong></pre><pre class="source-code">
<strong class="bold">  authorizedAction: (</strong></pre><pre class="source-code">
<strong class="bold">    state,</strong></pre><pre class="source-code">
<strong class="bold">    action: PayloadAction&lt;string[]&gt;</strong></pre><pre class="source-code">
<strong class="bold">  ) =&gt; {</strong></pre><pre class="source-code">
<strong class="bold">    state.permissions = action.payload;</strong></pre><pre class="source-code">
<strong class="bold">    state.loading = false;</strong></pre><pre class="source-code">
<strong class="bold">  }</strong></pre><pre class="source-code">
}</pre></li>
			</ol>
			<p>Each action handler updates the required state. <strong class="source-inline">PayloadAction</strong> is used for the type of the action parameters. <strong class="source-inline">PayloadAction</strong> is a generic type with a parameter for the type of the <span class="No-Break">action payload.</span></p>
			<ol>
				<li value="6">Lastly, export the <a id="_idIndexMarker653"/>action handlers and the <strong class="source-inline">reducer</strong> function from <span class="No-Break">the slice:</span><pre class="source-code">
export const {</pre><pre class="source-code">
  authenticateAction,</pre><pre class="source-code">
  authenticatedAction,</pre><pre class="source-code">
  authorizeAction,</pre><pre class="source-code">
  authorizedAction,</pre><pre class="source-code">
} = userSlice.actions;</pre><pre class="source-code">
export default userSlice.reducer;</pre></li>
			</ol>
			<p>A default export has been used for the <strong class="source-inline">reducer</strong> function so the consumer can name it <span class="No-Break">as required.</span></p>
			<p>That completes the implementation of the <span class="No-Break">Redux slice.</span></p>
			<h3>Creating the Redux store</h3>
			<p>Next, let’s create the <a id="_idIndexMarker654"/>Redux store. Carry out the <span class="No-Break">following steps:</span></p>
			<ol>
				<li value="1">Create a file called <strong class="source-inline">store.ts</strong> in the <strong class="source-inline">store</strong> folder containing the following <span class="No-Break">import statements:</span><pre class="source-code">
import { configureStore } from '@reduxjs/toolkit';</pre><pre class="source-code">
import userReducer from './userSlice';</pre></li>
				<li>Next, use the <strong class="source-inline">configureStore</strong> function to create the store referencing the reducer from the slice we <span class="No-Break">created earlier:</span><pre class="source-code">
export const store = configureStore({</pre><pre class="source-code">
  reducer: { user: userReducer }</pre><pre class="source-code">
});</pre></li>
			</ol>
			<p>We export the <strong class="source-inline">store</strong> variable so that we can later use it on React Redux’s <span class="No-Break"><strong class="source-inline">Provider</strong></span><span class="No-Break"> component.</span></p>
			<ol>
				<li value="3">The last thing to do in <strong class="source-inline">store.ts</strong> is export the type for Redux’s full state object, which we <a id="_idIndexMarker655"/>will eventually require in the <strong class="source-inline">useSelector</strong> hook in components consuming the <span class="No-Break">Redux store:</span><pre class="source-code">
export type RootState = ReturnType&lt;typeof store.getState&gt;;</pre></li>
			</ol>
			<p><strong class="source-inline">ReturnType</strong> is a standard TypeScript utility type that returns the return type of the function type passed into it. The <strong class="source-inline">getState</strong> function in the Redux store returns the full state object. So, we use <strong class="source-inline">ReturnType</strong> to infer the type of the full state object rather than explicitly <span class="No-Break">defining it.</span></p>
			<p>That completes the implementation of the <span class="No-Break">Redux store.</span></p>
			<h3>Adding the Redux store to the component tree</h3>
			<p>Next, we will add the store at an appropriate place in the component tree using the <strong class="source-inline">Provider</strong> component <a id="_idIndexMarker656"/>from React Redux. Follow <span class="No-Break">these steps:</span></p>
			<ol>
				<li value="1">Open <strong class="source-inline">App.tsx</strong> and remove the <strong class="source-inline">AppContext</strong> import statement. Remove the <strong class="source-inline">AppContext.tsx</strong> file as well because this is no <span class="No-Break">longer required.</span></li>
				<li>Add an import statement for the <strong class="source-inline">Provider</strong> component from React Redux and the Redux store <span class="No-Break">we created:</span><pre class="source-code">
import { Provider } from 'react-redux';</pre><pre class="source-code">
import { store } from './store/store';</pre></li>
				<li>Replace <strong class="source-inline">AppProvider</strong> with <strong class="source-inline">Provider</strong> in the JSX, <span class="No-Break">as follows:</span><pre class="source-code">
&lt;div className="max-w-7xl mx-auto px-4"&gt;</pre><pre class="source-code">
  &lt;<strong class="bold">Provider store={store}</strong>&gt;</pre><pre class="source-code">
    &lt;Header /&gt;</pre><pre class="source-code">
    &lt;Main /&gt;</pre><pre class="source-code">
  &lt;/<strong class="bold">Provider</strong>&gt;</pre><pre class="source-code">
&lt;/div&gt;</pre></li>
			</ol>
			<p>We pass the imported Redux store <span class="No-Break">into </span><span class="No-Break"><strong class="source-inline">Provider</strong></span><span class="No-Break">.</span></p>
			<p>The Redux store is <a id="_idIndexMarker657"/>now accessible to the <strong class="source-inline">Header</strong>, <strong class="source-inline">Main</strong>, and <span class="No-Break"><strong class="source-inline">Content</strong></span><span class="No-Break"> components.</span></p>
			<h3>Consuming the Redux store in the components</h3>
			<p>We will now integrate the <a id="_idIndexMarker658"/>Redux store into the <strong class="source-inline">Header</strong>, <strong class="source-inline">Main</strong>, and <strong class="source-inline">Content</strong> components. This will replace the previous React context consumption code. Follow <span class="No-Break">these steps:</span></p>
			<ol>
				<li value="1">Start by opening <strong class="source-inline">Header.tsx</strong> and remove the <strong class="source-inline">AppContext</strong> <span class="No-Break">import statement.</span></li>
				<li>Add the following import statements <span class="No-Break">to </span><span class="No-Break"><strong class="source-inline">Header.tsx</strong></span><span class="No-Break">:</span><pre class="source-code">
import { useSelector, useDispatch } from 'react-redux';</pre><pre class="source-code">
import type { RootState } from './store/store';</pre><pre class="source-code">
import {</pre><pre class="source-code">
  authenticateAction,</pre><pre class="source-code">
  authenticatedAction,</pre><pre class="source-code">
  authorizeAction,</pre><pre class="source-code">
  authorizedAction,</pre><pre class="source-code">
} from './store/userSlice';</pre></li>
			</ol>
			<p>We will be referencing state from Redux as well as dispatching actions, so we have imported both <strong class="source-inline">useSelector</strong> and <strong class="source-inline">useDispatch</strong>. The <strong class="source-inline">RootState</strong> type is required in the function we will eventually pass to <strong class="source-inline">useSelector</strong>. We have also imported all the actions from the slice we created because we will need them in the<a id="_idIndexMarker659"/> revised <span class="No-Break">sign-in handler.</span></p>
			<ol>
				<li value="3">Inside the <strong class="source-inline">Header</strong> component, replace the <strong class="source-inline">useAppContext</strong> call with <strong class="source-inline">useSelector</strong> calls to get the <span class="No-Break">required state:</span><pre class="source-code">
export function Header() {</pre><pre class="source-code">
  <strong class="bold">const user = useSelector(</strong></pre><pre class="source-code">
<strong class="bold">    (state: RootState) =&gt; state.user.user</strong></pre><pre class="source-code">
<strong class="bold">  );</strong></pre><pre class="source-code">
<strong class="bold">  const loading = useSelector(</strong></pre><pre class="source-code">
<strong class="bold">    (state: RootState) =&gt; state.user.loading</strong></pre><pre class="source-code">
<strong class="bold">  );</strong></pre><pre class="source-code">
  async function handleSignInClick() {</pre><pre class="source-code">
    ...</pre><pre class="source-code">
  }</pre><pre class="source-code">
  return ...</pre><pre class="source-code">
}</pre></li>
				<li>Also, call <strong class="source-inline">useDispatch</strong> to get a <span class="No-Break"><strong class="source-inline">dispatch</strong></span><span class="No-Break"> function:</span><pre class="source-code">
export function Header() {</pre><pre class="source-code">
  const user = useSelector(</pre><pre class="source-code">
    (state: RootState) =&gt; state.user.user</pre><pre class="source-code">
  );</pre><pre class="source-code">
  const loading = useSelector(</pre><pre class="source-code">
    (state: RootState) =&gt; state.user.loading</pre><pre class="source-code">
  );</pre><pre class="source-code">
  <strong class="bold">const dispatch = useDispatch();</strong></pre><pre class="source-code">
  async function handleSignInClick() {</pre><pre class="source-code">
    ...</pre><pre class="source-code">
  }</pre><pre class="source-code">
  return ...</pre><pre class="source-code">
}</pre></li>
				<li>The last thing to<a id="_idIndexMarker660"/> do in <strong class="source-inline">Header.tsx</strong> is to modify <strong class="source-inline">handleSignInClick</strong> to reference the action functions from the <span class="No-Break">Redux slice:</span><pre class="source-code">
async function handleSignInClick() {</pre><pre class="source-code">
  dispatch(<strong class="bold">authenticateAction()</strong>);</pre><pre class="source-code">
  const authenticatedUser = await authenticate();</pre><pre class="source-code">
  dispatch(<strong class="bold">authenticatedAction(authenticatedUser)</strong>);</pre><pre class="source-code">
  if (authenticatedUser !== undefined) {</pre><pre class="source-code">
    dispatch(<strong class="bold">authorizeAction()</strong>);</pre><pre class="source-code">
    const authorizedPermissions = await authorize(</pre><pre class="source-code">
      authenticatedUser.id</pre><pre class="source-code">
    );</pre><pre class="source-code">
    dispatch(<strong class="bold">authorizedAction(authorizedPermissions)</strong>);</pre><pre class="source-code">
  }</pre><pre class="source-code">
}</pre></li>
				<li>Now, open <strong class="source-inline">Main.tsx</strong> and replace the <strong class="source-inline">AppContext</strong> import statement with import statements for <strong class="source-inline">useSelector</strong> and the <span class="No-Break"><strong class="source-inline">RootState</strong></span><span class="No-Break"> type:</span><pre class="source-code">
import { useSelector } from 'react-redux';</pre><pre class="source-code">
import { RootState } from './store/store';</pre></li>
				<li>Replace the call<a id="_idIndexMarker661"/> to <strong class="source-inline">useAppContext</strong> with a call to <strong class="source-inline">useSelector</strong> to get the <strong class="source-inline">user</strong> <span class="No-Break">state value:</span><pre class="source-code">
export function Main() {</pre><pre class="source-code">
  <strong class="bold">const user = useSelector(</strong></pre><pre class="source-code">
<strong class="bold">    (state: RootState) =&gt; state.user.user</strong></pre><pre class="source-code">
<strong class="bold">  );</strong></pre><pre class="source-code">
  return ...</pre><pre class="source-code">
}</pre></li>
				<li>Next, open <strong class="source-inline">Content.tsx</strong> and replace the <strong class="source-inline">AppContext</strong> import statement with import statements for <strong class="source-inline">useSelector</strong> and the <span class="No-Break"><strong class="source-inline">RootState</strong></span><span class="No-Break"> type:</span><pre class="source-code">
import { useSelector } from 'react-redux';</pre><pre class="source-code">
import { RootState } from './store/store';</pre></li>
				<li>Replace the call to <strong class="source-inline">useAppContext</strong> with a call to <strong class="source-inline">useSelector</strong> to get the <strong class="source-inline">permissions</strong> <span class="No-Break">state value:</span><pre class="source-code">
export function Content() {</pre><pre class="source-code">
  <strong class="bold">const permissions = useSelector(</strong></pre><pre class="source-code">
<strong class="bold">    (state: RootState) =&gt; state.user.permissions</strong></pre><pre class="source-code">
<strong class="bold">  );</strong></pre><pre class="source-code">
  if (permissions === undefined) {</pre><pre class="source-code">
    return null;</pre><pre class="source-code">
  }</pre><pre class="source-code">
  return ...</pre><pre class="source-code">
}</pre></li>
				<li>Run the app by running <strong class="source-inline">npm start</strong> in the terminal. The app will look and behave just as it <span class="No-Break">did before.</span></li>
			</ol>
			<p>That completes the refactoring of the app to use Redux rather than <span class="No-Break">React context.</span></p>
			<p>Here’s a recap of the key points for <span class="No-Break">using Redux:</span></p>
			<ul>
				<li>State is stored in a <a id="_idIndexMarker662"/><span class="No-Break">central store</span></li>
				<li>State is updated by dispatching actions that are handled <span class="No-Break">by reducers</span></li>
				<li>A <strong class="source-inline">Provider</strong> component needs to be placed appropriately in the component tree to give components access to the <span class="No-Break">Redux store</span></li>
				<li>Components can select state using a <strong class="source-inline">useSelector</strong> hook and dispatch actions using a <span class="No-Break"><strong class="source-inline">useDispatch</strong></span><span class="No-Break"> hook</span></li>
			</ul>
			<p>As you have experienced, even using the Redux Toolkit requires many steps when using Redux to manage state. It is overkill for simple state management requirements but shines when there is a lot of shared <span class="No-Break">application-level state.</span></p>
			<h1 id="_idParaDest-215"><a id="_idTextAnchor217"/>Summary</h1>
			<p>In this chapter, we built a small one-page app that contained components that needed to share state. We started by using our existing knowledge and used props to pass the state between the components. We learned that a problem with this approach was that components not needing access to the state are forced to access it if its child components do need access <span class="No-Break">to it.</span></p>
			<p>We moved on to learn about React context and refactored the app to use it. We learned that React context can store state using <strong class="source-inline">useState</strong> or <strong class="source-inline">useReducer</strong>. The state can then be provided to components in the tree using the context’s <strong class="source-inline">Provider</strong> component. Components then access the context state via the <strong class="source-inline">useContext</strong> hook. We found that this was a much nicer solution than passing the state via props, particularly when many components need access to <span class="No-Break">the state.</span></p>
			<p>Next, we learned about Redux, which is similar to React context. A difference is that there can only be a single Redux store containing the state, but there can be many React contexts. We learned that a <strong class="source-inline">Provider</strong> component needs to be added to the component tree to give components access to the Redux store. Components select state using the <strong class="source-inline">useSelector</strong> hook and dispatch actions using the <strong class="source-inline">useDispatch</strong> hook. Reducers handle actions and then update the <span class="No-Break">state accordingly.</span></p>
			<p>In the next chapter, we will learn how to work with REST APIs <span class="No-Break">in React.</span></p>
			<h1 id="_idParaDest-216"><a id="_idTextAnchor218"/>Questions</h1>
			<p>Answer the following questions to check what you have learned in <span class="No-Break">this chapter:</span></p>
			<ol>
				<li value="1">We have a context defined as follows to hold the theme state for <span class="No-Break">an app:</span><pre class="source-code">
type Theme = {</pre><pre class="source-code">
  name: string;</pre><pre class="source-code">
  color: 'dark' | 'light';</pre><pre class="source-code">
};</pre><pre class="source-code">
type ThemeContextType = Theme &amp; {</pre><pre class="source-code">
  changeTheme: (</pre><pre class="source-code">
    name: string,</pre><pre class="source-code">
    color: 'dark' | 'light'</pre><pre class="source-code">
  ) =&gt; void;</pre><pre class="source-code">
};</pre><pre class="source-code">
const ThemeContext = createContext&lt;ThemeContextType&gt;();</pre></li>
			</ol>
			<p>The code doesn’t compile though; what is <span class="No-Break">the problem?</span></p>
			<ol>
				<li value="2">The context from question 1 has a provider wrapper called <strong class="source-inline">ThemeProvider</strong>, which is added to the component tree <span class="No-Break">as follows:</span><pre class="source-code">
&lt;ThemeProvider&gt;</pre><pre class="source-code">
  &lt;Header /&gt;</pre><pre class="source-code">
  &lt;Main /&gt;</pre><pre class="source-code">
&lt;/ThemeProvider&gt;</pre><pre class="source-code">
&lt;Footer /&gt;</pre></li>
			</ol>
			<p>The theme state is <strong class="source-inline">undefined</strong> when destructured from <strong class="source-inline">useContext</strong> in the <strong class="source-inline">Footer</strong> component. What is <span class="No-Break">the problem?</span></p>
			<ol>
				<li value="3">Is it possible to have two React contexts in <span class="No-Break">an app?</span></li>
				<li>Is it possible to have two Redux stores in <span class="No-Break">an app?</span></li>
				<li>The following code dispatches an action to change <span class="No-Break">the theme:</span><pre class="source-code">
function handleChangeTheme({ name, color }: Theme) {</pre><pre class="source-code">
  useDispatch(changeThemeAction(name, color));</pre><pre class="source-code">
}</pre></li>
			</ol>
			<p>There is a problem with this code. What is <span class="No-Break">this problem?</span></p>
			<ol>
				<li value="6">In a React component, is it possible to use state only required by this component using <strong class="source-inline">useState</strong> as well as state from a <span class="No-Break">Redux store?</span></li>
				<li>In this chapter, when we implemented the Redux slice, the action handlers appeared to directly update the state, as in the <span class="No-Break">following example:</span><pre class="source-code">
authorizedAction: (</pre><pre class="source-code">
  state,</pre><pre class="source-code">
  action: PayloadAction&lt;string[]&gt;</pre><pre class="source-code">
) =&gt; {</pre><pre class="source-code">
  <strong class="bold">state.permissions</strong> = action.payload;</pre><pre class="source-code">
  <strong class="bold">state.loading</strong> = false;</pre><pre class="source-code">
}</pre></li>
			</ol>
			<p>Why are we allowed to mutate the state? I thought that state in React had to <span class="No-Break">be immutable?</span></p>
			<h1 id="_idParaDest-217"><a id="_idTextAnchor219"/>Answers</h1>
			<ol>
				<li value="1"><strong class="source-inline">createContext</strong> must be passed a default value when using it with TypeScript. Here’s the <span class="No-Break">corrected code:</span><pre class="source-code">
const ThemeContext = createContext&lt;ThemeContextType&gt;(<strong class="bold">{</strong></pre><pre class="source-code">
<strong class="bold">  name: 'standard',</strong></pre><pre class="source-code">
<strong class="bold">  color: 'light',</strong></pre><pre class="source-code">
<strong class="bold">  changeTheme: (name: string, color: 'dark' | 'light') =&gt; {},</strong></pre><pre class="source-code">
<strong class="bold">}</strong>);</pre></li>
				<li><strong class="source-inline">Footer</strong> must be placed inside <strong class="source-inline">ThemeProvider</strong> <span class="No-Break">as follows:</span><pre class="source-code">
&lt;ThemeProvider&gt;</pre><pre class="source-code">
  &lt;Header /&gt;</pre><pre class="source-code">
  &lt;Main /&gt;</pre><pre class="source-code">
  <strong class="bold">&lt;Footer /&gt;</strong></pre><pre class="source-code">
&lt;/ThemeProvider&gt;</pre></li>
				<li>Yes, there is no limit on the number of React contexts in <span class="No-Break">an app.</span></li>
				<li>No, only a single Redux store can be added to <span class="No-Break">an app.</span></li>
				<li><strong class="source-inline">useDispatch</strong> can’t be used directly to dispatch an action – it returns a function that can be used to dispatch <span class="No-Break">an action:</span><pre class="source-code">
<strong class="bold">const dispatch = useDispatch();</strong></pre><pre class="source-code">
function handleChangeTheme({ name, color }: Theme) {</pre><pre class="source-code">
  <strong class="bold">dispatch</strong>(changeThemeAction(name, color));</pre><pre class="source-code">
}</pre></li>
				<li>Yes, local state defined using <strong class="source-inline">useState</strong> or <strong class="source-inline">useReducer</strong> can be used alongside shared state from a <span class="No-Break">Redux store.</span></li>
				<li>The Redux Toolkit uses <a id="_idIndexMarker663"/>a library called <strong class="bold">immer</strong> to allow developers to directly update the <strong class="source-inline">state</strong> object without mutating it. For more information on <em class="italic">immer</em>, see the following <span class="No-Break">link: </span><a href="https://github.com/immerjs/immer"><span class="No-Break">https://github.com/immerjs/immer</span></a><span class="No-Break">.</span></li>
			</ol>
		</div>
		<div>
			<div id="_idContainer128" class="IMG---Figure">
			</div>
		</div>
	</body></html>
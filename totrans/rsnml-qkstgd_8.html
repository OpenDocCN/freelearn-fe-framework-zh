<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Unit Testing in Reason</h1>
                </header>
            
            <article>
                
<p class="mce-root">The subject of testing in a typed language such as Reason is a somewhat controversial topic. Some believe that a good test suite diminishes the need for a type system. On the other hand, some value a type system much more than their test suite. These differences in opinion can lead to some pretty heated debates.</p>
<p class="mce-root">Of course, types and tests are not mutually exclusive. We can have types <em class="calibre15">and</em> tests. Perhaps Cheng Lou, one of Reason's core team members, said it best.</p>
<div class="packt_quote">Tests. That's an easy one, right? Types kill a category of tests—not all of the tests. And this is a discussion that people don't appreciate enough. They all pit tests against types. The point is: if you have types, and you <em class="calibre19">add</em> tests, your tests will be able to express much more with less energy. You don't need to assert on invalid input anymore. You can assert on something more important. Tests can be there if you want; you're just saying much more with them.</div>
<div class="packt_quote1">- Cheng Lou</div>
<div class="packt_infobox">You can watch Cheng Lou's talk at React Conf 2017 on the following URL:<br class="title-page-name"/>
<a href="https://youtu.be/_0T5OSSzxms" class="calibre17">https://youtu.be/_0T5OSSzxms</a></div>
<p class="mce-root">In this chapter, we'll set up Jest, the popular JavaScript testing framework, via the <kbd class="calibre11">bs-jest</kbd> BuckleScript bindings. We will do the following:</p>
<ul class="calibre9">
<li class="calibre10">Learn how to set up <kbd class="calibre11">bs-jest</kbd> with both the <kbd class="calibre11">es6</kbd> and <kbd class="calibre11">commonjs</kbd> module formats</li>
<li class="calibre10">Unit-test a Reason function</li>
<li class="calibre10">See how writing tests can help us improve our code</li>
</ul>
<p class="mce-root"><span class="calibre5">To follow along, clone this book's GitHub repository and start from </span><kbd class="calibre11">Chapter08/app-start</kbd><span class="calibre5"> using the following code:</span></p>
<pre class="calibre16"><strong class="calibre1">git clone https://github.com/PacktPublishing/ReasonML-Quick-Start-Guide.git</strong><br class="title-page-name"/><strong class="calibre1">cd ReasonML-Quick-Start-Guide</strong><br class="title-page-name"/><strong class="calibre1">cd Chapter08/app-start<br class="title-page-name"/>npm install</strong></pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Testing with Jest</h1>
                </header>
            
            <article>
                
<p class="mce-root"><span class="calibre5">Jest, also created by Facebook, is </span><span class="calibre5">arguably one of the most popular JavaScript testing frameworks. If you're familiar with React, you're likely also familiar with Jest. Therefore, we'll skip the formal introduction and get started with using Jest in Reason.</span></p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Installation</h1>
                </header>
            
            <article>
                
<p class="mce-root">Just like any other package, we start with the <strong class="calibre4">Reason Package Index</strong> (or <strong class="calibre4">Redex</strong>, for short).</p>
<div class="packt_infobox">Reason Package Index:<br class="title-page-name"/>
<br class="title-page-name"/>
<a href="https://redex.github.io/" target="_blank" class="calibre17">https://redex.github.io/</a></div>
<p class="mce-root">Typing in <kbd class="calibre11">jest</kbd> reveals the <kbd class="calibre11">bs-jest</kbd> bindings to Jest. Following the installation instructions for <kbd class="calibre11">bs-jest</kbd>, we first install <kbd class="calibre11">bs-jest</kbd> with npm:</p>
<pre class="calibre16"><strong class="calibre1">npm install --save-dev @glennsl/bs-jest</strong></pre>
<p class="mce-root">Then we let BuckleScript know about this dev dependency by including it in <kbd class="calibre11">bsconfig.json</kbd>. Notice that the key is <kbd class="calibre11">"bs-dev-dependencies"</kbd> and not <kbd class="calibre11">"bs-dependencies"</kbd>:</p>
<pre class="calibre16"><span><span>"</span>bs-dev-dependencies<span>"</span></span><span>:</span> [<span><span>"</span>@glennsl/bs-jest<span>"</span></span>]</pre>
<p class="mce-root">Since <kbd class="calibre11">bs-jest</kbd> lists <kbd class="calibre11">jest</kbd> as a dependency, npm will install <kbd class="calibre11">jest</kbd> as well, and we don't need to include <kbd class="calibre11">jest</kbd> as a direct dependency of our application.</p>
<p class="mce-root">Let's now create a <kbd class="calibre11">__tests__</kbd> directory as a sibling of the <kbd class="calibre11">src</kbd> directory:</p>
<pre class="calibre16"><strong class="calibre1">cd Chapter08/app-start<br class="title-page-name"/>mkdir __tests__</strong></pre>
<p class="mce-root">And <span class="calibre5">tell BuckleScript to look for this directory:</span></p>
<pre class="calibre16">/* bsconfig.json */<br class="title-page-name"/>...<br class="title-page-name"/>"sources": [<br class="title-page-name"/>  {<br class="title-page-name"/>    "dir": "src",<br class="title-page-name"/>    "subdirs": true<br class="title-page-name"/>  },<br class="title-page-name"/>  {<br class="title-page-name"/>    <strong class="calibre1">"dir": "__tests__",</strong><br class="title-page-name"/>    <strong class="calibre1">"type": "dev"</strong><br class="title-page-name"/>  }<br class="title-page-name"/>],<br class="title-page-name"/>...</pre>
<p class="mce-root">Lastly, we'll update our <kbd class="calibre11">test</kbd> script in <kbd class="calibre11">package.json</kbd> to use Jest:</p>
<pre class="calibre16">/* package.json */<br class="title-page-name"/>"test": "jest"</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Our first test</h1>
                </header>
            
            <article>
                
<p class="mce-root">Let's create our first test in <kbd class="calibre11">__tests__/First_test.re</kbd> with something simple for now:</p>
<pre class="calibre16">/* __tests__/First_test.re */<br class="title-page-name"/>open Jest;<br class="title-page-name"/><br class="title-page-name"/>describe("Expect", () =&gt;<br class="title-page-name"/>  Expect.(test("toBe", () =&gt;<br class="title-page-name"/>            expect(1 + 2) |&gt; toBe(3)<br class="title-page-name"/>          ))<br class="title-page-name"/>);</pre>
<p class="mce-root">Running <kbd class="calibre11">npm test</kbd> now fails with the following error:</p>
<pre class="calibre16"> FAIL lib/es6/__tests__/First_test.bs.js<br class="title-page-name"/>  ● Test suite failed to run<br class="title-page-name"/><br class="title-page-name"/>    Jest encountered an unexpected token<br class="title-page-name"/><br class="title-page-name"/>    This usually means that you are trying to import a file which Jest<br class="title-page-name"/>    cannot parse, e.g. it's not plain JavaScript.<br class="title-page-name"/><br class="title-page-name"/>    By default, if Jest sees a Babel config, it will use that to transform<br class="title-page-name"/>    your files, ignoring "node_modules".<br class="title-page-name"/><br class="title-page-name"/>    Here's what you can do:<br class="title-page-name"/>     • To have some of your "node_modules" files transformed, you can<br class="title-page-name"/>       specify a custom "transformIgnorePatterns" in your config.<br class="title-page-name"/>     • If you need a custom transformation specify a "transform" option in<br class="title-page-name"/>       your config.<br class="title-page-name"/>     • If you simply want to mock your non-JS modules (e.g. binary assets)<br class="title-page-name"/>       you can stub them out with the "moduleNameMapper" config option.<br class="title-page-name"/><br class="title-page-name"/>    You'll find more details and examples of these config options in the<br class="title-page-name"/>    docs:<br class="title-page-name"/>    https://jestjs.io/docs/en/configuration.html<br class="title-page-name"/><br class="title-page-name"/>    Details:<br class="title-page-name"/><br class="title-page-name"/>    .../lib/es6/__tests__/First_test.bs.js:3<br class="title-page-name"/>    <strong class="calibre1">import * as Jest from "@glennsl/bs-jest/lib/es6/src/jest.js";</strong><br class="title-page-name"/>           ^<br class="title-page-name"/><br class="title-page-name"/>    <strong class="calibre1">SyntaxError: Unexpected token *</strong><br class="title-page-name"/><br class="title-page-name"/>      at ScriptTransformer._transformAndBuildScript (node_modules/jest-<br class="title-page-name"/>      runtime/build/script_transformer.js:403:17)<br class="title-page-name"/><br class="title-page-name"/>Test Suites: 1 failed, 1 total<br class="title-page-name"/>Tests: 0 total<br class="title-page-name"/>Snapshots: 0 total<br class="title-page-name"/>Time: 1.43s<br class="title-page-name"/>Ran all test suites.<br class="title-page-name"/>npm ERR! Test failed. See above for more details.</pre>
<p class="mce-root">The problem here is that Jest cannot directly understand the ES Module format. Remember that we've configured BuckleScript to use ES modules via the following configuration (see <a href="4e4e3057-fca6-4c81-b6a7-05575aeeace3.xhtml" target="_blank" class="calibre8">Chapter 2</a>, <em class="calibre15">Setting Up a Development Environment</em>):</p>
<pre class="calibre16">/* bsconfig.json */<br class="title-page-name"/>...<br class="title-page-name"/>"package-specs": [<br class="title-page-name"/>  {<br class="title-page-name"/>    <strong class="calibre1">"module": "es6"</strong><br class="title-page-name"/>  }<br class="title-page-name"/>],<br class="title-page-name"/>...</pre>
<p class="mce-root">One way to resolve this issue is to configure BuckleScript to use the <kbd class="calibre11">"commonjs"</kbd> module format instead:</p>
<pre class="calibre16">/* bsconfig.json */<br class="title-page-name"/>...<br class="title-page-name"/>"package-specs": [<br class="title-page-name"/>  {<br class="title-page-name"/>    <strong class="calibre1">"module": "commonjs"</strong><br class="title-page-name"/>  }<br class="title-page-name"/>],<br class="title-page-name"/>...</pre>
<p class="mce-root">We'll then also need to update webpack's <kbd class="calibre11">entry</kbd> field:</p>
<pre class="calibre16">/* webpack.config.js */<br class="title-page-name"/>...<br class="title-page-name"/>entry: "./lib/<strong class="calibre1">js</strong>/src/Index.bs.js", /* changed <strong class="calibre1">es6</strong> to <strong class="calibre1">js</strong> */<br class="title-page-name"/>...</pre>
<p class="mce-root">Now, running <kbd class="calibre11">npm test</kbd> results in a test that passes:</p>
<pre class="calibre16"> PASS lib/js/__tests__/First_test.bs.js<br class="title-page-name"/>  Expect<br class="title-page-name"/>    ✓ toBe (4ms)<br class="title-page-name"/><br class="title-page-name"/>Test Suites: 1 passed, 1 total<br class="title-page-name"/>Tests: 1 passed, 1 total<br class="title-page-name"/>Snapshots: 0 total<br class="title-page-name"/>Time: 1.322s<br class="title-page-name"/>Ran all test suites.</pre>
<p class="mce-root">Alternatively, if we want to keep using the ES module format, we need to make sure Jest runs the <kbd class="calibre11">*test.bs.js</kbd> files through Babel first. To do this, we'll need to follow the following steps:</p>
<ol class="calibre12">
<li class="calibre10">Install both <kbd class="calibre11">babel-jest</kbd> and <kbd class="calibre11">babel-preset-env</kbd>:</li>
</ol>
<pre class="calibre18"><strong class="calibre1">npm install babel-core@6.26.3 babel-jest@23.6.0 babel-preset-env@1.7.0</strong></pre>
<ol start="2" class="calibre12">
<li class="calibre10">Add the corresponding Babel configuration in <kbd class="calibre11">.babelrc</kbd>:</li>
</ol>
<pre class="calibre18">/* .babelrc */<br class="title-page-name"/>{<br class="title-page-name"/>  "presets": ["env"]<br class="title-page-name"/>}</pre>
<ol start="3" class="calibre12">
<li class="calibre10">Ensure that Jest runs certain third-party dependencies within <kbd class="calibre11">node_modules</kbd> through Babel. Jest excludes running anything in <kbd class="calibre11">node_modules</kbd> through Babel by default <span>for performance reasons</span>. We can override this behavior by providing a custom Jest configuration in <kbd class="calibre11">package.json</kbd>. Here, we'll tell Jest to only ignore third-party dependencies that don't match <kbd class="calibre11">/node_modules/glennsl*</kbd>, <kbd class="calibre11">/node_modules/bs-platform*</kbd>, and so on:</li>
</ol>
<pre class="calibre18">/* package.json */<br class="title-page-name"/>...<br class="title-page-name"/>"jest": {<br class="title-page-name"/> "transformIgnorePatterns": [<br class="title-page-name"/> "/node_modules/(?!@glennsl|bs-platform|bs-css|reason-react)"<br class="title-page-name"/> ]<br class="title-page-name"/>}</pre>
<p class="mce-root">Now, running <kbd class="calibre11">npm test</kbd> works with the ES Module format:</p>
<pre class="calibre16"> PASS lib/es6/__tests__/First_test.bs.js<br class="title-page-name"/>  Expect<br class="title-page-name"/>    ✓ toBe (7ms)<br class="title-page-name"/><br class="title-page-name"/>Test Suites: 1 passed, 1 total<br class="title-page-name"/>Tests: 1 passed, 1 total<br class="title-page-name"/>Snapshots: 0 total<br class="title-page-name"/>Time: 1.041s<br class="title-page-name"/>Ran all test suites.</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Testing business logic</h1>
                </header>
            
            <article>
                
<p class="mce-root">Let's write a test that verifies we're able to get the right customer by its <kbd class="calibre11">id</kbd>. In <kbd class="calibre11">Customer.re</kbd>, there is a function called <kbd class="calibre11">getCustomer</kbd> that accepts an array of <kbd class="calibre11">customers</kbd>, and imperatively gets the <kbd class="calibre11">id</kbd> by calling <kbd class="calibre11">getId</kbd>. The <kbd class="calibre11">getId</kbd> function accepts a <kbd class="calibre11">pathname</kbd> that exists outside the scope of <kbd class="calibre11">getCustomer</kbd>:</p>
<pre class="calibre16">let getCustomer = customers =&gt; {<br class="title-page-name"/>  let id = getId(pathname);<br class="title-page-name"/>  customers |&gt; Js.Array.find(customer =&gt; customer.CustomerType.id == id);<br class="title-page-name"/>};</pre>
<p class="mce-root">Right away, we notice that this is less than ideal. It would be much better if <kbd class="calibre11">getCustomer</kbd> accepted an array of <kbd class="calibre11">customers</kbd> <em class="calibre15">and</em> an <kbd class="calibre11">id</kbd>, and focused on getting the customer by their <kbd class="calibre11">id</kbd>. Otherwise, it will be harder to write a test <em class="calibre15">just</em> for <kbd class="calibre11">getCustomer</kbd>.</p>
<p class="mce-root">So, we refactor <kbd class="calibre11">getCustomer</kbd> to also accept an <kbd class="calibre11">id</kbd>:</p>
<pre class="calibre16">let getCustomerById = (customers, id) =&gt; {<br class="title-page-name"/> customers |&gt; Js.Array.find(customer =&gt; customer.CustomerType.id == id);<br class="title-page-name"/>};</pre>
<p class="mce-root">Now, we can more easily write the test. Follow the compiler errors to ensure that you've replaced <kbd class="calibre11">getCustomer</kbd> with <kbd class="calibre11">getCustomerById</kbd>. For the <kbd class="calibre11">id</kbd> argument, pass in <kbd class="calibre11">getId(pathname)</kbd>.</p>
<p class="mce-root">Let's rename our test to <kbd class="calibre11">__tests__/Customers_test.re</kbd> and include the following test:</p>
<pre class="calibre16">open Jest;<br class="title-page-name"/><br class="title-page-name"/>describe("Customer", () =&gt;<br class="title-page-name"/>  Expect.(<br class="title-page-name"/>    test("can create a customer", () =&gt; {<br class="title-page-name"/>      let customers: array(CustomerType.t) = [|<br class="title-page-name"/>        {<br class="title-page-name"/>          id: 1,<br class="title-page-name"/>          name: "Irita Camsey",<br class="title-page-name"/>          address: {<br class="title-page-name"/>            street: "69 Ryan Parkway",<br class="title-page-name"/>            city: "Kansas City",<br class="title-page-name"/>            state: "MO",<br class="title-page-name"/>            zip: "00494",<br class="title-page-name"/>          },<br class="title-page-name"/>          phone: "8169271752",<br class="title-page-name"/>          email: "icamsey0@over-blog.com",<br class="title-page-name"/>        },<br class="title-page-name"/>        {<br class="title-page-name"/>          id: 2,<br class="title-page-name"/>          name: "Luise Grayson",<br class="title-page-name"/>          address: {<br class="title-page-name"/>            street: "2756 Gale Trail",<br class="title-page-name"/>            city: "Jacksonville",<br class="title-page-name"/>            state: "FL",<br class="title-page-name"/>            zip: "23566",<br class="title-page-name"/>          },<br class="title-page-name"/>          phone: "9044985243",<br class="title-page-name"/>          email: "lgrayson1@netlog.com",<br class="title-page-name"/>        },<br class="title-page-name"/>        {<br class="title-page-name"/>          id: 3,<br class="title-page-name"/>          name: "Derick Whitelaw",<br class="title-page-name"/>          address: {<br class="title-page-name"/>            street: "45 Southridge Par",<br class="title-page-name"/>            city: "Lexington",<br class="title-page-name"/>            state: "KY",<br class="title-page-name"/>            zip: "08037",<br class="title-page-name"/>          },<br class="title-page-name"/>          phone: "4079634850",<br class="title-page-name"/>          email: "dwhitelaw2@fema.gov",<br class="title-page-name"/>        },<br class="title-page-name"/>      |];<br class="title-page-name"/>      let customer: CustomerType.t =<br class="title-page-name"/>        Customer.getCustomerById(customers, 2) |&gt; Belt.Option.getExn;<br class="title-page-name"/>      expect((customer.id, customer.name)) |&gt; toEqual((2, "Luise <br class="title-page-name"/>       Grayson"));<br class="title-page-name"/>    })<br class="title-page-name"/>  )<br class="title-page-name"/>);</pre>
<p class="mce-root">Running this test (via <kbd class="calibre11">npm test</kbd>) with our existing code results in the following error:</p>
<pre class="calibre16"> FAIL lib/es6/__tests__/Customers_test.bs.js<br class="title-page-name"/>  ● Test suite failed to run<br class="title-page-name"/><br class="title-page-name"/>    Error: No message was provided<br class="title-page-name"/><br class="title-page-name"/>Test Suites: 1 failed, 1 total<br class="title-page-name"/>Tests: 0 total<br class="title-page-name"/>Snapshots: 0 total<br class="title-page-name"/>Time: 1.711s<br class="title-page-name"/>Ran all test suites.</pre>
<p class="mce-root">The reason for the error is that <kbd class="calibre11">Customers.re</kbd> makes a call to <kbd class="calibre11">localStorage</kbd> at the top level.</p>
<pre class="calibre16">/* Customer.re */<br class="title-page-name"/>let customers = DataBsJson.(parse(getItem("customers"))); /* this is the problem */</pre>
<p class="mce-root">Since Jest runs in Node.js, we don't have access to browser APIs. To resolve this issue, we can wrap this call in a function:</p>
<pre class="calibre16">/* Customer.re */<br class="title-page-name"/>let getCustomers = () =&gt; DataBsJson.(parse(getItem("customers")));</pre>
<p class="mce-root">And we can call this <kbd class="calibre11">getCustomers</kbd> function within <kbd class="calibre11">initialState</kbd>. This will allow us to avoid the call to <kbd class="calibre11">localStorage</kbd> from within Jest. </p>
<p class="mce-root">Let's update <kbd class="calibre11">Customer.re</kbd> to move the array of customers into the state:</p>
<pre class="calibre16">/* Customer.re */<br class="title-page-name"/>...<br class="title-page-name"/>type state = {<br class="title-page-name"/>  mode,<br class="title-page-name"/>  customer: CustomerType.t,<br class="title-page-name"/>  <strong class="calibre1">customers: array(CustomerType.t),</strong><br class="title-page-name"/>};<br class="title-page-name"/><br class="title-page-name"/>...<br class="title-page-name"/><br class="title-page-name"/><strong class="calibre1">let getCustomers = () =&gt; DataBsJson.(parse(getItem("customers")));</strong><br class="title-page-name"/><br class="title-page-name"/><strong class="calibre1">let getCustomerById = (customers, id) =&gt; {</strong><br class="title-page-name"/><strong class="calibre1">  customers |&gt; Js.Array.find(customer =&gt; customer.CustomerType.id == id);</strong><br class="title-page-name"/><strong class="calibre1">};</strong><br class="title-page-name"/><br class="title-page-name"/>...<br class="title-page-name"/><br class="title-page-name"/>initialState: () =&gt; {<br class="title-page-name"/>  let mode = Js.String.includes("create", pathname) ? Create : Update;<br class="title-page-name"/>  <strong class="calibre1">let customers = getCustomers();</strong><br class="title-page-name"/>  {<br class="title-page-name"/>    mode,<br class="title-page-name"/>    customer:<br class="title-page-name"/>      switch (mode) {<br class="title-page-name"/>      | Create =&gt; getDefault(customers)<br class="title-page-name"/>      | Update =&gt;<br class="title-page-name"/>        Belt.Option.getWithDefault(<br class="title-page-name"/>          getCustomerById(customers, getId(pathname)),<br class="title-page-name"/>          getDefault(customers),<br class="title-page-name"/>        )<br class="title-page-name"/>      },<br class="title-page-name"/>    customers,<br class="title-page-name"/>  };<br class="title-page-name"/>},<br class="title-page-name"/><br class="title-page-name"/>...<br class="title-page-name"/><br class="title-page-name"/>/* within the reducer */<br class="title-page-name"/>ReasonReact.UpdateWithSideEffects(<br class="title-page-name"/>  {<br class="title-page-name"/>    ...state,<br class="title-page-name"/>    customer: {<br class="title-page-name"/>      id: state.customer.id,<br class="title-page-name"/>      name: getInputValue("input[name=name]"),<br class="title-page-name"/>      address: {<br class="title-page-name"/>        street: getInputValue("input[name=street]"),<br class="title-page-name"/>        city: getInputValue("input[name=city]"),<br class="title-page-name"/>        state: getInputValue("input[name=state]"),<br class="title-page-name"/>        zip: getInputValue("input[name=zip]"),<br class="title-page-name"/>      },<br class="title-page-name"/>      phone: getInputValue("input[name=phone]"),<br class="title-page-name"/>      email: getInputValue("input[name=email]"),<br class="title-page-name"/>    },<br class="title-page-name"/>  },<br class="title-page-name"/>  self =&gt; {<br class="title-page-name"/>    let customers =<br class="title-page-name"/>      switch (self.state.mode) {<br class="title-page-name"/>      | Create =&gt;<br class="title-page-name"/>        Belt.Array.concat(state.customers, [|self.state.customer|])<br class="title-page-name"/>      | Update =&gt;<br class="title-page-name"/>        Belt.Array.setExn(<br class="title-page-name"/>          <strong class="calibre1">state.customers</strong>,<br class="title-page-name"/>          Js.Array.findIndex(<br class="title-page-name"/>            customer =&gt;<br class="title-page-name"/>              customer.CustomerType.id == self.state.customer.id,<br class="title-page-name"/>            <strong class="calibre1">state.customers</strong>,<br class="title-page-name"/>          ),<br class="title-page-name"/>          self.state.customer,<br class="title-page-name"/>        );<br class="title-page-name"/>        <strong class="calibre1">state.customers</strong>;<br class="title-page-name"/>      };<br class="title-page-name"/><br class="title-page-name"/>    let json = customers-&gt;DataBsJson.toJson;<br class="title-page-name"/>    DataBsJson.setItem("customers", json);<br class="title-page-name"/>  },<br class="title-page-name"/>);</pre>
<p class="mce-root">After these changes, our test succeeds:</p>
<pre class="calibre16"> PASS lib/es6/__tests__/Customers_test.bs.js<br class="title-page-name"/>  Customer<br class="title-page-name"/>    ✓ can create a customer (5ms)<br class="title-page-name"/><br class="title-page-name"/>Test Suites: 1 passed, 1 total<br class="title-page-name"/>Tests: 1 passed, 1 total<br class="title-page-name"/>Snapshots: 0 total<br class="title-page-name"/>Time: 1.179s<br class="title-page-name"/>Ran all test suites.</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Reflecting</h1>
                </header>
            
            <article>
                
<p class="mce-root">In this chapter, we learned the basics of setting up <kbd class="calibre11">bs-jest</kbd> with both the CommonJS and ES Module formats. We also learned that unit testing can help force us to write better code because, for the most part, code that is easier to test is also better. We refactored <kbd class="calibre11">getCustomer</kbd> to <kbd class="calibre11">getCustomerById</kbd>, and moved the array of customers into that component's state.</p>
<p class="mce-root">Since we've written our unit tests in Reason, the compiler checks our tests as well. For example, if <kbd class="calibre11">Customer_test.re</kbd> uses <kbd class="calibre11">getCustomer</kbd> and we change <kbd class="calibre11"><span>getCustomerById</span></kbd> to <kbd class="calibre11"><span>getCustomer</span></kbd> in <kbd class="calibre11">Customer.re</kbd>, we get a compile time error:</p>
<pre class="calibre16">We've found a bug for you!<br class="title-page-name"/>/__tests__/Customers_test.re 45:9-28<br class="title-page-name"/><br class="title-page-name"/>43  |];<br class="title-page-name"/>44  let customer: CustomerType.t =<br class="title-page-name"/>45  Customer.getCustomer(customers, 2) |&gt; Belt.Option.getExn;<br class="title-page-name"/>46  expect((customer.id, customer.name)) |&gt; toEqual((2, "Luise Grayson")<br class="title-page-name"/>      );<br class="title-page-name"/>47  })<br class="title-page-name"/><br class="title-page-name"/>The value getCustomer can't be found in Customer<br class="title-page-name"/><br class="title-page-name"/>Hint: Did you mean getCustomers?</pre>
<p class="mce-root">This means that we're also not able to write certain unit tests. For example, if we wanted to test <a href="86a6dec1-1340-4c6c-bdfa-95138e0d471b.xhtml" target="_blank" class="calibre8">Chapter 5</a>, <em class="calibre15">Effective ML</em> codes, where we used the type system to guarantee that an invoice wouldn't be discounted twice, the test wouldn't even compile. How lovely.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p class="mce-root">Since Reason's reach is so broad, there are so many different ways to approach learning it. This book has focused on learning Reason from the perspective of a frontend developer. We've taken skills and concepts that we're already familiar with (such as building web applications with ReactJS) and explored how we would do the same with Reason. While on this journey, we learned about Reason's type system, its toolchain, and its ecosystem.</p>
<p class="mce-root">I believe the future of Reason is bright. Many of the skills we've learned are directly transferable to targeting a native platform. Reason's frontend story is currently more polished than its native story, but it's already possible to compile to both web and native. And it's only going to get better from here. There have already been huge improvements from when I first started using Reason, and I'm so excited to see what the future holds.</p>
<p class="mce-root"><span class="calibre5">Hopefully this book has piqued your interest in Reason, OCaml, and the ML family of languages in general. Reason's type system has seen decades of engineering. As a result, there is a lot that this book hasn't covered, and I'm still learning myself. However, you should by now have a solid foundation on which to continue your learning. I encourage you to learn publicly by writing asking questions on the Discord channel, writing blog posts, mentoring others, sharing your journey in meetups, and so on.</span></p>
<p class="mce-root"><span class="calibre5"> Thank you very much for making it this far, and see you on the Discord channel!</span></p>
<div class="packt_infobox">Reason Discord channel:<br class="title-page-name"/>
<br class="title-page-name"/>
<a href="https://discord.gg/reasonml" target="_blank" class="calibre17">https://discord.gg/reasonml</a></div>


            </article>

            
        </section>
    </body></html>
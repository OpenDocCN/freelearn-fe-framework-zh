<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Client-Side Routing for SPA</h1>
                </header>
            
            <article>
                
<p class="mce-root"><strong>Single Page Applications</strong> (<strong>SPA</strong>) is a term used to refer to apps that are served from just one server route but have multiple client views. The single-server route is usually the default (<kbd>/</kbd> or <kbd>*</kbd>). Once the single-server route is loaded, the client (JavaScript) hijacks the page and starts controlling the route using the browser's routing mechanisms.</p>
<p>Being able to control the routes from JavaScript gives developers the ability to build better user experiences. This chapter describes how this can be done in Angular using TypeScript-written classes, directives, and so on.</p>
<p>Just like every other chapter, we will be doing this with practical examples.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">RouterModule</h1>
                </header>
            
            <article>
                
<p>Just like Forms, Angular doesn't generate routing by default in the CLI scaffold. This is because you might not need it in the project you're working on. To get routing working, you need to import it in the module that needs to make use of it:</p>
<pre class="mce-root">import { RouterModule }   from '@angular/router';</pre>
<p>The module exposes a static <kbd>forRoot</kbd> method, which is passed in an array of routes. Doing so registers and configures those routes for the module importing <kbd>RouterModule</kbd>. Start with creating a <kbd>routes.ts</kbd> file in the <kbd>app</kbd> folder:</p>
<pre>import { Routes } from '@angular/router';<br/><br/>export const routes: Routes = [<br/>  {<br/>    path: '',<br/>    component: HomeComponent<br/>  },<br/>  {<br/>    path: 'about',<br/>    component: AboutComponent<br/>  },<br/>  {<br/>    path: 'contact',<br/>    component: ContactComponent<br/>  }<br/>];</pre>
<p>The signature of the <kbd>Routes</kbd> class is an array that takes one or more objects. The object that is passed in should have a path and a component property. The path property defines the location while the component property defines the Angular component that should be mounted on the defined path.</p>
<p>You can then configure <kbd>RouterModule</kbd> with these arrays in <kbd>AppModule</kbd>. We have already imported <kbd>RouterModule</kbd>, so let's import the <kbd>routes</kbd> file and configure the routes in the <kbd>imports</kbd> array:</p>
<pre>import { BrowserModule } from '@angular/platform-browser';<br/>import { NgModule } from '@angular/core';<br/>//Import RuterModule<br/>import { RouterModule } from '@angular/router';<br/><br/>import { AppComponent } from './app.component';<br/><br/>//Imprt routes<br/>import { routes } from './routes';<br/><br/>@NgModule({<br/>  declarations: [<br/>    AppComponent<br/>  ],<br/>  imports: [<br/>    BrowserModule,<br/>    // RouterModule used to<br/>    // configure routes<br/>    RouterModule.forRoot(routes)<br/>  ],<br/>  providers: [],<br/>  bootstrap: [AppComponent]<br/>})<br/>export class AppModule { }</pre>
<p>That's all it takes to configure routes in Angular. The components for the routes are yet to be created, so if you try running the app, you will get errors in the terminal indicating the same:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-351 image-border" height="380" src="assets/885229f8-c052-470a-a72c-3335461f20af.jpg" width="518"/></div>
<p>Let's generate these components using the CLI:</p>
<pre>ng generate component home<br/>ng generate component about<br/>ng generate component contact</pre>
<p>Then, update the routes configuration to import the components:</p>
<pre>import { Routes } from '@angular/router';<br/><br/>import { ContactComponent } from './contact/contact.component';<br/>import { AboutComponent } from './about/about.component';<br/>import { HomeComponent } from './home/home.component';<br/><br/>export const routes: Routes = [<br/>  {<br/>    path: '',<br/>    component: HomeComponent<br/>  },<br/>  {<br/>    path: 'about',<br/>    component: AboutComponent<br/>  },<br/>  {<br/>    path: 'contact',<br/>    component: ContactComponent<br/>  }<br/>];</pre>
<p>Run the app one more time and see whether you got rid of the errors:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-352 image-border" height="393" src="assets/e245aa28-283f-4d3c-aad4-5d88b47d972b.jpg" width="539"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Router directives</h1>
                </header>
            
            <article>
                
<p>I know you're itching to see the example in the browser, but if you try testing the app at port <kbd>4200</kbd>, you will still see the content of the <kbd>app</kbd> component. This is because we haven't told Angular where it should mount the route.</p>
<p>Angular exposes two important route directives:</p>
<ul>
<li><strong>Router outlet</strong>: This defines where the route configuration should be mounted. This is usually in an entry component for single-page apps.</li>
<li><strong>Router link</strong>: This is used to define the navigation for Angular routes. Basically, it adds features to the anchor tag so as to work better with routes defined in an Angular app.</li>
</ul>
<p>Let's replace the content of the app component's template to utilize the router directives:</p>
<pre>&lt;div&gt;<br/>  &lt;nav class="navbar navbar-inverse"&gt;<br/>    &lt;div class="container-fluid"&gt;<br/>      &lt;div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1"&gt;<br/>        &lt;ul class="nav navbar-nav"&gt;<br/>          &lt;li&gt;&lt;a routerLink="/"&gt;Home&lt;/a&gt;&lt;/li&gt;<br/>          &lt;li&gt;&lt;a routerLink="/about"&gt;About&lt;/a&gt;&lt;/li&gt;<br/>          &lt;li&gt;&lt;a routerLink="/contact"&gt;Contact&lt;/a&gt;&lt;/li&gt;<br/>        &lt;/ul&gt;<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  &lt;/nav&gt;<br/>  &lt;div class="container"&gt;<br/>    &lt;router-outlet&gt;&lt;/router-outlet&gt;<br/>  &lt;/div&gt;<br/>&lt;/div&gt;</pre>
<p>The div with the class <kbd>container</kbd> is where each component will be displayed once we visit the respective route. We can navigate through each of the routes by clicking through the anchor tags that have the <kbd>routerLink</kbd> directive.</p>
<p>Open your browser and visit the localhost at port <kbd>4200</kbd>. You should see the home page by default:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-353 image-border" height="397" src="assets/62a7adaf-1178-4a2a-853b-8436fc3952b2.png" width="819"/></div>
<p>Try clicking on the <span class="packt_screen">About</span> or <span class="packt_screen">Contact</span> link in the navigation bar. If you followed all the steps, you should see the app replace the home component with the <span class="packt_screen">About</span> or <span class="packt_screen">Contact</span> component:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-354 image-border" height="397" src="assets/aae21ff1-f2b3-4455-8fc0-cdc6d4ead19a.png" width="818"/></div>
<p>Note how the address bar also updates with the path location we defined in the configuration:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-355 image-border" height="121" src="assets/37d9804c-b80b-4f61-932a-e1694552599f.png" width="820"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Master-details view with routes</h1>
                </header>
            
            <article>
                
<p>A very common UI pattern is to have a list of items without much information about the items. The detailed information about each of the items is shown when the item is selected, clicked, or a mouseover occurs.</p>
<p>Each of the items is usually referred to as the master, while the content that is shown after interacting with the item is referred to as the child or details.</p>
<p>Let's build a simple blog that shows a list of articles on the home page, and when each article is clicked, the post page is revealed and you can read the selected article.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Data source</h1>
                </header>
            
            <article>
                
<p>For a basic example, we don't need a database or a server. A simple JSON file containing blog posts is enough. Create a file named <kbd>db.json</kbd> in your <kbd>app</kbd> folder with the following structure:</p>
<pre>[<br/>  {<br/>    "imageId": "jorge-vasconez-364878_me6ao9",<br/>    "collector": "John Brian",<br/>    "description": "Yikes invaluably thorough hello more some that neglectfully on badger crud inside mallard thus crud wildebeest pending much because therefore hippopotamus disbanded much."<br/>  },<br/>  {<br/>    "imageId": "wynand-van-poortvliet-364366_gsvyby",<br/>    "collector": "Nnaemeka Ogbonnaya",<br/>    "description": "Inimically kookaburra furrowed impala jeering porcupine flaunting across following raccoon that woolly less gosh weirdly more fiendishly ahead magnificent calmly manta wow racy brought rabbit otter quiet wretched less brusquely wow inflexible abandoned jeepers."<br/>  },<br/>  {<br/>    "imageId": "josef-reckziegel-361544_qwxzuw",<br/>    "collector": "Ola Oluwa",<br/>    "description": "A together cowered the spacious much darn sorely punctiliously hence much less belched goodness however poutingly wow darn fed thought stretched this affectingly more outside waved mad ostrich erect however cuckoo thought."<br/>  },<br/>....<br/>]</pre>
<p>The structure shows an array of posts. Each post has <kbd>imageID</kbd>, an author as collector, and a description as the post content.</p>
<p>TypeScript, by default, won't understand the JSON file when you try importing it into a TypeScript file. To fix this, define <kbd>typings</kbd> with the following declarations:</p>
<pre>// ./src/typings.d.ts<br/>declare module "*.json" {<br/>  const value: any;<br/>  export default value;<br/>}</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Blog service</h1>
                </header>
            
            <article>
                
<p>Remember that we mentioned how having the business logic of our app in components is a bad idea. As much as possible, it's not recommended to interact with the data source directly from the component. What we will rather do is create a service class to do the same for us:</p>
<pre><strong>ng generate service blog</strong></pre>
<p>Update the generated empty service with the following:</p>
<pre>import { Injectable } from '@angular/core';<br/>import * as rawData from './db.json';<br/><br/>@Injectable()<br/>export class BlogService {<br/>  data = &lt;any&gt;rawData;<br/>  constructor() { }<br/><br/>  getPosts() {<br/>    return this.data.map(post =&gt; {<br/>      return {<br/>        id: post.imageId,<br/>        imageUrl: `https://res.cloudinary.com/christekh/image/upload/c_fit,q_auto,w_300/${post.imageId}`,<br/>        author: post.collector<br/>      }<br/>    })<br/>  }<br/><br/>  byId(id) {<br/>    return this.data<br/>      .filter(post =&gt; post.imageId === id)<br/>      .map(post =&gt; {<br/>        return {<br/>          id: post.imageId,<br/>          imageUrl: `https://res.cloudinary.com/christekh/image/upload/c_fit,q_auto,w_300/${post.imageId}`,<br/>          author: post.collector,<br/>          content: post.description<br/>        }<br/>      })[0]<br/>  }<br/><br/>}</pre>
<p>Let's talk about what's happening in the service:</p>
<ol>
<li>First, we import the data source we created.</li>
<li>Next, we create a <kbd>getPosts</kbd> method, which returns all the posts after transforming each item in the post. We also generate an image URL with the image ID. This is done by appending the ID to a Cloudinary (<a href="https://cloudinary.com/">https://cloudinary.com/</a>) image server URL. The images were uploaded to Cloudinary prior to using them.</li>
<li>The <kbd>byId</kbd> method takes the ID as an argument, finds the post with the ID using the filter method, and then transforms the retrieved post. After the transformation, we fetch the first and only item in the array.</li>
</ol>
<p>To expose this service, you need to add it to the <kbd>providers</kbd> array in the <kbd>app</kbd> module:</p>
<pre>import { BrowserModule } from '@angular/platform-browser';<br/>import { NgModule } from '@angular/core';<br/><br/>import { BlogService } from './blog.service';<br/><br/>@NgModule({<br/>  declarations: [<br/>    AppComponent<br/>  ],<br/>  imports: [<br/>    BrowserModule<br/>  ],<br/>  providers: [<br/>    BlogService<br/>  ],<br/>  bootstrap: [AppComponent]<br/>})<br/>export class AppModule { }</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Creating routes</h1>
                </header>
            
            <article>
                
<p> Now that we have a data source and a service to interact with this data source, it's time to start working on the routes and components that will consume this data. Add a <kbd>routes.ts</kbd> file to the <kbd>app</kbd> folder with the following configuration:</p>
<pre>import { Routes } from '@angular/router';<br/><br/>import { HomeComponent } from './home/home.component';<br/>import { PostComponent } from './post/post.component';<br/><br/>export const routes: Routes = [<br/>  {<br/>    path: '',<br/>    component: HomeComponent<br/>  },<br/>  {<br/>    path: 'post/:id',<br/>    component: PostComponent<br/>  }<br/>]</pre>
<p>The second route that points to <kbd>post</kbd> has a <kbd>:id</kbd> placeholder. This is used to define a dynamic route, which means that the value passed in as ID can be used to control the behavior of the mounted component.</p>
<p>Create the two components that we imported previously:</p>
<pre># Generate home component<br/>ng generate component home<br/><br/># Generate post component<br/>ng generate component post</pre>
<p>Update the <kbd>app</kbd> module to import the configured route, using <kbd>RouterModule</kbd>:</p>
<pre>import { BrowserModule } from '@angular/platform-browser';<br/>import { NgModule } from '@angular/core';<br/>import { RouterModule } from '@angular/router';<br/><br/>import { AppComponent } from './app.component';<br/>import { HomeComponent } from './home/home.component';<br/>import { PostComponent } from './post/post.component';<br/>import { BlogService } from './blog.service';<br/>import { routes } from './routes';<br/><br/><br/>@NgModule({<br/>  declarations: [<br/>    AppComponent,<br/>    HomeComponent,<br/>    PostComponent<br/>  ],<br/>  imports: [<br/>    BrowserModule,<br/>    RouterModule.forRoot(routes)<br/>  ],<br/>  providers: [<br/>    BlogService<br/>  ],<br/>  bootstrap: [AppComponent]<br/>})<br/>export class AppModule { }</pre>
<p>To mount the router, replace the entire content of the app component's template with the following markup:</p>
<pre>&lt;div class="wrapper"&gt;<br/>  &lt;router-outlet&gt;&lt;/router-outlet&gt;<br/>&lt;/div&gt;</pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Listing posts in the home component</h1>
                </header>
            
            <article>
                
<p>The home component that we are mounting on the home page is expected to show a list of posts. Therefore, it needs to interact with the blog service to do so. Update the class to the following:</p>
<pre>import { Component, OnInit } from '@angular/core';<br/>import { BlogService } from './../blog.service';<br/><br/>@Component({<br/>  selector: 'app-home',<br/>  templateUrl: './home.component.html',<br/>  styleUrls: ['./home.component.css']<br/>})<br/>export class HomeComponent implements OnInit {<br/>  <br/>  public posts;<br/>  constructor(<br/>    private blogService: BlogService<br/>  ) { }<br/><br/>  ngOnInit() {<br/>    this.posts = this.blogService.getPosts();<br/>  }<br/><br/>}</pre>
<p>The component depends on the <kbd>BlogService</kbd> class, which is resolved in the constructor. The <kbd>blogService</kbd> instance is then used to get the list of posts and pass it to the <kbd>posts</kbd> property. This property is what will be bound to the view.</p>
<p>To show these posts in the browser, we need to iterate over each of them and display them in the component's template:</p>
<pre>&lt;div class="cards"&gt;<br/>  &lt;div class="card" *ngFor="let post of posts"&gt;<br/>    &lt;div class="card-content"&gt;<br/>      &lt;img src="{{post.imageUrl}}" alt="{{post.author}}"&gt;<br/>      &lt;h4&gt;{{post.author}}&lt;/h4&gt;<br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/div&gt;</pre>
<p>Here is what it looks like when you run the app:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-356 image-border" height="763" src="assets/a2075f80-0926-4465-b4da-026e2b6aee94.png" width="1136"/></div>
<p>We need to define the behavior of interacting with the article cards. When the card is clicked, we could use a router link directive to navigate to the post page. However, because we have already seen that, let's use the second option, which is defining the behavior in a TypeScript method. First, add an event listener:</p>
<pre>&lt;div class="cards"&gt;<br/>  &lt;div class="card" *ngFor="let post of posts" (click)="showPost(post.id)"&gt;<br/>    ...<br/>  &lt;/div&gt;<br/>&lt;/div&gt;</pre>
<p>We intend to call the <kbd>showPost</kbd> method when the card is clicked. This method receives the ID of the clicked image. Here is the method implementation:</p>
<pre>import { Router } from '@angular/router';<br/><br/>...<br/>export class HomeComponent implements OnInit {<br/>  <br/>  public posts;<br/>  constructor(<br/>    private blogService: BlogService,<br/>    private router: Router<br/>  ) { }<br/><br/>  ngOnInit() {<br/>    this.posts = this.blogService.getPosts();<br/>  }<br/><br/>  showPost(id) {<br/>    this.router.navigate(['/post', id]);<br/>  }<br/><br/>}</pre>
<p>The <kbd>showPost</kbd> method uses the router's <kbd>navigate</kbd> method to move to a new route location.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Reading an article with the post component</h1>
                </header>
            
            <article>
                
<p>The post component just shows a single post with all the details. To display this single post, it receives the parameter from the URL and passes the parameter to the <kbd>byId</kbd> method in the blog service class:</p>
<pre>import { Component, OnInit } from '@angular/core';<br/>import { ActivatedRoute, ParamMap } from '@angular/router';<br/>import { BlogService } from './../blog.service';<br/><br/>@Component({<br/>  selector: 'app-post',<br/>  templateUrl: './post.component.html',<br/>  styleUrls: ['./post.component.css']<br/>})<br/>export class PostComponent implements OnInit {<br/><br/>  public post;<br/>  constructor(<br/>    private route: ActivatedRoute,<br/>    private blogService: BlogService,<br/>  ) { }<br/><br/>  ngOnInit() {<br/>    this.route.params.subscribe(params =&gt; {<br/>      this.post = this.blogService.byId(params.id)<br/>      console.log(this.post)<br/>   });<br/>  }<br/><br/>}</pre>
<p>The <kbd>ActivatedRoute</kbd> class exposes a <kbd>params</kbd> property, which is an Observable. You can subscribe to this Observable to get the parameters passed to a given route. We are setting the <kbd>post</kbd> property to the filtered value returned by the <kbd>byId</kbd> method.</p>
<p>Now, you can display the post in the template:</p>
<pre>&lt;div class="detail"&gt;<br/>  &lt;img src="{{post.imageUrl}}" alt=""&gt;<br/>  &lt;h2&gt;{{post.author}}&lt;/h2&gt;<br/>  <br/>  &lt;p&gt;{{post.content}}&lt;/p&gt;<br/>&lt;/div&gt;</pre>
<p>Open the app, and click on each of the cards. It should take you to their respective details page:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-357 image-border" height="734" src="assets/bdddddc5-5bb8-4bb6-8faf-13ea73664895.png" width="1143"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>Routing in Angular is important and can be a part of most of your everyday project. In such a case, it won't be a completely new concept to you. This is because this chapter has taught you some routing basics, building navigation and client routes, building a master-child view relationship, by developing a simple blogging system. In the next chapter, you will put some of what you have learned to build an app that actually uses a real and hosted data.</p>
<p class="mce-root"/>


            </article>

            
        </section>
    </body></html>
<html><head></head><body>
        <section>

                            <header>
                    <h1 class="header-title">Advanced Custom Components with TypeScript</h1>
                </header>
            
            <article>
                
<p class="mce-root">In the previous chapter, we discussed the basics of component creation and usage. This knowledge is not enough to build robust applications. We need to delve a little more deeply into Angular's exciting components and see how TypeScript makes working with components a lot easier.</p>
<p>We are going to address the following topics while showing some hands-on examples on how they work:</p>
<ul>
<li><strong>Lifecycle hooks</strong>: These are class methods in Angular that you can hook into. They are achievable by implementing a TypeScript interface.</li>
<li><strong>ElementRef</strong>: This involves manipulating and querying DOM safely in Angular using the ElementRef API.</li>
<li><strong>View encapsulation</strong>: You will learn how scoped styles are applied to Angular components and how to change the default behavior.</li>
</ul>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Lifecycle hooks</h1>
                </header>
            
            <article>
                
<p>Most methods you will create in classes must be called somewhere by you, which is the expected pattern in programming. This is not the case in what Angular defines as lifecycle hooks. These hooks are methods that you create for Angular to call them internally, depending on the current state of a component/directive. They are created in a component's or directive's class.</p>
<p>The following hooks are available in an Angular component:</p>
<ul>
<li><span><kbd>ngOnChanges</kbd>: Remember how properties are bound to components. These properties are reactive, meaning that, when they change, the view is updated as well. This lifecycle method is called when any property, bound to a view, is changed. Therefore, you can manipulate what happens before the changes are reflected.</span></li>
<li><span><kbd>ngOnInit</kbd>: This is the most common lifecycle. It is called after a component has been initialized with the default property bindings. Hence, it is called after the first <kbd>ngOnChanges</kbd>.</span></li>
<li><span><kbd>ngDoCheck</kbd>: Reactivity (change detection) is usually handled for you, but in extreme cases where it's not, you need to handle it yourself. Use <kbd>ngDoCheck</kbd> to detect and act upon changes that Angular can't or won't detect on its own.</span></li>
<li><kbd>ngAfterContentInit</kbd>: This is called after the component's content has been initialized.</li>
<li><kbd>ngAfterContentChecked</kbd>: This is called after every check on the component's content.</li>
<li><kbd>ngAfterViewInit</kbd>: This is called after initializing the view based on the component's template.</li>
<li><kbd>ngAfterViewChecked</kbd>: This is called after checking a component's view and the child views of a component.</li>
<li><kbd>ngOnDestroy</kbd>: This is called before a component is destroyed. This is a good place for a clean-up.</li>
</ul>
<p>Some lifecycle hooks may not make sense immediately. You shouldn't worry about them because it's only in extreme cases that you will need a lot of them.</p>
<p>An example will help clarify how they work. Let's explore the most common hook, which is <kbd>ngOnInit</kbd>. </p>
<p>Create a new Angular project with the CLI command. Open the app component TypeScript file and update the imports to include <kbd>OnInit</kbd>:</p>
<pre><span>// Code: 5.1<br/><span class="token p">//<span class="token tag"><span class="token punctuation">./src/app/app.component.ts</span></span></span><br/><br/>import</span><span> { </span><span>Component</span><span>, </span><span>OnInit</span><span> } </span><span>from</span><span> </span><span>'</span><span>@angular/core</span><span>'</span><span>;</span></pre>
<p><kbd>OnInit</kbd> is an interface that any class intended to implement <kbd>ngOnInit</kbd> should inherit. This is not technically required (see <a href="https://angular.io/guide/lifecycle-hooks#interfaces-are-optional-technically">https://angular.io/guide/lifecycle-hooks#interfaces-are-optional-technically</a>).</p>
<p>You can now make the <kbd>AppComponent</kbd> class implement this interface:</p>
<pre><span class="token p"><span>// Code: 5.1<br/></span>//<span class="token tag"><span class="token punctuation"><span>./src/app/app.component.ts</span></span></span><br/><br/>@Component({</span><span class="token lf"> <br/></span><span class="token p">  selector: 'app-root',</span><span class="token lf"> <br/></span><span class="token p">  templateUrl: './app.component.html',</span><span class="token lf">  <br/></span><span class="token p">  styleUrls: ['./app.component.css']</span><span class="token lf"> <br/></span><span class="token p">})</span><span class="token lf"> <br/></span><span class="token p">export class AppComponent implements OnInit {</span><span class="token lf"> <br/></span><span class="token p">  title: string = 'Items in Bag';</span><span class="token lf"> <br/></span><span class="token p">  items: Array<span class="token tag"><span class="token punctuation">&lt;</span>string<span class="token punctuation">&gt;</span></span> = [];</span><span class="token lf"> <br/></span><span class="token p">  loading: boolean = false;</span><span class="token lf"> </span><span class="token lf"> <br/></span><span class="token p">  ngOnInit () {</span><span class="token lf"> <br/></span><span class="token p">    this.loading = true;</span><span class="token lf"> </span><span class="token lf"> <br/></span><span class="token p">    setTimeout(() =&gt; {</span><span class="token lf"> <br/></span><span class="token p">      this.items = [</span><span class="token lf"> <br/></span><span class="token p">         'Pen',</span><span class="token lf"> <br/></span><span class="token p">         'Note',</span><span class="token lf"> <br/></span><span class="token p">         'Mug',</span><span class="token lf"> <br/></span><span class="token p">         'Charger',</span><span class="token lf"> <br/></span><span class="token p">         'Passport',</span><span class="token lf"> <br/></span><span class="token p">         'Keys'</span><span class="token lf"> <br/></span><span class="token p">      ]</span><span class="token lf"> <br/></span><span class="token p">     this.loading = false;</span><span class="token lf"> <br/></span><span class="token p">   }, 3000)</span><span class="token lf"> <br/></span><span class="token p"> }</span><span class="token lf"> <br/></span><span class="token p">}</span></pre>
<p>We are trying to simulate an asynchronous behavior, where values are resolved in the future. This kind of operation is best done when the application is initialized and that's why we are handling this in the <kbd>ngOnInit</kbd> method. Once the component is ready, Angular calls this hook, which will set the item array after three seconds.</p>
<p>We can bind the values to the view even before they come in. Angular will always update the view when the values are available:</p>
<pre><span class="token p"><span class="token tag"><span class="token punctuation"><span>&lt;!-- Code: 5.1 --&gt;<br/>&lt;!-- ./src/app/app.component.html --&gt;<br/></span><br/>&lt;</span>div <span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text-align:center<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span></span><span class="token lf"> </span><span class="token p"> <br/><span class="token tag"><span class="token punctuation">  &lt;</span>h1<span class="token punctuation">&gt;</span></span></span><span class="token lf"> </span><span class="token p"> {{title}}!!</span><span class="token lf"> </span><span class="token p"> <span class="token tag"><span class="token punctuation">&lt;/</span>h1<span class="token punctuation">&gt;</span></span></span><span class="token lf"> </span><span class="token p"> <br/>  &lt;h4 *ngIf="loading"&gt;Please wait...<span class="token tag"><span class="token punctuation">&lt;/</span>h4<span class="token punctuation">&gt;</span></span></span><span class="token lf"> </span><span class="token p"> <br/><span class="token tag"><span class="token punctuation">&lt;/</span>div<span class="token punctuation">&gt;</span></span></span><span class="token lf"> </span><span class="token p"> <br/><span class="token tag"><span class="token punctuation">&lt;</span>ul<span class="token punctuation">&gt;</span></span></span><span class="token lf"> </span><span class="token p"> <br/>  &lt;li *ngFor="let item of items"&gt;{{item}}<span class="token tag"><span class="token punctuation">&lt;/</span>li<span class="token punctuation">&gt;</span></span></span><span class="token lf"> </span><span class="token p"> <br/><span class="token tag"><span class="token punctuation">&lt;/</span>ul<span class="token punctuation">&gt;</span></span></span></pre>
<p>To iterate over a list in Angular templates, we use the <kbd>*ngFor</kbd> <strong>structural directive</strong>, as shown in the preceding example. The <kbd>*ngIf</kbd> structural directive is like <kbd>*ngFor</kbd> but is used to display DOM elements based on a Boolean property on the component.</p>
<p>As usual, run the app with <kbd>ng serve</kbd>, and you will see the following first:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-301 image-border" height="1102" src="assets/bb26d10d-0b15-4ab2-8574-b58bb9fa3fb3.png" width="1800"/></div>
<p>After three seconds, the <span class="packt_screen">Please wait...</span> text will disappear, and you will see your list of items:</p>
<div class="mce-root CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-302 image-border" height="1103" src="assets/2957cb42-5956-494d-80e4-428ed2e7fbb8.png" width="1800"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">DOM manipulation</h1>
                </header>
            
            <article>
                
<p>In Angular 1.x, <span>touching the DOM</span> seemed mysterious; not like you couldn't, but somehow it comes back to bite you. This is ironic because what we do as web designers/developers is paint the DOM, and that cannot be possible without manipulating it.</p>
<p>With Angular 2+, it became quite easy to do this. Angular abstracts the DOM and gives you the shallow copy to mess around with. It's then responsible for putting it back without hurting anyone. It becomes even more interesting with TypeScript because your editor can hint most of the DOM property methods for you.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">ElementRef</h1>
                </header>
            
            <article>
                
<p>The API to achieve Dom manipulation is <kbd>ElementRef</kbd>. Let's build a tab component that uses this API based on the basic demo on <a href="https://www.w3schools.com/howto/howto_js_tabs.asp">https://www.w3schools.com/howto/howto_js_tabs.asp</a>.</p>
<p>Start by generating a new component using the CLI generate command:</p>
<pre><strong>ng g component tab</strong></pre>
<p>Add the template as a child to our app component right after the <kbd>*ngFor</kbd> directive:</p>
<pre><span class="token p"><span class="token tag"><span class="token punctuation">&lt;</span>ul<span class="token punctuation">&gt;<br/></span></span></span><span class="token lf"> </span><span class="token p"> &lt;li *ngFor="let item of items"&gt;{{item}}<span class="token tag"><span class="token punctuation">&lt;/</span>li<span class="token punctuation">&gt;</span></span></span><span class="token lf"> </span><span class="token p"> <br/><span class="token tag"><span class="token punctuation">&lt;/</span>ul<span class="token punctuation">&gt;</span></span></span><span class="token lf"> </span><span class="token p"> <br/><br/>&lt;!--Add tab component to app--&gt;<br/><span class="token tag"><span class="token punctuation">&lt;</span>app-tab<span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token punctuation">&lt;/</span>app-tab<span class="token punctuation">&gt;</span></span></span></pre>
<p>Then, replace the component's template with the following:</p>
<pre><span class="token p"><span class="token tag"><span class="token punctuation">&lt;!--./src/app/tab/tab.component.css--&gt;<br/>&lt;</span>div <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tab<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span></span><span class="token lf"> </span><span class="token p"> <br/><span class="token tag"><span class="token punctuation">  &lt;</span>button <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tablink<span class="token punctuation">"</span></span> (<span class="token attr-name">click</span>)<span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>openTab($event, 'London')<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>London<span class="token tag"><span class="token punctuation">&lt;/</span>button<span class="token punctuation">&gt;</span></span></span><span class="token p"> <br/>  <span class="token tag"><span class="token punctuation">&lt;</span>button <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tablink<span class="token punctuation">"</span></span> (<span class="token attr-name">click</span>)<span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>openTab($event, 'Paris')<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Paris<span class="token tag"><span class="token punctuation">&lt;/</span>button<span class="token punctuation">&gt;<br/></span></span></span><span class="token lf"> </span><span class="token p"> <span class="token tag"><span class="token punctuation">&lt;</span>button <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tablink<span class="token punctuation">"</span></span> (<span class="token attr-name">click</span>)<span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>openTab($event, 'Tokyo')<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Tokyo<span class="token tag"><span class="token punctuation">&lt;/</span>button<span class="token punctuation">&gt;<br/></span></span></span><span class="token p"><span class="token tag"><span class="token punctuation">&lt;/</span>div<span class="token punctuation">&gt;<br/></span></span></span><span class="token p"><span class="token tag"><span class="token punctuation"><br/>&lt;</span>div <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>London<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tabcontent<span class="token punctuation">"</span></span><span class="token punctuation">&gt;<br/></span></span></span><span class="token lf"> </span><span class="token p"> <span class="token tag"><span class="token punctuation">&lt;</span>h3<span class="token punctuation">&gt;</span></span>London<span class="token tag"><span class="token punctuation">&lt;/</span>h3<span class="token punctuation">&gt;<br/></span></span></span><span class="token lf"> </span><span class="token p"> <span class="token tag"><span class="token punctuation">&lt;</span>p<span class="token punctuation">&gt;</span></span>London is the capital city of England.<span class="token tag"><span class="token punctuation">&lt;/</span>p<span class="token punctuation">&gt;<br/></span></span></span><span class="token p"><span class="token tag"><span class="token punctuation">&lt;/</span>div<span class="token punctuation">&gt;<br/></span></span></span><span class="token p"><span class="token tag"><span class="token punctuation">&lt;</span>div <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Paris<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tabcontent<span class="token punctuation">"</span></span><span class="token punctuation">&gt;<br/></span></span></span><span class="token lf"> </span><span class="token p"> <span class="token tag"><span class="token punctuation">&lt;</span>h3<span class="token punctuation">&gt;</span></span>Paris<span class="token tag"><span class="token punctuation">&lt;/</span>h3<span class="token punctuation">&gt;<br/></span></span></span><span class="token lf"> </span><span class="token p"> <span class="token tag"><span class="token punctuation">&lt;</span>p<span class="token punctuation">&gt;</span></span>Paris is the capital of France.<span class="token tag"><span class="token punctuation">&lt;/</span>p<span class="token punctuation">&gt;</span></span> </span><span class="token lf"> <br/></span><span class="token p"><span class="token tag"><span class="token punctuation">&lt;/</span>div<span class="token punctuation">&gt;<br/></span></span></span><span class="token p"><span class="token tag"><span class="token punctuation">&lt;</span>div <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>Tokyo<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tabcontent<span class="token punctuation">"</span></span><span class="token punctuation">&gt;<br/></span></span></span><span class="token lf">  </span><span class="token p"><span class="token tag"><span class="token punctuation">&lt;</span>h3<span class="token punctuation">&gt;</span></span>Tokyo<span class="token tag"><span class="token punctuation">&lt;/</span>h3<span class="token punctuation">&gt;<br/></span></span></span><span class="token lf">  </span><span class="token p"><span class="token tag"><span class="token punctuation">&lt;</span>p<span class="token punctuation">&gt;</span></span>Tokyo is the capital of Japan.<span class="token tag"><span class="token punctuation">&lt;/</span>p<span class="token punctuation">&gt;<br/></span></span></span><span class="token p"><span class="token tag"><span class="token punctuation">&lt;/</span>div<span class="token punctuation">&gt;</span></span></span></pre>
<p>You should see the result on the browser, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-303 image-border" height="1100" src="assets/efe4ce64-861d-47e5-8ea6-4df5f97d0c2a.png" width="1800"/></div>
<p>Let's add some styles to create a tabbed look:</p>
<pre><span class="token p">// based on styles from the base sample<br/><br/>/* ./src/app/tab/tab.component.css */<br/>div.tab {<br/></span><span class="token lf"> </span><span class="token p"> overflow: hidden;<br/></span><span class="token lf"> </span><span class="token p"> border: 1px solid #ccc;<br/></span><span class="token lf"> </span><span class="token p"> background-color: #f1f1f1;<br/></span><span class="token lf"> </span><span class="token p">}</span><span class="token lf"> <br/><br/></span><span class="token p">div.tab button {<br/></span><span class="token lf"> </span><span class="token p"> background-color: inherit;<br/></span><span class="token lf"> </span><span class="token p"> float: left;<br/></span><span class="token lf"> </span><span class="token p"> border: none;<br/></span><span class="token lf"> </span><span class="token p"> outline: none;<br/></span><span class="token lf"> </span><span class="token p"> cursor: pointer;<br/></span><span class="token lf"> </span><span class="token p"> padding: 14px 16px;<br/></span><span class="token lf"> </span><span class="token p"> transition: 0.3s;<br/></span><span class="token lf"> </span><span class="token p">}<br/><br/></span><span class="token p">div.tab button:hover {<br/></span><span class="token lf"> </span><span class="token p"> background-color: #ddd;<br/></span><span class="token lf"> </span><span class="token p">}</span><span class="token lf"> </span><span class="token lf"> </span><span class="token lf"> <br/><br/></span><span class="token p">div.tab button.active {<br/></span><span class="token lf"> </span><span class="token p"> background-color: #ccc;<br/></span><span class="token lf"> </span><span class="token p">}</span><span class="token lf"> </span><span class="token lf"> </span><span class="token lf"> <br/><br/></span><span class="token p">.tabcontent {</span><span class="token p"><br/></span><span class="token lf"> </span><span class="token p"> padding: 6px 12px;<br/></span><span class="token lf"> </span><span class="token p"> border: 1px solid #ccc;<br/></span><span class="token lf"> </span><span class="token p"> border-top: none;<br/></span><span class="token p">}</span></pre>
<p>With the styles, you should have the result shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-304 image-border" height="1100" src="assets/d1840279-66f0-47b0-a50b-d394bb9db2f7.png" width="1800"/></div>
<p>Now is the time to start manipulating the DOM. We <span>first </span>need to hide all the tab contents with CSS by default; then, they can be activated in TypeScript:</p>
<pre><span class="token p">.tabcontent {</span><span class="token lf"> </span><span class="token p"> <br/><span class="token em">  display: none;<br/></span></span><span class="token lf"> </span><span class="token p">}</span></pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Hooking into content initialization</h1>
                </header>
            
            <article>
                
<p>To be assured of gaining access to the DOM, we need to hook into the <kbd>ngAfterContentInit</kbd> lifecycle method. It's in this method that we can use <kbd>ElementRef</kbd> to query the DOM and manipulate it:</p>
<pre><span class="token p">import { Component, ElementRef, OnInit, AfterContentInit } from '@angular/core';</span><span class="token lf"> </span><span class="token lf"> <br/><br/></span><span class="token p">@Component({<br/></span><span class="token lf"> </span><span class="token p"> selector: 'app-tab',<br/></span><span class="token lf"> </span><span class="token p"> templateUrl: './tab.component.html',<br/></span><span class="token lf"> </span><span class="token p"> styleUrls: ['./tab.component.css']<br/></span><span class="token lf"> </span><span class="token p">})<br/></span><span class="token p"><br/>export class TabComponent implements OnInit, AfterContentInit {<br/></span><span class="token lf"> </span><span class="token p"> tabContents: Array<span class="token tag"><span class="token punctuation">&lt;</span>HTMLElement<span class="token punctuation">&gt;</span></span>;<br/></span><span class="token p">  tabLinks: Array<span class="token tag"><span class="token punctuation">&lt;</span>HTMLElement<span class="token punctuation">&gt;</span></span>;<br/></span><span class="token lf"> </span><span class="token lf"> <br/></span><span class="token p">  constructor(<br/></span><span class="token lf">   </span><span class="token p"> private el: ElementRef<br/></span><span class="token lf"> </span><span class="token p"> ) { }<br/><br/></span><span class="token lf"> </span><span class="token lf"> </span><span class="token p">ngOnInit() {}<br/><br/></span><span class="token lf"> </span><span class="token lf"> </span><span class="token p">ngAfterContentInit() {<br/>    // Grab the DOM<br/></span><span class="token lf">   </span><span class="token p"> this.tabContents = this.el.nativeElement.querySelectorAll('.tabcontent');<br/></span><span class="token lf"> </span><span class="token p">   this.tabLinks = this.el.nativeElement.querySelectorAll('.tablink');<br/></span><span class="token lf"> </span><span class="token lf"> </span><span class="token p"> }</span><span class="token lf"> </span><span class="token lf"> </span><span class="token p"> <br/></span><span class="token p">}</span><span class="token lf"> </span></pre>
<p>The class implements <kbd>AfterContentInit</kbd> as well as <kbd>OnInint</kbd>, showing how you can implement multiple interfaces. Then, we declare the buttons as an array of <kbd>HTMLElement</kbd> links. This also applies to the tab contents.</p>
<p>Right in the constructor, we create an instance of <kbd>ElementRef</kbd> as <kbd>el</kbd>, which we can use to interact with the DOM. The <kbd>ngAfterContentInit</kbd> function is called after the DOM contents are ready, which makes it the perfect candidate to handle DOM manipulations on startup. Hence, we grab a reference to the DOM there.</p>
<p>We need to show the first tab and make the first tab link active on load. Let's extend <kbd>ngAfterContentInit</kbd> to achieve this:</p>
<pre><span class="token p">export class TabComponent implements OnInit, AfterContentInit {<br/></span><span class="token lf"> </span><span class="token p"> </span><span class="token p">tabContents: Array<span class="token tag"><span class="token punctuation">&lt;</span>HTMLElement<span class="token punctuation">&gt;</span></span>;<br/></span><span class="token lf">  </span><span class="token p">tabLinks: Array<span class="token tag"><span class="token punctuation">&lt;</span>HTMLElement<span class="token punctuation">&gt;</span></span>;<br/></span><span class="token lf"> </span><span class="token lf"> </span><span class="token p">constructor(<br/></span><span class="token lf">    </span><span class="token p">private el: ElementRef<br/></span><span class="token lf"> </span><span class="token p"> ) { }<br/></span><span class="token lf"> </span><span class="token lf"> </span><span class="token p">ngOnInit() {}<br/></span><span class="token lf"> </span><span class="token p"> ngAfterContentInit() {<br/></span><span class="token lf">   </span><span class="token p"> this.tabContents = this.el.nativeElement.querySelectorAll('.tabcontent');<br/></span><span class="token lf">   </span><span class="token p"> this.tabLinks = this.el.nativeElement.querySelectorAll('.tablink');<br/>    <br/>    // Activate first tab<br/></span>  <br/>    this.tabContents[0].style.display = "block";<br/>    this.tabLinks[0].className = " active";<br/> }<span class="token p"><br/></span><span class="token p">}</span><span class="token lf"> </span></pre>
<p>This will display the first tab, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-305 image-border" height="1099" src="assets/3a5d38ec-7351-49ee-9953-c6d757d60159.png" width="1800"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Handling DOM events</h1>
                </header>
            
            <article>
                
<p>The final thing to do is add event listeners to the click events and start switching tabs. In the preceding template, we have click events attached to each button:</p>
<pre><span class="token p"><span class="token tag"><span class="token punctuation">&lt;</span>button <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tablink<span class="token punctuation">"</span></span> (<span class="token attr-name">click</span>)<span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"open</span>($event, 'London')<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>London<span class="token tag"><span class="token punctuation">&lt;/</span>button<span class="token punctuation">&gt;</span></span></span><span class="token p"> <br/><span class="token tag"><span class="token punctuation">&lt;</span>button <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tablink<span class="token punctuation">"</span></span> (<span class="token attr-name">click</span>)<span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>open($event, 'Paris')<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Paris<span class="token tag"><span class="token punctuation">&lt;/</span>button<span class="token punctuation">&gt;<br/></span></span></span><span class="token p"><span class="token tag"><span class="token punctuation">&lt;</span>button <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tablink<span class="token punctuation">"</span></span> (<span class="token attr-name">click</span>)<span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>open($event, 'Tokyo')<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Tokyo<span class="token tag"><span class="token punctuation">&lt;/</span>button<span class="token punctuation">&gt;</span></span></span></pre>
<p>The <kbd>openTab</kbd> method is the event handler. Let's implement it:</p>
<pre><span class="token p">export class TabComponent implements OnInit, AfterContentInit {<br/></span><span class="token lf"> </span><span class="token p"> </span><span class="token p">tabContents: Array<span class="token tag"><span class="token punctuation">&lt;</span>HTMLElement<span class="token punctuation">&gt;</span></span>;<br/></span><span class="token lf"> </span><span class="token p">tabLinks: Array<span class="token tag"><span class="token punctuation">&lt;</span>HTMLElement<span class="token punctuation">&gt;</span></span>;<br/></span><span class="token lf"> </span><span class="token lf"> </span><span class="token p">constructor(<br/></span><span class="token lf"> </span><span class="token p">private el: ElementRef<br/></span><span class="token lf"> </span><span class="token p"> ) { }<br/></span><span class="token lf"> </span><span class="token lf"> <br/></span><span class="token p">  // ...<br/></span><span class="token lf"> </span><span class="token lf"> </span><span class="token p"> <br/> open(evt, cityName) {<br/></span><span class="token lf"> </span><span class="token p">   for (let i = 0; i &lt; this.tabContents.length; i++) {<br/></span><span class="token lf"> </span><span class="token p">     this.tabContents[i].style.display = "none";<br/></span><span class="token lf">   </span><span class="token p"> }<br/></span><span class="token lf">   </span><span class="token p"> for (let i = 0; i &lt; this.tabLinks.length; i++) {<br/></span><span class="token lf"> </span><span class="token p">     this.tabLinks[i].className = this.tabLinks[i].className.replace(" active", "");<br/></span><span class="token lf">   </span><span class="token p"> }<br/></span><span class="token p">  </span><span class="token lf"> </span>this.el.nativeElement.querySelector(`#${cityName}`).style.display = "block"; <br/>   evt.currentTarget.className += " active"; <br/> <span class="token p">}<br/></span><span class="token p">}</span><span class="token lf"> </span></pre>
<p>When the method is called, we iterate over all the tabs and hide them. We also iterate over the buttons and disable them by replacing the active class with an empty string. Then, we can display the tab we want to open and activate the button that was clicked.</p>
<p>Now when you click tab buttons, each tab content is shown:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-306 image-border" height="1102" src="assets/a12abe97-05b9-4f8e-b94b-1872e0b45de8.png" width="1800"/></div>
<p>There are different ways to solve this, and some of them are more advanced. The example we just showed intentionally performs DOM querying to show you how possible and simple it is to do DOM manipulation in Angular.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">View encapsulation</h1>
                </header>
            
            <article>
                
<p>Components can be configured to apply styles differently. This concept is called encapsulation, and that's what we are going to discuss now.</p>
<p>Create another project with the CLI and add an extra component with the following command:</p>
<pre><strong>ng g component child</strong></pre>
<p>Then, add this new component to the view via the app component:</p>
<pre><span class="token p"><span class="token tag"><span class="token punctuation">// Code 5.2<br/>&lt;!-- ./src/app/app.component.html --&gt;<br/><br/>&lt;</span>div <span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text-align:center<span class="token punctuation">"</span></span><span class="token punctuation">&gt;<br/></span></span></span><span class="token lf"> </span><span class="token p"> <span class="token tag"><span class="token punctuation">&lt;</span>h1<span class="token punctuation">&gt;</span></span></span><span class="token lf"> </span><span class="token p"> This is parent component</span><span class="token lf"> </span><span class="token p"> <span class="token tag"><span class="token punctuation">&lt;/</span>h1<span class="token punctuation">&gt;<br/></span></span></span><span class="token lf"> </span><span class="token p"> <span class="token tag"><span class="token punctuation">&lt;</span>app-child<span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token punctuation">&lt;/</span>app-child<span class="token punctuation">&gt;</span></span></span><span class="token lf"> <br/></span><span class="token p"><span class="token tag"><span class="token punctuation">&lt;/</span>div<span class="token punctuation">&gt;</span></span></span><span class="token lf"> </span><span class="token lf"> </span></pre>
<p>The child component's template is as simple as this:</p>
<pre><span class="token p"><span class="token tag"><span class="token punctuation">// Code 5.2<br/>&lt;!-- ./src/app/child/child.component.html --&gt;<br/><br/>&lt;</span>h3<span class="token punctuation">&gt;</span></span></span><span class="token p">This is child component</span><span class="token lf"> </span><span class="token p"><span class="token tag"><span class="token punctuation">&lt;/</span>h3<span class="token punctuation">&gt;</span></span></span><span class="token lf"> </span></pre>
<p>That's just the minimum setup we need in order to understand view encapsulation strategies. Let's explore them.</p>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Emulated</h1>
                </header>
            
            <article>
                
<p>This is the default strategy. Any style applied globally via HTML (not the parent component) as well as all the styles applied to a component will be reflected. In our case, if we target <kbd>h3</kbd> and apply styles to <kbd>style.css</kbd>, <kbd>app.component.css</kbd>, and <kbd>child.component.css</kbd>, only <kbd>style.css</kbd> and <kbd>child.component.css</kbd> will be reflected.</p>
<p>The following CSS is the child component:</p>
<pre><span class="token p">h3 {</span><span class="token lf"> </span><span class="token p"> color: palevioletred</span><span class="token lf"> </span><span class="token p">}</span></pre>
<p><span>On running the preceding code, the result on the child component's view is as follows</span>:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-307 image-border" height="1100" src="assets/abbb916d-1ae6-4aee-9cda-0f950dd9478c.png" width="1800"/></div>
<p>In cases where the same styles are applied to the same element on both the global styles and the component itself, the component styles supersede the global style. For example, consider that the <kbd>style.css</kbd> file is as follows:</p>
<pre><span class="token p">h3 {<br/></span><span class="token lf"> </span><span class="token p"> color: palevioletred<br/></span><span class="token p">}</span></pre>
<p>Now consider that the <kbd>child.component.css</kbd> file is as follows:</p>
<pre><span class="token p">h3 {<br/></span><span class="token lf"> </span><span class="token p"> color: blueviolet<br/></span><span class="token p">}</span></pre>
<p>The <span>color of </span><kbd>h3</kbd> will be <kbd><span>blueviolet</span></kbd>, as shown in the following screenshot:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-308 image-border" height="869" src="assets/126071d5-858e-4373-b2e1-6fc6eb4833ef.png" width="1800"/></div>
<p>You can set this in the component decorator, though it is not necessary because <kbd>Emulated</kbd> is the default value:</p>
<pre><span class="token p">import { Component, OnInit, ViewEncapsulation } from '@angular/core';<br/><br/></span><span class="token p">@Component({<br/></span><span class="token lf"> </span><span class="token p"> selector: 'app-child',<br/>&lt;/span&gt;<span class="token lf"> </span><span class="token p"> templateUrl: './child.component.html',<br/></span><span class="token lf"> </span><span class="token p"> styleUrls: ['./child.component.css'],<br/>  // Encapsulation: Emulated<br/></span><span class="token lf"> </span><span class="token p"> encapsulation: ViewEncapsulation.Emulated<br/></span><span class="token p">})<br/></span><span class="token p"><br/>export class ChildComponent implements OnInit {<br/></span><span class="token lf"> </span><span class="token lf"> </span><span class="token p"> constructor() { }<br/></span><span class="token lf"> </span><span class="token lf"> </span><span class="token p"> ngOnInit() {</span><span class="token lf"> </span><span class="token p"> }<br/></span><span class="token p">}</span><span class="token lf"> </span></span></pre>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Native</h1>
                </header>
            
            <article>
                
<p>This strategy is like Emulated, but it disables global styles from entering the component. Leaving the style in the global style as it was, set the encapsulation to native:</p>
<pre><span class="token p">@Component({<br/></span><span class="token lf"> </span><span class="token p"> selector: 'app-child',<br/></span><span class="token lf"> </span><span class="token p"> templateUrl: './child.component.html',<br/></span><span class="token lf"> </span><span class="token p"> styleUrls: ['./child.component.css'],<br/> // Encapsulation: Native<br/></span><span class="token lf"> </span><span class="token p"> encapsulation: ViewEncapsulation.Native<br/></span><span class="token p">})</span></pre>
<p>Even though the global style sets the <kbd>h3</kbd> color to <kbd>pinkvioletred</kbd>, the text color remains black because it couldn't penetrate the template:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-309 image-border" height="871" src="assets/be23604f-c652-4997-8932-b8c986da9821.png" width="1800"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">None</h1>
                </header>
            
            <article>
                
<p>This is the freest strategy. No matter where the style is set--child or parent--the styles are leaked to the other components:</p>
<pre><span class="token p">@Component({<br/></span><span class="token lf"> </span><span class="token p"> selector: 'app-child',<br/></span><span class="token lf"> </span><span class="token p"> templateUrl: './child.component.html',<br/></span><span class="token lf"> </span><span class="token p"> styleUrls: ['./child.component.css'],<br/> // Encapsulation: Native<br/></span><span class="token lf"> </span><span class="token p"> encapsulation: ViewEncapsulation.None<br/></span><span class="token p">})</span></pre>
<p>With this setting, you can style the <kbd>h1</kbd> tag in the parent tag via the child component's styles:</p>
<pre><span class="token p">// child component style<br/>h1 {<br/></span><span class="token lf"> </span><span class="token p"> color: blueviolet<br/></span><span class="token p">}</span></pre>
<p>This reflects in the view, as shown in the following image:</p>
<div class="CDPAlignCenter CDPAlign"><img class="alignnone size-full wp-image-310 image-border" height="871" src="assets/8908367d-7c8c-4bed-ac17-821dbd48db1b.png" width="1800"/></div>


            </article>

            
        </section>
    

        <section>

                            <header>
                    <h1 class="header-title">Summary</h1>
                </header>
            
            <article>
                
<p>Hopefully, the advanced topics discussed were not so complex or difficult to comprehend. You learned how to implement lifecycle hooks, control the behavior of component-scoped styles, and manipulate the DOM content after it has been rendered.</p>
<p>If you take only one thing from this chapter, let it be how <span>to implement</span> the lifecycle interfaces with TypeScript and using TypeScript decorators to configure a component. In the next chapter, you will learn about component communication and how components interact with each other via properties, events, view children, and content children.</p>
<p class="mce-root"/>
<p class="mce-root"/>


            </article>

            
        </section>
    </body></html>
<html><head></head><body>
<div class="Basic-Text-Frame" id="_idContainer059">
<h1 class="chapterNumber"><span class="koboSpan" id="kobo.1.1">2</span></h1>
<h1 class="chapterTitle" id="_idParaDest-56"><span class="koboSpan" id="kobo.2.1">Working with Angular Directives and Built-In Control Flow</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.3.1">In this chapter, you’ll learn about Angular directives in depth, with a real-world example of using a directive that highlights text on searching. </span><span class="koboSpan" id="kobo.3.2">You’ll also write your first structural directive and see how the </span><code class="inlineCode"><span class="koboSpan" id="kobo.4.1">ViewContainer</span></code><span class="koboSpan" id="kobo.5.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.6.1">TemplateRef</span></code><span class="koboSpan" id="kobo.7.1"> services work together to add/remove elements from the </span><strong class="keyWord"><span class="koboSpan" id="kobo.8.1">Document Object Model</span></strong><span class="koboSpan" id="kobo.9.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.10.1">DOM</span></strong><span class="koboSpan" id="kobo.11.1">), just as</span><a id="_idIndexMarker102"/><span class="koboSpan" id="kobo.12.1"> in the case of </span><code class="inlineCode"><span class="koboSpan" id="kobo.13.1">*ngIf</span></code><span class="koboSpan" id="kobo.14.1">. </span><span class="koboSpan" id="kobo.14.2">You’ll also create some really cool attribute directives that do different tasks. </span><span class="koboSpan" id="kobo.14.3">Finally, you’ll learn how to use</span><a id="_idIndexMarker103"/><span class="koboSpan" id="kobo.15.1"> the </span><strong class="keyWord"><span class="koboSpan" id="kobo.16.1">Directive Composition API</span></strong><span class="koboSpan" id="kobo.17.1"> to apply multiple directives to the same element.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.18.1">Here are the recipes we’re going to cover in this chapter:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.19.1">Using attribute directives to handle the appearance of elements</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.20.1">Creating a directive to calculate the read time for articles</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.21.1">Creating a directive that allows you to vertically scroll to an element</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.22.1">Writing your first custom structural directive</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.23.1">How to apply multiple structural directives to the same element</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.24.1">Applying multiple directives to the same element using the Directive Composition API</span></li>
</ul>
<h1 class="heading-1" id="_idParaDest-57"><span class="koboSpan" id="kobo.25.1">Technical requirements</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.26.1">For the recipes in this chapter, ensure your setup is complete as per the 'Technical Requirements' in the 'Angular-Cookbook-2E' GitHub repository. </span><span class="koboSpan" id="kobo.26.2">For setup details, visit: </span><a href="https://github.com/PacktPublishing/Angular-Cookbook-2E/tree/main/docs/technical-requirements.md"><span class="url"><span class="koboSpan" id="kobo.27.1">https://github.com/PacktPublishing/Angular-Cookbook-2E/tree/main/docs/technical-requirements.md</span></span></a><span class="koboSpan" id="kobo.28.1">. </span><span class="koboSpan" id="kobo.28.2">The starter code for this chapter is located at </span><a href="https://github.com/PacktPublishing/Angular-Cookbook-2E/tree/main/start/apps/chapter02"><span class="url"><span class="koboSpan" id="kobo.29.1">https://github.com/PacktPublishing/Angular-Cookbook-2E/tree/main/start/apps/chapter02</span></span></a><span class="koboSpan" id="kobo.30.1">.</span></p>
<h1 class="heading-1" id="_idParaDest-58"><span class="koboSpan" id="kobo.31.1">Using attribute directives to handle the appearance of elements</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.32.1">In this recipe, you’ll work </span><a id="_idIndexMarker104"/><span class="koboSpan" id="kobo.33.1">with an Angular attribute directive named </span><strong class="keyWord"><span class="koboSpan" id="kobo.34.1">highlight</span></strong><span class="koboSpan" id="kobo.35.1">. </span><span class="koboSpan" id="kobo.35.2">With this directive, you’ll be able to search words and phrases within a paragraph and highlight them on the go. </span><span class="koboSpan" id="kobo.35.3">The whole </span><a id="_idIndexMarker105"/><span class="koboSpan" id="kobo.36.1">paragraph’s container background will also be changed when we have a search in action. </span><span class="koboSpan" id="kobo.36.2">For example, by using the following code:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.37.1">&lt;p </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.38.1">class</span></span><span class="koboSpan" id="kobo.39.1">=</span><span class="hljs-string"><span class="koboSpan" id="kobo.40.1">"text-content max-w-2xl m-auto"</span></span><span class="koboSpan" id="kobo.41.1"> appHighlight
  [highlightText]=</span><span class="hljs-string"><span class="koboSpan" id="kobo.42.1">"'de'"</span></span><span class="koboSpan" id="kobo.43.1">&gt;
  &lt;!--text here --&gt;
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.44.1">The result will appear as an output as shown in </span><em class="italic"><span class="koboSpan" id="kobo.45.1">Figure 2.1</span></em><span class="koboSpan" id="kobo.46.1">:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.47.1"><img alt="" role="presentation" src="../Images/B18469_02_01.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.48.1">Figure 2.1: The result when using the highlight directive</span></p>
<h2 class="heading-2" id="_idParaDest-59"><span class="koboSpan" id="kobo.49.1">Getting ready</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.50.1">The app that</span><a id="_idIndexMarker106"/><span class="koboSpan" id="kobo.51.1"> we are going to work </span><a id="_idIndexMarker107"/><span class="koboSpan" id="kobo.52.1">with resides in </span><code class="inlineCode"><span class="koboSpan" id="kobo.53.1">start/apps/chapter02/ng-attribute-directive</span></code><span class="koboSpan" id="kobo.54.1"> inside the cloned repository:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.55.1">Open the code repository in your code editor.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.56.1">Open the terminal, navigate to the code repository directory, and run the following command to serve the project:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.57.1">npm run serve ng-attribute-directive
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.58.1">This should open the app in a new browser tab, and you should see the following:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.59.1"><img alt="" role="presentation" src="../Images/B18469_02_02.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.60.1">Figure 2.2: ng-attribute-directive app running on http://localhost:4200</span></p> </li>
</ol>
<h2 class="heading-2" id="_idParaDest-60"><span class="koboSpan" id="kobo.61.1">How to do it…</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.62.1">The application has a search input and a paragraph of text. </span><span class="koboSpan" id="kobo.62.2">We want to be able to type a search query in the input so that we can highlight and find all the matching occurrences in the paragraph. </span><span class="koboSpan" id="kobo.62.3">Here are the steps to achieve this:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.63.1">We’ll create a property named </span><code class="inlineCode"><span class="koboSpan" id="kobo.64.1">searchText</span></code><span class="koboSpan" id="kobo.65.1"> in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.66.1">app.component.ts</span></code><span class="koboSpan" id="kobo.67.1"> file that we’ll use as a </span><code class="inlineCode"><span class="koboSpan" id="kobo.68.1">model</span></code><span class="koboSpan" id="kobo.69.1"> for the search-text input:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.70.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.71.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.72.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.73.1">AppComponent</span></span><span class="koboSpan" id="kobo.74.1"> {
  searchText = </span><span class="hljs-string"><span class="koboSpan" id="kobo.75.1">''</span></span><span class="koboSpan" id="kobo.76.1">;
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.77.1">Then, we use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.78.1">searchText</span></code><span class="koboSpan" id="kobo.79.1"> property in the template, i.e., in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.80.1">app.component.html</span></code><span class="koboSpan" id="kobo.81.1"> file, with the search input as an </span><code class="inlineCode"><span class="koboSpan" id="kobo.82.1">ngModel</span></code><span class="koboSpan" id="kobo.83.1">, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.84.1">...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.85.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.86.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.87.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.88.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.89.1">"content"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.90.1">role</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.91.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.92.1">"main"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.93.1">&gt;</span></span><span class="koboSpan" id="kobo.94.1">
  ...
     </span><span class="hljs-tag"><span class="koboSpan" id="kobo.95.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.96.1">input</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.97.1"> [(</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.98.1">ngModel</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.99.1">)]=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.100.1">"searchText"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.101.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.102.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.103.1">"text"</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.104.1">placeholder</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.105.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.106.1">"Quick Search..."</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.107.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.108.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.109.1">"pr-4 !pl-10</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.110.1">py-2"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.111.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.112.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.113.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.114.1">&gt;</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.115.1">You </span><a id="_idIndexMarker108"/><span class="koboSpan" id="kobo.116.1">will notice that </span><code class="inlineCode"><span class="koboSpan" id="kobo.117.1">ngModel</span></code><span class="koboSpan" id="kobo.118.1"> doesn’t work yet. </span><span class="koboSpan" id="kobo.118.2">This is because we’re missing the </span><code class="inlineCode"><span class="koboSpan" id="kobo.119.1">FormsModule</span></code><span class="koboSpan" id="kobo.120.1"> in </span><a id="_idIndexMarker109"/><span class="koboSpan" id="kobo.121.1">our application. </span><span class="koboSpan" id="kobo.121.2">Let’s import it into the </span><code class="inlineCode"><span class="koboSpan" id="kobo.122.1">app.component.ts</span></code><span class="koboSpan" id="kobo.123.1"> file as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.124.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.125.1">import</span></span><span class="koboSpan" id="kobo.126.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.127.1">FormsModule</span></span><span class="koboSpan" id="kobo.128.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.129.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.130.1">'@angular/forms'</span></span><span class="koboSpan" id="kobo.131.1">;
 @</span><span class="hljs-title"><span class="koboSpan" id="kobo.132.1">Component</span></span><span class="koboSpan" id="kobo.133.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.134.1">selector</span></span><span class="koboSpan" id="kobo.135.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.136.1">'app-root'</span></span><span class="koboSpan" id="kobo.137.1">,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.138.1">templateUrl</span></span><span class="koboSpan" id="kobo.139.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.140.1">'./app.component.html'</span></span><span class="koboSpan" id="kobo.141.1">,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.142.1">standalone</span></span><span class="koboSpan" id="kobo.143.1">: </span><span class="hljs-literal"><span class="koboSpan" id="kobo.144.1">true</span></span><span class="koboSpan" id="kobo.145.1">,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.146.1">styleUrls</span></span><span class="koboSpan" id="kobo.147.1">: [</span><span class="hljs-string"><span class="koboSpan" id="kobo.148.1">'./app.component.scss'</span></span><span class="koboSpan" id="kobo.149.1">],
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.150.1">imports</span></span><span class="koboSpan" id="kobo.151.1">: [</span><span class="hljs-title"><span class="koboSpan" id="kobo.152.1">CommonModule</span></span><span class="koboSpan" id="kobo.153.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.154.1">RouterModule</span></span><span class="koboSpan" id="kobo.155.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.156.1">FormsModule</span></span><span class="koboSpan" id="kobo.157.1">],
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.158.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.159.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.160.1">AppComponent</span></span><span class="koboSpan" id="kobo.161.1"> {
  searchText = </span><span class="hljs-string"><span class="koboSpan" id="kobo.162.1">''</span></span><span class="koboSpan" id="kobo.163.1">;
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.164.1">Now, we’ll create an attribute directive named </span><code class="inlineCode"><span class="koboSpan" id="kobo.165.1">highlight</span></code><span class="koboSpan" id="kobo.166.1"> by using the following command from the workspace root:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.167.1">cd start &amp;&amp; nx g directive highlight --directory apps/chapter02/ng-attribute-directive/src/app --standalone
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.168.1">If asked, choose the </span><code class="inlineCode"><span class="koboSpan" id="kobo.169.1">@nx/angular:directive schematics</span></code><span class="koboSpan" id="kobo.170.1"> and choose the “As provided” action. </span><span class="koboSpan" id="kobo.170.2">The preceding command generates a standalone directive that has a selector called </span><code class="inlineCode"><span class="koboSpan" id="kobo.171.1">appHighlight</span></code><span class="koboSpan" id="kobo.172.1">. </span><span class="koboSpan" id="kobo.172.2">See the </span><em class="italic"><span class="koboSpan" id="kobo.173.1">How it works…</span></em><span class="koboSpan" id="kobo.174.1"> section for why that happens, and for a brief explanation of the standalone API.</span></p></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="5"><span class="koboSpan" id="kobo.175.1">Now that we have the directive in place, we’ll create two inputs for the directive to be passed from </span><code class="inlineCode"><span class="koboSpan" id="kobo.176.1">AppComponent</span></code><span class="koboSpan" id="kobo.177.1"> (from </span><code class="inlineCode"><span class="koboSpan" id="kobo.178.1">app.component.html</span></code><span class="koboSpan" id="kobo.179.1">)—one for the search text and another for the highlight color. </span><span class="koboSpan" id="kobo.179.2">The code should look like this in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.180.1">highlight.directive.ts</span></code><span class="koboSpan" id="kobo.181.1"> file:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.182.1">import</span></span><span class="koboSpan" id="kobo.183.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.184.1">Directive</span></span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.185.1">, </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.186.1">Input</span></strong></span><span class="koboSpan" id="kobo.187.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.188.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.189.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.190.1">;
@</span><span class="hljs-title"><span class="koboSpan" id="kobo.191.1">Directive</span></span><span class="koboSpan" id="kobo.192.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.193.1">selector</span></span><span class="koboSpan" id="kobo.194.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.195.1">'[appHighlight]'</span></span><span class="koboSpan" id="kobo.196.1">,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.197.1">standalone</span></span><span class="koboSpan" id="kobo.198.1">: </span><span class="hljs-literal"><span class="koboSpan" id="kobo.199.1">true</span></span><span class="koboSpan" id="kobo.200.1">
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.201.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.202.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.203.1">HighlightDirective</span></span><span class="koboSpan" id="kobo.204.1"> {
  </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.205.1">@</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.206.1">Input</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.207.1">() highlightText = </span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.208.1">''</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.209.1">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.210.1">@</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.211.1">Input</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.212.1">() highlightColor = </span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.213.1">'yellow'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.214.1">;</span></strong></span><span class="koboSpan" id="kobo.215.1">
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.216.1">Let’s use</span><a id="_idIndexMarker110"/><span class="koboSpan" id="kobo.217.1"> the </span><code class="inlineCode"><span class="koboSpan" id="kobo.218.1">appHighlight</span></code><span class="koboSpan" id="kobo.219.1"> directive in </span><code class="inlineCode"><span class="koboSpan" id="kobo.220.1">app.component.html</span></code><span class="koboSpan" id="kobo.221.1"> and pass the </span><code class="inlineCode"><span class="koboSpan" id="kobo.222.1">searchText</span></code><span class="koboSpan" id="kobo.223.1"> model from there</span><a id="_idIndexMarker111"/><span class="koboSpan" id="kobo.224.1"> to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.225.1">appHighlight</span></code><span class="koboSpan" id="kobo.226.1"> directive as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.227.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.228.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.229.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.230.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.231.1">"content"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.232.1">role</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.233.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.234.1">"main"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.235.1">&gt;</span></span><span class="koboSpan" id="kobo.236.1">
  ...
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.237.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.238.1">p</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.239.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.240.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.241.1">"text-content"</span></span><span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.242.1">appHighlight</span></strong></span>
<span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.243.1">[</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.244.1">highlightText</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.245.1">]=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.246.1">"searchText"</span></strong></span><span class="hljs-tag"><span class="koboSpan" id="kobo.247.1">&gt;</span></span><span class="koboSpan" id="kobo.248.1">
    ...
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.249.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.250.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.251.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.252.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.253.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.254.1">&gt;</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.255.1">We’ll listen to the input changes now for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.256.1">searchText</span></code><span class="koboSpan" id="kobo.257.1"> input, using </span><code class="inlineCode"><span class="koboSpan" id="kobo.258.1">ngOnChanges</span></code><span class="koboSpan" id="kobo.259.1">. </span><span class="koboSpan" id="kobo.259.2">Please see the </span><em class="italic"><span class="koboSpan" id="kobo.260.1">Using ngOnChanges to intercept input property changes</span></em><span class="koboSpan" id="kobo.261.1"> recipe in </span><em class="chapterRef"><span class="koboSpan" id="kobo.262.1">Chapter 1</span></em><span class="koboSpan" id="kobo.263.1">, </span><em class="italic"><span class="koboSpan" id="kobo.264.1">Winning Component Communication</span></em><span class="koboSpan" id="kobo.265.1">, for how to listen to input changes. </span><span class="koboSpan" id="kobo.265.2">For now, we’ll only do a </span><code class="inlineCode"><span class="koboSpan" id="kobo.266.1">console.log</span></code><span class="koboSpan" id="kobo.267.1"> when the input changes. </span><span class="koboSpan" id="kobo.267.2">Let’s update the </span><code class="inlineCode"><span class="koboSpan" id="kobo.268.1">highlight.directive.ts</span></code><span class="koboSpan" id="kobo.269.1"> as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.270.1">import</span></span><span class="koboSpan" id="kobo.271.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.272.1">Directive</span></span><span class="koboSpan" id="kobo.273.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.274.1">Input</span></span><span class="koboSpan" id="kobo.275.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.276.1">OnChanges</span></span><span class="koboSpan" id="kobo.277.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.278.1">SimpleChanges</span></span><span class="koboSpan" id="kobo.279.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.280.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.281.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.282.1">@angular/core'</span></span><span class="koboSpan" id="kobo.283.1">;
...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.284.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.285.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.286.1">HighlightDirective</span></span><span class="koboSpan" id="kobo.287.1"> implements </span><span class="hljs-title"><span class="koboSpan" id="kobo.288.1">OnChanges</span></span><span class="koboSpan" id="kobo.289.1"> {
  @</span><span class="hljs-title"><span class="koboSpan" id="kobo.290.1">Input</span></span><span class="koboSpan" id="kobo.291.1">() highlightText = </span><span class="hljs-string"><span class="koboSpan" id="kobo.292.1">''</span></span><span class="koboSpan" id="kobo.293.1">;
  @</span><span class="hljs-title"><span class="koboSpan" id="kobo.294.1">Input</span></span><span class="koboSpan" id="kobo.295.1">() highlightColor = </span><span class="hljs-string"><span class="koboSpan" id="kobo.296.1">'yellow'</span></span><span class="koboSpan" id="kobo.297.1">;
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.298.1">ngOnChanges</span></span><span class="koboSpan" id="kobo.299.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.300.1">changes: SimpleChanges</span></span><span class="koboSpan" id="kobo.301.1">) {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.302.1">if</span></span><span class="koboSpan" id="kobo.303.1"> (changes[</span><span class="hljs-string"><span class="koboSpan" id="kobo.304.1">'highlightText'</span></span><span class="koboSpan" id="kobo.305.1">]?.</span><span class="hljs-property"><span class="koboSpan" id="kobo.306.1">firstChange</span></span><span class="koboSpan" id="kobo.307.1">) {
      </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.308.1">return</span></span><span class="koboSpan" id="kobo.309.1">;
    }
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.310.1">const</span></span><span class="koboSpan" id="kobo.311.1"> { currentValue } = changes[</span><span class="hljs-string"><span class="koboSpan" id="kobo.312.1">'highlightText'</span></span><span class="koboSpan" id="kobo.313.1">];
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.314.1">console</span></span><span class="koboSpan" id="kobo.315.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.316.1">log</span></span><span class="koboSpan" id="kobo.317.1">({ currentValue });
  }
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.318.1">If you type</span><a id="_idIndexMarker112"/><span class="koboSpan" id="kobo.319.1"> in the search input and see the console logs, you’ll see the new value being logged whenever you change the value.</span></p></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="8"><span class="koboSpan" id="kobo.320.1">Now, we’ll </span><a id="_idIndexMarker113"/><span class="koboSpan" id="kobo.321.1">write the logic for highlighting the search text. </span><span class="koboSpan" id="kobo.321.2">We’ll first import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.322.1">ElementRef</span></code><span class="koboSpan" id="kobo.323.1"> service so that we can get access to the template element on which our directive is applied. </span><span class="koboSpan" id="kobo.323.2">Here’s how we’ll do this:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.324.1">import</span></span><span class="koboSpan" id="kobo.325.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.326.1">Directive</span></span><span class="koboSpan" id="kobo.327.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.328.1">Input</span></span><span class="koboSpan" id="kobo.329.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.330.1">SimpleChanges</span></span><span class="koboSpan" id="kobo.331.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.332.1">OnChanges</span></span><span class="koboSpan" id="kobo.333.1">, </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.334.1">ElementRef</span></strong></span><span class="koboSpan" id="kobo.335.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.336.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.337.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.338.1">;
@</span><span class="hljs-title"><span class="koboSpan" id="kobo.339.1">Directive</span></span><span class="koboSpan" id="kobo.340.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.341.1">selector</span></span><span class="koboSpan" id="kobo.342.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.343.1">'[appHighlight]'</span></span><span class="koboSpan" id="kobo.344.1">
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.345.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.346.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.347.1">HighlightDirective</span></span><span class="koboSpan" id="kobo.348.1"> implements </span><span class="hljs-title"><span class="koboSpan" id="kobo.349.1">OnChanges</span></span><span class="koboSpan" id="kobo.350.1"> {
  @</span><span class="hljs-title"><span class="koboSpan" id="kobo.351.1">Input</span></span><span class="koboSpan" id="kobo.352.1">() highlightText = </span><span class="hljs-string"><span class="koboSpan" id="kobo.353.1">''</span></span><span class="koboSpan" id="kobo.354.1">;
  @</span><span class="hljs-title"><span class="koboSpan" id="kobo.355.1">Input</span></span><span class="koboSpan" id="kobo.356.1">() highlightColor = </span><span class="hljs-string"><span class="koboSpan" id="kobo.357.1">'yellow'</span></span><span class="koboSpan" id="kobo.358.1">;
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.359.1">constructor</span></span><span class="koboSpan" id="kobo.360.1">(</span><span class="code-highlight"><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.361.1">private el: ElementRef</span></strong></span><span class="koboSpan" id="kobo.362.1">) { }
  ...
</span><span class="koboSpan" id="kobo.362.2">}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.363.1">Now we’ll replace every matching text in our </span><code class="inlineCode"><span class="koboSpan" id="kobo.364.1">el</span></code><span class="koboSpan" id="kobo.365.1"> element with a custom </span><code class="inlineCode"><span class="koboSpan" id="kobo.366.1">&lt;span&gt;</span></code><span class="koboSpan" id="kobo.367.1"> tag with some hardcoded styles. </span><span class="koboSpan" id="kobo.367.2">Update your </span><code class="inlineCode"><span class="koboSpan" id="kobo.368.1">ngOnChanges</span></code><span class="koboSpan" id="kobo.369.1"> code in </span><code class="inlineCode"><span class="koboSpan" id="kobo.370.1">highlight.directive.ts</span></code><span class="koboSpan" id="kobo.371.1"> as follows, and see the result:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.372.1">ngOnChanges</span></span><span class="koboSpan" id="kobo.373.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.374.1">changes: SimpleChanges</span></span><span class="koboSpan" id="kobo.375.1">) {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.376.1">if</span></span><span class="koboSpan" id="kobo.377.1"> (changes.</span><span class="hljs-property"><span class="koboSpan" id="kobo.378.1">highlightText</span></span><span class="koboSpan" id="kobo.379.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.380.1">firstChange</span></span><span class="koboSpan" id="kobo.381.1">) {
      </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.382.1">return</span></span><span class="koboSpan" id="kobo.383.1">;
    }
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.384.1">const</span></span><span class="koboSpan" id="kobo.385.1"> { currentValue } = changes.</span><span class="hljs-property"><span class="koboSpan" id="kobo.386.1">highlightText</span></span><span class="koboSpan" id="kobo.387.1">;
    </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.388.1">if</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.389.1"> (currentValue) {</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.390.1">const</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.391.1"> regExp = </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.392.1">new</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.393.1">RegExp</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.394.1">(</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.395.1">`(</span></strong><strong class="hljs-subst-slc"><span class="koboSpan" id="kobo.396.1">${currentValue}</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.397.1">)`</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.398.1">,</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.399.1">'gi'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.400.1">)</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.401.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.402.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.403.1">el</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.404.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.405.1">nativeElement</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.406.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.407.1">innerHTML</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.408.1"> = </span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.409.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.410.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.411.1">el</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.412.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.413.1">nativeElement</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.414.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.415.1">innerHTML</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.416.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.417.1">replace</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.418.1">(regExp, </span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.419.1">`&lt;span</span></strong></span>
<span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.420.1">style="background-color: </span></strong><strong class="hljs-subst-slc"><span class="koboSpan" id="kobo.421.1">${</span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.422.1">this</span></strong><strong class="hljs-subst-slc"><span class="koboSpan" id="kobo.423.1">.highlightColor}</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.424.1">"</span></strong></span>
<span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.425.1">&gt;\$1&lt;/span&gt;`</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.426.1">)</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.427.1">}</span></strong></span><span class="koboSpan" id="kobo.428.1">
}
</span></code></pre>
<div class="packt_tip">
<p class="normal"><span class="koboSpan" id="kobo.429.1">TIP</span></p>
<p class="normal"><span class="koboSpan" id="kobo.430.1">You’ll notice that if you type a word, it will still show only one letter highlighted. </span><span class="koboSpan" id="kobo.430.2">That’s because whenever we replace the </span><code class="inlineCode"><span class="koboSpan" id="kobo.431.1">innerHTML</span></code><span class="koboSpan" id="kobo.432.1"> property, we end up changing the original text. </span><span class="koboSpan" id="kobo.432.2">Let’s fix that in the next step.</span></p>
</div> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="10"><span class="koboSpan" id="kobo.433.1">To keep the</span><a id="_idIndexMarker114"/><span class="koboSpan" id="kobo.434.1"> original </span><a id="_idIndexMarker115"/><span class="koboSpan" id="kobo.435.1">text intact, let’s create a property named </span><code class="inlineCode"><span class="koboSpan" id="kobo.436.1">originalHTML</span></code><span class="koboSpan" id="kobo.437.1"> and assign an initial value to it on the first change. </span><span class="koboSpan" id="kobo.437.2">We’ll also use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.438.1">originalHTML</span></code><span class="koboSpan" id="kobo.439.1"> property while replacing the values:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.440.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.441.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.442.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.443.1">HighlightDirective</span></span><span class="koboSpan" id="kobo.444.1"> implements </span><span class="hljs-title"><span class="koboSpan" id="kobo.445.1">OnChanges</span></span><span class="koboSpan" id="kobo.446.1"> {
  @</span><span class="hljs-title"><span class="koboSpan" id="kobo.447.1">Input</span></span><span class="koboSpan" id="kobo.448.1">() highlightText = </span><span class="hljs-string"><span class="koboSpan" id="kobo.449.1">''</span></span><span class="koboSpan" id="kobo.450.1">;
  @</span><span class="hljs-title"><span class="koboSpan" id="kobo.451.1">Input</span></span><span class="koboSpan" id="kobo.452.1">() highlightColor = </span><span class="hljs-string"><span class="koboSpan" id="kobo.453.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.454.1">yellow'</span></span><span class="koboSpan" id="kobo.455.1">;
  </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.456.1">originalHTML = </span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.457.1">''</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.458.1">;</span></strong></span>
<span class="hljs-title"><span class="koboSpan" id="kobo.459.1">constructor</span></span><span class="koboSpan" id="kobo.460.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.461.1">private el: ElementRef</span></span><span class="koboSpan" id="kobo.462.1">) { }
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.463.1">ngOnChanges</span></span><span class="koboSpan" id="kobo.464.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.465.1">changes: SimpleChanges</span></span><span class="koboSpan" id="kobo.466.1">) {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.467.1">if</span></span><span class="koboSpan" id="kobo.468.1"> (changes.</span><span class="hljs-property"><span class="koboSpan" id="kobo.469.1">highlightText</span></span><span class="koboSpan" id="kobo.470.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.471.1">firstChange</span></span><span class="koboSpan" id="kobo.472.1">) {
      </span><span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.473.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.474.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.475.1">originalHTML</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.476.1"> = </span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.477.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.478.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.479.1">el</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.480.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.481.1">nativeElement</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.482.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.483.1">innerHTML</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.484.1">;</span></strong></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.485.1">return</span></span><span class="koboSpan" id="kobo.486.1">;
    }
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.487.1">const</span></span><span class="koboSpan" id="kobo.488.1"> { currentValue } = changes.</span><span class="hljs-property"><span class="koboSpan" id="kobo.489.1">highlightText</span></span><span class="koboSpan" id="kobo.490.1">;
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.491.1">if</span></span><span class="koboSpan" id="kobo.492.1"> (currentValue) {
      </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.493.1">const</span></span><span class="koboSpan" id="kobo.494.1"> regExp = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.495.1">new</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.496.1">RegExp</span></span><span class="koboSpan" id="kobo.497.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.498.1">`(</span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.499.1">${currentValue}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.500.1">)`</span></span><span class="koboSpan" id="kobo.501.1">,</span><span class="hljs-string"><span class="koboSpan" id="kobo.502.1">'gi'</span></span><span class="koboSpan" id="kobo.503.1">)
      </span><span class="hljs-variable"><span class="koboSpan" id="kobo.504.1">this</span></span><span class="koboSpan" id="kobo.505.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.506.1">el</span></span><span class="koboSpan" id="kobo.507.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.508.1">nativeElement</span></span><span class="koboSpan" id="kobo.509.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.510.1">innerHTML</span></span><span class="koboSpan" id="kobo.511.1"> = </span><span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.512.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.513.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.514.1">originalHTML</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.515.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.516.1">replace</span></strong></span><span class="koboSpan" id="kobo.517.1">(regExp, </span><span class="hljs-string"><span class="koboSpan" id="kobo.518.1">`&lt;span style="background-color:</span></span>
<span class="hljs-subst"><span class="koboSpan" id="kobo.519.1">${</span></span><span class="hljs-variable"><span class="koboSpan" id="kobo.520.1">this</span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.521.1">.highlightColor}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.522.1">"&gt;\$1&lt;/span&gt;`</span></span><span class="koboSpan" id="kobo.523.1">)
    }
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.524.1">Now, we’ll write some logic to reset everything back to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.525.1">originalHTML</span></code><span class="koboSpan" id="kobo.526.1"> property when we remove our search query (when the search text is empty). </span><span class="koboSpan" id="kobo.526.2">In order to do so, let’s add an </span><code class="inlineCode"><span class="koboSpan" id="kobo.527.1">else</span></code><span class="koboSpan" id="kobo.528.1"> condition, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.529.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.530.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.531.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.532.1">HighlightDirective</span></span><span class="koboSpan" id="kobo.533.1"> implements </span><span class="hljs-title"><span class="koboSpan" id="kobo.534.1">OnChanges</span></span><span class="koboSpan" id="kobo.535.1"> {
  ...
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.536.1">ngOnChanges</span></span><span class="koboSpan" id="kobo.537.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.538.1">changes: SimpleChanges</span></span><span class="koboSpan" id="kobo.539.1">) {
   ...
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.540.1">if</span></span><span class="koboSpan" id="kobo.541.1"> (currentValue) {
      </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.542.1">const</span></span><span class="koboSpan" id="kobo.543.1"> regExp = </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.544.1">new</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.545.1">RegExp</span></span><span class="koboSpan" id="kobo.546.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.547.1">`(</span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.548.1">${currentValue}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.549.1">)`</span></span><span class="koboSpan" id="kobo.550.1">,</span><span class="hljs-string"><span class="koboSpan" id="kobo.551.1">'gi'</span></span><span class="koboSpan" id="kobo.552.1">)
      </span><span class="hljs-variable"><span class="koboSpan" id="kobo.553.1">this</span></span><span class="koboSpan" id="kobo.554.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.555.1">el</span></span><span class="koboSpan" id="kobo.556.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.557.1">nativeElement</span></span><span class="koboSpan" id="kobo.558.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.559.1">innerHTML</span></span><span class="koboSpan" id="kobo.560.1"> = </span><span class="hljs-variable"><span class="koboSpan" id="kobo.561.1">this</span></span><span class="koboSpan" id="kobo.562.1">.originalHTML
        .</span><span class="hljs-title"><span class="koboSpan" id="kobo.563.1">replace</span></span><span class="koboSpan" id="kobo.564.1">(regExp, </span><span class="hljs-string"><span class="koboSpan" id="kobo.565.1">`</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.566.1">&lt;span       style="background-</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.567.1">color: </span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.568.1">${</span></span><span class="hljs-variable"><span class="koboSpan" id="kobo.569.1">this</span></span><span class="hljs-subst"><span class="koboSpan" id="kobo.570.1">.highlightColor}</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.571.1">"&gt;\$1&lt;/span&gt;`</span></span><span class="koboSpan" id="kobo.572.1">)
    } </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.573.1">else</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.574.1"> {</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.575.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.576.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.577.1">el</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.578.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.579.1">nativeElement</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.580.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.581.1">innerHTML</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.582.1"> =</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.583.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.584.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.585.1">originalHTML</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.586.1">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.587.1">}</span></strong></span><span class="koboSpan" id="kobo.588.1">
  }
}
</span></code></pre>
</li>
</ol>
<h2 class="heading-2" id="_idParaDest-61"><span class="koboSpan" id="kobo.589.1">How it works…</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.590.1">We </span><a id="_idIndexMarker116"/><span class="koboSpan" id="kobo.591.1">created an attribute directive</span><a id="_idIndexMarker117"/><span class="koboSpan" id="kobo.592.1"> named </span><code class="inlineCode"><span class="koboSpan" id="kobo.593.1">highlight</span></code><span class="koboSpan" id="kobo.594.1"> (</span><code class="inlineCode"><span class="koboSpan" id="kobo.595.1">appHighlight</span></code><span class="koboSpan" id="kobo.596.1">) that takes two inputs: </span><code class="inlineCode"><span class="koboSpan" id="kobo.597.1">highlightText</span></code><span class="koboSpan" id="kobo.598.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.599.1">highlightColor</span></code><span class="koboSpan" id="kobo.600.1">. </span><span class="koboSpan" id="kobo.600.2">The directive listens to the input changes for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.601.1">highlightText</span></code><span class="koboSpan" id="kobo.602.1"> input using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.603.1">SimpleChanges</span></code><span class="koboSpan" id="kobo.604.1"> from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.605.1">ngOnChanges</span></code><span class="koboSpan" id="kobo.606.1"> life cycle hook by Angular. </span><span class="koboSpan" id="kobo.606.2">Every property in this </span><code class="inlineCode"><span class="koboSpan" id="kobo.607.1">SimpleChanges</span></code><span class="koboSpan" id="kobo.608.1"> object is a </span><code class="inlineCode"><span class="koboSpan" id="kobo.609.1">SimpleChange</span></code><span class="koboSpan" id="kobo.610.1"> object that contains the following properties:</span></p>
<ul>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.611.1">previousValue</span></code><span class="koboSpan" id="kobo.612.1">: any</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.613.1">currentValue</span></code><span class="koboSpan" id="kobo.614.1">: any</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.615.1">firstChange</span></code><span class="koboSpan" id="kobo.616.1">: boolean</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.617.1">isFirstChange()</span></code><span class="koboSpan" id="kobo.618.1">: boolean</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.619.1">First, we make sure to save the original content of the target element by getting the attached element using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.620.1">ElementRef</span></code><span class="koboSpan" id="kobo.621.1"> service. </span><span class="koboSpan" id="kobo.621.2">We get it using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.622.1">.nativeElement.innerHTML</span></code><span class="koboSpan" id="kobo.623.1"> property on the element we apply the directive to. </span><span class="koboSpan" id="kobo.623.2">We save the initial value to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.624.1">originalHTML</span></code><span class="koboSpan" id="kobo.625.1"> property of the directive. </span></p>
<p class="normal"><span class="koboSpan" id="kobo.626.1">Whenever the input changes, we assign a replaced version of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.627.1">originalHTML</span></code><span class="koboSpan" id="kobo.628.1"> by replacing all the instances of the searched term in the paragraph with an additional HTML element (a </span><code class="inlineCode"><span class="koboSpan" id="kobo.629.1">&lt;span&gt;</span></code><span class="koboSpan" id="kobo.630.1"> element). </span><span class="koboSpan" id="kobo.630.2">We also add the background color to this </span><code class="inlineCode"><span class="koboSpan" id="kobo.631.1">&lt;span&gt;</span></code><span class="koboSpan" id="kobo.632.1"> element. </span><span class="koboSpan" id="kobo.632.2">The background color applied comes from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.633.1">highlightColor</span></code><span class="koboSpan" id="kobo.634.1"> input. </span><span class="koboSpan" id="kobo.634.2">You can modify it to highlight using a different color. </span><span class="koboSpan" id="kobo.634.3">Play around and make this example your own.</span></p>
<h2 class="heading-2" id="_idParaDest-62"><span class="koboSpan" id="kobo.635.1">See also</span></h2>
<ul>
<li class="bulletList"><em class="italic"><span class="koboSpan" id="kobo.636.1">Testing Attribute Directives</span></em><span class="koboSpan" id="kobo.637.1"> official documentation: </span><a href="https://angular.io/guide/testing-attribute-directives"><span class="url"><span class="koboSpan" id="kobo.638.1">https://angular.io/guide/testing-attribute-directives</span></span></a></li>
<li class="bulletList"><span class="koboSpan" id="kobo.639.1">Angular </span><code class="inlineCode"><span class="koboSpan" id="kobo.640.1">SimpleChange</span></code><span class="koboSpan" id="kobo.641.1"> docs: </span><a href="https://angular.io/api/core/SimpleChange"><span class="url"><span class="koboSpan" id="kobo.642.1">https://angular.io/api/core/SimpleChange</span></span></a></li>
</ul>
<h1 class="heading-1" id="_idParaDest-63"><span class="koboSpan" id="kobo.643.1">Creating a directive to calculate the read time for articles</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.644.1">In this recipe, you’ll create an attribute directive to calculate the read time of an article, just like Medium (</span><a href="https://medium.com"><span class="url"><span class="koboSpan" id="kobo.645.1">https://medium.com</span></span></a><span class="koboSpan" id="kobo.646.1">), which is a platform for sharing articles and blog posts. </span><span class="koboSpan" id="kobo.646.2">The code for this recipe is highly inspired by my existing repository on GitHub, which you can view at the following link: </span><a href="https://github.com/AhsanAyaz/ngx-read-time"><span class="url"><span class="koboSpan" id="kobo.647.1">https://github.com/AhsanAyaz/ngx-read-time</span></span></a><span class="koboSpan" id="kobo.648.1">.</span></p>
<h2 class="heading-2" id="_idParaDest-64"><span class="koboSpan" id="kobo.649.1">Getting ready</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.650.1">The app that we</span><a id="_idIndexMarker118"/><span class="koboSpan" id="kobo.651.1"> are going to </span><a id="_idIndexMarker119"/><span class="koboSpan" id="kobo.652.1">work with resides in </span><code class="inlineCode"><span class="koboSpan" id="kobo.653.1">start/apps/chapter02/ng-read-time-directive</span></code><span class="koboSpan" id="kobo.654.1"> inside the cloned repository:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.655.1">Open the code repository in your code editor.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.656.1">Open the terminal, navigate to the code repository directory, and run the following command to serve the project:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.657.1">npm run serve ng-read-time-directive
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.658.1">This should open the app in a new browser tab and you should see the following:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.659.1"><img alt="" role="presentation" src="../Images/B18469_02_03.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.660.1">Figure 2.3: ng-read-time-directive app running on http://localhost:4200</span></p> </li>
</ol>
<h2 class="heading-2" id="_idParaDest-65"><span class="koboSpan" id="kobo.661.1">How to do it…</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.662.1">Right now, we</span><a id="_idIndexMarker120"/><span class="koboSpan" id="kobo.663.1"> have a paragraph in our </span><code class="inlineCode"><span class="koboSpan" id="kobo.664.1">app.component.html</span></code><span class="koboSpan" id="kobo.665.1"> file for which we need to calculate the </span><code class="inlineCode"><span class="koboSpan" id="kobo.666.1">read-time</span></code><span class="koboSpan" id="kobo.667.1"> in minutes. </span><span class="koboSpan" id="kobo.667.2">Let’s get started:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.668.1">First, we’ll </span><a id="_idIndexMarker121"/><span class="koboSpan" id="kobo.669.1">create an attribute directive named </span><code class="inlineCode"><span class="koboSpan" id="kobo.670.1">read-time</span></code><span class="koboSpan" id="kobo.671.1">. </span><span class="koboSpan" id="kobo.671.2">To do that, run the following command from the project root and select the </span><code class="inlineCode"><span class="koboSpan" id="kobo.672.1">@nx/angular:directive schematics</span></code><span class="koboSpan" id="kobo.673.1"> when asked:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.674.1">cd start &amp;&amp; nx g directive read-time --directory apps/chapter02/ng-read-time-directive/src/app/directives --standalone=false
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.675.1">If asked, choose the </span><code class="inlineCode"><span class="koboSpan" id="kobo.676.1">@nx/angular:directive</span></code> <code class="inlineCode"><span class="koboSpan" id="kobo.677.1">schematics</span></code><span class="koboSpan" id="kobo.678.1"> and choose the “As provided” action.</span></p>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.679.1">Note that we’re using </span><code class="inlineCode"><span class="koboSpan" id="kobo.680.1">--standalone = false</span></code><span class="koboSpan" id="kobo.681.1"> in the command. </span><span class="koboSpan" id="kobo.681.2">That is because we have an </span><code class="inlineCode"><span class="koboSpan" id="kobo.682.1">NgModule</span></code><span class="koboSpan" id="kobo.683.1"> based application and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.684.1">AppComponent</span></code><span class="koboSpan" id="kobo.685.1"> is not a standalone component.</span></p>
</div> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="2"><span class="koboSpan" id="kobo.686.1">The preceding command creates a directive with the class name </span><code class="inlineCode"><span class="koboSpan" id="kobo.687.1">ReadTimeDirective</span></code><span class="koboSpan" id="kobo.688.1"> and has </span><code class="inlineCode"><span class="koboSpan" id="kobo.689.1">appReadTime</span></code><span class="koboSpan" id="kobo.690.1"> as the selector. </span><span class="koboSpan" id="kobo.690.2">We’ll apply this directive to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.691.1">div</span></code><span class="koboSpan" id="kobo.692.1"> that has </span><code class="inlineCode"><span class="koboSpan" id="kobo.693.1">id</span></code><span class="koboSpan" id="kobo.694.1"> set to </span><code class="inlineCode"><span class="koboSpan" id="kobo.695.1">mainContent</span></code><span class="koboSpan" id="kobo.696.1"> inside the </span><code class="inlineCode"><span class="koboSpan" id="kobo.697.1">app.component.html</span></code><span class="koboSpan" id="kobo.698.1"> file as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.699.1">...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.700.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.701.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.702.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.703.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.704.1">"content"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.705.1">role</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.706.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.707.1">"main"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.708.1">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.709.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.710.1">"mainContent"</span></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.711.1">appReadTime</span></strong></span><span class="hljs-tag"><span class="koboSpan" id="kobo.712.1">&gt;</span></span><span class="koboSpan" id="kobo.713.1">
...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.714.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.715.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.716.1">&gt;</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.717.1">Now, we’ll create a configuration object for our </span><code class="inlineCode"><span class="koboSpan" id="kobo.718.1">appReadTime</span></code><span class="koboSpan" id="kobo.719.1"> directive. </span><span class="koboSpan" id="kobo.719.2">This configuration will contain a </span><code class="inlineCode"><span class="koboSpan" id="kobo.720.1">wordsPerMinute</span></code><span class="koboSpan" id="kobo.721.1"> value, on the basis of which we’ll calculate the read time. </span><span class="koboSpan" id="kobo.721.2">Let’s create an input inside the </span><code class="inlineCode"><span class="koboSpan" id="kobo.722.1">read-time.directive.ts</span></code><span class="koboSpan" id="kobo.723.1"> file with a </span><code class="inlineCode"><span class="koboSpan" id="kobo.724.1">ReadTimeConfig</span></code><span class="koboSpan" id="kobo.725.1"> exported interface for the configuration, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.726.1">import</span></span><span class="koboSpan" id="kobo.727.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.728.1">Directive</span></span><span class="koboSpan" id="kobo.729.1">, </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.730.1">Input</span></strong></span><span class="koboSpan" id="kobo.731.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.732.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.733.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.734.1">;
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.735.1">export</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.736.1"> interface </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.737.1">ReadTimeConfig</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.738.1"> {</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.739.1">wordsPerMinute</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.740.1">: number;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.741.1">}</span></strong></span><span class="koboSpan" id="kobo.742.1">
@</span><span class="hljs-title"><span class="koboSpan" id="kobo.743.1">Directive</span></span><span class="koboSpan" id="kobo.744.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.745.1">selector</span></span><span class="koboSpan" id="kobo.746.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.747.1">'[appReadTime]'</span></span><span class="koboSpan" id="kobo.748.1">
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.749.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.750.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.751.1">ReadTimeDirective</span></span><span class="koboSpan" id="kobo.752.1"> {
  </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.753.1">@</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.754.1">Input</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.755.1">() </span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.756.1">configuration</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.757.1">: </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.758.1">ReadTimeConfig</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.759.1"> = {</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.760.1">wordsPerMinute</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.761.1">: </span></strong><strong class="hljs-number-slc"><span class="koboSpan" id="kobo.762.1">200</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.763.1">}</span></strong></span>
<span class="hljs-title"><span class="koboSpan" id="kobo.764.1">constructor</span></span><span class="koboSpan" id="kobo.765.1">() { }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.766.1">We can </span><a id="_idIndexMarker122"/><span class="koboSpan" id="kobo.767.1">now move</span><a id="_idIndexMarker123"/><span class="koboSpan" id="kobo.768.1"> on to getting the text to calculate the read time. </span><span class="koboSpan" id="kobo.768.2">For this, we’ll use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.769.1">ElementRef</span></code><span class="koboSpan" id="kobo.770.1"> service to retrieve the </span><code class="inlineCode"><span class="koboSpan" id="kobo.771.1">textContent</span></code><span class="koboSpan" id="kobo.772.1"> property of the element. </span><span class="koboSpan" id="kobo.772.2">We’ll extract the </span><code class="inlineCode"><span class="koboSpan" id="kobo.773.1">textContent</span></code><span class="koboSpan" id="kobo.774.1"> property and assign it to a local variable named </span><code class="inlineCode"><span class="koboSpan" id="kobo.775.1">text</span></code><span class="koboSpan" id="kobo.776.1"> in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.777.1">ngOnInit</span></code><span class="koboSpan" id="kobo.778.1"> life cycle hook, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.779.1">import</span></span><span class="koboSpan" id="kobo.780.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.781.1">Directive</span></span><span class="koboSpan" id="kobo.782.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.783.1">Input</span></span><span class="koboSpan" id="kobo.784.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.785.1">ElementRef</span></span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.786.1">, </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.787.1">OnInit</span></strong></span><span class="koboSpan" id="kobo.788.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.789.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.790.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.791.1">@angular/core'</span></span><span class="koboSpan" id="kobo.792.1">;
...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.793.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.794.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.795.1">ReadTimeDirective</span></span> <span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.796.1">implements </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.797.1">OnInit</span></strong></span><span class="koboSpan" id="kobo.798.1"> {
  @</span><span class="hljs-title"><span class="koboSpan" id="kobo.799.1">Input</span></span><span class="koboSpan" id="kobo.800.1">() </span><span class="hljs-attr"><span class="koboSpan" id="kobo.801.1">configuration</span></span><span class="koboSpan" id="kobo.802.1">: </span><span class="hljs-title"><span class="koboSpan" id="kobo.803.1">ReadTimeConfig</span></span><span class="koboSpan" id="kobo.804.1"> = {
    </span><span class="hljs-attr"><span class="koboSpan" id="kobo.805.1">wordsPerMinute</span></span><span class="koboSpan" id="kobo.806.1">: </span><span class="hljs-number"><span class="koboSpan" id="kobo.807.1">200</span></span><span class="koboSpan" id="kobo.808.1">
  }
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.809.1">constructor</span></span><span class="koboSpan" id="kobo.810.1">(</span><span class="code-highlight"><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.811.1">private el: ElementRef</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.812.1">) { }</span></strong></span>
<span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.813.1">ngOnInit</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.814.1">() {</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.815.1">const</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.816.1"> text = </span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.817.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.818.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.819.1">el</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.820.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.821.1">nativeElement</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.822.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.823.1">textContent</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.824.1">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.825.1">}</span></strong></span><span class="koboSpan" id="kobo.826.1">
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.827.1">Now that we have our text variable filled up with the element’s entire text content, we can calculate the time to read this text. </span><span class="koboSpan" id="kobo.827.2">For this, we’ll create a method named </span><code class="inlineCode"><span class="koboSpan" id="kobo.828.1">calculateReadTime</span></code><span class="koboSpan" id="kobo.829.1"> by passing the </span><code class="inlineCode"><span class="koboSpan" id="kobo.830.1">text</span></code><span class="koboSpan" id="kobo.831.1"> property to it, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.832.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.833.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.834.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.835.1">ReadTimeDirective</span></span><span class="koboSpan" id="kobo.836.1"> implements </span><span class="hljs-title"><span class="koboSpan" id="kobo.837.1">OnInit</span></span><span class="koboSpan" id="kobo.838.1"> {
  ...
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.839.1">ngOnInit</span></span><span class="koboSpan" id="kobo.840.1">() {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.841.1">const</span></span><span class="koboSpan" id="kobo.842.1"> text = </span><span class="hljs-variable"><span class="koboSpan" id="kobo.843.1">this</span></span><span class="koboSpan" id="kobo.844.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.845.1">el</span></span><span class="koboSpan" id="kobo.846.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.847.1">nativeElement</span></span><span class="koboSpan" id="kobo.848.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.849.1">textContent</span></span><span class="koboSpan" id="kobo.850.1">;
    </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.851.1">const</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.852.1"> time = </span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.853.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.854.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.855.1">calculateReadTime</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.856.1">(text);</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.857.1">console</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.858.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.859.1">log</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.860.1">({ </span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.861.1">readTime</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.862.1">: time });</span></strong></span><span class="koboSpan" id="kobo.863.1">
  }
  </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.864.1">calculateReadTime</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.865.1">(</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.866.1">text: string</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.867.1">) {</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.868.1">const</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.869.1"> wordsCount = text.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.870.1">split</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.871.1">(</span></strong><strong class="hljs-regexp-slc"><span class="koboSpan" id="kobo.872.1">/\s+/g</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.873.1">).</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.874.1">length</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.875.1">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.876.1">const</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.877.1"> minutes = wordsCount / </span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.878.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.879.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.880.1">configuration</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.881.1">.</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.882.1">wordsPerMinute;</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.883.1">return</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.884.1">Math</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.885.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.886.1">ceil</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.887.1">(minutes);</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.888.1">}</span></strong></span><span class="koboSpan" id="kobo.889.1">
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.890.1">If you </span><a id="_idIndexMarker124"/><span class="koboSpan" id="kobo.891.1">look</span><a id="_idIndexMarker125"/><span class="koboSpan" id="kobo.892.1"> at the console now, you should see an object containing the </span><code class="inlineCode"><span class="koboSpan" id="kobo.893.1">readTime</span></code><span class="koboSpan" id="kobo.894.1"> property being logged. </span><span class="koboSpan" id="kobo.894.2">The value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.895.1">readTime</span></code><span class="koboSpan" id="kobo.896.1"> is the time in minutes:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.897.1"><img alt="" role="presentation" src="../Images/B18469_02_04.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.898.1">Figure 2.4: Console log showing the time in minutes</span></p> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="6"><span class="koboSpan" id="kobo.899.1">We’ve got the time now in minutes, but it’s not in a user-readable format at the moment since it is just a number. </span><span class="koboSpan" id="kobo.899.2">We need to show it in a way that is understandable for the end user. </span><span class="koboSpan" id="kobo.899.3">To do so, we’ll do some minor calculations and create </span><a id="_idIndexMarker126"/><span class="koboSpan" id="kobo.900.1">an </span><a id="_idIndexMarker127"/><span class="koboSpan" id="kobo.901.1">appropriate string to show on the UI. </span><span class="koboSpan" id="kobo.901.2">The code is shown here:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.902.1">...
</span><span class="koboSpan" id="kobo.902.2">@</span><span class="hljs-title"><span class="koboSpan" id="kobo.903.1">Directive</span></span><span class="koboSpan" id="kobo.904.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.905.1">selector</span></span><span class="koboSpan" id="kobo.906.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.907.1">'[appReadTime]'</span></span><span class="koboSpan" id="kobo.908.1">
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.909.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.910.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.911.1">ReadTimeDirective</span></span><span class="koboSpan" id="kobo.912.1"> implements </span><span class="hljs-title"><span class="koboSpan" id="kobo.913.1">OnInit</span></span><span class="koboSpan" id="kobo.914.1"> {
...
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.915.1">ngOnInit</span></span><span class="koboSpan" id="kobo.916.1">() {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.917.1">const</span></span><span class="koboSpan" id="kobo.918.1"> text = </span><span class="hljs-variable"><span class="koboSpan" id="kobo.919.1">this</span></span><span class="koboSpan" id="kobo.920.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.921.1">el</span></span><span class="koboSpan" id="kobo.922.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.923.1">nativeElement</span></span><span class="koboSpan" id="kobo.924.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.925.1">textContent</span></span><span class="koboSpan" id="kobo.926.1">;
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.927.1">const</span></span><span class="koboSpan" id="kobo.928.1"> time = </span><span class="hljs-variable"><span class="koboSpan" id="kobo.929.1">this</span></span><span class="koboSpan" id="kobo.930.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.931.1">calculateReadTime</span></span><span class="koboSpan" id="kobo.932.1">(text);
    </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.933.1">const</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.934.1"> timeStr = </span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.935.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.936.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.937.1">createTimeString</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.938.1">(time);</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.939.1">console</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.940.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.941.1">log</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.942.1">({ </span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.943.1">readTime</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.944.1">: timeStr });</span></strong></span><span class="koboSpan" id="kobo.945.1">
  }
...
  </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.946.1">createTimeString</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.947.1">(</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.948.1">timeInMinutes: number</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.949.1">) {</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.950.1">if</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.951.1"> (timeInMinutes &lt; </span></strong><strong class="hljs-number-slc"><span class="koboSpan" id="kobo.952.1">1</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.953.1">) {</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.954.1">return</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.955.1">'&lt; 1 minute'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.956.1">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.957.1">} </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.958.1">else</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.959.1">if</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.960.1"> (timeInMinutes === </span></strong><strong class="hljs-number-slc"><span class="koboSpan" id="kobo.961.1">1</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.962.1">) {</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.963.1">return</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.964.1">'1 minute'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.965.1">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.966.1">} </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.967.1">else</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.968.1"> {</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.969.1">return</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.970.1">`</span></strong><strong class="hljs-subst-slc"><span class="koboSpan" id="kobo.971.1">${timeInMinutes}</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.972.1"> minutes`</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.973.1">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.974.1">}</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.975.1">}</span></strong></span><span class="koboSpan" id="kobo.976.1">
}
</span></code></pre>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.977.1">Note that with the code so far, you should be able to see the minutes on the console when you refresh the application.</span></p>
</div></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="7"><span class="koboSpan" id="kobo.978.1">Now, let’s add an </span><code class="inlineCode"><span class="koboSpan" id="kobo.979.1">@Output()</span></code><span class="koboSpan" id="kobo.980.1"> to the directive so that we can get the read time in the parent component and display it on the UI. </span><span class="koboSpan" id="kobo.980.2">Let’s add it as follows in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.981.1">read-time.directive.ts</span></code><span class="koboSpan" id="kobo.982.1"> file:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.983.1">import</span></span><span class="koboSpan" id="kobo.984.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.985.1">Directive</span></span><span class="koboSpan" id="kobo.986.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.987.1">Input</span></span><span class="koboSpan" id="kobo.988.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.989.1">ElementRef</span></span><span class="koboSpan" id="kobo.990.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.991.1">OnInit</span></span><span class="koboSpan" id="kobo.992.1">, </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.993.1">Output</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.994.1">, </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.995.1">EventEmitter</span></strong></span><span class="koboSpan" id="kobo.996.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.997.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.998.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.999.1">;
...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1000.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1001.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1002.1">ReadTimeDirective</span></span><span class="koboSpan" id="kobo.1003.1"> implements </span><span class="hljs-title"><span class="koboSpan" id="kobo.1004.1">OnInit</span></span><span class="koboSpan" id="kobo.1005.1"> {
  @</span><span class="hljs-title"><span class="koboSpan" id="kobo.1006.1">Input</span></span><span class="koboSpan" id="kobo.1007.1">() </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1008.1">configuration</span></span><span class="koboSpan" id="kobo.1009.1">: </span><span class="hljs-title"><span class="koboSpan" id="kobo.1010.1">ReadTimeConfig</span></span><span class="koboSpan" id="kobo.1011.1"> = {
    </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1012.1">wordsPerMinute</span></span><span class="koboSpan" id="kobo.1013.1">: </span><span class="hljs-number"><span class="koboSpan" id="kobo.1014.1">200</span></span><span class="koboSpan" id="kobo.1015.1">
  }
  </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1016.1">@</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1017.1">Output</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1018.1">() readTimeCalculated = </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1019.1">new </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1020.1">EventEmitter</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1021.1">&lt;string&gt;();</span></strong></span>
<span class="hljs-title"><span class="koboSpan" id="kobo.1022.1">constructor</span></span><span class="koboSpan" id="kobo.1023.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1024.1">private el: ElementRef</span></span><span class="koboSpan" id="kobo.1025.1">) { }
...
</span><span class="koboSpan" id="kobo.1025.2">}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1026.1">Let’s use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1027.1">readTimeCalculated</span></code><span class="koboSpan" id="kobo.1028.1"> output to emit the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1029.1">timeStr</span></code><span class="koboSpan" id="kobo.1030.1"> variable from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1031.1">ngOnInit</span></code><span class="koboSpan" id="kobo.1032.1"> method when we’ve calculated the read time:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1033.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1034.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1035.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1036.1">ReadTimeDirective</span></span><span class="koboSpan" id="kobo.1037.1"> {
...
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.1038.1">ngOnInit</span></span><span class="koboSpan" id="kobo.1039.1">() {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1040.1">const</span></span><span class="koboSpan" id="kobo.1041.1"> text = </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1042.1">this</span></span><span class="koboSpan" id="kobo.1043.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1044.1">el</span></span><span class="koboSpan" id="kobo.1045.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1046.1">nativeElement</span></span><span class="koboSpan" id="kobo.1047.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1048.1">textContent</span></span><span class="koboSpan" id="kobo.1049.1">;
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1050.1">const</span></span><span class="koboSpan" id="kobo.1051.1"> time = </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1052.1">this</span></span><span class="koboSpan" id="kobo.1053.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1054.1">calculateReadTime</span></span><span class="koboSpan" id="kobo.1055.1">(text);
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1056.1">const</span></span><span class="koboSpan" id="kobo.1057.1"> timeStr = </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1058.1">this</span></span><span class="koboSpan" id="kobo.1059.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1060.1">createTimeString</span></span><span class="koboSpan" id="kobo.1061.1">(time);
    </span><span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1062.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1063.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1064.1">readTimeCalculated</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1065.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1066.1">emit</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1067.1">(timeStr);</span></strong></span><span class="koboSpan" id="kobo.1068.1">
  }
...
</span><span class="koboSpan" id="kobo.1068.2">}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1069.1">Since</span><a id="_idIndexMarker128"/><span class="koboSpan" id="kobo.1070.1"> we emit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1071.1">read-time</span></code><span class="koboSpan" id="kobo.1072.1"> value using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1073.1">readTimeCalculated</span></code><span class="koboSpan" id="kobo.1074.1"> output, we</span><a id="_idIndexMarker129"/><span class="koboSpan" id="kobo.1075.1"> have to listen to this output’s event in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1076.1">app.component.html</span></code><span class="koboSpan" id="kobo.1077.1"> file and assign it to a property of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1078.1">AppComponent</span></code><span class="koboSpan" id="kobo.1079.1"> class so that we can show this on the view. </span><span class="koboSpan" id="kobo.1079.2">But before that, we’ll create a local property in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1080.1">app.component.ts</span></code><span class="koboSpan" id="kobo.1081.1"> file to store the output event’s value, and we’ll also create a method to be called upon when the output event is triggered. </span><span class="koboSpan" id="kobo.1081.2">The code is shown here:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1082.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1083.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1084.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1085.1">AppComponent</span></span><span class="koboSpan" id="kobo.1086.1"> {
  </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1087.1">readTime</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1088.1">!: string;</span></strong></span>
<span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1089.1">onReadTimeCalculated</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1090.1">(</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.1091.1">readTimeStr: string</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1092.1">) {</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1093.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1094.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1095.1">readTime</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1096.1"> = readTimeStr;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1097.1">}</span></strong></span><span class="koboSpan" id="kobo.1098.1">
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1099.1">We can now listen to the output event in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1100.1">app.component.html</span></code><span class="koboSpan" id="kobo.1101.1"> file, and we can then call the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1102.1">onReadTimeCalculated</span></code><span class="koboSpan" id="kobo.1103.1"> method when the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1104.1">readTimeCalculated</span></code><span class="koboSpan" id="kobo.1105.1"> output event is triggered:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1106.1">...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1107.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1108.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1109.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1110.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1111.1">"content"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1112.1">role</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1113.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1114.1">"main"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1115.1">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1116.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1117.1">"mainContent"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1118.1">appReadTime</span></span>
<span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1119.1">(</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1120.1">readTimeCalculated</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1121.1">)= </span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1122.1">"onReadTimeCalculated($event)"</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1123.1">&gt;</span></strong></span><span class="koboSpan" id="kobo.1124.1">
...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1125.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1126.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1127.1">&gt;</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1128.1">Now, we </span><a id="_idIndexMarker130"/><span class="koboSpan" id="kobo.1129.1">can finally</span><a id="_idIndexMarker131"/><span class="koboSpan" id="kobo.1130.1"> show the read time in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1131.1">app.component.html</span></code><span class="koboSpan" id="kobo.1132.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.1133.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1134.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1135.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1136.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1137.1">"content"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1138.1">role</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1139.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1140.1">"main"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1141.1">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1142.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1143.1">"mainContent"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1144.1">appReadTime</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1145.1">  (</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.1146.1">readTimeCalculated</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1147.1">)=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1148.1">"onReadTimeCalculated($event)"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1149.1">&gt;</span></span>
<span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1150.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.1151.1">h4</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1152.1">class</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1153.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1154.1">"text-3xl"</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1155.1">&gt;</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1156.1">Read Time = {{readTime}}</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1157.1">&lt;/</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.1158.1">h4</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1159.1">&gt;</span></strong></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1160.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1161.1">p</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1162.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1163.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1164.1">"text-content"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1165.1">&gt;</span></span><span class="koboSpan" id="kobo.1166.1">
    Silent sir say desire fat him letter. </span><span class="koboSpan" id="kobo.1166.2">Whatever settling
    goodness too and honoured she building answered her. </span><span class="koboSpan" id="kobo.1166.3">...
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1167.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1168.1">p</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1169.1">&gt;</span></span><span class="koboSpan" id="kobo.1170.1">
...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1171.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1172.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1173.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1174.1">If you now go to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1175.1">http://localhost:4200</span></code><span class="koboSpan" id="kobo.1176.1">, you should be able to see the read time in the app, as shown in the following image:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1177.1"><img alt="" role="presentation" src="../Images/B18469_02_05.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1178.1">Figure 2.5: Read time being displayed in the app</span></p></li>
</ol>
<h2 class="heading-2" id="_idParaDest-66"><span class="koboSpan" id="kobo.1179.1">How it works…</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1180.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.1181.1">appReadTime</span></code><span class="koboSpan" id="kobo.1182.1"> directive</span><a id="_idIndexMarker132"/><span class="koboSpan" id="kobo.1183.1"> is at</span><a id="_idIndexMarker133"/><span class="koboSpan" id="kobo.1184.1"> the heart of this recipe. </span><span class="koboSpan" id="kobo.1184.2">While creating the directive, we create it as a non-standalone directive because the application itself is bootstrapped using an NgModule instead of a standalone </span><code class="inlineCode"><span class="koboSpan" id="kobo.1185.1">AppComponent</span></code><span class="koboSpan" id="kobo.1186.1">. </span><span class="koboSpan" id="kobo.1186.2">We use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1187.1">ElementRef</span></code><span class="koboSpan" id="kobo.1188.1"> service inside the directive to get the native element that the directive is attached to and then we take out its text content. </span><span class="koboSpan" id="kobo.1188.2">The only thing that remains then is to perform the calculation. </span><span class="koboSpan" id="kobo.1188.3">We first split the entire text content into words by using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1189.1">/\s+/g </span></code><strong class="keyWord"><span class="koboSpan" id="kobo.1190.1">regular expression</span></strong><span class="koboSpan" id="kobo.1191.1"> (</span><strong class="keyWord"><span class="koboSpan" id="kobo.1192.1">regex</span></strong><span class="koboSpan" id="kobo.1193.1">), and thus we count the total words in the text content. </span><span class="koboSpan" id="kobo.1193.2">Then, we divide the word count by the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1194.1">wordsPerMinute</span></code><span class="koboSpan" id="kobo.1195.1"> value we have in the configuration to calculate how many minutes it would take to read the entire text. </span><span class="koboSpan" id="kobo.1195.2">Finally, we make it readable in a better way using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1196.1">createTimeString</span></code><span class="koboSpan" id="kobo.1197.1"> method. </span><em class="italic"><span class="koboSpan" id="kobo.1198.1">Easy peasy, lemon squeezy</span></em><span class="koboSpan" id="kobo.1199.1">.</span></p>
<h2 class="heading-2" id="_idParaDest-67"><span class="koboSpan" id="kobo.1200.1">See also</span></h2>
<ul>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.1201.1">ngx-read-time</span></code><span class="koboSpan" id="kobo.1202.1"> library: </span><a href="https://github.com/AhsanAyaz/ngx-read-time"><span class="url"><span class="koboSpan" id="kobo.1203.1">https://github.com/AhsanAyaz/ngx-read-time</span></span></a></li>
<li class="bulletList"><span class="koboSpan" id="kobo.1204.1">Angular attribute directives documentation: </span><a href="https://angular.io/guide/testing-attribute-directives"><span class="url"><span class="koboSpan" id="kobo.1205.1">https://angular.io/guide/testing-attribute-directives</span></span></a></li>
</ul>
<h1 class="heading-1" id="_idParaDest-68"><span class="koboSpan" id="kobo.1206.1">Creating a directive that allows you to vertically scroll to an element</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.1207.1">Can you </span><a id="_idIndexMarker134"/><span class="koboSpan" id="kobo.1208.1">imagine being able to instantly jump to any place that your eyes can see? </span><span class="koboSpan" id="kobo.1208.2">That would be awesome! </span><em class="italic"><span class="koboSpan" id="kobo.1209.1">Wouldn’t it?</span></em><span class="koboSpan" id="kobo.1210.1"> But what if we wanted our app to be able to do that? </span><span class="koboSpan" id="kobo.1210.2">In this recipe, you’ll create a directive that the user can click to jump to specific sessions in an Angular application.</span></p>
<h2 class="heading-2" id="_idParaDest-69"><span class="koboSpan" id="kobo.1211.1">Getting ready</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1212.1">The app that we are going to work with resides in </span><code class="inlineCode"><span class="koboSpan" id="kobo.1213.1">start/apps/chapter02/ng-scroll-to-directive</span></code><span class="koboSpan" id="kobo.1214.1"> inside the cloned repository:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1215.1">Open the code repository in your code editor.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1216.1">Open the terminal, navigate to the code repository directory, and run the following command to serve the project:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1217.1">npm run serve ng-scroll-to-directive
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1218.1">This should open the app in a new browser tab, and you should see the following:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1219.1"><img alt="" role="presentation" src="../Images/B18469_02_06.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1220.1">Figure 2.6: ng-scroll-to-directive app running on http://localhost:4200</span></p></li>
</ol>
<h2 class="heading-2" id="_idParaDest-70"><span class="koboSpan" id="kobo.1221.1">How to do it…</span></h2>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1222.1">First, we’ll create a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1223.1">scroll-to</span></code><span class="koboSpan" id="kobo.1224.1"> directive</span><a id="_idIndexMarker135"/><span class="koboSpan" id="kobo.1225.1"> so that we can enhance our application with smooth scrolls to different sections. </span><span class="koboSpan" id="kobo.1225.2">We’ll do this using the following command in the workspace root folder:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1226.1">cd start &amp;&amp; nx g directive scroll-to --directory apps/chapter02/ng-scroll-to-directive/src/app/directives
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1227.1">If asked, choose the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1228.1">@nx/angular:component schematics</span></code><span class="koboSpan" id="kobo.1229.1"> and choose the “As provided” action.</span></p> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="2"><span class="koboSpan" id="kobo.1230.1">Now, we</span><a id="_idIndexMarker136"/><span class="koboSpan" id="kobo.1231.1"> need to make the directive capable of accepting an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1232.1">@Input()</span></code><span class="koboSpan" id="kobo.1233.1"> that’ll contain the </span><strong class="keyWord"><span class="koboSpan" id="kobo.1234.1">CSS Query Selector</span></strong><span class="koboSpan" id="kobo.1235.1"> for our target section, which we’ll scroll to upon the element’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.1236.1">click</span></code><span class="koboSpan" id="kobo.1237.1"> event. </span><span class="koboSpan" id="kobo.1237.2">Let’s add the input as follows to our </span><code class="inlineCode"><span class="koboSpan" id="kobo.1238.1">scroll-to.directive.ts</span></code><span class="koboSpan" id="kobo.1239.1"> file:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1240.1">import</span></span><span class="koboSpan" id="kobo.1241.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1242.1">Directive</span></span><span class="koboSpan" id="kobo.1243.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.1244.1">Input</span></span><span class="koboSpan" id="kobo.1245.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1246.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1247.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.1248.1">;
@</span><span class="hljs-title"><span class="koboSpan" id="kobo.1249.1">Directive</span></span><span class="koboSpan" id="kobo.1250.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1251.1">selector</span></span><span class="koboSpan" id="kobo.1252.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1253.1">'[appScrollTo]'</span></span><span class="koboSpan" id="kobo.1254.1">
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1255.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1256.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1257.1">ScrollToDirective</span></span><span class="koboSpan" id="kobo.1258.1"> {
  @</span><span class="hljs-title"><span class="koboSpan" id="kobo.1259.1">Input</span></span><span class="koboSpan" id="kobo.1260.1">() target = </span><span class="hljs-string"><span class="koboSpan" id="kobo.1261.1">''</span></span><span class="koboSpan" id="kobo.1262.1">;
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1263.1">Now, we’ll apply the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1264.1">appScrollTo</span></code><span class="koboSpan" id="kobo.1265.1"> directive</span><a id="_idIndexMarker137"/><span class="koboSpan" id="kobo.1266.1"> to the links in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1267.1">app.component.html</span></code><span class="koboSpan" id="kobo.1268.1"> file along with the respective targets. </span><span class="koboSpan" id="kobo.1268.2">We’ll replace the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1269.1">href</span></code><span class="koboSpan" id="kobo.1270.1"> attribute with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1271.1">target</span></code><span class="koboSpan" id="kobo.1272.1"> attribute. </span><span class="koboSpan" id="kobo.1272.2">The code should look like this:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1273.1">...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1274.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1275.1">main</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1276.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1277.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1278.1">"content"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1279.1">role</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1280.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1281.1">"main"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1282.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1283.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1284.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1285.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1286.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1287.1">"page-links"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1288.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1289.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1290.1">h4</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1291.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1292.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1293.1">"page-links__heading"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1294.1">&gt;</span></span><span class="koboSpan" id="kobo.1295.1">
      Links
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1296.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1297.1">h4</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1298.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1299.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1300.1">a</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1301.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1302.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1303.1">"page-links__link"</span></span><span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1304.1">appScrollTotarget</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1305.1">=</span></strong></span>
<span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1306.1">"#resources"</span></strong></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1307.1">&gt;</span></span><span class="koboSpan" id="kobo.1308.1">Resources</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1309.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1310.1">a</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1311.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1312.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1313.1">a</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1314.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1315.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1316.1">"page-links__link"</span></span><span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1317.1">appScrollTotarget</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1318.1">=</span></strong></span>
<span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1319.1">"#nextSteps"</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1320.1">&gt;</span></strong></span><span class="koboSpan" id="kobo.1321.1">Next Steps</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1322.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1323.1">a</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1324.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1325.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1326.1">a</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1327.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1328.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1329.1">"page-links__link"</span></span><span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1330.1">appScrollTotarget</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1331.1">=</span></strong></span>
<span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1332.1">"#moreContent"</span></strong></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1333.1">&gt;</span></span><span class="koboSpan" id="kobo.1334.1">More Content</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1335.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1336.1">a</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1337.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1338.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1339.1">a</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1340.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1341.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1342.1">"page-links__link"</span></span><span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1343.1">appScrollTotarget</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1344.1">=</span></strong></span>
<span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1345.1">"#furtherContent"</span></strong></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1346.1">&gt;</span></span><span class="koboSpan" id="kobo.1347.1">Further Content</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1348.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1349.1">a</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1350.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1351.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1352.1">a</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1353.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1354.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1355.1">"page-links__link"</span></span><span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1356.1">appScrollTotarget</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1357.1">=</span></strong></span>
<span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1358.1">"#moreToRead"</span></strong></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1359.1">&gt;</span></span><span class="koboSpan" id="kobo.1360.1">More To Read</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1361.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1362.1">a</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1363.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1364.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1365.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1366.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1367.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1368.1">main</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1369.1">&gt;</span></span><span class="koboSpan" id="kobo.1370.1">
  ...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1371.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1372.1">a</span></span><span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1373.1">appScrollTo</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1374.1">target</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1375.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1376.1">"#toolbar"</span></strong></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1377.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1378.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1379.1">"to-top-button w-12</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.1380.1">h-12 text-white flex items-center justify-center"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1381.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1382.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1383.1">span</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1384.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1385.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1386.1">"material-symbols-outlined text-3xl text-</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.1387.1">white"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1388.1">&gt;</span></span><span class="koboSpan" id="kobo.1389.1"> expand_less </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1390.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1391.1">span</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1392.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1393.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1394.1">a</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1395.1">&gt;</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1396.1">Now, we’ll implement the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1397.1">HostListener()</span></code><span class="koboSpan" id="kobo.1398.1"> decorator to bind the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1399.1">click</span></code><span class="koboSpan" id="kobo.1400.1"> event to the element the </span><a id="_idIndexMarker138"/><span class="koboSpan" id="kobo.1401.1">directive is attached to. </span><span class="koboSpan" id="kobo.1401.2">We’ll just log the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1402.1">target</span></code><span class="koboSpan" id="kobo.1403.1"> input when we click the links. </span><span class="koboSpan" id="kobo.1403.2">Let’s implement this, and then you can try clicking on the links to see the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1404.1">target</span></code><span class="koboSpan" id="kobo.1405.1"> input on the console:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1406.1">import</span></span><span class="koboSpan" id="kobo.1407.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1408.1">Directive</span></span><span class="koboSpan" id="kobo.1409.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.1410.1">Input</span></span><span class="koboSpan" id="kobo.1411.1">, </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1412.1">HostListener</span></strong></span><span class="koboSpan" id="kobo.1413.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1414.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1415.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.1416.1">;
@</span><span class="hljs-title"><span class="koboSpan" id="kobo.1417.1">Directive</span></span><span class="koboSpan" id="kobo.1418.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1419.1">selector</span></span><span class="koboSpan" id="kobo.1420.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1421.1">'[appScrollTo]'</span></span><span class="koboSpan" id="kobo.1422.1">
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1423.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1424.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1425.1">ScrollToDirective</span></span><span class="koboSpan" id="kobo.1426.1"> {
  @</span><span class="hljs-title"><span class="koboSpan" id="kobo.1427.1">Input</span></span><span class="koboSpan" id="kobo.1428.1">() target = </span><span class="hljs-string"><span class="koboSpan" id="kobo.1429.1">''</span></span><span class="koboSpan" id="kobo.1430.1">;
  </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1431.1">@</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1432.1">HostListener</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1433.1">(</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1434.1">'click'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1435.1">)</span></strong></span>
<span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1436.1">onClick</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1437.1">() {</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1438.1">console</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1439.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1440.1">log</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1441.1">(</span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1442.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1443.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1444.1">target</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1445.1">);</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1446.1">}</span></strong></span><span class="koboSpan" id="kobo.1447.1">
  ...
</span><span class="koboSpan" id="kobo.1447.2">}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1448.1">We will now implement the logic to scroll to a particular target. </span><span class="koboSpan" id="kobo.1448.2">We’ll use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1449.1">document.querySelector</span></code><span class="koboSpan" id="kobo.1450.1"> method, using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1451.1">target</span></code><span class="koboSpan" id="kobo.1452.1"> variable’s value to get the element, and then the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1453.1">Element.scrollIntoView</span></code><span class="koboSpan" id="kobo.1454.1"> web API to scroll to the target element. </span><span class="koboSpan" id="kobo.1454.2">With this change, you should see the page scrolling to the target element already when you click the corresponding link:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1455.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1456.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1457.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1458.1">ScrollToDirective</span></span><span class="koboSpan" id="kobo.1459.1"> {
  @</span><span class="hljs-title"><span class="koboSpan" id="kobo.1460.1">Input</span></span><span class="koboSpan" id="kobo.1461.1">() target = </span><span class="hljs-string"><span class="koboSpan" id="kobo.1462.1">''</span></span><span class="koboSpan" id="kobo.1463.1">;
  @</span><span class="hljs-title"><span class="koboSpan" id="kobo.1464.1">HostListener</span></span><span class="koboSpan" id="kobo.1465.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1466.1">'click'</span></span><span class="koboSpan" id="kobo.1467.1">)
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.1468.1">onClick</span></span><span class="koboSpan" id="kobo.1469.1">() {
    </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1470.1">const</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1471.1"> targetElement =</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1472.1">document</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1473.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1474.1">querySelector</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1475.1">(</span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1476.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1477.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1478.1">target</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1479.1">);</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1480.1">if</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1481.1"> (!targetElement) {</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1482.1">throw</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1483.1">new</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1484.1">Error</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1485.1">(</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1486.1">'`target' is required.`</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1487.1">);</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1488.1">}</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1489.1">targetElement.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1490.1">scrollIntoView</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1491.1">();</span></strong></span><span class="koboSpan" id="kobo.1492.1">
  }
  ...
</span><span class="koboSpan" id="kobo.1492.2">}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1493.1">All right—we got the scroll to work. </span><em class="italic"><span class="koboSpan" id="kobo.1494.1">“But what’s new, Ahsan? </span><span class="koboSpan" id="kobo.1494.2">Isn’t this exactly what we were already doing with the href implementation before?”</span></em><span class="koboSpan" id="kobo.1495.1"> Well, you’re right. </span><span class="koboSpan" id="kobo.1495.2">But we’re </span><a id="_idIndexMarker139"/><span class="koboSpan" id="kobo.1496.1">going to make the scroll super </span><em class="italic"><span class="koboSpan" id="kobo.1497.1">smoooooth</span></em><span class="koboSpan" id="kobo.1498.1">. </span><span class="koboSpan" id="kobo.1498.2">We’ll pass </span><code class="inlineCode"><span class="koboSpan" id="kobo.1499.1">scrollIntoViewOptions</span></code><span class="koboSpan" id="kobo.1500.1"> as an argument to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1501.1">scrollIntoView</span></code><span class="koboSpan" id="kobo.1502.1"> method with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1503.1">{behavior: "smooth"}</span></code><span class="koboSpan" id="kobo.1504.1"> value to use an animation during the scroll. </span><span class="koboSpan" id="kobo.1504.2">The code should look like this:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1505.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1506.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1507.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1508.1">ScrollToDirective</span></span><span class="koboSpan" id="kobo.1509.1"> {
  @</span><span class="hljs-title"><span class="koboSpan" id="kobo.1510.1">Input</span></span><span class="koboSpan" id="kobo.1511.1">() target = </span><span class="hljs-string"><span class="koboSpan" id="kobo.1512.1">''</span></span><span class="koboSpan" id="kobo.1513.1">;
  @</span><span class="hljs-title"><span class="koboSpan" id="kobo.1514.1">HostListener</span></span><span class="koboSpan" id="kobo.1515.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1516.1">'click'</span></span><span class="koboSpan" id="kobo.1517.1">)
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.1518.1">onClick</span></span><span class="koboSpan" id="kobo.1519.1">() {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1520.1">const</span></span><span class="koboSpan" id="kobo.1521.1"> targetElement = </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1522.1">document</span></span><span class="koboSpan" id="kobo.1523.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1524.1">querySelector</span></span><span class="koboSpan" id="kobo.1525.1">
      (</span><span class="hljs-variable"><span class="koboSpan" id="kobo.1526.1">this</span></span><span class="koboSpan" id="kobo.1527.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1528.1">target</span></span><span class="koboSpan" id="kobo.1529.1">);
    targetElement.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1530.1">scrollIntoView</span></span><span class="koboSpan" id="kobo.1531.1">(</span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1532.1">{</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1533.1">behavior</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1534.1">: </span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1535.1">'smooth'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1536.1">});</span></strong></span><span class="koboSpan" id="kobo.1537.1">
  }
}
</span></code></pre>
</li>
</ol>
<h2 class="heading-2" id="_idParaDest-71"><span class="koboSpan" id="kobo.1538.1">How it works…</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1539.1">The essence of this recipe is the web API that we’re using within an Angular directive, which is </span><code class="inlineCode"><span class="koboSpan" id="kobo.1540.1">Element.scrollIntoView</span></code><span class="koboSpan" id="kobo.1541.1">. </span><span class="koboSpan" id="kobo.1541.2">We first attach our </span><code class="inlineCode"><span class="koboSpan" id="kobo.1542.1">appScrollTo</span></code><span class="koboSpan" id="kobo.1543.1"> directive to the elements </span><a id="_idIndexMarker140"/><span class="koboSpan" id="kobo.1544.1">that should trigger scrolling upon clicking them. </span><span class="koboSpan" id="kobo.1544.2">We also specify which element to scroll to by using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1545.1">target</span></code><span class="koboSpan" id="kobo.1546.1"> input for each directive attached. </span><span class="koboSpan" id="kobo.1546.2">Then, we implement the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1547.1">click</span></code><span class="koboSpan" id="kobo.1548.1"> handler inside the directive with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1549.1">scrollIntoView</span></code><span class="koboSpan" id="kobo.1550.1"> method to scroll to a particular target, and to use a smooth animation while scrolling, we pass the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1551.1">{behavior: 'smooth'}</span></code><span class="koboSpan" id="kobo.1552.1"> object as an argument to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1553.1">scrollIntoView</span></code><span class="koboSpan" id="kobo.1554.1"> method.</span></p>
<h2 class="heading-2" id="_idParaDest-72"><span class="koboSpan" id="kobo.1555.1">See also</span></h2>
<ul>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.1556.1">scrollIntoView</span></code><span class="koboSpan" id="kobo.1557.1"> method documentation: </span><a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoView"><span class="url"><span class="koboSpan" id="kobo.1558.1">https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollIntoView</span></span></a></li>
<li class="bulletList"><span class="koboSpan" id="kobo.1559.1">Angular attribute directives documentation: </span><a href="https://angular.io/guide/testing-attribute-directives"><span class="url"><span class="koboSpan" id="kobo.1560.1">https://angular.io/guide/testing-attribute-directives</span></span></a></li>
</ul>
<h1 class="heading-1" id="_idParaDest-73"><span class="koboSpan" id="kobo.1561.1">Writing your first custom structural directive</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.1562.1">In this recipe, you’ll</span><a id="_idIndexMarker141"/><span class="koboSpan" id="kobo.1563.1"> write your first custom structural directive named </span><code class="inlineCode"><span class="koboSpan" id="kobo.1564.1">showFor</span></code><span class="koboSpan" id="kobo.1565.1"> (or </span><code class="inlineCode"><span class="koboSpan" id="kobo.1566.1">*appShowFor</span></code><span class="koboSpan" id="kobo.1567.1"> with the prefix). </span><span class="koboSpan" id="kobo.1567.2">A structural directive is one that can add or remove elements from the DOM. </span><span class="koboSpan" id="kobo.1567.3">So, with this directive, we will add the particular element to the DOM if a provided Boolean is true, and we will remove it after the specified time (provided as a number representing milliseconds).</span></p>
<h2 class="heading-2" id="_idParaDest-74"><span class="koboSpan" id="kobo.1568.1">Getting ready</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1569.1">The app that we are going to work with resides in </span><code class="inlineCode"><span class="koboSpan" id="kobo.1570.1">start/apps/chapter02/ng-show-for-directive</span></code><span class="koboSpan" id="kobo.1571.1"> inside the cloned repository:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1572.1">Open the code repository in your code editor.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1573.1">Open the terminal, navigate to the code repository directory, and run the following command to serve the project:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1574.1">npm run serve ng-show-for-directive
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1575.1">This should open the app in a new browser tab, and you should see the following:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1576.1"><img alt="" role="presentation" src="../Images/B18469_02_07.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1577.1">Figure 2.7: ng-show-for-directive app running on http://localhost:4200</span></p></li>
</ol>
<h2 class="heading-2" id="_idParaDest-75"><span class="koboSpan" id="kobo.1578.1">How to do it…</span></h2>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1579.1">First of all, we’ll </span><a id="_idIndexMarker142"/><span class="koboSpan" id="kobo.1580.1">create a directive using the following command in the workspace root folder:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1581.1">cd start &amp;&amp; nx g directive show-for --directory apps/chapter02/ng-show-for-directive/src/app/directives --standalone=false
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1582.1">If asked, choose the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1583.1">@nx/angular:component schematics</span></code><span class="koboSpan" id="kobo.1584.1"> and choose the “As provided” action.</span></p> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="2"><span class="koboSpan" id="kobo.1585.1">Now, instead of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1586.1">*ngIf</span></code><span class="koboSpan" id="kobo.1587.1"> directive in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1588.1">app.component.html</span></code><span class="koboSpan" id="kobo.1589.1"> file on the element with the class </span><code class="inlineCode"><span class="koboSpan" id="kobo.1590.1">"dialog"</span></code><span class="koboSpan" id="kobo.1591.1">, we can use our </span><code class="inlineCode"><span class="koboSpan" id="kobo.1592.1">*appShowFor</span></code><span class="koboSpan" id="kobo.1593.1"> directive:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1594.1">...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1595.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1596.1">main</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1597.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1598.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1599.1">"content"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1600.1">role</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1601.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1602.1">"main"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1603.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1604.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1605.1">button</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1606.1"> (</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.1607.1">click</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1608.1">)=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1609.1">"toggleDialog()"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1610.1">&gt;</span></span><span class="koboSpan" id="kobo.1611.1">Toggle Dialog</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1612.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1613.1">button</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1614.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1615.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1616.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1617.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1618.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1619.1">"dialog"</span></span><span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1620.1">*</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1621.1">appShowFor</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1622.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1623.1">"showDialog"</span></strong></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1624.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1625.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1626.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1627.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1628.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1629.1">"dialog__heading"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1630.1">&gt;</span></span><span class="koboSpan" id="kobo.1631.1">...</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1632.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1633.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1634.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1635.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1636.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1637.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1638.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1639.1">"dialog__body"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1640.1">&gt;</span></span><span class="koboSpan" id="kobo.1641.1">...</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1642.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1643.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1644.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1645.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1646.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1647.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1648.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1649.1">main</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1650.1">&gt;</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1651.1">Now that we have set the condition, we need to create two </span><code class="inlineCode"><span class="koboSpan" id="kobo.1652.1">@Input</span></code><span class="koboSpan" id="kobo.1653.1"> properties inside the directive’s TypeScript file, one being a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1654.1">boolean</span></code><span class="koboSpan" id="kobo.1655.1"> property and one being a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1656.1">number</span></code><span class="koboSpan" id="kobo.1657.1">. </span><span class="koboSpan" id="kobo.1657.2">We’ll use a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1658.1">setter</span></code><span class="koboSpan" id="kobo.1659.1"> to intercept the Boolean value’s changes and will log the value to the console for now:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1660.1">import</span></span><span class="koboSpan" id="kobo.1661.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1662.1">Directive</span></span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1663.1">, </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1664.1">Input</span></strong></span><span class="koboSpan" id="kobo.1665.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1666.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1667.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.1668.1">;
@</span><span class="hljs-title"><span class="koboSpan" id="kobo.1669.1">Directive</span></span><span class="koboSpan" id="kobo.1670.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1671.1">selector</span></span><span class="koboSpan" id="kobo.1672.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1673.1">'[appShowFor]'</span></span><span class="koboSpan" id="kobo.1674.1">,
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1675.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1676.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1677.1">ShowForDirective</span></span><span class="koboSpan" id="kobo.1678.1"> {
  </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1679.1">@</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1680.1">Input</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1681.1">() duration = </span></strong><strong class="hljs-number-slc"><span class="koboSpan" id="kobo.1682.1">1500</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1683.1">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1684.1">@</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1685.1">Input</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1686.1">() </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1687.1">set</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1688.1">appShowFor</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1689.1">(</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.1690.1">value: boolean</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1691.1">) {</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1692.1">console</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1693.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1694.1">log</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1695.1">({ </span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1696.1">showForValue</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1697.1">: value });</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1698.1">}</span></strong></span><span class="koboSpan" id="kobo.1699.1">
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1700.1">If you tap</span><a id="_idIndexMarker143"/><span class="koboSpan" id="kobo.1701.1"> on the </span><strong class="screenText"><span class="koboSpan" id="kobo.1702.1">Toggle Dialog</span></strong><span class="koboSpan" id="kobo.1703.1"> button now, you should see the values being changed and reflected on the console, as follows:</span></li>
</ol>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1704.1"><img alt="" role="presentation" src="../Images/B18469_02_08.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1705.1">Figure 2.8: Console logs displaying changes for the appShowFor directive values</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="5"><span class="koboSpan" id="kobo.1706.1">Now, we’re moving toward the actual implementation of showing and hiding the content based on the value being </span><code class="inlineCode"><span class="koboSpan" id="kobo.1707.1">false</span></code><span class="koboSpan" id="kobo.1708.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1709.1">true</span></code><span class="koboSpan" id="kobo.1710.1"> respectively. </span><span class="koboSpan" id="kobo.1710.2">For that, we first need the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1711.1">TemplateRef</span></code><span class="koboSpan" id="kobo.1712.1"> service and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1713.1">ViewContainerRef</span></code><span class="koboSpan" id="kobo.1714.1"> service injected into the constructor of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1715.1">if-not.directive.ts</span></code><span class="koboSpan" id="kobo.1716.1"> file. </span><span class="koboSpan" id="kobo.1716.2">Let’s add these, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1717.1">import</span></span><span class="koboSpan" id="kobo.1718.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1719.1">Directive</span></span><span class="koboSpan" id="kobo.1720.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.1721.1">Input</span></span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1722.1">, </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1723.1">TemplateRef</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1724.1">, </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1725.1">ViewContainerRef</span></strong></span><span class="koboSpan" id="kobo.1726.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1727.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1728.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.1729.1">;
@</span><span class="hljs-title"><span class="koboSpan" id="kobo.1730.1">Directive</span></span><span class="koboSpan" id="kobo.1731.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1732.1">selector</span></span><span class="koboSpan" id="kobo.1733.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.1734.1">'[appShowFor]'</span></span><span class="koboSpan" id="kobo.1735.1">
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1736.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1737.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1738.1">ShowForDirective</span></span><span class="koboSpan" id="kobo.1739.1">{
  @</span><span class="hljs-title"><span class="koboSpan" id="kobo.1740.1">Input</span></span><span class="koboSpan" id="kobo.1741.1">() duration = </span><span class="hljs-number"><span class="koboSpan" id="kobo.1742.1">1500</span></span><span class="koboSpan" id="kobo.1743.1">;
  @</span><span class="hljs-title"><span class="koboSpan" id="kobo.1744.1">Input</span></span><span class="koboSpan" id="kobo.1745.1">() </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1746.1">set</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1747.1">appShowFor</span></span><span class="koboSpan" id="kobo.1748.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1749.1">value: boolean</span></span><span class="koboSpan" id="kobo.1750.1">) {
     </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1751.1">console</span></span><span class="koboSpan" id="kobo.1752.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1753.1">log</span></span><span class="koboSpan" id="kobo.1754.1">({ </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1755.1">showForValue</span></span><span class="koboSpan" id="kobo.1756.1">: value });
   }
   </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1757.1">constructor</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1758.1">(</span></strong></span>
<span class="code-highlight"><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.1759.1">private templateRef: TemplateRef&lt;any&gt;,</span></strong></span>
<span class="code-highlight"><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.1760.1">private viewContainerRef: ViewContainerRef</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1761.1">) {}</span></strong></span><span class="koboSpan" id="kobo.1762.1">
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1763.1">Now let’s show </span><a id="_idIndexMarker144"/><span class="koboSpan" id="kobo.1764.1">the element. </span><span class="koboSpan" id="kobo.1764.2">We’re going to create a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1765.1">show</span></code><span class="koboSpan" id="kobo.1766.1"> method and we’ll call it when the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1767.1">appShowFor</span></code><span class="koboSpan" id="kobo.1768.1"> property becomes </span><code class="inlineCode"><span class="koboSpan" id="kobo.1769.1">true</span></code><span class="koboSpan" id="kobo.1770.1">. </span><span class="koboSpan" id="kobo.1770.2">The code should look as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1771.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1772.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1773.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1774.1">ShowForDirective</span></span><span class="koboSpan" id="kobo.1775.1"> {
  @</span><span class="hljs-title"><span class="koboSpan" id="kobo.1776.1">Input</span></span><span class="koboSpan" id="kobo.1777.1">() duration = </span><span class="hljs-number"><span class="koboSpan" id="kobo.1778.1">1500</span></span><span class="koboSpan" id="kobo.1779.1">;
  @</span><span class="hljs-title"><span class="koboSpan" id="kobo.1780.1">Input</span></span><span class="koboSpan" id="kobo.1781.1">() </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1782.1">set</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1783.1">appShowFor</span></span><span class="koboSpan" id="kobo.1784.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1785.1">value: boolean</span></span><span class="koboSpan" id="kobo.1786.1">) {
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1787.1">console</span></span><span class="koboSpan" id="kobo.1788.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1789.1">log</span></span><span class="koboSpan" id="kobo.1790.1">({ </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1791.1">showForValue</span></span><span class="koboSpan" id="kobo.1792.1">: value });
    </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1793.1">if</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1794.1"> (value) {</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1795.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1796.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1797.1">show</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1798.1">();</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1799.1">}</span></strong></span><span class="koboSpan" id="kobo.1800.1">
  }
  </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1801.1">show</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1802.1">() {</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1803.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1804.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1805.1">viewContainerRef</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1806.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1807.1">createEmbeddedView</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1808.1">(</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1809.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1810.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1811.1">templateRef</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1812.1">);</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1813.1">}</span></strong></span>
<span class="hljs-title"><span class="koboSpan" id="kobo.1814.1">constructor</span></span><span class="koboSpan" id="kobo.1815.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1816.1">...</span></span><span class="koboSpan" id="kobo.1817.1">) {}
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1818.1">If you click the </span><strong class="screenText"><span class="koboSpan" id="kobo.1819.1">Toggle Dialog</span></strong><span class="koboSpan" id="kobo.1820.1"> button now, you should be able to see the dialog as follows:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1821.1"><img alt="" role="presentation" src="../Images/B18469_02_09.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1822.1">Figure 2.9: Dialog being shown using the show method</span></p> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="7"><span class="koboSpan" id="kobo.1823.1">Let’s</span><a id="_idIndexMarker145"/><span class="koboSpan" id="kobo.1824.1"> implement the logic of hiding the dialog. </span><span class="koboSpan" id="kobo.1824.2">We’ll use an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1825.1">@Output()</span></code><span class="koboSpan" id="kobo.1826.1"> prop with an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1827.1">EventEmitter</span></code><span class="koboSpan" id="kobo.1828.1"> for this as we want the value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.1829.1">appShowFor</span></code><span class="koboSpan" id="kobo.1830.1"> that’s passed by the parent to be updated, instead of updating it within the directive. </span><span class="koboSpan" id="kobo.1830.2">Modify the code as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1831.1">import</span></span><span class="koboSpan" id="kobo.1832.1"> { ... </span><span class="koboSpan" id="kobo.1832.2">, </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1833.1">EventEmitter</span></strong><strong class="hljs-slc"> </strong></span><span class="koboSpan" id="kobo.1834.1">} </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1835.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1836.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.1837.1">;
...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1838.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1839.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1840.1">ShowForDirective</span></span><span class="koboSpan" id="kobo.1841.1"> {
  @</span><span class="hljs-title"><span class="koboSpan" id="kobo.1842.1">Input</span></span><span class="koboSpan" id="kobo.1843.1">() duration = </span><span class="hljs-number"><span class="koboSpan" id="kobo.1844.1">1500</span></span><span class="koboSpan" id="kobo.1845.1">;
  @</span><span class="hljs-title"><span class="koboSpan" id="kobo.1846.1">Input</span></span><span class="koboSpan" id="kobo.1847.1">() </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1848.1">set</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1849.1">appShowFor</span></span><span class="koboSpan" id="kobo.1850.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1851.1">value: boolean</span></span><span class="koboSpan" id="kobo.1852.1">) {
    ...
  </span><span class="koboSpan" id="kobo.1852.2">}
  </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1853.1">@</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1854.1">Output</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1855.1">() elementHidden = </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1856.1">new</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1857.1">EventEmitter</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1858.1">();</span></strong></span>
<span class="hljs-title"><span class="koboSpan" id="kobo.1859.1">show</span></span><span class="koboSpan" id="kobo.1860.1">() {...}
  </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1861.1">hide</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1862.1">() {</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1863.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1864.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1865.1">viewContainerRef</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1866.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1867.1">clear</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1868.1">();</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1869.1">}</span></strong></span>
<span class="hljs-title"><span class="koboSpan" id="kobo.1870.1">constructor</span></span><span class="koboSpan" id="kobo.1871.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1872.1">...</span></span><span class="koboSpan" id="kobo.1873.1">) {}
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1874.1">Now that we have the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1875.1">hide</span></code><span class="koboSpan" id="kobo.1876.1"> method there, let’s call it after the duration time saved in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1877.1">duration</span></code><span class="koboSpan" id="kobo.1878.1"> property of the directive. </span><span class="koboSpan" id="kobo.1878.2">This is so the dialog hides after that duration. </span><span class="koboSpan" id="kobo.1878.3">Modify the code of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1879.1">show</span></code><span class="koboSpan" id="kobo.1880.1"> method as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.1881.1">show</span></span><span class="koboSpan" id="kobo.1882.1">() {
  </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1883.1">this</span></span><span class="koboSpan" id="kobo.1884.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1885.1">viewContainerRef</span></span><span class="koboSpan" id="kobo.1886.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1887.1">createEmbeddedView</span></span><span class="koboSpan" id="kobo.1888.1">(
   </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1889.1">this</span></span><span class="koboSpan" id="kobo.1890.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1891.1">templateRef</span></span><span class="koboSpan" id="kobo.1892.1">
  );
  </span><span class="code-highlight"><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.1893.1">setTimeout</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1894.1">(</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.1895.1">() =&gt;</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1896.1"> {</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1897.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1898.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1899.1">elementHidden</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1900.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1901.1">emit</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1902.1">();</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1903.1">}, </span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1904.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1905.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1906.1">duration</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1907.1">);</span></strong></span><span class="koboSpan" id="kobo.1908.1">
 }
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1909.1">With this change, you’ll see that nothing happens if you click the </span><strong class="screenText"><span class="koboSpan" id="kobo.1910.1">Toggle Dialog</span></strong><span class="koboSpan" id="kobo.1911.1"> button after the dialog is shown, i.e., it never gets hidden. </span><span class="koboSpan" id="kobo.1911.2">For that, we need to listen to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1912.1">elementHidden</span></code><span class="koboSpan" id="kobo.1913.1"> event emitter we just created.</span></p></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="9"><span class="koboSpan" id="kobo.1914.1">Let’s make</span><a id="_idIndexMarker146"/><span class="koboSpan" id="kobo.1915.1"> the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1916.1">app.component.html</span></code><span class="koboSpan" id="kobo.1917.1"> listen to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1918.1">elementHidden</span></code><span class="koboSpan" id="kobo.1919.1"> event listener to change the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1920.1">showDialog</span></code><span class="koboSpan" id="kobo.1921.1"> property as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.1922.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1923.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1924.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1925.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1926.1">"dialog"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1927.1"> *</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.1928.1">appShowFor</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1929.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1930.1">"showDialog"</span></span>
<span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1931.1">(</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1932.1">elementHidden</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1933.1">)=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1934.1">"toggleDialog()"</span></strong></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1935.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1936.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1937.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1938.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1939.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1940.1">"dialog__heading"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1941.1">&gt;</span></span><span class="koboSpan" id="kobo.1942.1">
            I am a Dialog
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1943.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1944.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1945.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1946.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1947.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1948.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1949.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1950.1">"dialog__body"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1951.1">&gt;</span></span><span class="koboSpan" id="kobo.1952.1">
      And this is some random content
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1953.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1954.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1955.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1956.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1957.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1958.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1959.1">With this change, you’ll notice that it still doesn’t work. </span><span class="koboSpan" id="kobo.1959.2">Yep! </span><span class="koboSpan" id="kobo.1959.3">Because we need to call the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1960.1">hide</span></code><span class="koboSpan" id="kobo.1961.1"> method when the value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.1962.1">showDialog</span></code><span class="koboSpan" id="kobo.1963.1"> passed as the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1964.1">appShowFor</span></code><span class="koboSpan" id="kobo.1965.1"> prop is set to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1966.1">false</span></code><span class="koboSpan" id="kobo.1967.1">.</span></p> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="10"><span class="koboSpan" id="kobo.1968.1">Let’s call the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1969.1">hide</span></code><span class="koboSpan" id="kobo.1970.1"> method in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1971.1">ShowForDirective</span></code><span class="koboSpan" id="kobo.1972.1"> (in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1973.1">appShowFor</span></code><span class="koboSpan" id="kobo.1974.1"> property’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.1975.1">set</span></code><span class="koboSpan" id="kobo.1976.1"> method) when the value of </span><code class="inlineCode"><span class="koboSpan" id="kobo.1977.1">appShowFor</span></code><span class="koboSpan" id="kobo.1978.1"> becomes </span><code class="inlineCode"><span class="koboSpan" id="kobo.1979.1">false</span></code><span class="koboSpan" id="kobo.1980.1"> as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1981.1">@</span><span class="hljs-title"><span class="koboSpan" id="kobo.1982.1">Input</span></span><span class="koboSpan" id="kobo.1983.1">() </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1984.1">set</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1985.1">appShowFor</span></span><span class="koboSpan" id="kobo.1986.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.1987.1">value: boolean</span></span><span class="koboSpan" id="kobo.1988.1">) {
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1989.1">console</span></span><span class="koboSpan" id="kobo.1990.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1991.1">log</span></span><span class="koboSpan" id="kobo.1992.1">({ </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1993.1">showForValue</span></span><span class="koboSpan" id="kobo.1994.1">: value });
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1995.1">if</span></span><span class="koboSpan" id="kobo.1996.1"> (value) {
      </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1997.1">this</span></span><span class="koboSpan" id="kobo.1998.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1999.1">show</span></span><span class="koboSpan" id="kobo.2000.1">();
    } </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.2001.1">else</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2002.1"> {</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.2003.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2004.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2005.1">hide</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2006.1">();</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2007.1">}</span></strong></span><span class="koboSpan" id="kobo.2008.1">
  }
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2009.1">The thing is… this still won’t work because a structural directive in Angular can’t emit values. </span><span class="koboSpan" id="kobo.2009.2">Or even if it does, the parent element won’t be able to listen to it. </span><span class="koboSpan" id="kobo.2009.3">The following Stack Overflow question discusses why and links to an open GitHub issue in the Angular repository as well: </span><a href="https://stackoverflow.com/q/44235638"><span class="url"><span class="koboSpan" id="kobo.2010.1">https://stackoverflow.com/q/44235638</span></span></a><span class="koboSpan" id="kobo.2011.1">.</span></p> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="11"><span class="koboSpan" id="kobo.2012.1">To make our</span><a id="_idIndexMarker147"/><span class="koboSpan" id="kobo.2013.1"> structural directive work, we need to get rid of the syntactic sugar it comes with. </span><span class="koboSpan" id="kobo.2013.2">Let’s modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2014.1">app.component.html</span></code><span class="koboSpan" id="kobo.2015.1"> to use the directive in a different (expanded) way, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.2016.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2017.1">main</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2018.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2019.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2020.1">"content"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2021.1">role</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2022.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2023.1">"main"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2024.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2025.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2026.1">button</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2027.1"> (</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2028.1">click</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2029.1">)=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2030.1">"toggleDialog()"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2031.1">&gt;</span></span><span class="koboSpan" id="kobo.2032.1">Toggle Dialog</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2033.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2034.1">button</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2035.1">&gt;</span></span>
<span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2036.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2037.1">ng-template</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2038.1"> [</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2039.1">appShowFor</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2040.1">]=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2041.1">"showDialog"</span></strong></span>
<span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2042.1">(</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2043.1">elementHidden</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2044.1">)=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2045.1">"toggleDialog()"</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2046.1">&gt;</span></strong></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2047.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2048.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2049.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2050.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2051.1">"dialog"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2052.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2053.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2054.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2055.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2056.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2057.1">"dialog__heading"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2058.1">&gt;</span></span><span class="koboSpan" id="kobo.2059.1">
        I am a Dialog
      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2060.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2061.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2062.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2063.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2064.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2065.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2066.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2067.1">"dialog__body"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2068.1">&gt;</span></span><span class="koboSpan" id="kobo.2069.1">
        And this is some random content
      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2070.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2071.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2072.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2073.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2074.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2075.1">&gt;</span></span>
<span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2076.1">&lt;/</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2077.1">ng-template</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2078.1">&gt;</span></strong></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2079.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2080.1">main</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2081.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2082.1">The dialog should be hidden now. </span><span class="koboSpan" id="kobo.2082.2">Yay! </span><span class="koboSpan" id="kobo.2082.3">But wait. </span><span class="koboSpan" id="kobo.2082.4">Try clicking the </span><strong class="screenText"><span class="koboSpan" id="kobo.2083.1">Toggle Dialog</span></strong><span class="koboSpan" id="kobo.2084.1"> button lots of times quickly. </span><span class="koboSpan" id="kobo.2084.2">You’ll see that the app goes crazy. </span><span class="koboSpan" id="kobo.2084.3">That’s because we end up having too many </span><code class="inlineCode"><span class="koboSpan" id="kobo.2085.1">setTimeout</span></code><span class="koboSpan" id="kobo.2086.1"> functions registered.</span></p></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="12"><span class="koboSpan" id="kobo.2087.1">Let’s clear the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2088.1">setTimeout</span></code><span class="koboSpan" id="kobo.2089.1"> if we toggle the dialog to manually hide it. </span><span class="koboSpan" id="kobo.2089.2">Update the code for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2090.1">ShowForDirective</span></code><span class="koboSpan" id="kobo.2091.1"> class as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2092.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2093.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2094.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2095.1">ShowForDirective</span></span><span class="koboSpan" id="kobo.2096.1"> {
  ...
  </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2097.1">timer!: </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2098.1">ReturnType</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2099.1">&lt;</span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.2100.1">typeof</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.2101.1">setTimeout</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2102.1">&gt;;</span></strong></span>
<span class="hljs-title"><span class="koboSpan" id="kobo.2103.1">show</span></span><span class="koboSpan" id="kobo.2104.1">() {
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.2105.1">this</span></span><span class="koboSpan" id="kobo.2106.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.2107.1">viewContainerRef</span></span><span class="koboSpan" id="kobo.2108.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.2109.1">createEmbeddedView</span></span><span class="koboSpan" id="kobo.2110.1">(
      </span><span class="hljs-variable"><span class="koboSpan" id="kobo.2111.1">this</span></span><span class="koboSpan" id="kobo.2112.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.2113.1">templateRef</span></span><span class="koboSpan" id="kobo.2114.1">
    );
    </span><span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.2115.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2116.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.2117.1">timer</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2118.1"> = </span></strong></span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2119.1">setTimeout</span></span><span class="koboSpan" id="kobo.2120.1">(</span><span class="hljs-function"><span class="koboSpan" id="kobo.2121.1">() =&gt;</span></span><span class="koboSpan" id="kobo.2122.1"> {
      </span><span class="hljs-variable"><span class="koboSpan" id="kobo.2123.1">this</span></span><span class="koboSpan" id="kobo.2124.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.2125.1">elementHidden</span></span><span class="koboSpan" id="kobo.2126.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.2127.1">emit</span></span><span class="koboSpan" id="kobo.2128.1">();
    }, </span><span class="hljs-variable"><span class="koboSpan" id="kobo.2129.1">this</span></span><span class="koboSpan" id="kobo.2130.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.2131.1">duration</span></span><span class="koboSpan" id="kobo.2132.1">);
  }
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.2133.1">hide</span></span><span class="koboSpan" id="kobo.2134.1">() {
    </span><span class="code-highlight"><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.2135.1">clearTimeout</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2136.1">(</span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.2137.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2138.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.2139.1">timer</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2140.1">);</span></strong></span>
<span class="hljs-variable"><span class="koboSpan" id="kobo.2141.1">this</span></span><span class="koboSpan" id="kobo.2142.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.2143.1">viewContainerRef</span></span><span class="koboSpan" id="kobo.2144.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.2145.1">clear</span></span><span class="koboSpan" id="kobo.2146.1">();
  }
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.2147.1">constructor</span></span><span class="koboSpan" id="kobo.2148.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.2149.1">...</span></span><span class="koboSpan" id="kobo.2150.1">) {}
}
</span></code></pre>
</li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.2151.1">Awesome! </span><span class="koboSpan" id="kobo.2151.2">You’ll notice</span><a id="_idIndexMarker148"/><span class="koboSpan" id="kobo.2152.1"> that even if you click the </span><strong class="screenText"><span class="koboSpan" id="kobo.2153.1">Toggle Dialog</span></strong><span class="koboSpan" id="kobo.2154.1"> button fast and too many times, the app behaves correctly.</span></p>
<h2 class="heading-2" id="_idParaDest-76"><span class="koboSpan" id="kobo.2155.1">How it works…</span></h2>
<p class="normal"><strong class="keyWord"><span class="koboSpan" id="kobo.2156.1">Structural directives</span></strong><span class="koboSpan" id="kobo.2157.1"> in</span><a id="_idIndexMarker149"/><span class="koboSpan" id="kobo.2158.1"> Angular are special for multiple reasons. </span><span class="koboSpan" id="kobo.2158.2">First, they allow you to manipulate DOM elements—that is, not just showing and hiding but also adding and removing elements entirely from the DOM based on your needs. </span><span class="koboSpan" id="kobo.2158.3">Moreover, they have the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2159.1">*</span></code><span class="koboSpan" id="kobo.2160.1"> prefix, which binds to all the magic Angular does behind the scenes. </span><span class="koboSpan" id="kobo.2160.2">For example, Angular automatically provides the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2161.1">TemplateRef</span></code><span class="koboSpan" id="kobo.2162.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.2163.1">ViewContainer</span></code><span class="koboSpan" id="kobo.2164.1"> for working with this directive. </span><span class="koboSpan" id="kobo.2164.2">As an example, </span><code class="inlineCode"><span class="koboSpan" id="kobo.2165.1">*ngIf</span></code><span class="koboSpan" id="kobo.2166.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.2167.1">*ngFor</span></code><span class="koboSpan" id="kobo.2168.1"> are both structural directives that work behind the scenes with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2169.1">&lt;ng-template&gt;</span></code><span class="koboSpan" id="kobo.2170.1"> directive containing the content you bind the directive to. </span><span class="koboSpan" id="kobo.2170.2">They then create the required variables/properties for you in the scope of </span><code class="inlineCode"><span class="koboSpan" id="kobo.2171.1">ng-template</span></code><span class="koboSpan" id="kobo.2172.1">. </span><span class="koboSpan" id="kobo.2172.2">In this recipe, we do the same. </span><span class="koboSpan" id="kobo.2172.3">We use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2173.1">TemplateRef</span></code><span class="koboSpan" id="kobo.2174.1"> service to access the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2175.1">&lt;ng-template&gt;</span></code><span class="koboSpan" id="kobo.2176.1"> directive that Angular creates for us behind the scenes, containing </span><a id="_idIndexMarker150"/><span class="koboSpan" id="kobo.2177.1">the </span><strong class="keyWord"><span class="koboSpan" id="kobo.2178.1">host element</span></strong><span class="koboSpan" id="kobo.2179.1"> to which our </span><code class="inlineCode"><span class="koboSpan" id="kobo.2180.1">appShowFor</span></code><span class="koboSpan" id="kobo.2181.1"> directive is applied. </span><span class="koboSpan" id="kobo.2181.2">We use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2182.1">ViewContainerRef</span></code><span class="koboSpan" id="kobo.2183.1"> service to add the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2184.1">TemplateRef</span></code><span class="koboSpan" id="kobo.2185.1"> to the DOM via the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2186.1">createEmbeddedView</span></code><span class="koboSpan" id="kobo.2187.1"> method. </span></p>
<p class="normal"><span class="koboSpan" id="kobo.2188.1">We do this when the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2189.1">appShowFor</span></code><span class="koboSpan" id="kobo.2190.1"> property becomes </span><code class="inlineCode"><span class="koboSpan" id="kobo.2191.1">true</span></code><span class="koboSpan" id="kobo.2192.1">. </span><span class="koboSpan" id="kobo.2192.2">Notice that we’re intercepting the property </span><code class="inlineCode"><span class="koboSpan" id="kobo.2193.1">appShowFor</span></code><span class="koboSpan" id="kobo.2194.1"> using a </span><code class="inlineCode"><span class="koboSpan" id="kobo.2195.1">setter</span></code><span class="koboSpan" id="kobo.2196.1">. </span><span class="koboSpan" id="kobo.2196.2">We learned about this in </span><em class="chapterRef"><span class="koboSpan" id="kobo.2197.1">Chapter 1</span></em><span class="koboSpan" id="kobo.2198.1">, </span><em class="italic"><span class="koboSpan" id="kobo.2199.1">Winning Components Communication</span></em><span class="koboSpan" id="kobo.2200.1">. </span><span class="koboSpan" id="kobo.2200.2">We then use a </span><code class="inlineCode"><span class="koboSpan" id="kobo.2201.1">setTimeout</span></code><span class="koboSpan" id="kobo.2202.1"> to automatically notify the parent component that the value passed to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2203.1">appShowFor</span></code><span class="koboSpan" id="kobo.2204.1"> property needs to be changed to </span><code class="inlineCode"><span class="koboSpan" id="kobo.2205.1">false</span></code><span class="koboSpan" id="kobo.2206.1">. </span><span class="koboSpan" id="kobo.2206.2">We do this using an </span><code class="inlineCode"><span class="koboSpan" id="kobo.2207.1">@Output()</span></code><span class="koboSpan" id="kobo.2208.1"> emitter named </span><code class="inlineCode"><span class="koboSpan" id="kobo.2209.1">elementHidden</span></code><span class="koboSpan" id="kobo.2210.1">. </span><span class="koboSpan" id="kobo.2210.2">Notice that we’re not supposed to make it </span><code class="inlineCode"><span class="koboSpan" id="kobo.2211.1">false</span></code><span class="koboSpan" id="kobo.2212.1"> within the directive. </span><span class="koboSpan" id="kobo.2212.2">The parent component is supposed to do it and it will automatically reflect in the directive. </span><span class="koboSpan" id="kobo.2212.3">Our directive is supposed to react to that change and hide (or remove) the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2213.1">TemplateRef</span></code><span class="koboSpan" id="kobo.2214.1"> from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2215.1">ViewContainer</span></code><span class="koboSpan" id="kobo.2216.1">. </span><span class="koboSpan" id="kobo.2216.2">You can see that we do this in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2217.1">hide</span></code><span class="koboSpan" id="kobo.2218.1"> method using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2219.1">this.viewContainerRef.clear();</span></code><span class="koboSpan" id="kobo.2220.1"> statement. </span><span class="koboSpan" id="kobo.2220.2">One of the key things to learn from this recipe is that if we use syntactic sugar, i.e., </span><code class="inlineCode"><span class="koboSpan" id="kobo.2221.1">*appShowFor</span></code><span class="koboSpan" id="kobo.2222.1">, in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2223.1">app.component.html</span></code><span class="koboSpan" id="kobo.2224.1">, we can’t listen to </span><a id="_idIndexMarker151"/><span class="koboSpan" id="kobo.2225.1">the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2226.1">elementHidden</span></code><span class="koboSpan" id="kobo.2227.1"> event emitter. </span><span class="koboSpan" id="kobo.2227.2">That’s because this is a quirk of Angular - there’s an open issue on GitHub about this (check the </span><em class="italic"><span class="koboSpan" id="kobo.2228.1">See also</span></em><span class="koboSpan" id="kobo.2229.1"> section). </span><span class="koboSpan" id="kobo.2229.2">For this to work, we removed the syntactic sugar and expanded the syntax by using a </span><code class="inlineCode"><span class="koboSpan" id="kobo.2230.1">&lt;ng-template&gt;</span></code><span class="koboSpan" id="kobo.2231.1"> to wrap our dialog’s HTML in </span><em class="italic"><span class="koboSpan" id="kobo.2232.1">step 11</span></em><span class="koboSpan" id="kobo.2233.1">. </span><span class="koboSpan" id="kobo.2233.2">Notice that we just used </span><code class="inlineCode"><span class="koboSpan" id="kobo.2234.1">[appShowFor]</span></code><span class="koboSpan" id="kobo.2235.1"> to pass the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2236.1">showDialog</span></code><span class="koboSpan" id="kobo.2237.1"> variable instead of </span><code class="inlineCode"><span class="koboSpan" id="kobo.2238.1">*appShowFor="showDialog"</span></code><span class="koboSpan" id="kobo.2239.1">. </span><span class="koboSpan" id="kobo.2239.2">And we are also listening to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2240.1">elementHidden</span></code><span class="koboSpan" id="kobo.2241.1"> event on the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2242.1">&lt;ng-template&gt;</span></code><span class="koboSpan" id="kobo.2243.1"> element itself.</span></p>
<h2 class="heading-2" id="_idParaDest-77"><span class="koboSpan" id="kobo.2244.1">See also</span></h2>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.2245.1">Angular structural directive microsyntax documentation: </span><a href="https://angular.io/guide/structural-directives#microsyntax"><span class="url"><span class="koboSpan" id="kobo.2246.1">https://angular.io/guide/structural-directives#microsyntax</span></span></a></li>
<li class="bulletList"><span class="koboSpan" id="kobo.2247.1">Angular structural directives documentation: </span><a href="https://angular.io/guide/structural-directives"><span class="url"><span class="koboSpan" id="kobo.2248.1">https://angular.io/guide/structural-directives</span></span></a></li>
<li class="bulletList"><em class="italic"><span class="koboSpan" id="kobo.2249.1">Creating a Structural Directive</span></em><span class="koboSpan" id="kobo.2250.1"> by Rangle.io: </span><a href="https://angular-2-training-book.rangle.io/advanced-angular/directives/creating_a_structural_directive"><span class="url"><span class="koboSpan" id="kobo.2251.1">https://angular-2-training-book.rangle.io/advanced-angular/directives/creating_a_structural_directive</span></span></a></li>
<li class="bulletList"><em class="italic"><span class="koboSpan" id="kobo.2252.1">Sugar (*) syntax does not support @Output (and exportAs)</span></em><span class="koboSpan" id="kobo.2253.1">: </span><a href="https://github.com/angular/angular/issues/12121"><span class="url"><span class="koboSpan" id="kobo.2254.1">https://github.com/angular/angular/issues/12121</span></span></a></li>
</ul>
<h1 class="heading-1" id="_idParaDest-78"><span class="koboSpan" id="kobo.2255.1">How to apply multiple structural directives to the same element</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.2256.1">In certain</span><a id="_idIndexMarker152"/><span class="koboSpan" id="kobo.2257.1"> situations, you might want to use more than one structural directive on the same host or for the same element—for example, a combination of </span><code class="inlineCode"><span class="koboSpan" id="kobo.2258.1">*ngIf</span></code><span class="koboSpan" id="kobo.2259.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.2260.1">*ngFor</span></code><span class="koboSpan" id="kobo.2261.1"> together—which is not something Angular supports out of the box. </span><span class="koboSpan" id="kobo.2261.2">The reason is that it is hard to identify which directive takes precedence over the other, and even if there was a system, I think the apps would become too complex and hard to manage. </span><span class="koboSpan" id="kobo.2261.3">In this recipe, we will show a message conditionally using </span><code class="inlineCode"><span class="koboSpan" id="kobo.2262.1">*ngIf</span></code><span class="koboSpan" id="kobo.2263.1"> when we have no items in the bucket. </span><span class="koboSpan" id="kobo.2263.2">Since we’re supposed to show it conditionally and apply the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2264.1">for</span></code><span class="koboSpan" id="kobo.2265.1"> loop on the element, this is a perfect example to use for this recipe.</span></p>
<h2 class="heading-2" id="_idParaDest-79"><span class="koboSpan" id="kobo.2266.1">Getting ready</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2267.1">The app that we are going to work with resides in </span><code class="inlineCode"><span class="koboSpan" id="kobo.2268.1">start/apps/chapter02/ng-multi-struc-directives</span></code><span class="koboSpan" id="kobo.2269.1"> inside the cloned repository:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.2270.1">Open the</span><a id="_idIndexMarker153"/><span class="koboSpan" id="kobo.2271.1"> code repository in your code editor.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2272.1">Open the terminal, navigate to the code repository directory, and run the following command to serve the project:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2273.1">npm run serve ng-multi-struc-directives
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2274.1">This should open the app in a new browser tab, and you should see the following:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2275.1"><img alt="" role="presentation" src="../Images/B18469_02_10.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2276.1">Figure 2.10: ng-multi-struc-directives app running on http://localhost:4200</span></p> </li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.2277.1">Now that we have the app running, let’s see the steps for this recipe in the next section.</span></p>
<h2 class="heading-2" id="_idParaDest-80"><span class="koboSpan" id="kobo.2278.1">How to do it…</span></h2>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.2279.1">We’ll start by creating a template for the message to be shown when there are no items in the bucket. </span><span class="koboSpan" id="kobo.2279.2">We’ll modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2280.1">app.component.html</span></code><span class="koboSpan" id="kobo.2281.1"> file for this as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.2282.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2283.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2284.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2285.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2286.1">"fruits"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2287.1">&gt;</span></span><span class="koboSpan" id="kobo.2288.1">
    ...
    </span><span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2289.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2290.1">ng-template</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2291.1"> #</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2292.1">bucketEmptyMessage</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2293.1">&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2294.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2295.1">div</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2296.1">class</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2297.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2298.1">"fruits__no-items-msg"</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2299.1">&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2300.1">No items in bucket. </span><span class="koboSpan" id="kobo.2300.2">Add some fruits!</span></strong></span>
<span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2301.1">&lt;/</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2302.1">div</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2303.1">&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2304.1">&lt;/</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2305.1">ng-template</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2306.1">&gt;</span></strong></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2307.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2308.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2309.1">&gt;</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2310.1">Now we’ll try to apply the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2311.1">*ngIf</span></code><span class="koboSpan" id="kobo.2312.1"> condition to the element that renders the fruits. </span><span class="koboSpan" id="kobo.2312.2">Let’s modify the code in the same file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2313.1">...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2314.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2315.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2316.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2317.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2318.1">"fruits"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2319.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2320.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2321.1">div</span></span>
<span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2322.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2323.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2324.1">"fruits__item"</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2325.1">      *</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2326.1">ngFor</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2327.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2328.1">"let item of bucket"</span></span>
<span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2329.1">*</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2330.1">ngIf</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2331.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2332.1">"bucket.length &gt; 0; else bucketEmptyMessage" </span></strong></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2333.1">&gt;</span></span><span class="koboSpan" id="kobo.2334.1">...</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2335.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2336.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2337.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2338.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2339.1">ng-template</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2340.1"> #</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2341.1">bucketEmptyMessage</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2342.1">&gt;</span></span><span class="koboSpan" id="kobo.2343.1">...</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2344.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2345.1">ng-template</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2346.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2347.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2348.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2349.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2350.1">As </span><a id="_idIndexMarker154"/><span class="koboSpan" id="kobo.2351.1">soon as you save the preceding code, you’ll see the application breaks, saying that we can’t use multiple template bindings on one element. </span><span class="koboSpan" id="kobo.2351.2">This means we can’t use multiple structural directives on one element:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2352.1"><img alt="" role="presentation" src="../Images/B18469_02_11.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2353.1">Figure 2.11: Angular Language Service explaining we can’t use two structural directives on the same element</span></p> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="3"><span class="koboSpan" id="kobo.2354.1">We can fix this by moving one of the structural directives into a </span><code class="inlineCode"><span class="koboSpan" id="kobo.2355.1">&lt;ng-container&gt;</span></code><span class="koboSpan" id="kobo.2356.1"> wrapper, which doesn’t create any additional HTML elements in the DOM. </span><span class="koboSpan" id="kobo.2356.2">Let’s modify the code as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.2357.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2358.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2359.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2360.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2361.1">"fruits"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2362.1">&gt;</span></span>
<span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2363.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2364.1">ng-container</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2365.1"> *</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2366.1">ngIf</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2367.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2368.1">"bucket.length &gt; 0; else</span></strong></span>
<span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2369.1">bucketEmptyMessage"</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2370.1">&gt;</span></strong></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2371.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2372.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2373.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2374.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2375.1">"fruits__item"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2376.1"> *</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2377.1">ngFor</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2378.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2379.1">"let item of bucket"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2380.1">&gt;</span></span><span class="koboSpan" id="kobo.2381.1">
      ...
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2382.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2383.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2384.1">&gt;</span></span>
<span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2385.1">&lt;/</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2386.1">ng-container</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2387.1">&gt;</span></strong></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2388.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2389.1">ng-template</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2390.1"> #</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2391.1">bucketEmptyMessage</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2392.1">&gt;</span></span><span class="koboSpan" id="kobo.2393.1">...</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2394.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2395.1">ng-template</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2396.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2397.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2398.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2399.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2400.1">With the </span><a id="_idIndexMarker155"/><span class="koboSpan" id="kobo.2401.1">change above, you should be able to see the message when there are no items in the bucket, as follows:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2402.1"><img alt="" role="presentation" src="../Images/B18469_02_12.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2403.1">Figure 2.12: The final result with *ngIf and *ngFor together</span></p></li>
</ol>
<h2 class="heading-2" id="_idParaDest-81"><span class="koboSpan" id="kobo.2404.1">How it works…</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2405.1">Since we can’t use two structural directives on the same element (let’s say a button), we can always use another HTML element as a wrapper (parent) to use one of the structural directive on it, and the other structural directive on the target element (button in our case). </span><span class="koboSpan" id="kobo.2405.2">However, that adds another element to the DOM and might cause problems for your element hierarchy or other layout behavioral issues, based on your implementation. </span><span class="koboSpan" id="kobo.2405.3">However, </span><code class="inlineCode"><span class="koboSpan" id="kobo.2406.1">&lt;ng-container&gt;</span></code><span class="koboSpan" id="kobo.2407.1"> is a magical element from Angular that is not added to the DOM. </span><span class="koboSpan" id="kobo.2407.2">Instead, it just wraps the logic/condition that you apply to it, which makes it ideal for us to use in cases like these.</span></p>
<h2 class="heading-2" id="_idParaDest-82"><span class="koboSpan" id="kobo.2408.1">See also</span></h2>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.2409.1">Grouping sibling elements with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2410.1">&lt;ng-container&gt;</span></code><span class="koboSpan" id="kobo.2411.1"> documentation: </span><a href="https://angular.io/guide/structural-directives#group-sibling-elements-with-ng-container"><span class="url"><span class="koboSpan" id="kobo.2412.1">https://angular.io/guide/structural-directives#group-sibling-elements-with-ng-container</span></span></a></li>
</ul>
<h1 class="heading-1" id="_idParaDest-83"><span class="koboSpan" id="kobo.2413.1">Applying multiple directives to the same element using the Directive Composition API</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.2414.1">In this </span><a id="_idIndexMarker156"/><span class="koboSpan" id="kobo.2415.1">recipe, you’ll use the </span><strong class="keyWord"><span class="koboSpan" id="kobo.2416.1">Directive Composition API</span></strong><span class="koboSpan" id="kobo.2417.1"> to create multiple components and</span><a id="_idIndexMarker157"/><span class="koboSpan" id="kobo.2418.1"> apply directives to them directly for reusability instead of having to apply the directives to each component or create additional elements inside the template of the component to apply the directives.</span></p>
<h2 class="heading-2" id="_idParaDest-84"><span class="koboSpan" id="kobo.2419.1">Getting ready</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2420.1">The app that we are going to work with resides in </span><code class="inlineCode"><span class="koboSpan" id="kobo.2421.1">start/apps/chapter02/ng-directive-comp-api</span></code><span class="koboSpan" id="kobo.2422.1"> inside the cloned repository:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.2423.1">Open the code repository in your code editor.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2424.1">Open the terminal, navigate to the code repository directory, and run the following command to serve the project:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2425.1">npm run serve ng-directive-comp-api
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2426.1">This should open the app in a new browser tab, and you should see the following:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2427.1"><img alt="" role="presentation" src="../Images/B18469_02_13.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2428.1">Figure 2.13: ng-directive-comp-api app running on http://localhost:4200</span></p> </li>
</ol>
<h2 class="heading-2" id="_idParaDest-85"><span class="koboSpan" id="kobo.2429.1">How to do it…</span></h2>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.2430.1">First, we’ll </span><a id="_idIndexMarker158"/><span class="koboSpan" id="kobo.2431.1">create a couple of components for our application. </span><span class="koboSpan" id="kobo.2431.2">We’ll create one directive for the filled button, one for the outline button, and one for a </span><a id="_idIndexMarker159"/><span class="koboSpan" id="kobo.2432.1">button with a tooltip. </span><span class="koboSpan" id="kobo.2432.2">Run the following command from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2433.1">start</span></code><span class="koboSpan" id="kobo.2434.1"> folder within the workspace:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2435.1">nx g directive button-filled --directory apps/chapter02/ng-directive-comp-api/src/app/directives --standalone=false
nx g directive button-outlined --directory apps/chapter02/ng-directive-comp-api/src/app/directives --standalone=false
nx g directive button-with-tooltip --directory apps/chapter02/ng-directive-comp-api/src/app/directives --standalone=false
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2436.1">If asked, choose the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2437.1">@nx/angular:component schematics</span></code><span class="koboSpan" id="kobo.2438.1"> and choose the “As provided” action.</span></p>
<div class="note">
<p class="normal"><span class="koboSpan" id="kobo.2439.1">Note that all the directives we have created are non-standalone directives. </span><span class="koboSpan" id="kobo.2439.2">That is because the application is bootstrapped with an </span><code class="inlineCode"><span class="koboSpan" id="kobo.2440.1">NgModule</span></code><span class="koboSpan" id="kobo.2441.1"> and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2442.1">AppComponent</span></code><span class="koboSpan" id="kobo.2443.1"> is not a standalone component. </span><span class="koboSpan" id="kobo.2443.2">Therefore, we these directives to be imported in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2444.1">app.module.ts</span></code><span class="koboSpan" id="kobo.2445.1"> for this recipe to work.</span></p>
</div> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="2"><span class="koboSpan" id="kobo.2446.1">Let’s make the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2447.1">ButtonDirective</span></code><span class="koboSpan" id="kobo.2448.1"> a standalone directive, which means this isn’t going to be a part of any </span><code class="inlineCode"><span class="koboSpan" id="kobo.2449.1">NgModule</span></code><span class="koboSpan" id="kobo.2450.1">. </span><span class="koboSpan" id="kobo.2450.2">Update the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2451.1">button.directive.ts</span></code><span class="koboSpan" id="kobo.2452.1"> as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2453.1">...
</span><span class="koboSpan" id="kobo.2453.2">@</span><span class="hljs-title"><span class="koboSpan" id="kobo.2454.1">Directive</span></span><span class="koboSpan" id="kobo.2455.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2456.1">selector</span></span><span class="koboSpan" id="kobo.2457.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.2458.1">'[appButton]'</span></span><span class="koboSpan" id="kobo.2459.1">,
  </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2460.1">standalone</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2461.1">: </span></strong><strong class="hljs-literal-slc"><span class="koboSpan" id="kobo.2462.1">true</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2463.1">,</span></strong></span><span class="koboSpan" id="kobo.2464.1">
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2465.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2466.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2467.1">ButtonDirective</span></span><span class="koboSpan" id="kobo.2468.1"> {
  ...
</span><span class="koboSpan" id="kobo.2468.2">}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2469.1">Let’s also </span><a id="_idIndexMarker160"/><span class="koboSpan" id="kobo.2470.1">remove it from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2471.1">app.module.ts</span></code><span class="koboSpan" id="kobo.2472.1"> file as it is now a </span><code class="inlineCode"><span class="koboSpan" id="kobo.2473.1">standalone</span></code><span class="koboSpan" id="kobo.2474.1"> directive. </span><span class="koboSpan" id="kobo.2474.2">Update the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2475.1">app.module.ts</span></code><span class="koboSpan" id="kobo.2476.1"> file as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2477.1">...
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.2478.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2479.1"> { </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2480.1">ButtonDirective</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2481.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.2482.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2483.1">'</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2484.1">./directives/button.directive'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2485.1">; </span></strong><strong class="hljs-comment-slc"><span class="koboSpan" id="kobo.2486.1">// &lt;-- remove the import</span></strong></span><span class="koboSpan" id="kobo.2487.1">
...
</span><span class="koboSpan" id="kobo.2487.2">@</span><span class="hljs-title"><span class="koboSpan" id="kobo.2488.1">NgModule</span></span><span class="koboSpan" id="kobo.2489.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2490.1">declarations</span></span><span class="koboSpan" id="kobo.2491.1">: [
    ...,
    </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2492.1">ButtonDirective</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2493.1">, </span></strong><strong class="hljs-comment-slc"><span class="koboSpan" id="kobo.2494.1">// &lt;-- remove this</span></strong></span><span class="koboSpan" id="kobo.2495.1">
    ...
  </span><span class="koboSpan" id="kobo.2495.2">],
  ...
</span><span class="koboSpan" id="kobo.2495.3">})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2496.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2497.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2498.1">AppModule</span></span><span class="koboSpan" id="kobo.2499.1"> {}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2500.1">You’ll notice </span><a id="_idIndexMarker161"/><span class="koboSpan" id="kobo.2501.1">that none of the buttons have the required styles anymore as follows:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2502.1"><img alt="" role="presentation" src="../Images/B18469_02_14.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2503.1">Figure 2.14: Styles from the button directive are gone</span></p> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="4"><span class="koboSpan" id="kobo.2504.1">Let’s update the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2505.1">ButtonFilledDirective</span></code><span class="koboSpan" id="kobo.2506.1"> to use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2507.1">ButtonDirective</span></code><span class="koboSpan" id="kobo.2508.1"> using </span><a id="_idIndexMarker162"/><span class="koboSpan" id="kobo.2509.1">the Directive Composition API. </span><span class="koboSpan" id="kobo.2509.2">Update the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2510.1">button-filled.directive.ts</span></code><span class="koboSpan" id="kobo.2511.1"> file as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2512.1">import</span></span><span class="koboSpan" id="kobo.2513.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.2514.1">Directive</span></span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2515.1">, </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2516.1">HostBinding</span></strong></span><span class="koboSpan" id="kobo.2517.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2518.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2519.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2520.1">@angular/core'</span></span><span class="koboSpan" id="kobo.2521.1">;
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.2522.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2523.1"> { </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2524.1">ButtonDirective</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2525.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.2526.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2527.1">'./button.directive'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2528.1">;</span></strong></span><span class="koboSpan" id="kobo.2529.1">
@</span><span class="hljs-title"><span class="koboSpan" id="kobo.2530.1">Directive</span></span><span class="koboSpan" id="kobo.2531.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2532.1">selector</span></span><span class="koboSpan" id="kobo.2533.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.2534.1">'[appButtonFilled]'</span></span><span class="koboSpan" id="kobo.2535.1">,
  </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2536.1">hostDirectives</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2537.1">: [</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2538.1">{</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2539.1">directive</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2540.1">: </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2541.1">ButtonDirective</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2542.1">,</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2543.1">inputs</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2544.1">: [</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2545.1">'color'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2546.1">],</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2547.1">},</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2548.1">],</span></strong></span><span class="koboSpan" id="kobo.2549.1">
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2550.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2551.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2552.1">ButtonFilledDirective</span></span><span class="koboSpan" id="kobo.2553.1"> {
  </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2554.1">@</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2555.1">HostBinding</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2556.1">(</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2557.1">'attr.fill'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2558.1">)</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2559.1">fill = </span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2560.1">'filled'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2561.1">;</span></strong></span><span class="koboSpan" id="kobo.2562.1">
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2563.1">We can</span><a id="_idIndexMarker163"/><span class="koboSpan" id="kobo.2564.1"> use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2565.1">appButtonFilled</span></code><span class="koboSpan" id="kobo.2566.1"> directive in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2567.1">app.component.html</span></code><span class="koboSpan" id="kobo.2568.1"> file as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2569.1">...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2570.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2571.1">main</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2572.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2573.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2574.1">"content"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2575.1">role</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2576.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2577.1">"main"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2578.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2579.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2580.1">ul</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2581.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2582.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2583.1">"flex flex-col"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2584.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2585.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2586.1">li</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2587.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2588.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2589.1">"flex gap-4 items-center border-b justify-</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2590.1">      between border-slate-300 py-3"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2591.1">&gt;</span></span><span class="koboSpan" id="kobo.2592.1">...</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2593.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2594.1">li</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2595.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2596.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2597.1">li</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2598.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2599.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2600.1">"flex gap-4 items-center border-b justify-</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2601.1">      between border-slate-300 py-3"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2602.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2603.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2604.1">h4</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2605.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2606.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2607.1">"text-lg"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2608.1">&gt;</span></span><span class="koboSpan" id="kobo.2609.1">Filled Button:</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2610.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2611.1">h4</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2612.1">&gt;</span></span>
<span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2613.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2614.1">button</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2615.1">appButtonFilled</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2616.1">color</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2617.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2618.1">"</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2619.1">yellow"</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2620.1">&gt;</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2621.1">Click</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2622.1">Me</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2623.1">&lt;/</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2624.1">button</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2625.1">&gt;</span></strong></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2626.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2627.1">li</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2628.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2629.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2630.1">li</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2631.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2632.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2633.1">"flex gap-4 items-center border-b justify-</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2634.1">      between border-slate-300 py-3"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2635.1">&gt;</span></span><span class="koboSpan" id="kobo.2636.1">...</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2637.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2638.1">li</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2639.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2640.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2641.1">li</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2642.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2643.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2644.1">"flex gap-4 items-center border-b justify-</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2645.1">      between border-slate-300 py-3"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2646.1">&gt;</span></span><span class="koboSpan" id="kobo.2647.1">...</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2648.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2649.1">li</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2650.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2651.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2652.1">ul</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2653.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2654.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2655.1">main</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2656.1">&gt;</span></span>
</code></pre>
</li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.2657.1">Notice that we’ve removed the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2658.1">fill</span></code><span class="koboSpan" id="kobo.2659.1"> attribute from the element.</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="6"><span class="koboSpan" id="kobo.2660.1">Let’s update the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2661.1">ButtonOutlined</span></code><span class="koboSpan" id="kobo.2662.1"> directive as well. </span><span class="koboSpan" id="kobo.2662.2">We’ll modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2663.1">button-outlined.directive.ts</span></code><span class="koboSpan" id="kobo.2664.1"> as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2665.1">import</span></span><span class="koboSpan" id="kobo.2666.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.2667.1">Directive</span></span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2668.1">, </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2669.1">HostBinding</span></strong></span><span class="koboSpan" id="kobo.2670.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2671.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2672.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.2673.1">;
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.2674.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2675.1"> { </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2676.1">ButtonDirective</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2677.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.2678.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2679.1">'./button.directive'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2680.1">;</span></strong></span><span class="koboSpan" id="kobo.2681.1">
@</span><span class="hljs-title"><span class="koboSpan" id="kobo.2682.1">Directive</span></span><span class="koboSpan" id="kobo.2683.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2684.1">selector</span></span><span class="koboSpan" id="kobo.2685.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.2686.1">'[appButtonOutlined]'</span></span><span class="koboSpan" id="kobo.2687.1">,
  </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2688.1">hostDirectives</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2689.1">: [</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2690.1">{</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2691.1">directive</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2692.1">: </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2693.1">ButtonDirective</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2694.1">,</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2695.1">inputs</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2696.1">: [</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2697.1">'color'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2698.1">],</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2699.1">},</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2700.1">],</span></strong></span><span class="koboSpan" id="kobo.2701.1">
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2702.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2703.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2704.1">ButtonOutlinedDirective</span></span><span class="koboSpan" id="kobo.2705.1"> {
  </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2706.1">@</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2707.1">HostBinding</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2708.1">(</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2709.1">'attr.fill'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2710.1">)</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2711.1">fill = </span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2712.1">'outlined'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2713.1">;</span></strong></span><span class="koboSpan" id="kobo.2714.1">
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2715.1">Let’s </span><a id="_idIndexMarker164"/><span class="koboSpan" id="kobo.2716.1">also modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2717.1">ButtonWithTooltipDirective</span></code><span class="koboSpan" id="kobo.2718.1"> class. </span><span class="koboSpan" id="kobo.2718.2">We’ll </span><a id="_idIndexMarker165"/><span class="koboSpan" id="kobo.2719.1">update the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2720.1">button-with-tooltip.directive.ts</span></code><span class="koboSpan" id="kobo.2721.1"> as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2722.1">import</span></span><span class="koboSpan" id="kobo.2723.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.2724.1">Directive</span></span><span class="koboSpan" id="kobo.2725.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2726.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2727.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.2728.1">;
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.2729.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2730.1"> { </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2731.1">ButtonDirective</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2732.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.2733.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2734.1">'./button.directive'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2735.1">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.2736.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2737.1"> { </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2738.1">TooltipDirective</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2739.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.2740.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2741.1">'./tooltip.directive'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2742.1">;</span></strong></span><span class="koboSpan" id="kobo.2743.1">
@</span><span class="hljs-title"><span class="koboSpan" id="kobo.2744.1">Directive</span></span><span class="koboSpan" id="kobo.2745.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2746.1">selector</span></span><span class="koboSpan" id="kobo.2747.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.2748.1">'[appButtonWithTooltip]'</span></span><span class="koboSpan" id="kobo.2749.1">,
  </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2750.1">hostDirectives</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2751.1">: [</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2752.1">{</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2753.1">directive</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2754.1">: </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2755.1">ButtonDirective</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2756.1">,</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2757.1">inputs</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2758.1">: [</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2759.1">'color'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2760.1">, </span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2761.1">'fill'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2762.1">],</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2763.1">},</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2764.1">{</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2765.1">directive</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2766.1">: </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2767.1">TooltipDirective</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2768.1">,</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2769.1">inputs</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2770.1">: [</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2771.1">'appTooltip: tooltip'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2772.1">],</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2773.1">},</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2774.1">],</span></strong></span><span class="koboSpan" id="kobo.2775.1">
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2776.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2777.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2778.1">ButtonWithTooltipDirective</span></span><span class="koboSpan" id="kobo.2779.1"> {}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2780.1">You will</span><a id="_idIndexMarker166"/><span class="koboSpan" id="kobo.2781.1"> notice that the app starts throwing an error that </span><code class="inlineCode"><span class="koboSpan" id="kobo.2782.1">TooltipDirective</span></code><span class="koboSpan" id="kobo.2783.1"> is not a standalone component. </span><span class="koboSpan" id="kobo.2783.2">That’s true. </span><span class="koboSpan" id="kobo.2783.3">We need to do </span><a id="_idIndexMarker167"/><span class="koboSpan" id="kobo.2784.1">the same thing we did for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2785.1">ButtonDirective</span></code><span class="koboSpan" id="kobo.2786.1"> in </span><em class="italic"><span class="koboSpan" id="kobo.2787.1">step 2</span></em><span class="koboSpan" id="kobo.2788.1"> and </span><em class="italic"><span class="koboSpan" id="kobo.2789.1">step 3</span></em><span class="koboSpan" id="kobo.2790.1"> for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2791.1">TooltipDirective</span></code><span class="koboSpan" id="kobo.2792.1"> as well. </span><span class="koboSpan" id="kobo.2792.2">Move on to the next step once you’ve done that.</span></p></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="8"><span class="koboSpan" id="kobo.2793.1">Now, update the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2794.1">app.component.html</span></code><span class="koboSpan" id="kobo.2795.1"> file to use both the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2796.1">appButtonOutlined</span></code><span class="koboSpan" id="kobo.2797.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.2798.1">appButtonTooltip</span></code><span class="koboSpan" id="kobo.2799.1"> directives as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2800.1">...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2801.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2802.1">main</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2803.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2804.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2805.1">"content"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2806.1">role</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2807.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2808.1">"main"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2809.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2810.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2811.1">ul</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2812.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2813.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2814.1">"flex flex-col"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2815.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2816.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2817.1">li</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2818.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2819.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2820.1">"flex gap-4 items-center border-b justify-</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2821.1">      between border-slate-300 py-3"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2822.1">&gt;</span></span><span class="koboSpan" id="kobo.2823.1">...</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2824.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2825.1">li</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2826.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2827.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2828.1">li</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2829.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2830.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2831.1">"flex gap-4 items-center border-b justify-</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2832.1">      between border-slate-300 py-3"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2833.1">&gt;</span></span><span class="koboSpan" id="kobo.2834.1">...</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2835.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2836.1">li</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2837.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2838.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2839.1">li</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2840.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2841.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2842.1">"flex gap-4 items-center border-b justify-</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2843.1">      between border-slate-300 py-3"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2844.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2845.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2846.1">h4</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2847.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2848.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2849.1">"text-lg"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2850.1">&gt;</span></span><span class="koboSpan" id="kobo.2851.1">Outlined Button:</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2852.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2853.1">h4</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2854.1">&gt;</span></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2855.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2856.1">button</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2857.1">appButtonOutlined</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2858.1">&gt;</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2859.1">Click Me</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2860.1">&lt;/</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2861.1">button</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2862.1">&gt;</span></strong></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2863.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2864.1">li</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2865.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2866.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2867.1">li</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2868.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2869.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2870.1">"flex gap-4 items-center border-b justify-</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2871.1">      between border-slate-300 py-3"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2872.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2873.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2874.1">h4</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2875.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2876.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2877.1">"text-lg"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2878.1">&gt;</span></span><span class="koboSpan" id="kobo.2879.1">Button with Tooltip:</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2880.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2881.1">h4</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2882.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2883.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2884.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2885.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2886.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2887.1">"flex flex-col gap-4"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2888.1">&gt;</span></span>
<span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2889.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2890.1">button</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2891.1">appButtonWithTooltip</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2892.1">tooltip</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2893.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2894.1">"code with</span></strong></span>
<span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2895.1">ahsan"</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2896.1">fill</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2897.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2898.1">"</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2899.1">outlined"</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2900.1">color</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2901.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2902.1">"blue"</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2903.1">&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2904.1">Click Me</span></strong></span>
<span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2905.1">&lt;/</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2906.1">button</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2907.1">&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2908.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2909.1">button</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2910.1">appButtonWithTooltip</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2911.1">tooltip</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2912.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2913.1">"code with</span></strong></span>
<span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2914.1">ahsan"</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2915.1">fill</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2916.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2917.1">"filled"</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2918.1">color</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2919.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2920.1">"blue"</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2921.1">&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2922.1">Click Me</span></strong></span>
<span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2923.1">&lt;/</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2924.1">button</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2925.1">&gt;</span></strong></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2926.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2927.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2928.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2929.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2930.1">li</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2931.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2932.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2933.1">ul</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2934.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2935.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2936.1">main</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2937.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2938.1">If you’ve</span><a id="_idIndexMarker168"/><span class="koboSpan" id="kobo.2939.1"> followed all the steps correctly, you should be able to see the </span><a id="_idIndexMarker169"/><span class="koboSpan" id="kobo.2940.1">final result as follows:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2941.1"><img alt="" role="presentation" src="../Images/B18469_02_15.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2942.1">Figure 2.15: Final result containing buttons with different directives applied</span></p></li>
</ol>
<h2 class="heading-2" id="_idParaDest-86"><span class="koboSpan" id="kobo.2943.1">How it works…</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2944.1">The Directive Composition API </span><a id="_idIndexMarker170"/><span class="koboSpan" id="kobo.2945.1">was introduced in Angular v15 and has been one of the most requested features from the Angular community. </span><span class="koboSpan" id="kobo.2945.2">In this recipe, we tried to create some components that bind the directives to the component directly in the component’s TypeScript classes rather than in the template. </span><span class="koboSpan" id="kobo.2945.3">This eliminates the need to create a wrapper element within the components to then apply the directives or to map the inputs of the components to the inputs of the directives. </span><span class="koboSpan" id="kobo.2945.4">This also allows multiple directives to be bound to the same component – even if they may have inputs with the same names, we can alias them differently. </span></p>
<p class="normal"><span class="koboSpan" id="kobo.2946.1">The flow of the directives in our application works in the following way:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.2947.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.2948.1">AppComponent</span></code><span class="koboSpan" id="kobo.2949.1"> uses the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2950.1">ButtonFilledDirective</span></code><span class="koboSpan" id="kobo.2951.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.2952.1">ButtonOutlinedDirective</span></code><span class="koboSpan" id="kobo.2953.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.2954.1">ButtonWithTooltipDirective</span></code><span class="koboSpan" id="kobo.2955.1"> directives. </span><span class="koboSpan" id="kobo.2955.2">For this, these directive need to be non-standalone since the application is bootstrapped with an </span><code class="inlineCode"><span class="koboSpan" id="kobo.2956.1">NgModule</span></code></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.2957.1">ButtonFilledDirective</span></code><span class="koboSpan" id="kobo.2958.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.2959.1">ButtonOutlinedDirective</span></code><span class="koboSpan" id="kobo.2960.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.2961.1">ButtonWithTooltipDirective</span></code><span class="koboSpan" id="kobo.2962.1"> directives use the directive composition API to use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2963.1">ButtonDirective</span></code><span class="koboSpan" id="kobo.2964.1"> and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2965.1">TooltipDirective</span></code><span class="koboSpan" id="kobo.2966.1">. </span><span class="koboSpan" id="kobo.2966.2">These need to be standalone directives to be used as ‘</span><code class="inlineCode"><span class="koboSpan" id="kobo.2967.1">hostDirectives</span></code><span class="koboSpan" id="kobo.2968.1">'</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.2969.1">The key to using the Directive Composition API is to construct your base-directives with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2970.1">standalone: true</span></code><span class="koboSpan" id="kobo.2971.1"> flag. </span><span class="koboSpan" id="kobo.2971.2">This means your directives aren’t part of any </span><code class="inlineCode"><span class="koboSpan" id="kobo.2972.1">NgModule</span></code><span class="koboSpan" id="kobo.2973.1"> and can be imported directly into the imports array of any component they’re being used in. </span><span class="koboSpan" id="kobo.2973.2">This is why we make both the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2974.1">ButtonDirective</span></code><span class="koboSpan" id="kobo.2975.1"> and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2976.1">TooltipDirective</span></code><span class="koboSpan" id="kobo.2977.1"> standalone in </span><em class="italic"><span class="koboSpan" id="kobo.2978.1">steps 2</span></em><span class="koboSpan" id="kobo.2979.1">, </span><em class="italic"><span class="koboSpan" id="kobo.2980.1">3</span></em><span class="koboSpan" id="kobo.2981.1">, and </span><em class="italic"><span class="koboSpan" id="kobo.2982.1">7</span></em><span class="koboSpan" id="kobo.2983.1">. </span><span class="koboSpan" id="kobo.2983.2">Then, we use those directives in </span><code class="inlineCode"><span class="koboSpan" id="kobo.2984.1">ButtonFilledDirective</span></code><span class="koboSpan" id="kobo.2985.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.2986.1">ButtonOutlinedDirective</span></code><span class="koboSpan" id="kobo.2987.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.2988.1">ButtonWithTooltipDirective</span></code><span class="koboSpan" id="kobo.2989.1"> to be able to reuse the logic without having to create any wrapper component or additional HTML. </span><span class="koboSpan" id="kobo.2989.2">We do it using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2990.1">hostDirectives</span></code><span class="koboSpan" id="kobo.2991.1"> property in the directive metadata. </span><span class="koboSpan" id="kobo.2991.2">Notice that we pass an array of objects to this property and each object can contain the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2992.1">directive</span></code><span class="koboSpan" id="kobo.2993.1"> property, which takes the class of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2994.1">directive</span></code><span class="koboSpan" id="kobo.2995.1"> to be applied. </span><span class="koboSpan" id="kobo.2995.2">And we can also provide </span><strong class="keyWord"><span class="koboSpan" id="kobo.2996.1">inputs</span></strong><span class="koboSpan" id="kobo.2997.1"> and </span><strong class="keyWord"><span class="koboSpan" id="kobo.2998.1">outputs</span></strong><span class="koboSpan" id="kobo.2999.1"> for the host bindings. </span><span class="koboSpan" id="kobo.2999.2">As you saw for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3000.1">ButtonWithTooltipDirective</span></code><span class="koboSpan" id="kobo.3001.1">, we also aliased the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3002.1">appTooltip</span></code><span class="koboSpan" id="kobo.3003.1"> input of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3004.1">TooltipDirective</span></code><span class="koboSpan" id="kobo.3005.1"> with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3006.1">tooltip</span></code><span class="koboSpan" id="kobo.3007.1"> input of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3008.1">ButtonWithTooltipDirective</span></code><span class="koboSpan" id="kobo.3009.1">. </span><span class="koboSpan" id="kobo.3009.2">One thing to notice is that if you don’t want to map any inputs or outputs </span><a id="_idIndexMarker171"/><span class="koboSpan" id="kobo.3010.1">and just want to bind a directive in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3011.1">hostDirectives</span></code><span class="koboSpan" id="kobo.3012.1">, you can just provide an array of the classes of the directives to be applied as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-attr"><span class="koboSpan" id="kobo.3013.1">hostDirectives</span></span><span class="koboSpan" id="kobo.3014.1">: [
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.3015.1">ButtonDirective</span></span><span class="koboSpan" id="kobo.3016.1">,
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.3017.1">TooltipDirective</span></span><span class="koboSpan" id="kobo.3018.1">
],
</span></code></pre>
<h2 class="heading-2" id="_idParaDest-87"><span class="koboSpan" id="kobo.3019.1">See also</span></h2>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.3020.1">Directive Composition API documentation: </span><a href="https://angular.io/guide/directive-composition-api#directive-composition-api"><span class="url"><span class="koboSpan" id="kobo.3021.1">https://angular.io/guide/directive-composition-api#directive-composition-api</span></span></a></li>
<li class="bulletList"><span class="koboSpan" id="kobo.3022.1">Standalone components: </span><a href="https://angular.io/guide/standalone-components"><span class="url"><span class="koboSpan" id="kobo.3023.1">https://angular.io/guide/standalone-components</span></span></a></li>
</ul>
<h1 class="heading-1"><span class="koboSpan" id="kobo.3024.1">Learn more on Discord</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.3025.1">To join the Discord community for this book – where you can share feedback, ask questions to the author, and learn about new releases – follow the QR code below:</span></p>
<p class="normal"><a href="Chapter_2.xhtml"><span class="url"><span class="koboSpan" id="kobo.3026.1">https://packt.link/AngularCookbook2e</span></span></a></p>
<p class="normal"><span class="koboSpan" id="kobo.3027.1"><img alt="" role="presentation" src="../Images/QR_Code1388317275422265.png"/></span></p>
</div>
</body></html>
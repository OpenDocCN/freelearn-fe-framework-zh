# 前言

NgRx 是 Redux 流行模式的实现，旨在与 Angular 一起使用。完全有可能创建一个不使用 NgRx 的 Angular 应用程序。你甚至可能会在这方面非常成功。然而，在某些情况下，Redux 确实可以提供帮助；你可以通过使用 NgRx 来获得这种帮助。

那么，什么是 Redux，我们何时需要它呢？Redux 是关于给你的应用程序增加可预测性。可预测性意味着知道谁在应用程序中对状态做了什么。

单一的真实来源是一个 Redux 实现的概念，因为它促进了将所有数据添加到一个存储中。在任何给定时刻，你都将能够了解你的应用程序处于什么状态。如果你想在游戏中创建一个保存点并稍后从该保存点恢复游戏，那么保存状态并返回到它是非常好的（也称为重新水合）。

这不仅关乎有一个单一的真实来源；还关乎知道谁被允许更改存储的内容或状态。你经常面临的一个挑战是，随着应用程序的增长，你需要添加许多视图和控制台，你逐渐失去了对哪些代码影响应用程序中哪些状态的全面了解。Redux 通过确保视图不能直接更改状态，而必须发出代表你希望状态如何更改的意图的操作来帮助你解决这个问题。

另一个可能发生的情况是，大量的用户交互会触发对状态的许多更改。其中一些操作应导致立即更改，而另一些则导致最终会改变应用程序状态的异步操作。在这个阶段，重要的是确保所有这些更改都按正确的顺序发生。Redux 通过排队所有操作并确保我们的应用程序以可预测的方式更改状态来帮助我们做到这一点。

Redux 的一个非常重要的方面是，当它更改状态时，它不会对其进行修改。它用旧状态的副本替换状态，但应用了最新的操作。如果我们再次使用我们的游戏类比，想象一下你有一个游戏，你想要在你的背包中添加一瓶药水。当你在 Redux 中这样做时，我们替换了主要角色；我们用背包里有药水的主要角色来替换它。我们这样做的事实使得我们很容易记住每个先前的状态，并在需要时返回到较早的状态，这被称为时间旅行调试。为了使我们能够用新状态替换旧状态，我们正在使用一种称为纯函数的东西。纯函数确保我们只创建数据的副本，而不是对其进行修改。

了解应用在特定时刻包含的状态有很多好处。然而，并非应用中的所有状态都需要 Redux。这取决于个人偏好。有些人喜欢将所有状态放入存储中，有些人喜欢将部分状态放入存储中，而有些状态如果只作为特定组件的本地状态存在也是可以的。可以这样想，如果你要恢复应用，哪些状态是可以丢失的；答案可能是下拉选择或其他，如果有的话。将所有内容放入存储中可以确保你不会因为错误地调用额外的 Ajax 请求，如果存储中已经持有数据，因此这也是一种帮助你缓存的方式。

# 这本书面向的对象

这本书旨在为编写过一个或两个应用的 Angular 开发者提供帮助，他们正在寻找一种更结构化的方式来处理数据管理。这意味着你理想情况下应该对 JavaScript、HTML 和 CSS 有相当的了解，知道如何使用 angular-cli 搭建 Angular 应用，并且知道如何使用 Angular 的 HttpClient 服务进行 Ajax 请求。

# 这本书涵盖的内容

第一章，*简单应用的快速回顾数据服务*，介绍了如何使用服务和 Angular 依赖注入如何提供帮助。它还提到了 MVC 模式，并讨论了内聚性和耦合性。

第二章，*1.21 吉瓦——Flux 模式解释*，讲解了 Flux 模式是什么以及它包含哪些概念。它展示了如何使用存储、分发器和几个视图来实现 Flux 模式。

第三章，*异步编程*，探讨了异步的含义，并讨论了回调、承诺、async/await 以及异步库如何帮助我们创建有序的异步代码。

第四章，*函数式响应式编程*，比较了声明式和命令式编程，并查看声明式编程的一个子集——函数式编程。我们深入探讨了函数式编程的某些特性，如高阶函数、不可变性和递归。此外，我们探讨了如何使代码响应式以及响应式的含义。

第五章，*RxJS 基础*，介绍了 RxJS 库。此外，它还提出了诸如可观察对象、生产者和观察者等概念。它进一步讨论了可观察对象是如何将所有异步概念统一为一个异步概念。我们还涉及到操作符及其含义。最后，我们尝试构建自己的 RxJS 微实现，以进一步理解底层的工作原理。

第六章，*操作流及其值*，着重于教育读者了解操作符，这是 RxJS 获得其力量的关键。读者应该带着更多关于如何操作数据和 Observables 的知识离开这一章。

第七章，*RxJS 高级*，深入探讨了 RxJS 中更高级的概念，例如热和冷 Observables、subjects、错误处理，以及如何使用 Marble 测试来测试您的 RxJS 代码。

第八章，*Redux*，展示了 Redux 模式，并解释了它是如何从 Flux 模式演变而来，并改进了一些其范式和概念。读者将通过学习构建自己的 Redux 以及使用相同的模式，包括几个视图，来了解它在实践中的工作方式。

第九章，*NgRx – Reduxing that Angular App*，探讨了 NgRx 是什么以及它由什么组成。它还向读者展示了如何将其添加到 Angular 应用程序中以投入使用。解释并演示了诸如 store 等概念，读者将学习如何使用 Effects 库进行调试和处理副作用。

第十章*，NgRx – In Depth*，涵盖了 Entity 库，它通过减少大量样板代码，允许你编写更少的代码。它还展示了如何将路由的状态放入 store 中。此外，我们探讨了如何测试 NgRx，如何自己构建它，最后，我们涵盖了 Schematics，这将通过允许我们构建在 NgRx 中需要工作的最常见结构来进一步帮助我们。

# 为了最大限度地利用本书

本书是关于使用 NGRX 构建 Angular 应用程序的。为了最大限度地利用本书，您需要对 Angular 框架有一个基本的了解，并且应该能够使用 Angular-CLI 构建 Angular 应用程序，或者如果您更喜欢这种方式，能够通过 Webpack 设置 Angular 项目。对 JavaScript 和 TypeScript 有一个良好的理解是很好的。最重要的是，一个好奇的心是您真正需要的。在您的机器上安装 NodeJs 是个好主意。

# 下载示例代码文件

您可以从[www.packtpub.com](http://www.packtpub.com)的账户下载此书的示例代码文件。如果您在其他地方购买了此书，您可以访问[www.packtpub.com/support](http://www.packtpub.com/support)并注册，以便将文件直接通过电子邮件发送给您。

您可以通过以下步骤下载代码文件：

1.  在[www.packtpub.com](http://www.packtpub.com/support)登录或注册。

1.  选择 SUPPORT 标签。

1.  点击代码下载与勘误。

1.  在搜索框中输入书籍名称，并遵循屏幕上的说明。

文件下载后，请确保使用最新版本的软件解压缩或提取文件夹：

+   Windows 上的 WinRAR/7-Zip

+   Mac 上的 Zipeg/iZip/UnRarX

+   Linux 下的 7-Zip/PeaZip

本书代码包也托管在 GitHub 上，网址为 [`github.com/PacktPublishing/Architecting-Angular-Applications-with-Redux-RxJs-and-NgRx`](https://github.com/PacktPublishing/Architecting-Angular-Applications-with-Redux-RxJs-and-NgRx)。我们还有其他来自我们丰富图书和视频目录的代码包，可在 **[`github.com/PacktPublishing/`](https://github.com/PacktPublishing/)** 上找到。去看看吧！

# 使用的约定

本书使用了多种文本约定。

`CodeInText`：表示文本中的代码单词、数据库表名、文件夹名、文件名、文件扩展名、路径名、虚拟 URL、用户输入和 Twitter 账号。以下是一个示例：“我们需要在终端中键入以下内容来安装 `webpack`。”

代码块设置如下：

```js
interface IPrinter {
  print(IPrintable printable);
}
```

当我们希望您注意代码块中的特定部分时，相关的行或项目将以粗体显示：

```js
interface IPrintable {
 String getContent();
}

interface IPrinter {
  print(IPrintable printable);
}
```

任何命令行输入或输出都按以下方式编写：

```js
npm install webpack webpack-cli --save-dev
```

**粗体**：表示新术语、重要单词或您在屏幕上看到的单词。例如，菜单或对话框中的单词在文本中显示如下。以下是一个示例：“让我们通过向我们的输入元素添加一个值并按保存按钮来向我们的存储中添加一个条目。”

警告或重要提示如下所示。

小技巧和技巧如下所示。

# 联系我们

我们始终欢迎读者的反馈。

**总体反馈**：请发送电子邮件至 `feedback@packtpub.com`，并在邮件主题中提及书籍标题。如果您对本书的任何方面有疑问，请通过电子邮件联系我们的 `questions@packtpub.com`。

**勘误**：尽管我们已经尽最大努力确保内容的准确性，但错误仍然可能发生。如果您在这本书中发现了错误，我们将不胜感激，如果您能向我们报告这一错误。请访问 [www.packtpub.com/submit-errata](http://www.packtpub.com/submit-errata)，选择您的书籍，点击勘误提交表单链接，并输入详细信息。

**盗版**：如果您在互联网上以任何形式发现我们作品的非法副本，我们将不胜感激，如果您能向我们提供位置地址或网站名称。请通过电子邮件联系我们的 `copyright@packtpub.com`，并提供材料的链接。

**如果您有兴趣成为作者**：如果您在某个领域有专业知识，并且您有兴趣撰写或为书籍做出贡献，请访问 [authors.packtpub.com](http://authors.packtpub.com/)。

# 评论

请留下评论。一旦您阅读并使用过这本书，为什么不在这本书购买的网站上留下评论呢？潜在读者可以查看并使用您的客观意见来做出购买决定，Packt 可以了解您对我们产品的看法，我们的作者也可以看到他们对书籍的反馈。谢谢！

如需了解 Packt 的更多信息，请访问 [packtpub.com](https://www.packtpub.com/)。

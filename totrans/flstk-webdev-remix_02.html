<html><head></head><body>
<div id="_idContainer010">
<h1 class="chapter-number" id="_idParaDest-33"><a id="_idTextAnchor030"/><span class="koboSpan" id="kobo.1.1">2</span></h1>
<h1 id="_idParaDest-34"><a id="_idTextAnchor031"/><span class="koboSpan" id="kobo.2.1">Creating a New Remix App</span></h1>
<p><span class="koboSpan" id="kobo.3.1">Getting started with a new framework means familiarizing yourself with its primitives, conventions, and levers. </span><span class="koboSpan" id="kobo.3.2">This book uses a demo application that we will build from start to finish. </span><span class="koboSpan" id="kobo.3.3">Each chapter focuses on one specific topic of full stack web development with Remix. </span><span class="koboSpan" id="kobo.3.4">In this chapter, we will explore explore the breadth of Remixâ€™s </span><strong class="source-inline"><span class="koboSpan" id="kobo.4.1">create-remix</span></strong><span class="koboSpan" id="kobo.5.1"> CLI script, introduce Remixâ€™s file and folder structure, and familiarize ourselves with </span><span class="No-Break"><span class="koboSpan" id="kobo.6.1">Remixâ€™s runtime.</span></span></p>
<p><span class="koboSpan" id="kobo.7.1">This chapter covers the </span><span class="No-Break"><span class="koboSpan" id="kobo.8.1">following topics:</span></span></p>
<ul>
<li><span class="koboSpan" id="kobo.9.1">Creating a â€œHello World!â€ </span><span class="No-Break"><span class="koboSpan" id="kobo.10.1">Remix app</span></span></li>
<li><span class="koboSpan" id="kobo.11.1">Understanding Remixâ€™s file and </span><span class="No-Break"><span class="koboSpan" id="kobo.12.1">folder structure</span></span></li>
<li><span class="koboSpan" id="kobo.13.1">Exploring the client and </span><span class="No-Break"><span class="koboSpan" id="kobo.14.1">server environments</span></span></li>
<li><span class="koboSpan" id="kobo.15.1">Troubleshooting </span><span class="No-Break"><span class="koboSpan" id="kobo.16.1">Remix applications</span></span></li>
</ul>
<p><span class="koboSpan" id="kobo.17.1">First, we will walk through the setup of a new Remix project using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.18.1">create-remix</span></strong><span class="koboSpan" id="kobo.19.1"> CLI script. </span><span class="koboSpan" id="kobo.19.2">The chapter then introduces you to Remixâ€™s folder structure. </span><span class="koboSpan" id="kobo.19.3">We will investigate each file and learn about its function. </span><span class="koboSpan" id="kobo.19.4">Next, we will discuss Remixâ€™s two environments: the client and the server. </span><span class="koboSpan" id="kobo.19.5">You will learn how to manage client and server code in Remix. </span><span class="koboSpan" id="kobo.19.6">Finally, we will introduce a troubleshooting guide that will help us debug </span><span class="No-Break"><span class="koboSpan" id="kobo.20.1">Remix applications.</span></span></p>
<p><span class="koboSpan" id="kobo.21.1">By the end of this chapter, you will know how to create a Remix project and will have familiarized yourself with Remixâ€™s file and folder structure. </span><span class="koboSpan" id="kobo.21.2">You will also learn more about Remixâ€™s client and server environments and how to troubleshoot </span><span class="No-Break"><span class="koboSpan" id="kobo.22.1">Remix applications.</span></span></p>
<h1 id="_idParaDest-35"><a id="_idTextAnchor032"/><span class="koboSpan" id="kobo.23.1">Technical requirements</span></h1>
<p><span class="koboSpan" id="kobo.24.1">To complete this chapter, you will need a computer that can run Node.js. </span><span class="koboSpan" id="kobo.24.2">All common operation systems should suffice. </span><span class="koboSpan" id="kobo.24.3">Please install both Node.js and </span><strong class="source-inline"><span class="koboSpan" id="kobo.25.1">npm</span></strong><span class="koboSpan" id="kobo.26.1"> on your machine. </span><span class="koboSpan" id="kobo.26.2">An editor such as VS Code </span><span class="No-Break"><span class="koboSpan" id="kobo.27.1">is recommended.</span></span></p>
<p><span class="koboSpan" id="kobo.28.1">You can download Node.js and </span><strong class="source-inline"><span class="koboSpan" id="kobo.29.1">npm</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.30.1">here: </span></span><a href="https://nodejs.org/en/download/"><span class="No-Break"><span class="koboSpan" id="kobo.31.1">https://nodejs.org/en/download/</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.32.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.33.1">The solution for this chapter can be found here: </span><a href="https://github.com/PacktPublishing/Full-Stack-Web-Development-with-Remix/tree/main/02-creating-a-new-remix-app"><span class="koboSpan" id="kobo.34.1">https://github.com/PacktPublishing/Full-Stack-Web-Development-with-Remix/tree/main/02-creating-a-new-remix-app</span></a><span class="koboSpan" id="kobo.35.1">. </span><span class="koboSpan" id="kobo.35.2">Try to read through this chapter first before peeking at the </span><span class="No-Break"><span class="koboSpan" id="kobo.36.1">final code.</span></span></p>
<h1 id="_idParaDest-36"><a id="_idTextAnchor033"/><span class="koboSpan" id="kobo.37.1">Creating a â€œHello World!â€ </span><span class="koboSpan" id="kobo.37.2">Remix app</span></h1>
<p><span class="koboSpan" id="kobo.38.1">This section </span><a id="_idIndexMarker032"/><span class="koboSpan" id="kobo.39.1">walks you through the creation of a new Remix application using the </span><strong class="source-inline"><span class="koboSpan" id="kobo.40.1">create-remix</span></strong><span class="koboSpan" id="kobo.41.1"> CLI script. </span><span class="koboSpan" id="kobo.41.2">The script is maintained by the Remix </span><a id="_idIndexMarker033"/><span class="koboSpan" id="kobo.42.1">team and used to bootstrap new </span><span class="No-Break"><span class="koboSpan" id="kobo.43.1">Remix projects:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.44.1">Open a new terminal window and run the </span><span class="No-Break"><span class="koboSpan" id="kobo.45.1">following command:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.46.1">
npx create-remix@2</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.47.1">We use </span><strong class="source-inline"><span class="koboSpan" id="kobo.48.1">npx</span></strong><span class="koboSpan" id="kobo.49.1"> to execute</span><a id="_idIndexMarker034"/><span class="koboSpan" id="kobo.50.1"> the </span><strong class="source-inline"><span class="koboSpan" id="kobo.51.1">create-remix</span></strong><span class="koboSpan" id="kobo.52.1"> script. </span><strong class="bold"><span class="koboSpan" id="kobo.53.1">npx</span></strong><span class="koboSpan" id="kobo.54.1"> is part of </span><strong class="source-inline"><span class="koboSpan" id="kobo.55.1">npm</span></strong><span class="koboSpan" id="kobo.56.1"> and stands</span><a id="_idIndexMarker035"/><span class="koboSpan" id="kobo.57.1"> for </span><strong class="bold"><span class="koboSpan" id="kobo.58.1">Node Package Execute</span></strong><span class="koboSpan" id="kobo.59.1">. </span><span class="koboSpan" id="kobo.59.2">The command lets us run remote node scripts locally on our machine â€“ </span><span class="No-Break"><span class="koboSpan" id="kobo.60.1">pretty nifty!</span></span></p><p class="list-inset"><span class="koboSpan" id="kobo.61.1">Note that we specify to use the latest available version of </span><strong class="source-inline"><span class="koboSpan" id="kobo.62.1">create-remix</span></strong><span class="koboSpan" id="kobo.63.1"> v2. </span><span class="koboSpan" id="kobo.63.2">The examples in this book are based on Remix v2. </span><span class="koboSpan" id="kobo.63.3">By adding the </span><strong class="source-inline"><span class="koboSpan" id="kobo.64.1">@2</span></strong><span class="koboSpan" id="kobo.65.1"> postfix to the package name, we ensure that our first demo application installs a Remix </span><span class="No-Break"><span class="koboSpan" id="kobo.66.1">v2 application.</span></span></p><p class="list-inset"><span class="koboSpan" id="kobo.67.1">For projects outside of this book, we recommend using the following command instead to work with the latest stable version </span><span class="No-Break"><span class="koboSpan" id="kobo.68.1">of Remix:</span></span></p><pre class="source-code"><span class="koboSpan" id="kobo.69.1">npx create-remix@latest</span></pre></li> <li><span class="koboSpan" id="kobo.70.1">If you are asked by </span><strong class="source-inline"><span class="koboSpan" id="kobo.71.1">npx</span></strong><span class="koboSpan" id="kobo.72.1"> to install </span><strong class="source-inline"><span class="koboSpan" id="kobo.73.1">create-remix</span></strong><span class="koboSpan" id="kobo.74.1">, enter </span><strong class="source-inline"><span class="koboSpan" id="kobo.75.1">y</span></strong><span class="koboSpan" id="kobo.76.1"> to answer </span><span class="No-Break"><span class="koboSpan" id="kobo.77.1">with yes.</span></span></li>
<li><span class="koboSpan" id="kobo.78.1">After installing the </span><strong class="source-inline"><span class="koboSpan" id="kobo.79.1">create-remix</span></strong><span class="koboSpan" id="kobo.80.1"> script, we are prompted to provide a valid location for our </span><span class="No-Break"><span class="koboSpan" id="kobo.81.1">Remix project:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.82.1">
Where should we create your new project? </span><strong class="bold"><span class="koboSpan" id="kobo.83.1">./my-remix-app</span></strong></pre><p class="list-inset"><span class="koboSpan" id="kobo.84.1">Pick an install location on your machine or use the default install location offered by the </span><span class="No-Break"><span class="koboSpan" id="kobo.85.1">CLI tool.</span></span></p><p class="list-inset"><span class="koboSpan" id="kobo.86.1">After </span><a id="_idIndexMarker036"/><span class="koboSpan" id="kobo.87.1">hitting </span><em class="italic"><span class="koboSpan" id="kobo.88.1">Enter</span></em><span class="koboSpan" id="kobo.89.1">, the script informs us that it </span><a id="_idIndexMarker037"/><span class="koboSpan" id="kobo.90.1">selected the basic template, also called </span><strong class="bold"><span class="koboSpan" id="kobo.91.1">Remix App Server</span></strong><span class="koboSpan" id="kobo.92.1">. </span><span class="koboSpan" id="kobo.92.2">The</span><a id="_idIndexMarker038"/><span class="koboSpan" id="kobo.93.1"> script defaults to the basic template if no other template is specified. </span><span class="koboSpan" id="kobo.93.2">We will learn more about templates in the </span><span class="No-Break"><span class="koboSpan" id="kobo.94.1">next section.</span></span></p></li> <li><span class="koboSpan" id="kobo.95.1">The script prompts us to initialize a new Git repository. </span><span class="No-Break"><span class="koboSpan" id="kobo.96.1">Select </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.97.1">Yes</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.98.1">:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.99.1">
Initialize a new git repository? </span><strong class="bold"><span class="koboSpan" id="kobo.100.1">â—</span></strong><strong class="bold"><span class="koboSpan" id="kobo.101.1"> YesÂ Â â—‹ No</span></strong></pre></li> <li><span class="koboSpan" id="kobo.102.1">Now, we must decide whether we want to run </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.103.1">npm install</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.104.1">:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.105.1">
Install dependencies with npm? </span><strong class="bold"><span class="koboSpan" id="kobo.106.1">â—</span></strong><strong class="bold"><span class="koboSpan" id="kobo.107.1"> YesÂ Â â—‹ No</span></strong></pre><p class="list-inset"><span class="koboSpan" id="kobo.108.1">Since we want to run the app, </span><span class="No-Break"><span class="koboSpan" id="kobo.109.1">select </span></span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.110.1">Yes</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.111.1">.</span></span></p></li> <li><span class="koboSpan" id="kobo.112.1">Wait until </span><strong class="source-inline"><span class="koboSpan" id="kobo.113.1">npm install</span></strong><span class="koboSpan" id="kobo.114.1"> has finished. </span><span class="koboSpan" id="kobo.114.2">Next, use the terminal to navigate into the newly created </span><span class="No-Break"><span class="koboSpan" id="kobo.115.1">project folder:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.116.1">
cd </span><strong class="bold"><span class="koboSpan" id="kobo.117.1">./my-remix-app</span></strong></pre><p class="list-inset"><span class="koboSpan" id="kobo.118.1">Congratulations on bootstrapping your first Remix project! </span><span class="koboSpan" id="kobo.118.2">Letâ€™s start the local </span><span class="No-Break"><span class="koboSpan" id="kobo.119.1">development server.</span></span></p></li> <li><span class="koboSpan" id="kobo.120.1">The following command starts our Remix </span><span class="No-Break"><span class="koboSpan" id="kobo.121.1">application locally:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.122.1">
npm run dev</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.123.1">Once the Remix application is running, it should provide you with a URL to open the running application in a </span><span class="No-Break"><span class="koboSpan" id="kobo.124.1">web browser:</span></span></p><pre class="source-code"><span class="koboSpan" id="kobo.125.1">&gt; dev&gt; remix dev ğŸ’¿Â Â remix dev infoÂ Â building... </span><span class="koboSpan" id="kobo.125.2">infoÂ Â built (204ms)Remix App Server started at http://localhost:3000 (http://10.0.0.173:3000)</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.126.1">Please </span><a id="_idIndexMarker039"/><span class="koboSpan" id="kobo.127.1">note how fast Remix builds. </span><span class="koboSpan" id="kobo.127.2">Built in 204 ms â€“ that is the power of esbuild. </span><span class="koboSpan" id="kobo.127.3">The exact number of milliseconds varies based on your system, but itâ€™s amazing that we can speak about build times </span><span class="No-Break"><span class="koboSpan" id="kobo.128.1">in milliseconds!</span></span></p></li> <li><span class="koboSpan" id="kobo.129.1">Open</span><a id="_idIndexMarker040"/><span class="koboSpan" id="kobo.130.1"> the specified URL in your browser: </span><strong class="source-inline"><span class="koboSpan" id="kobo.131.1">http://localhost:3000</span></strong><span class="koboSpan" id="kobo.132.1">. </span><span class="koboSpan" id="kobo.132.2">It should render a simple </span><span class="No-Break"><span class="koboSpan" id="kobo.133.1">HTML page.</span></span><p class="list-inset"><span class="koboSpan" id="kobo.134.1">Congratulations on running your first Remix application locally! </span><span class="koboSpan" id="kobo.134.2">However, it wouldnâ€™t be a â€œHello World!â€ </span><span class="koboSpan" id="kobo.134.3">project without printing â€œHello Worldâ€ on </span><span class="No-Break"><span class="koboSpan" id="kobo.135.1">the screen.</span></span></p></li>
<li><span class="koboSpan" id="kobo.136.1">Open the Remix project in an editor of your choice. </span><span class="koboSpan" id="kobo.136.2">In the editor, open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.137.1">_index.tsx</span></strong><span class="koboSpan" id="kobo.138.1"> file, located in </span><strong class="source-inline"><span class="koboSpan" id="kobo.139.1">app/routes</span></strong><span class="koboSpan" id="kobo.140.1">. </span><span class="koboSpan" id="kobo.140.2">You will find it exports a React component. </span><span class="koboSpan" id="kobo.140.3">Remove the existing JSX code and replace it with </span><span class="No-Break"><span class="koboSpan" id="kobo.141.1">the following:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.142.1">
export default function Index() {Â Â return (Â Â Â Â </span><strong class="bold"><span class="koboSpan" id="kobo.143.1">&lt;h1&gt;Hello World!&lt;/h1&gt;</span></strong><span class="koboSpan" id="kobo.144.1">Â Â );}</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.145.1">Note that Remix ships with TypeScript by default. </span><span class="koboSpan" id="kobo.145.2">Donâ€™t be worried if you havenâ€™t used TypeScript before. </span><span class="koboSpan" id="kobo.145.3">There are only a few instances where we will have to deal with TypeScript directly. </span><span class="koboSpan" id="kobo.145.4">Mostly, we can enjoy type inference and autocompletion without having to write </span><span class="No-Break"><span class="koboSpan" id="kobo.146.1">types ourselves.</span></span></p></li> <li><span class="koboSpan" id="kobo.147.1">Save the </span><a id="_idIndexMarker041"/><span class="koboSpan" id="kobo.148.1">file changes. </span><span class="koboSpan" id="kobo.148.2">Your browser tab should now automatically reload and display the </span><a id="_idIndexMarker042"/><span class="koboSpan" id="kobo.149.1">updated HTML: </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.150.1">Hello World!</span></strong></span></li>
</ol>
<p><span class="koboSpan" id="kobo.151.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.152.1">create-remix</span></strong><span class="koboSpan" id="kobo.153.1"> CLI script makes it easy to create new Remix applications. </span><span class="koboSpan" id="kobo.153.2">In this section, we bootstrapped a simple Remix application using the default template and rendered </span><strong class="bold"><span class="koboSpan" id="kobo.154.1">Hello World!</span></strong><span class="koboSpan" id="kobo.155.1"> to the screen. </span><span class="koboSpan" id="kobo.155.2">Next, letâ€™s inspect the bootstrapped folder structure. </span><span class="koboSpan" id="kobo.155.3">We will inspect each file and study </span><span class="No-Break"><span class="koboSpan" id="kobo.156.1">its function.</span></span></p>
<h1 id="_idParaDest-37"><a id="_idTextAnchor034"/><span class="koboSpan" id="kobo.157.1">Understanding Remixâ€™s file and folder structure</span></h1>
<p><span class="koboSpan" id="kobo.158.1">Remix takes </span><a id="_idIndexMarker043"/><span class="koboSpan" id="kobo.159.1">on the responsibilities of a compiler, router, and runtime. </span><span class="koboSpan" id="kobo.159.2">It provides the foundations and framing for the application. </span><span class="koboSpan" id="kobo.159.3">As such, it proposes a skeleton folder structure for the application. </span><span class="koboSpan" id="kobo.159.4">Some files serve as entry points that you can hook into. </span><span class="koboSpan" id="kobo.159.5">Others can be used to configure Remix. </span><span class="koboSpan" id="kobo.159.6">Letâ€™s review our bootstrapped </span><span class="No-Break"><span class="koboSpan" id="kobo.160.1">Remix app.</span></span></p>
<p><span class="koboSpan" id="kobo.161.1">Which files and folders are present depends on the selected configuration options during the creation process. </span><span class="koboSpan" id="kobo.161.2">However, most files are part of all setups. </span><span class="koboSpan" id="kobo.161.3">Selecting the basic Remix App Server template yields the following file and </span><span class="No-Break"><span class="koboSpan" id="kobo.162.1">folder structure:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.163.1">
my-remix-appâ”œâ”€â”€ .eslintrc.js
â”œâ”€â”€ .gitignore
â”œâ”€â”€ README.md
â”œâ”€â”€ app
â”‚Â Â Â â”œâ”€â”€ entry.client.tsx
â”‚Â Â Â â”œâ”€â”€ entry.server.tsx
â”‚Â Â Â â”œâ”€â”€ root.tsx
â”‚Â Â Â â””â”€â”€ routes
â”‚Â Â Â Â Â Â Â â””â”€â”€ _index.tsx
â”œâ”€â”€ package.json
â”œâ”€â”€ public
â”‚Â Â Â â””â”€â”€ favicon.ico
â”œâ”€â”€ remix.config.js
â”œâ”€â”€ remix.env.d.ts
â””â”€â”€ tsconfig.json</span></pre>
<p><span class="koboSpan" id="kobo.164.1">Letâ€™s </span><a id="_idIndexMarker044"/><span class="koboSpan" id="kobo.165.1">have a look at each file and folder. </span><span class="koboSpan" id="kobo.165.2">Remix ships with a </span><strong class="source-inline"><span class="koboSpan" id="kobo.166.1">.eslintrc</span></strong><span class="koboSpan" id="kobo.167.1"> file, which configures ESLint to extend Remixâ€™s ESLint extensions. </span><span class="koboSpan" id="kobo.167.2">You can adapt or remove this file based on your linting and </span><span class="No-Break"><span class="koboSpan" id="kobo.168.1">formatting preferences.</span></span></p>
<p><span class="koboSpan" id="kobo.169.1">When initializing a new Git repository, Remix also creates a </span><strong class="source-inline"><span class="koboSpan" id="kobo.170.1">.gitignore</span></strong><span class="koboSpan" id="kobo.171.1"> file. </span><span class="koboSpan" id="kobo.171.2">It is set up to ignore Remixâ€™s build artifacts, temporary files such as the </span><strong class="source-inline"><span class="koboSpan" id="kobo.172.1">.cache</span></strong><span class="koboSpan" id="kobo.173.1"> folder, and other commonly ignored files and folders. </span><span class="koboSpan" id="kobo.173.2">You can update this file based on your </span><span class="No-Break"><span class="koboSpan" id="kobo.174.1">applicationâ€™s requirements.</span></span></p>
<p><span class="koboSpan" id="kobo.175.1">Every newly created project comes with a </span><strong class="source-inline"><span class="koboSpan" id="kobo.176.1">README.md</span></strong><span class="koboSpan" id="kobo.177.1"> file. </span><span class="koboSpan" id="kobo.177.2">The file contains important information on how to run and deploy your application. </span><span class="koboSpan" id="kobo.177.3">The documentation varies based on the selected template. </span><span class="koboSpan" id="kobo.177.4">Make sure to read through the </span><strong class="source-inline"><span class="koboSpan" id="kobo.178.1">README.md</span></strong><span class="koboSpan" id="kobo.179.1"> file whenever you bootstrap a new </span><span class="No-Break"><span class="koboSpan" id="kobo.180.1">Remix application.</span></span></p>
<p><span class="koboSpan" id="kobo.181.1">Next, letâ€™s continue with the </span><strong class="source-inline"><span class="koboSpan" id="kobo.182.1">package.json</span></strong><span class="koboSpan" id="kobo.183.1"> file. </span><span class="koboSpan" id="kobo.183.2">If you have worked with Node.js-based projects before, you will be familiar with the content. </span><span class="koboSpan" id="kobo.183.3">Remixâ€™s  </span><strong class="source-inline"><span class="koboSpan" id="kobo.184.1">package.json</span></strong><span class="koboSpan" id="kobo.185.1"> file comes with all the sections you </span><span class="No-Break"><span class="koboSpan" id="kobo.186.1">would expect:</span></span></p>
<ul>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.187.1">scripts</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.188.1">dependencies</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.189.1">devDependencies</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.190.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.191.1">scripts</span></strong><span class="koboSpan" id="kobo.192.1"> section includes a set of scripts to run your Remix application locally, build your application, and run your application in production. </span><span class="koboSpan" id="kobo.192.2">Usually, those scripts are named </span><strong class="source-inline"><span class="koboSpan" id="kobo.193.1">dev</span></strong><span class="koboSpan" id="kobo.194.1">, </span><strong class="source-inline"><span class="koboSpan" id="kobo.195.1">build</span></strong><span class="koboSpan" id="kobo.196.1">, and </span><strong class="source-inline"><span class="koboSpan" id="kobo.197.1">start</span></strong><span class="koboSpan" id="kobo.198.1">. </span><span class="koboSpan" id="kobo.198.2">Your application might come with additional scripts depending on the </span><span class="No-Break"><span class="koboSpan" id="kobo.199.1">selected template.</span></span></p>
<p><span class="koboSpan" id="kobo.200.1">Take a moment to investigate the </span><strong class="source-inline"><span class="koboSpan" id="kobo.201.1">dependencies</span></strong><span class="koboSpan" id="kobo.202.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.203.1">devDependencies</span></strong><span class="koboSpan" id="kobo.204.1"> sections. </span><span class="koboSpan" id="kobo.204.2">You might notice that Remix is split into several packages. </span><span class="koboSpan" id="kobo.204.3">Some are dependencies, and others are </span><strong class="source-inline"><span class="koboSpan" id="kobo.205.1">dev</span></strong><span class="koboSpan" id="kobo.206.1"> dependencies. </span><span class="koboSpan" id="kobo.206.2">One dependency to highlight is the adapter </span><span class="No-Break"><span class="koboSpan" id="kobo.207.1">in use.</span></span></p>
<p><span class="koboSpan" id="kobo.208.1">We</span><a id="_idIndexMarker045"/><span class="koboSpan" id="kobo.209.1"> learned in the previous chapter that Remix can run anywhere where JavaScript can be executed. </span><span class="koboSpan" id="kobo.209.2">Remixâ€™s server-side HTTP request handler uses adapters to run on different JavaScript runtime and server environments. </span><span class="koboSpan" id="kobo.209.3">Each Remix application uses an adapter that sits between Remix and the </span><span class="No-Break"><span class="koboSpan" id="kobo.210.1">web server.</span></span></p>
<p><span class="koboSpan" id="kobo.211.1">The basic template uses the </span><strong class="source-inline"><span class="koboSpan" id="kobo.212.1">@remix-run/serve</span></strong><span class="koboSpan" id="kobo.213.1"> package to run on a Node.js server environment. </span><span class="koboSpan" id="kobo.213.2">The package implements the Remix App Server, a production-ready Express.js server. </span><span class="koboSpan" id="kobo.213.3">In contrast to other templates, the Remix App Server does not expose the Node.js server setup. </span><span class="koboSpan" id="kobo.213.4">Perfect to </span><span class="No-Break"><span class="koboSpan" id="kobo.214.1">get started.</span></span></p>
<p><span class="koboSpan" id="kobo.215.1">Next, letâ€™s have a look at the </span><strong class="source-inline"><span class="koboSpan" id="kobo.216.1">public</span></strong><span class="koboSpan" id="kobo.217.1"> folder. </span><span class="koboSpan" id="kobo.217.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.218.1">public</span></strong><span class="koboSpan" id="kobo.219.1"> folder contains static files and assets that are exposed over the internet. </span><span class="koboSpan" id="kobo.219.2">Currently, the folder includes a </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.220.1">favicon.ico</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.221.1"> file.</span></span></p>
<p><span class="koboSpan" id="kobo.222.1">After running the app locally (</span><strong class="source-inline"><span class="koboSpan" id="kobo.223.1">npm run dev</span></strong><span class="koboSpan" id="kobo.224.1">), the folder should further include a </span><strong class="source-inline"><span class="koboSpan" id="kobo.225.1">build</span></strong><span class="koboSpan" id="kobo.226.1"> folder. </span><span class="koboSpan" id="kobo.226.2">The folder is one of two </span><strong class="source-inline"><span class="koboSpan" id="kobo.227.1">build</span></strong><span class="koboSpan" id="kobo.228.1"> folders that contain your bundled app code. </span><span class="koboSpan" id="kobo.228.2">To build your application, locate your terminal and run </span><strong class="source-inline"><span class="koboSpan" id="kobo.229.1">npm run build</span></strong><span class="koboSpan" id="kobo.230.1">. </span><span class="koboSpan" id="kobo.230.2">This will generate the two bundles for production based on your latest </span><span class="No-Break"><span class="koboSpan" id="kobo.231.1">code changes.</span></span></p>
<p><span class="koboSpan" id="kobo.232.1">Remix includes a client and a server application. </span><span class="koboSpan" id="kobo.232.2">When writing your Remix application, you write code for two different environments, runtimes, and applications. </span><span class="koboSpan" id="kobo.232.3">The client-side application code is bundled into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.233.1">public/build</span></strong><span class="koboSpan" id="kobo.234.1"> folder. </span><span class="koboSpan" id="kobo.234.2">These files are exposed over the internet and can be fetched from </span><span class="No-Break"><span class="koboSpan" id="kobo.235.1">a browser.</span></span></p>
<p><span class="koboSpan" id="kobo.236.1">If you peek inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.237.1">public/build</span></strong><span class="koboSpan" id="kobo.238.1"> folder, you can notice that each JavaScript module filename ends with a hash. </span><span class="koboSpan" id="kobo.238.2">The hash is referred to as the fileâ€™s fingerprint. </span><span class="koboSpan" id="kobo.238.3">There cannot be two files with the same name and different content. </span><span class="koboSpan" id="kobo.238.4">This simplifies caching. </span><span class="koboSpan" id="kobo.238.5">Since a new version of a file means a new file is generated, we can cache each file forever without having to deal with cache invalidations. </span><span class="koboSpan" id="kobo.238.6">If the content of a module changes in a new version of your application, then it will have a different unique filename and will be </span><span class="No-Break"><span class="koboSpan" id="kobo.239.1">freshly loaded.</span></span></p>
<p><span class="koboSpan" id="kobo.240.1">Inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.241.1">public/build</span></strong><span class="koboSpan" id="kobo.242.1"> folder, you can also locate a manifest file (</span><strong class="source-inline"><span class="koboSpan" id="kobo.243.1">manifest-*.js</span></strong><span class="koboSpan" id="kobo.244.1">). </span><span class="koboSpan" id="kobo.244.2">Remix compiles an asset manifest, which is used to route requests and locate assets. </span><span class="koboSpan" id="kobo.244.3">Since the manifest must be accessed by the client, it is also part of the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.245.1">public/build</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.246.1"> bundle.</span></span></p>
<p><span class="koboSpan" id="kobo.247.1">Letâ€™s have a </span><a id="_idIndexMarker046"/><span class="koboSpan" id="kobo.248.1">look at the </span><strong class="source-inline"><span class="koboSpan" id="kobo.249.1">remix.config.js</span></strong><span class="koboSpan" id="kobo.250.1"> file. </span><span class="koboSpan" id="kobo.250.2">This JavaScript file exports an </span><strong class="source-inline"><span class="koboSpan" id="kobo.251.1">AppConfig</span></strong><span class="koboSpan" id="kobo.252.1"> configuration object. </span><span class="koboSpan" id="kobo.252.2">This file can be used to configure Remix, enable future flags, and override Remix's default behavior. </span><span class="koboSpan" id="kobo.252.3">Normally, you wonâ€™t need to touch this file. </span><span class="koboSpan" id="kobo.252.4">However, since its content might change depending on what template and adapter you choose, it may be relevant when switching between templates or adapters. </span><span class="koboSpan" id="kobo.252.5">We will learn more about switching adapters later in </span><span class="No-Break"><span class="koboSpan" id="kobo.253.1">this book.</span></span></p>
<p><span class="koboSpan" id="kobo.254.1">Next, letâ€™s inspect the </span><strong class="source-inline"><span class="koboSpan" id="kobo.255.1">remix.env.d.ts</span></strong><span class="koboSpan" id="kobo.256.1"> file. </span><span class="koboSpan" id="kobo.256.2">This file includes information for the TypeScript compiler. </span><span class="koboSpan" id="kobo.256.3">The file contains triple-slash directives that declare packages that the application is dependent on. </span><span class="koboSpan" id="kobo.256.4">The declarations tell TypeScript that your application is dependent on </span><span class="No-Break"><span class="koboSpan" id="kobo.257.1">Remixâ€™s packages.</span></span></p>
<p><span class="koboSpan" id="kobo.258.1">Finally, there is the </span><strong class="source-inline"><span class="koboSpan" id="kobo.259.1">tsconfig.json</span></strong><span class="koboSpan" id="kobo.260.1"> file â€“ or </span><strong class="source-inline"><span class="koboSpan" id="kobo.261.1">jsconfig.json</span></strong><span class="koboSpan" id="kobo.262.1"> file if you picked a template without TypeScript. </span><span class="koboSpan" id="kobo.262.2">These config files contain configuration options for the TypeScript compiler and are used to bundle and compile your </span><span class="No-Break"><span class="koboSpan" id="kobo.263.1">Remix application.</span></span></p>
<p><span class="koboSpan" id="kobo.264.1">Now that we have visited all top-level files and folders, letâ€™s have a look inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.265.1">app</span></strong><span class="koboSpan" id="kobo.266.1"> folder. </span><span class="koboSpan" id="kobo.266.2">This is where the Remix application lives and where we write our application code. </span><span class="koboSpan" id="kobo.266.3">Remix populates the folder with a set of starter files. </span><span class="koboSpan" id="kobo.266.4">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.267.1">entry.server.tsx</span></strong><span class="koboSpan" id="kobo.268.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.269.1">entry.client.tsx</span></strong><span class="koboSpan" id="kobo.270.1"> files serve as entry points for the client and server </span><span class="No-Break"><span class="koboSpan" id="kobo.271.1">frameworks, respectively.</span></span></p>
<p><span class="koboSpan" id="kobo.272.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.273.1">entry.client.ts</span></strong><span class="koboSpan" id="kobo.274.1"> file contains the code that serves as an entry point for the client. </span><span class="koboSpan" id="kobo.274.2">Its responsibility is to hydrate React and, hence, initialize the SPA-like experience on the client. </span><span class="koboSpan" id="kobo.274.3">Remix exposes the entry file so that you can adapt it based on your use case. </span><span class="koboSpan" id="kobo.274.4">The file can serve as a great place for any code that has to be executed only once when the application first loads on the client. </span><span class="koboSpan" id="kobo.274.5">You can also delete the file, in which case Remix will fall back to the </span><span class="No-Break"><span class="koboSpan" id="kobo.275.1">default implementation.</span></span></p>
<p><span class="koboSpan" id="kobo.276.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.277.1">entry.server.tsx</span></strong><span class="koboSpan" id="kobo.278.1"> file exports the </span><strong class="source-inline"><span class="koboSpan" id="kobo.279.1">handleRequest</span></strong><span class="koboSpan" id="kobo.280.1"> function as its default export. </span><span class="koboSpan" id="kobo.280.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.281.1">handleRequest</span></strong><span class="koboSpan" id="kobo.282.1"> function is called on incoming requests and generates the HTTP response. </span><span class="koboSpan" id="kobo.282.2">The general flow of </span><strong class="source-inline"><span class="koboSpan" id="kobo.283.1">handleRequest</span></strong><span class="koboSpan" id="kobo.284.1"> looks as follows: </span><strong class="source-inline"><span class="koboSpan" id="kobo.285.1">handleRequest</span></strong><span class="koboSpan" id="kobo.286.1"> is invoked with a request object and some additional parameters. </span><span class="koboSpan" id="kobo.286.2">The function renders React on the server side. </span><span class="koboSpan" id="kobo.286.3">The rendered markup is returned, wrapped in a new </span><strong class="source-inline"><span class="koboSpan" id="kobo.287.1">Response</span></strong><span class="koboSpan" id="kobo.288.1"> object, and returned to the adapter code, which passes the response to the server to serve the response to </span><span class="No-Break"><span class="koboSpan" id="kobo.289.1">the client.</span></span></p>
<p><span class="koboSpan" id="kobo.290.1">Letâ€™s have a </span><a id="_idIndexMarker047"/><span class="koboSpan" id="kobo.291.1">look at the </span><strong class="source-inline"><span class="koboSpan" id="kobo.292.1">root.tsx</span></strong><span class="koboSpan" id="kobo.293.1"> file and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.294.1">routes</span></strong><span class="koboSpan" id="kobo.295.1"> folder. </span><span class="koboSpan" id="kobo.295.2">Remix utilizes a file-based routing solution. </span><span class="koboSpan" id="kobo.295.3">Every file inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.296.1">routes</span></strong><span class="koboSpan" id="kobo.297.1"> folder is considered a nested route module within the route tree. </span><span class="koboSpan" id="kobo.297.2">The file and folder hierarchy of the folder maps to the routing hierarchy. </span><span class="koboSpan" id="kobo.297.3">Every document/UI route must export a </span><span class="No-Break"><span class="koboSpan" id="kobo.298.1">React component.</span></span></p>
<p><span class="koboSpan" id="kobo.299.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.300.1">root.tsx</span></strong><span class="koboSpan" id="kobo.301.1"> file contains the root document route module. </span><span class="koboSpan" id="kobo.301.2">As such, it also exports a React component as its </span><span class="No-Break"><span class="koboSpan" id="kobo.302.1">default export:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.303.1">
export default function App() {Â Â return (
Â Â Â Â &lt;html lang="en"&gt;
Â Â Â Â Â Â &lt;head&gt;
Â Â Â Â Â Â Â Â &lt;meta charSet="utf-8" /&gt;
Â Â Â Â Â Â Â Â &lt;meta name="viewport" content="width=device-width,initial-          scale=1" /&gt;
Â Â Â Â Â Â Â Â &lt;Meta /&gt;
Â Â Â Â Â Â Â Â &lt;Links /&gt;
Â Â Â Â Â Â &lt;/head&gt;
Â Â Â Â Â Â &lt;body&gt;
Â Â Â Â Â Â Â Â &lt;Outlet /&gt;
Â Â Â Â Â Â Â Â &lt;ScrollRestoration /&gt;
Â Â Â Â Â Â Â Â &lt;Scripts /&gt;
Â Â Â Â Â Â Â Â &lt;LiveReload /&gt;
Â Â Â Â Â Â &lt;/body&gt;
Â Â Â Â &lt;/html&gt;
Â Â );
}</span></pre>
<p><span class="koboSpan" id="kobo.304.1">Note that Remix manages the full HTML document, including the </span><strong class="source-inline"><span class="koboSpan" id="kobo.305.1">&lt;html /&gt;</span></strong><span class="koboSpan" id="kobo.306.1"> tag and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.307.1">&lt;head /&gt;</span></strong><span class="koboSpan" id="kobo.308.1"> tag in React. </span><span class="koboSpan" id="kobo.308.2">This gives us full control over the structure of our HTML document. </span><span class="koboSpan" id="kobo.308.3">With </span><a id="_idIndexMarker048"/><span class="koboSpan" id="kobo.309.1">Remix, you can conditionally render meta tags, change the </span><strong class="source-inline"><span class="koboSpan" id="kobo.310.1">lang</span></strong><span class="koboSpan" id="kobo.311.1"> attribute, or add and remove client-side JavaScript (</span><strong class="source-inline"><span class="koboSpan" id="kobo.312.1">&lt;Scripts /&gt;</span></strong><span class="koboSpan" id="kobo.313.1">) </span><span class="No-Break"><span class="koboSpan" id="kobo.314.1">conditionally.</span></span></p>
<p><span class="koboSpan" id="kobo.315.1">The route component in </span><strong class="source-inline"><span class="koboSpan" id="kobo.316.1">root.tsx</span></strong><span class="koboSpan" id="kobo.317.1"> renders several of Remixâ€™s </span><span class="No-Break"><span class="koboSpan" id="kobo.318.1">built-in components:</span></span></p>
<ul>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.319.1">Meta</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.320.1">Links</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.321.1">Outlet</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.322.1">ScrollRestoration</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.323.1">Scripts</span></strong></span></li>
<li><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.324.1">LiveReload</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.325.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.326.1">Meta</span></strong><span class="koboSpan" id="kobo.327.1"> component adds meta tags defined in </span><strong class="source-inline"><span class="koboSpan" id="kobo.328.1">meta</span></strong><span class="koboSpan" id="kobo.329.1"> exports to the HTML document. </span><span class="koboSpan" id="kobo.329.2">Similarly, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.330.1">Links</span></strong><span class="koboSpan" id="kobo.331.1"> component adds links defined in </span><strong class="source-inline"><span class="koboSpan" id="kobo.332.1">links</span></strong><span class="koboSpan" id="kobo.333.1"> exports. </span><span class="koboSpan" id="kobo.333.2">You will learn more about the </span><strong class="source-inline"><span class="koboSpan" id="kobo.334.1">Meta</span></strong><span class="koboSpan" id="kobo.335.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.336.1">Links</span></strong><span class="koboSpan" id="kobo.337.1"> components in </span><a href="B17399_09.xhtml#_idTextAnchor137"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.338.1">Chapter 9</span></em></span></a><span class="koboSpan" id="kobo.339.1">, </span><em class="italic"><span class="koboSpan" id="kobo.340.1">Assets and </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.341.1">Metadata Handling</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.342.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.343.1">Instead of </span><strong class="source-inline"><span class="koboSpan" id="kobo.344.1">{children}</span></strong><span class="koboSpan" id="kobo.345.1"> â€“ which you might have expected â€“ Remix provides an </span><strong class="source-inline"><span class="koboSpan" id="kobo.346.1">Outlet</span></strong><span class="koboSpan" id="kobo.347.1"> component to specify where to render the child route. </span><span class="koboSpan" id="kobo.347.2">You will learn more about the </span><strong class="source-inline"><span class="koboSpan" id="kobo.348.1">Outlet</span></strong><span class="koboSpan" id="kobo.349.1"> component and nesting of child routes in </span><a href="B17399_04.xhtml#_idTextAnchor057"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.350.1">Chapter 4</span></em></span></a><span class="koboSpan" id="kobo.351.1">, </span><em class="italic"><span class="koboSpan" id="kobo.352.1">Routing </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.353.1">in Remix</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.354.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.355.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.356.1">ScrollRestoration</span></strong><span class="koboSpan" id="kobo.357.1"> component manages scroll positions for all client-side navigations. </span><span class="koboSpan" id="kobo.357.2">SPAs avoid full page reloads and instead render a new page with JavaScript on the client. </span><span class="koboSpan" id="kobo.357.3">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.358.1">ScrollRestoration</span></strong><span class="koboSpan" id="kobo.359.1"> component is used to emulate the browserâ€™s default behavior and restore the scroll position when the browserâ€™s back and forward buttons </span><span class="No-Break"><span class="koboSpan" id="kobo.360.1">are used.</span></span></p>
<p><span class="koboSpan" id="kobo.361.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.362.1">Scripts</span></strong><span class="koboSpan" id="kobo.363.1"> component might be one of the most fascinating components that Remix exposes. </span><span class="koboSpan" id="kobo.363.2">The component adds all script tags of the bundled Remix application to the HTML document. </span><span class="koboSpan" id="kobo.363.3">By removing the </span><strong class="source-inline"><span class="koboSpan" id="kobo.364.1">Scripts</span></strong><span class="koboSpan" id="kobo.365.1"> component, we can remove all client-side JavaScript from our </span><span class="No-Break"><span class="koboSpan" id="kobo.366.1">Remix application.</span></span></p>
<p><span class="koboSpan" id="kobo.367.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.368.1">LiveReload</span></strong><span class="koboSpan" id="kobo.369.1"> component triggers page reloads during development whenever the development server detects any file changes. </span><strong class="source-inline"><span class="koboSpan" id="kobo.370.1">LiveReload</span></strong><span class="koboSpan" id="kobo.371.1"> is part of Remixâ€™s development server setup and is not used in </span><span class="No-Break"><span class="koboSpan" id="kobo.372.1">production environments.</span></span></p>
<p><span class="koboSpan" id="kobo.373.1">Notice that </span><a id="_idIndexMarker049"/><span class="koboSpan" id="kobo.374.1">Remix offers us control over its inner workings by exposing when and how its built-in components are rendered. </span><span class="koboSpan" id="kobo.374.2">For instance, if we are not interested in live reloads during development, we can just remove the </span><strong class="source-inline"><span class="koboSpan" id="kobo.375.1">LiveReload</span></strong><span class="koboSpan" id="kobo.376.1"> component. </span><span class="koboSpan" id="kobo.376.2">If we want to develop static pages without client-side JavaScript, we can remove the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.377.1">Scripts</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.378.1"> component.</span></span></p>
<p><span class="koboSpan" id="kobo.379.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.380.1">routes</span></strong><span class="koboSpan" id="kobo.381.1"> folder contains all other routes of your Remix application. </span><span class="koboSpan" id="kobo.381.2">As of now, it only contains an </span><strong class="source-inline"><span class="koboSpan" id="kobo.382.1">_index</span></strong><span class="koboSpan" id="kobo.383.1"> route. </span><span class="koboSpan" id="kobo.383.2">An </span><strong class="source-inline"><span class="koboSpan" id="kobo.384.1">_index</span></strong><span class="koboSpan" id="kobo.385.1"> route is the default child of its parent route and shares the same URL. </span><span class="koboSpan" id="kobo.385.2">The present </span><strong class="source-inline"><span class="koboSpan" id="kobo.386.1">_index</span></strong><span class="koboSpan" id="kobo.387.1"> route maps to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.388.1">/</span></strong><span class="koboSpan" id="kobo.389.1"> pathname. </span><span class="koboSpan" id="kobo.389.2">We will learn all about routing in </span><a href="B17399_04.xhtml#_idTextAnchor057"><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.390.1">Chapter 4</span></em></span></a><span class="koboSpan" id="kobo.391.1">, </span><em class="italic"><span class="koboSpan" id="kobo.392.1">Routing </span></em><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.393.1">in Remix</span></em></span><span class="No-Break"><span class="koboSpan" id="kobo.394.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.395.1">That was quite a few files! </span><span class="koboSpan" id="kobo.395.2">Remix acts as your compiler, router, and runtime. </span><span class="koboSpan" id="kobo.395.3">As such, Remix must be aware of your compiler configurations and the location of your code. </span><span class="koboSpan" id="kobo.395.4">Remix must further know about all your route modules. </span><span class="koboSpan" id="kobo.395.5">As your runtime, it also must own the entry points of your application. </span><span class="koboSpan" id="kobo.395.6">Since Remix is not a server, it must expose these entry points to the server environment. </span><span class="koboSpan" id="kobo.395.7">Most of the time, you donâ€™t have to touch these entry points and configuration files. </span><span class="koboSpan" id="kobo.395.8">However, it is great that you can easily alter the content of those files and hook application logic into these places </span><span class="No-Break"><span class="koboSpan" id="kobo.396.1">if needed.</span></span></p>
<p><span class="koboSpan" id="kobo.397.1">Now that we have gone through Remixâ€™s folder structure and investigated Remixâ€™s configuration and project files, we will learn more about the two environments of your </span><span class="No-Break"><span class="koboSpan" id="kobo.398.1">Remix application.</span></span></p>
<h1 id="_idParaDest-38"><a id="_idTextAnchor035"/><span class="koboSpan" id="kobo.399.1">Exploring the client and server environments</span></h1>
<p><span class="koboSpan" id="kobo.400.1">In this section, you </span><a id="_idIndexMarker050"/><span class="koboSpan" id="kobo.401.1">will learn about the two environments of every Remix application: the client and the server. </span><span class="koboSpan" id="kobo.401.2">First, we will learn more about how code is executed during runtime. </span><span class="koboSpan" id="kobo.401.3">Next, you will learn where to write your client and server code and how to help Remixâ€™s compiler recognize what belongs in the client bundle and what belongs in the </span><span class="No-Break"><span class="koboSpan" id="kobo.402.1">server bundle.</span></span></p>
<h2 id="_idParaDest-39"><a id="_idTextAnchor036"/><span class="koboSpan" id="kobo.403.1">The two bundles of your Remix application</span></h2>
<p><span class="koboSpan" id="kobo.404.1">The Remix App Server </span><a id="_idIndexMarker051"/><span class="koboSpan" id="kobo.405.1">does not expose its server setup, but most other templates do. </span><span class="koboSpan" id="kobo.405.2">In this section, we will use the Express.js template to review how Remix interacts with the </span><span class="No-Break"><span class="koboSpan" id="kobo.406.1">web server.</span></span></p>
<p><span class="koboSpan" id="kobo.407.1">Follow these steps to bootstrap an Express.js </span><span class="No-Break"><span class="koboSpan" id="kobo.408.1">Remix app:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.409.1">Run the following </span><strong class="source-inline"><span class="koboSpan" id="kobo.410.1">create-remix</span></strong><span class="koboSpan" id="kobo.411.1"> command in </span><span class="No-Break"><span class="koboSpan" id="kobo.412.1">a terminal:</span></span><pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.413.1">npx create-remix@2 --template remix-run/remix/templates/express</span></strong></pre><p class="list-inset"><span class="koboSpan" id="kobo.414.1">This time, we donâ€™t use the basic template but Remixâ€™s </span><span class="No-Break"><span class="koboSpan" id="kobo.415.1">Express.js template.</span></span></p><p class="list-inset"><span class="koboSpan" id="kobo.416.1">Note that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.417.1">--template</span></strong><span class="koboSpan" id="kobo.418.1"> flag points to a folder on GitHub.com, using the following pattern: </span><strong class="source-inline"><span class="koboSpan" id="kobo.419.1">:username/:repository/:path-to-folder</span></strong><span class="koboSpan" id="kobo.420.1">. </span><span class="koboSpan" id="kobo.420.2">You can learn more about the different </span><strong class="source-inline"><span class="koboSpan" id="kobo.421.1">--template</span></strong><span class="koboSpan" id="kobo.422.1"> options by calling </span><strong class="source-inline"><span class="koboSpan" id="kobo.423.1">npx </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.424.1">create-remix@latest --help</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.425.1">.</span></span></p></li> <li><span class="koboSpan" id="kobo.426.1">Pick a new folder location for this Remix application and follow the prompts as practiced in the </span><span class="No-Break"><span class="koboSpan" id="kobo.427.1">previous section.</span></span></li>
<li><span class="koboSpan" id="kobo.428.1">Review the new Remix application. </span><span class="koboSpan" id="kobo.428.2">Compare the </span><strong class="source-inline"><span class="koboSpan" id="kobo.429.1">package.json</span></strong><span class="koboSpan" id="kobo.430.1"> file with the Remix App Server </span><strong class="source-inline"><span class="koboSpan" id="kobo.431.1">package.json</span></strong><span class="koboSpan" id="kobo.432.1"> file from the last section. </span><span class="koboSpan" id="kobo.432.2">How do the </span><strong class="source-inline"><span class="koboSpan" id="kobo.433.1">dependencies</span></strong><span class="koboSpan" id="kobo.434.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.435.1">scripts</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.436.1">sections differ?</span></span></li>
<li><span class="koboSpan" id="kobo.437.1">Next, open the </span><strong class="source-inline"><span class="koboSpan" id="kobo.438.1">server.js</span></strong><span class="koboSpan" id="kobo.439.1"> file. </span><span class="koboSpan" id="kobo.439.2">The file contains code to set up a new Express.js application. </span><span class="koboSpan" id="kobo.439.3">Let's go over the code together and discuss the most </span><span class="No-Break"><span class="koboSpan" id="kobo.440.1">important aspects.</span></span><p class="list-inset"><span class="koboSpan" id="kobo.441.1">Notice that </span><strong class="source-inline"><span class="koboSpan" id="kobo.442.1">createRequestHandler</span></strong><span class="koboSpan" id="kobo.443.1"> is imported from Remixâ€™s Express.js adapter (</span><strong class="source-inline"><span class="koboSpan" id="kobo.444.1">@</span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.445.1">remix-run/express</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.446.1">).</span></span></p><p class="list-inset"><span class="koboSpan" id="kobo.447.1">Next, the server build of the Remix application is </span><span class="No-Break"><span class="koboSpan" id="kobo.448.1">dynamically imported:</span></span></p><pre class="source-code"><span class="koboSpan" id="kobo.449.1">
const BUILD_PATH = path.resolve("build/index.js");const initialBuild = await reimportServer();</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.450.1">The server </span><strong class="source-inline"><span class="koboSpan" id="kobo.451.1">build</span></strong><span class="koboSpan" id="kobo.452.1"> folder contains the bundled server code of the Remix application. </span><span class="koboSpan" id="kobo.452.2">Among other things, it contains the </span><strong class="source-inline"><span class="koboSpan" id="kobo.453.1">entry.server.tsx</span></strong><span class="koboSpan" id="kobo.454.1"> file and the content of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.455.1">handleRequest</span></strong><span class="koboSpan" id="kobo.456.1"> function that we reviewed in the </span><span class="No-Break"><span class="koboSpan" id="kobo.457.1">last section.</span></span></p><p class="list-inset"><span class="koboSpan" id="kobo.458.1">In the </span><a id="_idIndexMarker052"/><span class="koboSpan" id="kobo.459.1">next step, the Express.js application </span><span class="No-Break"><span class="koboSpan" id="kobo.460.1">is created:</span></span></p><pre class="source-code"><span class="koboSpan" id="kobo.461.1">const app = express();</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.462.1">The express app is further configured to expose static files from the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.463.1">public/build</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.464.1"> folder:</span></span></p><pre class="source-code"><span class="koboSpan" id="kobo.465.1">app.use(Â Â "/build",Â Â express.static("public/build", { immutable: true, maxAge: "1y" }));</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.466.1">Every request to </span><strong class="source-inline"><span class="koboSpan" id="kobo.467.1">/build</span></strong><span class="koboSpan" id="kobo.468.1"> is mapped to modules in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.469.1">public/build</span></strong><span class="koboSpan" id="kobo.470.1"> folder. </span><span class="koboSpan" id="kobo.470.2">This is how we expose the content of the </span><span class="No-Break"><span class="koboSpan" id="kobo.471.1">client bundle.</span></span></p><p class="list-inset"><span class="koboSpan" id="kobo.472.1">Similarly, the rest of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.473.1">/public</span></strong><span class="koboSpan" id="kobo.474.1"> folder is also exposed by the </span><span class="No-Break"><span class="koboSpan" id="kobo.475.1">web server:</span></span></p><pre class="source-code"><span class="koboSpan" id="kobo.476.1">app.use(express.static("public", { maxAge: "1h" }));</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.477.1">Anything put into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.478.1">/public</span></strong><span class="koboSpan" id="kobo.479.1"> folder is accessible over the internet. </span><span class="koboSpan" id="kobo.479.2">All other requests to the web server are then forwarded to Remixâ€™s </span><span class="No-Break"><span class="koboSpan" id="kobo.480.1">HTTP handler:</span></span></p><pre class="source-code"><span class="koboSpan" id="kobo.481.1">app.all(Â Â "*",Â Â process.env.NODE_ENV === "development"Â Â Â Â ? </span><span class="koboSpan" id="kobo.481.2">createDevRequestHandler()Â Â Â Â : </span><strong class="bold"><span class="koboSpan" id="kobo.482.1">createRequestHandler</span></strong><span class="koboSpan" id="kobo.483.1">({Â Â Â Â Â Â Â Â build: initialBuild,Â Â Â Â Â Â Â Â mode: initialBuild.mode,Â Â Â Â Â Â }));</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.484.1">We pass the content of the server </span><strong class="source-inline"><span class="koboSpan" id="kobo.485.1">build</span></strong><span class="koboSpan" id="kobo.486.1"> folder to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.487.1">createRequestHandler</span></strong><span class="koboSpan" id="kobo.488.1"> function, using the `</span><strong class="source-inline"><span class="koboSpan" id="kobo.489.1">initialBuild</span></strong><span class="koboSpan" id="kobo.490.1">` object we </span><span class="No-Break"><span class="koboSpan" id="kobo.491.1">defined earlier.</span></span></p><p class="list-inset"><span class="koboSpan" id="kobo.492.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.493.1">createRequestHandler</span></strong><span class="koboSpan" id="kobo.494.1"> function acts as </span><a id="_idIndexMarker053"/><span class="koboSpan" id="kobo.495.1">an </span><strong class="bold"><span class="koboSpan" id="kobo.496.1">adapter</span></strong><span class="koboSpan" id="kobo.497.1"> between Remix and </span><a id="_idIndexMarker054"/><span class="koboSpan" id="kobo.498.1">the underlying server environment. </span><span class="koboSpan" id="kobo.498.2">It returns a wrapper function around the request handler (</span><strong class="source-inline"><span class="koboSpan" id="kobo.499.1">handleRequest</span></strong><span class="koboSpan" id="kobo.500.1">) found in </span><strong class="source-inline"><span class="koboSpan" id="kobo.501.1">entry.server.tsx</span></strong><span class="koboSpan" id="kobo.502.1">. </span><span class="koboSpan" id="kobo.502.2">The wrapper function handles requests according to the underlying server environment and translates incoming requests into a format understood by Remix. </span><span class="koboSpan" id="kobo.502.3">The wrapper function also translates Remixâ€™s </span><strong class="source-inline"><span class="koboSpan" id="kobo.503.1">Response</span></strong><span class="koboSpan" id="kobo.504.1"> into instructions understood by the </span><span class="No-Break"><span class="koboSpan" id="kobo.505.1">server environment.</span></span></p><p class="list-inset"><span class="koboSpan" id="kobo.506.1">Finally, we start the Express.js application by calling </span><strong class="source-inline"><span class="koboSpan" id="kobo.507.1">app.listen</span></strong><span class="koboSpan" id="kobo.508.1">. </span><span class="koboSpan" id="kobo.508.2">All incoming requests are mapped from our Express.js app </span><span class="No-Break"><span class="koboSpan" id="kobo.509.1">to Remix.</span></span></p></li> </ol>
<p><span class="koboSpan" id="kobo.510.1">Note that the server environment is informed about both the client and server bundle of the Remix application. </span><span class="koboSpan" id="kobo.510.2">The client bundle is exposed over the internet. </span><span class="koboSpan" id="kobo.510.3">The server bundle is passed to the Remix adapter and called on </span><span class="No-Break"><span class="koboSpan" id="kobo.511.1">incoming requests.</span></span></p>
<p class="callout-heading"><span class="koboSpan" id="kobo.512.1">Remix is an HTTP request handler</span></p>
<p class="callout"><span class="koboSpan" id="kobo.513.1">Remix is not a web server but an HTTP request handler that runs on a server environment. </span><span class="koboSpan" id="kobo.513.2">Remix uses adapters to communicate with the </span><span class="No-Break"><span class="koboSpan" id="kobo.514.1">underlying server.</span></span></p>
<p><span class="koboSpan" id="kobo.515.1">Remixâ€™s adapter code is used within the server environment. </span><span class="koboSpan" id="kobo.515.2">The adapter passes requests from the server environment to our Remix application and manages our HTTP handlerâ€™s response using the primitives of the server environment. </span><span class="koboSpan" id="kobo.515.3">Depending on the selected template and deployment target, the server </span><span class="No-Break"><span class="koboSpan" id="kobo.516.1">code differs.</span></span></p>
<p><span class="koboSpan" id="kobo.517.1">With Remix, we have full control over the </span><strong class="source-inline"><span class="koboSpan" id="kobo.518.1">server.js</span></strong><span class="koboSpan" id="kobo.519.1"> file. </span><span class="koboSpan" id="kobo.519.2">If necessary, we can hook into the server code and add additional logic. </span><span class="koboSpan" id="kobo.519.3">For instance, we could add a WebSocket server to our Express.js application and let it run next to our Remix application. </span><span class="koboSpan" id="kobo.519.4">Remixâ€™s architecture offers full control over the runtime of </span><span class="No-Break"><span class="koboSpan" id="kobo.520.1">our application.</span></span></p>
<p><span class="koboSpan" id="kobo.521.1">Next, letâ€™s write some application code inside the </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.522.1">app</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.523.1"> folder.</span></span></p>
<h2 id="_idParaDest-40"><a id="_idTextAnchor037"/><span class="koboSpan" id="kobo.524.1">Client and server code</span></h2>
<p><span class="koboSpan" id="kobo.525.1">With Remix, you </span><a id="_idIndexMarker055"/><span class="koboSpan" id="kobo.526.1">can take advantage of the full stack of the web </span><a id="_idIndexMarker056"/><span class="koboSpan" id="kobo.527.1">platform. </span><span class="koboSpan" id="kobo.527.2">In this section, we will learn more about how to write client and server code </span><span class="No-Break"><span class="koboSpan" id="kobo.528.1">in Remix.</span></span></p>
<p><span class="koboSpan" id="kobo.529.1">Earlier in this chapter, we printed </span><strong class="bold"><span class="koboSpan" id="kobo.530.1">Hello World!</span></strong><span class="koboSpan" id="kobo.531.1"> on the home page of our first Remix application. </span><span class="koboSpan" id="kobo.531.2">We used the following code to render a React component onto </span><span class="No-Break"><span class="koboSpan" id="kobo.532.1">the screen:</span></span></p>
<pre class="source-code"><span class="koboSpan" id="kobo.533.1">
export default function Index() {Â Â return (
Â Â Â Â &lt;h1&gt;Hello World!&lt;/h1&gt;
Â Â );
}</span></pre>
<p><span class="koboSpan" id="kobo.534.1">Letâ€™s investigate Remixâ€™s client and </span><span class="No-Break"><span class="koboSpan" id="kobo.535.1">server runtimes:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.536.1">Open your </span><strong class="source-inline"><span class="koboSpan" id="kobo.537.1">Hello World!</span></strong><span class="koboSpan" id="kobo.538.1"> Remix application in an editor and add a </span><strong class="source-inline"><span class="koboSpan" id="kobo.539.1">console.log</span></strong><span class="koboSpan" id="kobo.540.1"> statement into the </span><strong class="source-inline"><span class="koboSpan" id="kobo.541.1">function</span></strong><span class="koboSpan" id="kobo.542.1"> component </span><span class="No-Break"><span class="koboSpan" id="kobo.543.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.544.1">app/_index.tsx</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.545.1">:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.546.1">
export default function Index() {</span><strong class="bold"><span class="koboSpan" id="kobo.547.1">Â Â console.log("Another hello to the world!");</span></strong><span class="koboSpan" id="kobo.548.1">Â Â return (Â Â Â Â &lt;h1&gt;Hello World!&lt;/h1&gt;Â Â );}</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.549.1">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.550.1">console.log</span></strong><span class="koboSpan" id="kobo.551.1"> is executed anytime our React </span><span class="No-Break"><span class="koboSpan" id="kobo.552.1">component renders.</span></span></p></li> <li><span class="koboSpan" id="kobo.553.1">Start the Remix application locally. </span><span class="koboSpan" id="kobo.553.2">In your terminal window, execute </span><strong class="source-inline"><span class="koboSpan" id="kobo.554.1">npm run dev</span></strong><span class="koboSpan" id="kobo.555.1"> at the root of the project. </span><span class="koboSpan" id="kobo.555.2">Can you guess how many times the </span><strong class="source-inline"><span class="koboSpan" id="kobo.556.1">console.log</span></strong><span class="koboSpan" id="kobo.557.1"> statement will </span><span class="No-Break"><span class="koboSpan" id="kobo.558.1">be run?</span></span></li>
<li><span class="koboSpan" id="kobo.559.1">Open the application in a new browser tab. </span></li>
<li><span class="koboSpan" id="kobo.560.1">Next, review the terminal where you executed npm run dev. </span><span class="koboSpan" id="kobo.560.2">You will see that Another hello to the world! </span><span class="koboSpan" id="kobo.560.3">is printed in </span><span class="No-Break"><span class="koboSpan" id="kobo.561.1">the terminal.</span></span><pre class="source-code"><span class="koboSpan" id="kobo.562.1">
Remix App Server started at http://localhost:3000 (http://10.0.0.37:3000)Another hello to the world!GET / 200 - - 66.536 ms</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.563.1">The</span><a id="_idIndexMarker057"/><span class="koboSpan" id="kobo.564.1"> terminal is connected to our server-side </span><a id="_idIndexMarker058"/><span class="koboSpan" id="kobo.565.1">environment. </span><span class="koboSpan" id="kobo.565.2">Visiting the web page in a browser tab creates a </span><strong class="source-inline"><span class="koboSpan" id="kobo.566.1">GET</span></strong><span class="koboSpan" id="kobo.567.1"> request for the web server. </span><strong class="source-inline"><span class="koboSpan" id="kobo.568.1">GET / 200</span></strong><span class="koboSpan" id="kobo.569.1"> â€“ the </span><strong class="source-inline"><span class="koboSpan" id="kobo.570.1">GET</span></strong><span class="koboSpan" id="kobo.571.1"> request to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.572.1">/</span></strong><span class="koboSpan" id="kobo.573.1"> â€“ path is responded to with status </span><span class="No-Break"><span class="koboSpan" id="kobo.574.1">code </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.575.1">200</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.576.1">.</span></span></p><p class="list-inset"><span class="koboSpan" id="kobo.577.1">First, the request is received by the underlying server environment. </span><span class="koboSpan" id="kobo.577.2">The web server calls Remixâ€™s adapter callback and the adapter forwards the request to Remixâ€™s </span><strong class="source-inline"><span class="koboSpan" id="kobo.578.1">handleRequest</span></strong><span class="koboSpan" id="kobo.579.1"> function. </span><span class="koboSpan" id="kobo.579.2">Remix then renders the React application on the server. </span><span class="koboSpan" id="kobo.579.3">While our </span><strong class="source-inline"><span class="koboSpan" id="kobo.580.1">Index</span></strong><span class="koboSpan" id="kobo.581.1"> React component is executed, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.582.1">console.log</span></strong><span class="koboSpan" id="kobo.583.1"> statement is called, printing the statement to the terminal. </span><span class="koboSpan" id="kobo.583.2">Conclusively, </span><strong class="source-inline"><span class="koboSpan" id="kobo.584.1">console.log</span></strong><span class="koboSpan" id="kobo.585.1"> is executed once on the server. </span><span class="koboSpan" id="kobo.585.2">But is </span><span class="No-Break"><span class="koboSpan" id="kobo.586.1">that all?</span></span></p></li> <li><span class="koboSpan" id="kobo.587.1">Navigate to your browser window and open the developer tools in the tab that shows the Remix application. </span><span class="koboSpan" id="kobo.587.2">In the developer tools, navigate to the </span><strong class="bold"><span class="koboSpan" id="kobo.588.1">Console</span></strong><span class="koboSpan" id="kobo.589.1"> tab. </span><span class="koboSpan" id="kobo.589.2">You should see </span><strong class="bold"><span class="koboSpan" id="kobo.590.1">Another hello to </span></strong><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.591.1">the world!</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.592.1">.</span></span><p class="list-inset"><span class="koboSpan" id="kobo.593.1">Your browser downloads the rendered HTML document from the server and loads the linked JavaScript modules. </span><span class="koboSpan" id="kobo.593.2">The browser then executes the code inside the </span><strong class="source-inline"><span class="koboSpan" id="kobo.594.1">entry.client.ts</span></strong><span class="koboSpan" id="kobo.595.1"> file. </span><span class="koboSpan" id="kobo.595.2">Here, Remix rehydrates your React application. </span><span class="koboSpan" id="kobo.595.3">React re-renders on the client and renders the </span><strong class="source-inline"><span class="koboSpan" id="kobo.596.1">Index</span></strong><span class="koboSpan" id="kobo.597.1"> component again. </span><span class="koboSpan" id="kobo.597.2">Hence, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.598.1">console.log</span></strong><span class="koboSpan" id="kobo.599.1"> statement is run once on the server and then also on </span><span class="No-Break"><span class="koboSpan" id="kobo.600.1">the client.</span></span></p></li>
</ol>
<p><span class="koboSpan" id="kobo.601.1">The React code of your Remix application is run on the server and on the client. </span><span class="koboSpan" id="kobo.601.2">However, some code should only ever run on the server or the client. </span><span class="koboSpan" id="kobo.601.3">For instance, the </span><strong class="source-inline"><span class="koboSpan" id="kobo.602.1">entry.client.tsx</span></strong><span class="koboSpan" id="kobo.603.1"> module should only run on the client, and the </span><strong class="source-inline"><span class="koboSpan" id="kobo.604.1">entry.server.tsx</span></strong><span class="koboSpan" id="kobo.605.1"> module should only ever be executed on </span><span class="No-Break"><span class="koboSpan" id="kobo.606.1">the server.</span></span></p>
<p><span class="koboSpan" id="kobo.607.1">It is also important that no server-side code makes it into the client bundle. </span><span class="koboSpan" id="kobo.607.2">The code in the client bundle is exposed over the internet. </span><span class="koboSpan" id="kobo.607.3">Think about your API tokens and other secrets that may be present in your backend logic. </span><span class="koboSpan" id="kobo.607.4">Moreover, the browser and server environments differ. </span><span class="koboSpan" id="kobo.607.5">Node.js APIs are not available on the client, and the browserâ€™s global </span><strong class="source-inline"><span class="koboSpan" id="kobo.608.1">window</span></strong><span class="koboSpan" id="kobo.609.1"> object is not available in Node.js. </span><span class="koboSpan" id="kobo.609.2">Server-side code may throw errors when executed on the client, and </span><span class="No-Break"><span class="koboSpan" id="kobo.610.1">vice versa.</span></span></p>
<p><span class="koboSpan" id="kobo.611.1">Remix is your </span><a id="_idIndexMarker059"/><span class="koboSpan" id="kobo.612.1">compiler and bundles your code into a server and a client bundle. </span><span class="koboSpan" id="kobo.612.2">But how do we tell Remix what to bundle for the server and what to </span><a id="_idIndexMarker060"/><span class="koboSpan" id="kobo.613.1">bundle for the client? </span><span class="koboSpan" id="kobo.613.2">Most of the time, Remix can figure it out by itself. </span><span class="koboSpan" id="kobo.613.3">Remix uses â€œtree shakingâ€ to filter your code and aims to infer which code belongs to which bundle. </span><span class="koboSpan" id="kobo.613.4">However, you can also explicitly tell the compiler â€“ and developers working on your project â€“ that code should only be executed in one of the </span><span class="No-Break"><span class="koboSpan" id="kobo.614.1">two environments.</span></span></p>
<p><span class="koboSpan" id="kobo.615.1">Remix offers a convention to mark files as purely server-side or client-side modules. </span><span class="koboSpan" id="kobo.615.2">Adding </span><strong class="source-inline"><span class="koboSpan" id="kobo.616.1">.client.</span></strong><span class="koboSpan" id="kobo.617.1"> or </span><strong class="source-inline"><span class="koboSpan" id="kobo.618.1">.server.</span></strong><span class="koboSpan" id="kobo.619.1"> to the end of the filename tells Remixâ€™s compiler to avoid including these files in the server or client bundle, respectively. </span><span class="koboSpan" id="kobo.619.2">For instance, you can name your database setup file </span><strong class="source-inline"><span class="koboSpan" id="kobo.620.1">db.server.ts</span></strong><span class="koboSpan" id="kobo.621.1"> to explicitly exclude it from the client bundle. </span><span class="koboSpan" id="kobo.621.2">Similarly, you can name a file that imports client-only libraries </span><strong class="source-inline"><span class="koboSpan" id="kobo.622.1">libs.client.ts</span></strong><span class="koboSpan" id="kobo.623.1"> to explicitly avoid importing these packages on </span><span class="No-Break"><span class="koboSpan" id="kobo.624.1">the server.</span></span></p>
<p><span class="koboSpan" id="kobo.625.1">You might have noticed that both entry files (</span><strong class="source-inline"><span class="koboSpan" id="kobo.626.1">entry.server</span></strong><span class="koboSpan" id="kobo.627.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.628.1">entry.client</span></strong><span class="koboSpan" id="kobo.629.1">) follow this convention. </span><span class="koboSpan" id="kobo.629.2">Feel free to add </span><strong class="source-inline"><span class="koboSpan" id="kobo.630.1">console.log</span></strong><span class="koboSpan" id="kobo.631.1"> statements to both entry files and recognize where each statement is executed â€“ the terminal window or the browser </span><span class="No-Break"><strong class="bold"><span class="koboSpan" id="kobo.632.1">Console</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.633.1"> tab.</span></span></p>
<p><span class="koboSpan" id="kobo.634.1">Note that some files cannot be declared as server or client files. </span><span class="koboSpan" id="kobo.634.2">For instance, route modules in the </span><strong class="source-inline"><span class="koboSpan" id="kobo.635.1">/routes</span></strong><span class="koboSpan" id="kobo.636.1"> folder must not be declared as client or server files as they may include both client and </span><span class="No-Break"><span class="koboSpan" id="kobo.637.1">server code.</span></span></p>
<p><span class="koboSpan" id="kobo.638.1">In this section, you learned more about the code flow of a </span><strong class="source-inline"><span class="koboSpan" id="kobo.639.1">GET</span></strong><span class="koboSpan" id="kobo.640.1"> request through your Remix application. </span><span class="koboSpan" id="kobo.640.2">You learned that Remix receives </span><strong class="source-inline"><span class="koboSpan" id="kobo.641.1">GET</span></strong><span class="koboSpan" id="kobo.642.1"> requests on the server and renders your React application on both the client and the server. </span><span class="koboSpan" id="kobo.642.2">Some code in your Remix application is run on both environments, while other code should only run on </span><span class="No-Break"><span class="koboSpan" id="kobo.643.1">one environment.</span></span></p>
<p><span class="koboSpan" id="kobo.644.1">Remix runs on both the client and the server. </span><span class="koboSpan" id="kobo.644.2">Learning how to troubleshoot across the two environments is crucial. </span><span class="koboSpan" id="kobo.644.3">In the next section, you will learn more about how to interpret error messages in your Remix application and where to </span><span class="No-Break"><span class="koboSpan" id="kobo.645.1">get help.</span></span></p>
<h1 id="_idParaDest-41"><a id="_idTextAnchor038"/><span class="koboSpan" id="kobo.646.1">Troubleshooting Remix applications</span></h1>
<p><span class="koboSpan" id="kobo.647.1">In this section, you </span><a id="_idIndexMarker061"/><span class="koboSpan" id="kobo.648.1">will learn more about debugging Remix applications. </span><span class="koboSpan" id="kobo.648.2">First, we will provide you with a general process to approach issues while developing with Remix. </span><span class="koboSpan" id="kobo.648.3">Next, we will document how to best search for answers and get help from </span><span class="No-Break"><span class="koboSpan" id="kobo.649.1">the community.</span></span></p>
<h2 id="_idParaDest-42"><a id="_idTextAnchor039"/><span class="koboSpan" id="kobo.650.1">A Remix troubleshooting process</span></h2>
<p><span class="koboSpan" id="kobo.651.1">Remix is not a server </span><a id="_idIndexMarker062"/><span class="koboSpan" id="kobo.652.1">but runs on top of a web server and an underlying server runtime environment. </span><span class="koboSpan" id="kobo.652.2">Remix acts as an HTTP request handler, orchestrates your routes, executes your code during runtime, and acts as your compiler. </span><span class="koboSpan" id="kobo.652.3">Quite a few things can go wrong. </span><span class="koboSpan" id="kobo.652.4">Thatâ€™s why itâ€™s important to practice the process of debugging </span><span class="No-Break"><span class="koboSpan" id="kobo.653.1">in Remix.</span></span></p>
<p><span class="koboSpan" id="kobo.654.1">In the last section, we learned more about Remixâ€™s two environments, the client and the server. </span><span class="koboSpan" id="kobo.654.2">Remix runs on the server and then executes logic inside the browser. </span><span class="koboSpan" id="kobo.654.3">Hence, when debugging your Remix application, we must investigate both the client and the server environment. </span><span class="koboSpan" id="kobo.654.4">Letâ€™s break the </span><strong class="source-inline"><span class="koboSpan" id="kobo.655.1">Hello </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.656.1">World!</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.657.1"> App:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.658.1">Add the following troublesome code to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.659.1">app/routes/_index.tsx</span></strong><span class="koboSpan" id="kobo.660.1"> file in your </span><strong class="source-inline"><span class="koboSpan" id="kobo.661.1">Hello </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.662.1">World!</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.663.1"> app:</span></span><pre class="source-code"><span class="koboSpan" id="kobo.664.1">
export default function Index() {</span><strong class="bold"><span class="koboSpan" id="kobo.665.1">Â Â const userAgent = navigator.userAgent;</span></strong><strong class="bold"><span class="koboSpan" id="kobo.666.1">Â Â console.log(`Another hello to ${userAgent}!`);</span></strong><span class="koboSpan" id="kobo.667.1">Â Â return (Â Â Â Â &lt;h1&gt;Hello to {userAgent}!&lt;/h1&gt;Â Â );}</span></pre><p class="list-inset"><span class="koboSpan" id="kobo.668.1">The code uses the browserâ€™s </span><strong class="source-inline"><span class="koboSpan" id="kobo.669.1">navigator</span></strong><span class="koboSpan" id="kobo.670.1"> interface to access user agent information. </span><span class="koboSpan" id="kobo.670.2">Our goal is to greet the user based on their </span><span class="No-Break"><span class="koboSpan" id="kobo.671.1">user agent.</span></span></p></li> <li><span class="koboSpan" id="kobo.672.1">Run </span><strong class="source-inline"><span class="koboSpan" id="kobo.673.1">npm run dev</span></strong><span class="koboSpan" id="kobo.674.1"> to start the app if it is not </span><span class="No-Break"><span class="koboSpan" id="kobo.675.1">already running.</span></span></li>
<li><span class="koboSpan" id="kobo.676.1">Visit the Remix app in a new browser window or refresh an existing one. </span><span class="koboSpan" id="kobo.676.2">Unfortunately, you will notice that the application throws an error. </span><span class="koboSpan" id="kobo.676.3">The page should show the headline </span><strong class="bold"><span class="koboSpan" id="kobo.677.1">Application Error</span></strong><span class="koboSpan" id="kobo.678.1">. </span><span class="koboSpan" id="kobo.678.2">Snap! </span><span class="koboSpan" id="kobo.678.3">Letâ€™s </span><span class="No-Break"><span class="koboSpan" id="kobo.679.1">start debugging.</span></span></li>
</ol>
<h3><span class="koboSpan" id="kobo.680.1">1. </span><span class="koboSpan" id="kobo.680.2">Trust the error message</span></h3>
<p><span class="koboSpan" id="kobo.681.1">If something </span><a id="_idIndexMarker063"/><span class="koboSpan" id="kobo.682.1">goes wrong, the first thing you should do is inspect the terminal that is running Remix locally. </span><span class="koboSpan" id="kobo.682.2">You should be able to see the following error message in </span><span class="No-Break"><span class="koboSpan" id="kobo.683.1">the terminal:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.684.1">
ReferenceError: navigator is not defined</span></pre> <p><span class="koboSpan" id="kobo.685.1">You might have to scroll a bit to find the relevant line above the stack trace. </span><span class="koboSpan" id="kobo.685.2">Additionally, the error message should also be rendered in the browser tab. </span><span class="koboSpan" id="kobo.685.3">Remix displays a fallback error page in case something goes wrong. </span><span class="koboSpan" id="kobo.685.4">The error message on the page is more readable than on the terminal, but consider the terminal the source of truth when it comes to troubleshooting. </span><span class="koboSpan" id="kobo.685.5">In this case, both errors are matching. </span><span class="koboSpan" id="kobo.685.6">It seems like the </span><strong class="source-inline"><span class="koboSpan" id="kobo.686.1">navigator</span></strong><span class="koboSpan" id="kobo.687.1"> object </span><span class="No-Break"><span class="koboSpan" id="kobo.688.1">is undefined.</span></span></p>
<h3><span class="koboSpan" id="kobo.689.1">2. </span><span class="koboSpan" id="kobo.689.2">Locate the line</span></h3>
<p><span class="koboSpan" id="kobo.690.1">Letâ€™s </span><a id="_idIndexMarker064"/><span class="koboSpan" id="kobo.691.1">investigate the error message in the terminal in more detail. </span><span class="koboSpan" id="kobo.691.2">We can utilize the stack trace to learn which file threw the error and follow the stack trace downward across the stack of function calls. </span><span class="koboSpan" id="kobo.691.3">You should be able to see that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.692.1">app/routes/_index.tsx</span></strong><span class="koboSpan" id="kobo.693.1"> file threw the error. </span><span class="koboSpan" id="kobo.693.2">Seems like thatâ€™s an application error and not an error with Remix or a dependency since itâ€™s our code </span><span class="No-Break"><span class="koboSpan" id="kobo.694.1">that broke.</span></span></p>
<h3><span class="koboSpan" id="kobo.695.1">3. </span><span class="koboSpan" id="kobo.695.2">Build time or runtime</span></h3>
<p><span class="koboSpan" id="kobo.696.1">Next, note </span><a id="_idIndexMarker065"/><span class="koboSpan" id="kobo.697.1">that the error occurs only after we request a page from the web server. </span><span class="koboSpan" id="kobo.697.2">As </span><strong class="source-inline"><span class="koboSpan" id="kobo.698.1">npm run dev</span></strong><span class="koboSpan" id="kobo.699.1"> succeeded without throwing any errors, this is a runtime issue, not a build time issue. </span><span class="koboSpan" id="kobo.699.2">The server also started without throwing errors. </span><span class="koboSpan" id="kobo.699.3">This indicates that the error occurred within the request handlers and not in the server </span><span class="No-Break"><span class="koboSpan" id="kobo.700.1">startup code.</span></span></p>
<h3><span class="koboSpan" id="kobo.701.1">4. </span><span class="koboSpan" id="kobo.701.2">The Console and Network tabs</span></h3>
<p><span class="koboSpan" id="kobo.702.1">Letâ€™s </span><a id="_idIndexMarker066"/><span class="koboSpan" id="kobo.703.1">open the developer tools in the browser window. </span><span class="koboSpan" id="kobo.703.2">Click on the </span><strong class="bold"><span class="koboSpan" id="kobo.704.1">Console</span></strong><span class="koboSpan" id="kobo.705.1"> tab to view any logged client-side errors. </span><span class="koboSpan" id="kobo.705.2">The following error should </span><span class="No-Break"><span class="koboSpan" id="kobo.706.1">show up:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.707.1">
GET http://localhost:3000/ 500 (Internal Server Error)</span></pre> <p><span class="koboSpan" id="kobo.708.1">A </span><strong class="source-inline"><span class="koboSpan" id="kobo.709.1">GET</span></strong><span class="koboSpan" id="kobo.710.1"> request failed with an internal server error. </span><span class="koboSpan" id="kobo.710.2">We investigate further by navigating to the </span><strong class="bold"><span class="koboSpan" id="kobo.711.1">Network</span></strong><span class="koboSpan" id="kobo.712.1"> tab, as </span><span class="No-Break"><span class="koboSpan" id="kobo.713.1">shown here:</span></span></p>
<div>
<div class="IMG---Figure" id="_idContainer009">
<span class="koboSpan" id="kobo.714.1"><img alt="Figure 2.1 â€“ Introducing the Network tab" src="image/Figure_2.01_B17399.jpg"/></span>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"><span class="koboSpan" id="kobo.715.1">Figure 2.1 â€“ Introducing the Network tab</span></p>
<p><span class="koboSpan" id="kobo.716.1">The </span><strong class="bold"><span class="koboSpan" id="kobo.717.1">Network</span></strong><span class="koboSpan" id="kobo.718.1"> tab reveals that the document request failed. </span><span class="koboSpan" id="kobo.718.2">The </span><strong class="bold"><span class="koboSpan" id="kobo.719.1">Network</span></strong><span class="koboSpan" id="kobo.720.1"> tabâ€™s </span><strong class="bold"><span class="koboSpan" id="kobo.721.1">Headers</span></strong><span class="koboSpan" id="kobo.722.1"> tab displays the response and request headers. </span><span class="koboSpan" id="kobo.722.2">We can see that the server responded with status code </span><strong class="source-inline"><span class="koboSpan" id="kobo.723.1">500</span></strong><span class="koboSpan" id="kobo.724.1">. </span><span class="koboSpan" id="kobo.724.2">In the </span><strong class="bold"><span class="koboSpan" id="kobo.725.1">Response</span></strong><span class="koboSpan" id="kobo.726.1"> tab (not shown in </span><span class="No-Break"><em class="italic"><span class="koboSpan" id="kobo.727.1">Figure 2</span></em></span><em class="italic"><span class="koboSpan" id="kobo.728.1">.1</span></em><span class="koboSpan" id="kobo.729.1">), we can further see that Remix returned an HTML document â€“ the </span><strong class="bold"><span class="koboSpan" id="kobo.730.1">Application Error</span></strong><span class="koboSpan" id="kobo.731.1"> document we see on </span><span class="No-Break"><span class="koboSpan" id="kobo.732.1">the screen.</span></span></p>
<p><span class="koboSpan" id="kobo.733.1">What happened? </span><span class="koboSpan" id="kobo.733.2">The web server attempted to handle the </span><strong class="source-inline"><span class="koboSpan" id="kobo.734.1">GET</span></strong><span class="koboSpan" id="kobo.735.1"> request but threw a </span><strong class="source-inline"><span class="koboSpan" id="kobo.736.1">ReferenceError</span></strong><span class="koboSpan" id="kobo.737.1">. </span><span class="koboSpan" id="kobo.737.2">The error was caught by Remix. </span><span class="koboSpan" id="kobo.737.3">Remix returned an error response document to the browser. </span><span class="koboSpan" id="kobo.737.4">Remix uses the status code </span><strong class="source-inline"><span class="koboSpan" id="kobo.738.1">500</span></strong><span class="koboSpan" id="kobo.739.1"> â€“ the status code for internal server errors â€“ to tell us and the browser that the response is an </span><span class="No-Break"><span class="koboSpan" id="kobo.740.1">error response.</span></span></p>
<h3><span class="koboSpan" id="kobo.741.1">5. </span><span class="koboSpan" id="kobo.741.2">Turn it off and on again</span></h3>
<p><span class="koboSpan" id="kobo.742.1">If we canâ€™t identify </span><a id="_idIndexMarker067"/><span class="koboSpan" id="kobo.743.1">the error thus far, it is a good idea to clean up any temporary files that might affect our local development server. </span><span class="koboSpan" id="kobo.743.2">Stop the development server if it is still running. </span><span class="koboSpan" id="kobo.743.3">Then run the following command to clean up all temporary </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.744.1">build</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.745.1"> artifacts:</span></span></p>
<pre class="console"><span class="koboSpan" id="kobo.746.1">
rm -rf build public/build .cache</span></pre> <p><span class="koboSpan" id="kobo.747.1">This removes all temporary files and folders. </span><span class="koboSpan" id="kobo.747.2">Next, restart the development server by executing </span><strong class="source-inline"><span class="koboSpan" id="kobo.748.1">npm run dev</span></strong><span class="koboSpan" id="kobo.749.1"> in the terminal. </span><span class="koboSpan" id="kobo.749.2">This triggers a new build and results in a cleaned-up local environment. </span><span class="koboSpan" id="kobo.749.3">Does the error persist? </span><span class="koboSpan" id="kobo.749.4">In our case, it does, but we are able to verify that the error is not due to a </span><span class="No-Break"><span class="koboSpan" id="kobo.750.1">broken build.</span></span></p>
<h3><span class="koboSpan" id="kobo.751.1">6. </span><span class="koboSpan" id="kobo.751.2">Google the issue</span></h3>
<p><span class="koboSpan" id="kobo.752.1">What would </span><a id="_idIndexMarker068"/><span class="koboSpan" id="kobo.753.1">be your Google search query for this issue? </span><span class="koboSpan" id="kobo.753.2">Maybe see whether you can find the issue on Google. </span><span class="koboSpan" id="kobo.753.3">I would probably use one of the </span><span class="No-Break"><span class="koboSpan" id="kobo.754.1">following searches:</span></span></p>
<ul>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.755.1">Navigator undefined </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.756.1">server-rendered React</span></strong></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.757.1">Server throws with </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.758.1">navigator undefined</span></strong></span></li>
<li><strong class="source-inline"><span class="koboSpan" id="kobo.759.1">Remix throws navigator not defined on </span></strong><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.760.1">the server</span></strong></span></li>
</ul>
<p><span class="koboSpan" id="kobo.761.1">The gotcha is that the </span><strong class="source-inline"><span class="koboSpan" id="kobo.762.1">window</span></strong><span class="koboSpan" id="kobo.763.1"> element and other browser globals do not exist in Node.js. </span><span class="koboSpan" id="kobo.763.2">Since we attempt to execute the React component on the server, it throws </span><strong class="source-inline"><span class="koboSpan" id="kobo.764.1">ReferenceError</span></strong><span class="koboSpan" id="kobo.765.1"> â€“ not really a Remix issue but a common pitfall when rendering React code on the server. </span><span class="No-Break"><span class="koboSpan" id="kobo.766.1">Case solved!</span></span></p>
<p><span class="koboSpan" id="kobo.767.1">A quick fix for this type of error is to wrap references to browser APIs in </span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.768.1">useEffect</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.769.1"> calls:</span></span></p>
<pre class="source-code">
<strong class="bold"><span class="koboSpan" id="kobo.770.1">import { useEffect, useState } from "react";</span></strong><span class="koboSpan" id="kobo.771.1">export default function Index() {
</span><strong class="bold"><span class="koboSpan" id="kobo.772.1">Â Â const [userAgent, setUserAgent] = useState('the World');</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.773.1">Â Â useEffect(() =&gt; {</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.774.1">Â Â Â Â setUserAgent(navigator.userAgent);</span></strong>
<strong class="bold"><span class="koboSpan" id="kobo.775.1">Â Â }, []);</span></strong><span class="koboSpan" id="kobo.776.1">
Â Â console.log(`Another hello to ${userAgent}!`);
Â Â return (
Â Â Â Â &lt;h1&gt;Hello to {userAgent}!&lt;/h1&gt;
Â Â );
}</span></pre>
<p><strong class="source-inline"><span class="koboSpan" id="kobo.777.1">useEffect</span></strong><span class="koboSpan" id="kobo.778.1"> only runs after the initial render. </span><span class="koboSpan" id="kobo.778.2">Since we only render once on the server, we know that </span><strong class="source-inline"><span class="koboSpan" id="kobo.779.1">useEffect</span></strong><span class="koboSpan" id="kobo.780.1"> is only executed on the client and never on the server. </span><span class="koboSpan" id="kobo.780.2">We can safely call browser APIs </span><span class="No-Break"><span class="koboSpan" id="kobo.781.1">in </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.782.1">useEffect</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.783.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.784.1">Can </span><a id="_idIndexMarker069"/><span class="koboSpan" id="kobo.785.1">you think of any disadvantages of this approach? </span><span class="koboSpan" id="kobo.785.2">Reload your application and have a look at the terminal. </span><span class="koboSpan" id="kobo.785.3">It logs </span><strong class="source-inline"><span class="koboSpan" id="kobo.786.1">Another hello to the world!</span></strong><span class="koboSpan" id="kobo.787.1">. </span><span class="koboSpan" id="kobo.787.2">On the server, we do not have access to the </span><strong class="source-inline"><span class="koboSpan" id="kobo.788.1">navigator</span></strong><span class="koboSpan" id="kobo.789.1"> object and instead use the default value of the React state. </span><span class="koboSpan" id="kobo.789.2">We only re-render the appropriate greeting message on </span><span class="No-Break"><span class="koboSpan" id="kobo.790.1">the client.</span></span></p>
<p><span class="koboSpan" id="kobo.791.1">What if JavaScript fails to load or is disabled? </span><span class="koboSpan" id="kobo.791.2">What if the request is made by a web crawler that doesnâ€™t run JavaScript? </span><span class="koboSpan" id="kobo.791.3">On slow internet connections, the layout might flicker, and the user might first see the server value before it is updated once JavaScript is loaded. </span><span class="koboSpan" id="kobo.791.4">This is not a great </span><span class="No-Break"><span class="koboSpan" id="kobo.792.1">user experience.</span></span></p>
<p><span class="koboSpan" id="kobo.793.1">Remix provides utilities to work with user data right on the server â€“ no need to use </span><strong class="source-inline"><span class="koboSpan" id="kobo.794.1">useEffect</span></strong><span class="koboSpan" id="kobo.795.1"> at all. </span><span class="koboSpan" id="kobo.795.2">Most of the time, we can avoid client-server state mismatches. </span><span class="koboSpan" id="kobo.795.3">For now, we can be pleased that we fixed the issue and learned how to investigate errors in Remix. </span><span class="koboSpan" id="kobo.795.4">We can summarize the described troubleshooting process </span><span class="No-Break"><span class="koboSpan" id="kobo.796.1">as follows:</span></span></p>
<ol>
<li><span class="koboSpan" id="kobo.797.1">Find and read the error message in </span><span class="No-Break"><span class="koboSpan" id="kobo.798.1">the terminal.</span></span></li>
<li><span class="koboSpan" id="kobo.799.1">Locate the file that produces </span><span class="No-Break"><span class="koboSpan" id="kobo.800.1">the error.</span></span></li>
<li><span class="koboSpan" id="kobo.801.1">Understand whether itâ€™s a build time or </span><span class="No-Break"><span class="koboSpan" id="kobo.802.1">runtime error.</span></span></li>
<li><span class="koboSpan" id="kobo.803.1">Check the browser developer tools to get </span><span class="No-Break"><span class="koboSpan" id="kobo.804.1">more context.</span></span></li>
<li><span class="koboSpan" id="kobo.805.1">Remove all build artifacts </span><span class="No-Break"><span class="koboSpan" id="kobo.806.1">and retry.</span></span></li>
<li><span class="koboSpan" id="kobo.807.1">Google </span><span class="No-Break"><span class="koboSpan" id="kobo.808.1">the issue.</span></span></li>
</ol>
<p><span class="koboSpan" id="kobo.809.1">Next, we will focus on </span><em class="italic"><span class="koboSpan" id="kobo.810.1">step 6</span></em><span class="koboSpan" id="kobo.811.1">. </span><span class="koboSpan" id="kobo.811.2">Successful debugging takes practice and experience. </span><span class="koboSpan" id="kobo.811.3">Often, you just have to use Google. </span><span class="koboSpan" id="kobo.811.4">In the next section, we document where to find answers when working </span><span class="No-Break"><span class="koboSpan" id="kobo.812.1">with Remix.</span></span></p>
<h2 id="_idParaDest-43"><a id="_idTextAnchor040"/><span class="koboSpan" id="kobo.813.1">Looking for answers</span></h2>
<p><span class="koboSpan" id="kobo.814.1">Successful </span><a id="_idIndexMarker070"/><span class="koboSpan" id="kobo.815.1">debugging takes practice. </span><span class="koboSpan" id="kobo.815.2">Once you encounter an issue once or twice, you will get faster at figuring out the root cause. </span><span class="koboSpan" id="kobo.815.3">Until then, it is good practice to search for a solution online. </span><span class="koboSpan" id="kobo.815.4">In this section, you will learn how to get help when working </span><span class="No-Break"><span class="koboSpan" id="kobo.816.1">with Remix.</span></span></p>
<p><span class="koboSpan" id="kobo.817.1">Follow the troubleshooting process as laid out in the last section. </span><span class="koboSpan" id="kobo.817.2">It is important that you gather as much information as possible. </span><span class="koboSpan" id="kobo.817.3">Once you start formulating your issue or question, you will find that a thorough investigation might already yield the answer. </span><span class="koboSpan" id="kobo.817.4">At least it will help identify the right keywords for your </span><span class="No-Break"><span class="koboSpan" id="kobo.818.1">online search.</span></span></p>
<p><span class="koboSpan" id="kobo.819.1">Most issues we encounter during development are not related to Remix. </span><span class="koboSpan" id="kobo.819.2">Most errors occur because of rendering React on the server, accidentally running server code on the client, or because of issues with node packages. </span><span class="koboSpan" id="kobo.819.3">In these cases, Stack Overflow, GitHub, and other places might have the answers </span><span class="No-Break"><span class="koboSpan" id="kobo.820.1">we seek.</span></span></p>
<p><span class="koboSpan" id="kobo.821.1">If that is not the case, then I can only encourage you to join </span><a id="_idIndexMarker071"/><span class="koboSpan" id="kobo.822.1">the Remix Discord server (</span><a href="https://discord.com/invite/xwx7mMzVkA"><span class="koboSpan" id="kobo.823.1">https://discord.com/invite/xwx7mMzVkA</span></a><span class="koboSpan" id="kobo.824.1">). </span><span class="koboSpan" id="kobo.824.2">The Remix community is </span><span class="No-Break"><span class="koboSpan" id="kobo.825.1">very supportive.</span></span></p>
<p><span class="koboSpan" id="kobo.826.1">Before asking a question, make sure to use Discordâ€™s search feature to see whether the question has already been asked and answered. </span><span class="koboSpan" id="kobo.826.2">This saves everyone time. </span><span class="koboSpan" id="kobo.826.3">By following the troubleshooting process, you should be able to provide plenty of context that can help the community debug your code. </span><span class="koboSpan" id="kobo.826.4">Providing code snippets (or, better, a code sandbox or public repository) will also greatly improve the likelihood that the community can assist you. </span><span class="koboSpan" id="kobo.826.5">The Remix community is amazing, and Discord is a great place to </span><span class="No-Break"><span class="koboSpan" id="kobo.827.1">seek help.</span></span></p>
<p><span class="koboSpan" id="kobo.828.1">If you have issues with Remix primitives or conventions, refer to the Remix documentation. </span><span class="koboSpan" id="kobo.828.2">The following page compiles a list of common pitfalls: </span><a href="https://remix.run/docs/en/2/guides/gotchas"><span class="koboSpan" id="kobo.829.1">https://remix.run/docs/en/2/guides/gotchas</span></a><span class="koboSpan" id="kobo.830.1">. </span><span class="koboSpan" id="kobo.830.2">These are issues that are harder to debug. </span><span class="koboSpan" id="kobo.830.3">Being aware of them ahead of time can save you costly </span><span class="No-Break"><span class="koboSpan" id="kobo.831.1">debugging time.</span></span></p>
<p><span class="koboSpan" id="kobo.832.1">In this section, you learned how to troubleshoot issues while working with Remix. </span><span class="koboSpan" id="kobo.832.2">You went through an example error and applied the proposed debugging process to uncover the root cause. </span><span class="koboSpan" id="kobo.832.3">You further learned more about how to search for answers and where to ask </span><span class="No-Break"><span class="koboSpan" id="kobo.833.1">questions online.</span></span></p>
<h1 id="_idParaDest-44"><a id="_idTextAnchor041"/><span class="koboSpan" id="kobo.834.1">Summary</span></h1>
<p><span class="koboSpan" id="kobo.835.1">In this chapter, we created our first Remix application. </span><span class="koboSpan" id="kobo.835.2">We used Remixâ€™s </span><strong class="source-inline"><span class="koboSpan" id="kobo.836.1">create-remix</span></strong><span class="koboSpan" id="kobo.837.1"> CLI script to bootstrap one Remix app with the basic template and one using Remixâ€™s </span><span class="No-Break"><span class="koboSpan" id="kobo.838.1">Express.js template.</span></span></p>
<p><span class="koboSpan" id="kobo.839.1">By following this chapter, you have learned how to build and run Remix applications locally using </span><strong class="source-inline"><span class="koboSpan" id="kobo.840.1">npm run dev</span></strong><span class="koboSpan" id="kobo.841.1"> and </span><strong class="source-inline"><span class="koboSpan" id="kobo.842.1">npm run build</span></strong><span class="koboSpan" id="kobo.843.1">. </span><span class="koboSpan" id="kobo.843.2">More importantly, you understand where to find all available scripts (</span><strong class="source-inline"><span class="koboSpan" id="kobo.844.1">package.json</span></strong><span class="koboSpan" id="kobo.845.1">) and additional information for running a specific </span><span class="No-Break"><span class="koboSpan" id="kobo.846.1">template (</span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.847.1">README.md</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.848.1">).</span></span></p>
<p><span class="koboSpan" id="kobo.849.1">We reviewed Remixâ€™s file and folder structure. </span><span class="koboSpan" id="kobo.849.2">After reading this chapter, you know about the client and server entry points: </span><strong class="source-inline"><span class="koboSpan" id="kobo.850.1">entry.client.tsx</span></strong> <span class="No-Break"><span class="koboSpan" id="kobo.851.1">and </span></span><span class="No-Break"><strong class="source-inline"><span class="koboSpan" id="kobo.852.1">entry.server.tsx</span></strong></span><span class="No-Break"><span class="koboSpan" id="kobo.853.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.854.1">We also spent some time investigating the </span><strong class="source-inline"><span class="koboSpan" id="kobo.855.1">root.tsx</span></strong><span class="koboSpan" id="kobo.856.1"> file. </span><span class="koboSpan" id="kobo.856.2">The </span><strong class="source-inline"><span class="koboSpan" id="kobo.857.1">root.tsx</span></strong><span class="koboSpan" id="kobo.858.1"> file acts as the root of the route tree. </span><span class="koboSpan" id="kobo.858.2">Remix utilizes React to render the full HTML document, including the head, bundled scripts, links, and meta tags. </span><span class="koboSpan" id="kobo.858.3">This provides full control over what is rendered on </span><span class="No-Break"><span class="koboSpan" id="kobo.859.1">the screen.</span></span></p>
<p><span class="koboSpan" id="kobo.860.1">We changed the code of the </span><strong class="source-inline"><span class="koboSpan" id="kobo.861.1">_index</span></strong><span class="koboSpan" id="kobo.862.1"> route and rendered </span><strong class="source-inline"><span class="koboSpan" id="kobo.863.1">Hello World!</span></strong><span class="koboSpan" id="kobo.864.1"> to the screen. </span><span class="koboSpan" id="kobo.864.2">Next, we studied Remixâ€™s two environments: the client and the server. </span><span class="koboSpan" id="kobo.864.3">You learned that Remix runs in the browser and on a web server. </span><span class="koboSpan" id="kobo.864.4">Remix compiles the application code into a client and a server build. </span><span class="koboSpan" id="kobo.864.5">The web server exposes the client code as static files while calling the server bundle during runtime to handle </span><span class="No-Break"><span class="koboSpan" id="kobo.865.1">incoming requests.</span></span></p>
<p><span class="koboSpan" id="kobo.866.1">Remix uses adapters to run on different web servers and server runtimes. </span><span class="koboSpan" id="kobo.866.2">The adapter manages the communication between our Remix app and the underlying </span><span class="No-Break"><span class="koboSpan" id="kobo.867.1">server code.</span></span></p>
<p><span class="koboSpan" id="kobo.868.1">Finally, we practiced troubleshooting Remix applications by solving an example error. </span><span class="koboSpan" id="kobo.868.2">You learned how to investigate errors by looking both at the serverâ€™s terminal and the </span><strong class="bold"><span class="koboSpan" id="kobo.869.1">Console</span></strong><span class="koboSpan" id="kobo.870.1"> tab in the browser. </span><span class="koboSpan" id="kobo.870.2">You also practiced searching for issues online, and you found out where to ask the Remix community </span><span class="No-Break"><span class="koboSpan" id="kobo.871.1">for help.</span></span></p>
<p><span class="koboSpan" id="kobo.872.1">In the next chapter, you will learn more about different templates, deployment targets, adapters, and Remix stacks. </span><span class="koboSpan" id="kobo.872.2">We will compare different server runtimes and deployment environments so you can pick the right one for your Remix apps. </span><span class="koboSpan" id="kobo.872.3">You will also be introduced to </span><strong class="source-inline"><span class="koboSpan" id="kobo.873.1">Bee-Rich</span></strong><span class="koboSpan" id="kobo.874.1">, the demo application of this book. </span><span class="koboSpan" id="kobo.874.2">Get ready to build a Remix application start to finish following the chapters of </span><span class="No-Break"><span class="koboSpan" id="kobo.875.1">this book!</span></span></p>
<h1 id="_idParaDest-45"><a id="_idTextAnchor042"/><span class="koboSpan" id="kobo.876.1">Further reading</span></h1>
<p><span class="koboSpan" id="kobo.877.1">You donâ€™t need to use </span><strong class="source-inline"><span class="koboSpan" id="kobo.878.1">create-remix</span></strong><span class="koboSpan" id="kobo.879.1"> to bootstrap a new Remix project. </span><span class="koboSpan" id="kobo.879.2">You can also start from scratch by installing Remixâ€™s dependencies and setting up the file and folder structure yourself. </span><span class="koboSpan" id="kobo.879.3">If you are curious about this approach, follow the 5-minute tutorial from the Remix </span><span class="No-Break"><span class="koboSpan" id="kobo.880.1">documentation: </span></span><a href="https://remix.run/docs/en/2/start/quickstart"><span class="No-Break"><span class="koboSpan" id="kobo.881.1">https://remix.run/docs/en/2/start/quickstart</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.882.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.883.1">We introduced you to the Remix App Server. </span><span class="koboSpan" id="kobo.883.2">You can read more about the Remixâ€™s basic template </span><span class="No-Break"><span class="koboSpan" id="kobo.884.1">here: </span></span><a href="https://remix.run/docs/en/2/other-api/serve"><span class="No-Break"><span class="koboSpan" id="kobo.885.1">https://remix.run/docs/en/2/other-api/serve</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.886.1">.</span></span></p>
<p><span class="koboSpan" id="kobo.887.1">As mentioned earlier in the chapter, refer to Remixâ€™s own troubleshooting guide to get help with common </span><span class="No-Break"><span class="koboSpan" id="kobo.888.1">gotchas: </span></span><a href="https://remix.run/docs/en/2/guides/gotchas"><span class="No-Break"><span class="koboSpan" id="kobo.889.1">https://remix.run/docs/en/2/guides/gotchas</span></span></a><span class="No-Break"><span class="koboSpan" id="kobo.890.1">.</span></span></p>
</div>
</body></html>
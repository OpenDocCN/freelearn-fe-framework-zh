<html><head></head><body>
<div class="Basic-Text-Frame" id="_idContainer160">
<h1 class="chapterNumber"><span class="koboSpan" id="kobo.1.1">8</span></h1>
<h1 class="chapterTitle" id="_idParaDest-259"><span class="koboSpan" id="kobo.2.1">Mastering Angular Forms</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.3.1">Getting user input is an integral part of almost any modern app that we use. </span><span class="koboSpan" id="kobo.3.2">Whether it is authenticating users, asking for feedback, or filling out business-critical forms, knowing how to implement and present forms to end users is always an interesting challenge. </span><span class="koboSpan" id="kobo.3.3">In this chapter, you’ll learn about </span><strong class="keyWord"><span class="koboSpan" id="kobo.4.1">Angular forms</span></strong><span class="koboSpan" id="kobo.5.1"> and how you can create great user experiences using them.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.6.1">Here are the recipes that we’re going to cover in this chapter:</span></p>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.7.1">Creating your first template-driven form with validation</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.8.1">Creating your first reactive form with form validation</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.9.1">Testing forms in Angular</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.10.1">Server-side validation using asynchronous validator functions</span></li>
<li class="bulletList"><span class="koboSpan" id="kobo.11.1">Implementing complex forms with reactive </span><code class="inlineCode"><span class="koboSpan" id="kobo.12.1">FormArray</span></code> </li>
<li class="bulletList"><span class="koboSpan" id="kobo.13.1">Writing your own custom form control using </span><code class="inlineCode"><span class="koboSpan" id="kobo.14.1">ControlValueAccessor</span></code></li>
</ul>
<h1 class="heading-1" id="_idParaDest-260"><span class="koboSpan" id="kobo.15.1">Technical requirements</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.16.1">For the recipes in this chapter, ensure your setup is complete as per the 'Technical Requirements' in the 'Angular-Cookbook-2E' GitHub repository. </span><span class="koboSpan" id="kobo.16.2">For setup details, visit: </span><a href="https://github.com/PacktPublishing/Angular-Cookbook-2E/tree/main/docs/technical-requirements.md"><span class="url"><span class="koboSpan" id="kobo.17.1">https://github.com/PacktPublishing/Angular-Cookbook-2E/tree/main/docs/technical-requirements.md</span></span></a><span class="koboSpan" id="kobo.18.1">. </span><span class="koboSpan" id="kobo.18.2">The starter code for this chapter is located at </span><a href="https://github.com/PacktPublishing/Angular-Cookbook-2E/tree/main/start/apps/chapter08"><span class="url"><span class="koboSpan" id="kobo.19.1">https://github.com/PacktPublishing/Angular-Cookbook-2E/tree/main/start/apps/chapter08</span></span></a><span class="koboSpan" id="kobo.20.1">.</span></p>
<h1 class="heading-1" id="_idParaDest-261"><span class="koboSpan" id="kobo.21.1">Creating your first template-driven form with validation</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.22.1">Let’s start getting familiar with </span><a id="_idIndexMarker508"/><span class="koboSpan" id="kobo.23.1">Angular forms in this recipe. </span><span class="koboSpan" id="kobo.23.2">In this one, you’ll learn about the basic concepts of template-driven forms and will create a basic Angular form, using the template-driven forms API.</span></p>
<h2 class="heading-2" id="_idParaDest-262"><span class="koboSpan" id="kobo.24.1">Getting ready</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.25.1">The app that we are going to work with resides in </span><code class="inlineCode"><span class="koboSpan" id="kobo.26.1">start/apps/chapter08/ng-tdf</span></code><span class="koboSpan" id="kobo.27.1"> inside the cloned repository:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.28.1">Open the code repository in your code editor.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.29.1">Open the terminal, navigate to the code repository directory, and run the following command to serve the project:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.30.1">npm run serve ng-tdf
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.31.1">This should open the app in a new browser tab, and you should see the following:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.32.1"><img alt="" role="presentation" src="../Images/B18469_08_01.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.33.1">Figure 8.1: ng-tdf app running on http://localhost:4200</span></p></li>
</ol>
<h2 class="heading-2" id="_idParaDest-263"><span class="koboSpan" id="kobo.34.1">How to do it…</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.35.1">We have an Angular app that already has a bunch of components and some UI setup. </span><span class="koboSpan" id="kobo.35.2">We need to implement the functionality to add a new version to the logs. </span><span class="koboSpan" id="kobo.35.3">We’ll use a template-driven form to</span><a id="_idIndexMarker509"/><span class="koboSpan" id="kobo.36.1"> allow the user to pick an app and submit a release version. </span><span class="koboSpan" id="kobo.36.2">Let’s get started:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.37.1">First, we’ll add the </span><code class="inlineCode"><span class="koboSpan" id="kobo.38.1">FormsModule</span></code><span class="koboSpan" id="kobo.39.1"> in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.40.1">src/app/components/version-control/version-control.component.ts</span></code><span class="koboSpan" id="kobo.41.1"> file in the project, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.42.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.43.1">import</span></span><span class="koboSpan" id="kobo.44.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.45.1">FormsModule</span></span><span class="koboSpan" id="kobo.46.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.47.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.48.1">'@angular/forms'</span></span><span class="koboSpan" id="kobo.49.1">;
...
</span><span class="koboSpan" id="kobo.49.2">@</span><span class="hljs-title"><span class="koboSpan" id="kobo.50.1">Component</span></span><span class="koboSpan" id="kobo.51.1">({
  ...,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.52.1">imports</span></span><span class="koboSpan" id="kobo.53.1">: [</span><span class="hljs-title"><span class="koboSpan" id="kobo.54.1">CommonModule</span></span><span class="koboSpan" id="kobo.55.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.56.1">FormsModule</span></span><span class="koboSpan" id="kobo.57.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.58.1">VcLogsComponent</span></span><span class="koboSpan" id="kobo.59.1">]
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.60.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.61.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.62.1">VersionControlComponent</span></span><span class="koboSpan" id="kobo.63.1">  {...}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.64.1">Now, we’ll use a template-variable with </span><code class="inlineCode"><span class="koboSpan" id="kobo.65.1">NgForm</span></code><span class="koboSpan" id="kobo.66.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.67.1">NgModel</span></code><span class="koboSpan" id="kobo.68.1"> on the form input inside the component’s HTML file to use template-driven forms. </span><span class="koboSpan" id="kobo.68.2">Update the </span><code class="inlineCode"><span class="koboSpan" id="kobo.69.1">version-control.component.html</span></code><span class="koboSpan" id="kobo.70.1"> file as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.71.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.72.1">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.73.1"> #</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.74.1">versionForm</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.75.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.76.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.77.1">ngForm"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.78.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.79.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.80.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.81.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.82.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.83.1">"form-group mb-4"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.84.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.85.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.86.1">label</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.87.1">for</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.88.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.89.1">"versionNumber"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.90.1">&gt;</span></span><span class="koboSpan" id="kobo.91.1">Version Number</span><span class="hljs-tag"><span class="koboSpan" id="kobo.92.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.93.1">label</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.94.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.95.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.96.1">input</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.97.1"> [(</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.98.1">ngModel</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.99.1">)]=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.100.1">"versionInput"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.101.1">name</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.102.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.103.1">"version"</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.104.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.105.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.106.1">"text"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.107.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.108.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.109.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.110.1">form-control my-2 text-center"</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.111.1">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.112.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.113.1">"versionNumber"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.114.1">aria-describedby</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.115.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.116.1">"versionHelp"</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.117.1">placeholder</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.118.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.119.1">"Enter version number"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.120.1">&gt;</span></span><span class="koboSpan" id="kobo.121.1">
    ...
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.122.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.123.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.124.1">&gt;</span></span><span class="koboSpan" id="kobo.125.1">
  ...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.126.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.127.1">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.128.1">&gt;</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.129.1">Let’s create a method that will be triggered when the form is submitted. </span><span class="koboSpan" id="kobo.129.2">Update the </span><code class="inlineCode"><span class="koboSpan" id="kobo.130.1">version-control.component.ts</span></code><span class="koboSpan" id="kobo.131.1"> file as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.132.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.133.1">import</span></span><span class="koboSpan" id="kobo.134.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.135.1">FormsModule</span></span><span class="koboSpan" id="kobo.136.1">, </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.137.1">NgForm</span></strong></span><span class="koboSpan" id="kobo.138.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.139.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.140.1">'@angular/forms'</span></span><span class="koboSpan" id="kobo.141.1">;
...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.142.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.143.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.144.1">VersionControlComponent</span></span><span class="koboSpan" id="kobo.145.1">  {
  ...
  </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.146.1">formSubmit</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.147.1">(</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.148.1">form</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.149.1">: </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.150.1">NgForm</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.151.1">) {</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.152.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.153.1">.versionName = form.controls[</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.154.1">'version'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.155.1">].value;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.156.1">}</span></strong></span><span class="koboSpan" id="kobo.157.1">
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.158.1">Now that we have the form submit handler, let’s add the event listener to the template. </span><span class="koboSpan" id="kobo.158.2">Update the </span><code class="inlineCode"><span class="koboSpan" id="kobo.159.1">version-control.component.html</span></code><span class="koboSpan" id="kobo.160.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.161.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.162.1">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.163.1"> #</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.164.1">versionForm</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.165.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.166.1">"ngForm"</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.167.1">  (</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.168.1">ngSubmit</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.169.1">)=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.170.1">"formSubmit(versionForm)"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.171.1">&gt;</span></span><span class="koboSpan" id="kobo.172.1">
  ...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.173.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.174.1">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.175.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.176.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.177.1">app-vc-logs</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.178.1"> [</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.179.1">vName</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.180.1">]=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.181.1">"versionName"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.182.1">&gt;&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.183.1">app-vc-logs</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.184.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.185.1">After adding this, you </span><a id="_idIndexMarker510"/><span class="koboSpan" id="kobo.186.1">should be able to add new versions. </span><span class="koboSpan" id="kobo.186.2">However, you can use any value for the input or even provide nothing, and it will add as a new version. </span><span class="koboSpan" id="kobo.186.3">See the following screenshot for an example:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.187.1"><img alt="" role="presentation" src="../Images/B18469_08_02.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.188.1">Figure 8.2: ng-tdf app without form validation</span></p> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="5"><span class="koboSpan" id="kobo.189.1">We’ll add some form validation going forward. </span><span class="koboSpan" id="kobo.189.2">First of all, we’ll make sure we only change the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.190.1">versionName</span></code><span class="koboSpan" id="kobo.191.1"> property when the form has a valid input. </span><span class="koboSpan" id="kobo.191.2">Update the </span><code class="inlineCode"><span class="koboSpan" id="kobo.192.1">formSubmit</span></code><span class="koboSpan" id="kobo.193.1"> method in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.194.1">version-control.component.ts</span></code><span class="koboSpan" id="kobo.195.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.196.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.197.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.198.1">VersionControlComponent</span></span><span class="koboSpan" id="kobo.199.1">  {
  ...
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.200.1">formSubmit</span></span><span class="koboSpan" id="kobo.201.1">(</span><span class="hljs-attr"><span class="koboSpan" id="kobo.202.1">form</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.203.1">: </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.204.1">NgForm</span></span><span class="koboSpan" id="kobo.205.1">) {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.206.1">if</span></span><span class="koboSpan" id="kobo.207.1"> (!form.</span><span class="hljs-property"><span class="koboSpan" id="kobo.208.1">valid</span></span><span class="koboSpan" id="kobo.209.1">) {
      </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.210.1">return</span></span><span class="koboSpan" id="kobo.211.1">;
    }
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.212.1">this</span></span><span class="koboSpan" id="kobo.213.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.214.1">versionName</span></span><span class="koboSpan" id="kobo.215.1"> = form.</span><span class="hljs-property"><span class="koboSpan" id="kobo.216.1">controls</span></span><span class="koboSpan" id="kobo.217.1">[</span><span class="hljs-string"><span class="koboSpan" id="kobo.218.1">'version'</span></span><span class="koboSpan" id="kobo.219.1">].</span><span class="hljs-property"><span class="koboSpan" id="kobo.220.1">value</span></span><span class="koboSpan" id="kobo.221.1">;
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.222.1">We will now add some validations in the template file. </span><span class="koboSpan" id="kobo.222.2">We’ll make the required input and ensure that the</span><a id="_idIndexMarker511"/><span class="koboSpan" id="kobo.223.1"> version provided follows semantic versioning. </span><span class="koboSpan" id="kobo.223.2">Update the </span><code class="inlineCode"><span class="koboSpan" id="kobo.224.1">version-control.component.html</span></code><span class="koboSpan" id="kobo.225.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.226.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.227.1">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.228.1"> #</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.229.1">versionForm</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.230.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.231.1">"ngForm"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.232.1"> (</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.233.1">ngSubmit</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.234.1">)=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.235.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.236.1">formSubmit(versionForm)"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.237.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.238.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.239.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.240.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.241.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.242.1">"form-group mb-4"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.243.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.244.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.245.1">label</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.246.1">for</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.247.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.248.1">"versionNumber"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.249.1">&gt;</span></span><span class="koboSpan" id="kobo.250.1">Version Number</span><span class="hljs-tag"><span class="koboSpan" id="kobo.251.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.252.1">label</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.253.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.254.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.255.1">input</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.256.1"> [(</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.257.1">ngModel</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.258.1">)]=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.259.1">"versionInput"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.260.1">pattern</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.261.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.262.1">"(</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.263.1">[0-9]+)\.([0-9]+)\.([0-9]+)"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.264.1">required</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.265.1">name</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.266.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.267.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.268.1">version"</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.269.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.270.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.271.1">"text"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.272.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.273.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.274.1">"form-control my-2 text-center"</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.275.1">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.276.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.277.1">"versionNumber"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.278.1">aria-describedby</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.279.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.280.1">"versionHelp"</span></span>
<span class="hljs-attr"><span class="koboSpan" id="kobo.281.1">placeholder</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.282.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.283.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.284.1">Enter version number"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.285.1">&gt;</span></span><span class="koboSpan" id="kobo.286.1">
    ...
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.287.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.288.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.289.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.290.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.291.1">button</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.292.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.293.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.294.1">"submit"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.295.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.296.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.297.1">"btn btn-primary"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.298.1">&gt;</span></span><span class="koboSpan" id="kobo.299.1">Submit</span><span class="hljs-tag"><span class="koboSpan" id="kobo.300.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.301.1">button</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.302.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.303.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.304.1">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.305.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.306.1">If you try submitting the form now with an invalid value, you’ll see that the version provided doesn’t get added to the logs, but if you provide a valid version like </span><code class="inlineCode"><span class="koboSpan" id="kobo.307.1">2.1.0</span></code><span class="koboSpan" id="kobo.308.1">, it will be added to the logs. </span><span class="koboSpan" id="kobo.308.2">However, this isn’t great in terms of UX, since it doesn’t tell us what’s wrong.</span></p></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="7"><span class="koboSpan" id="kobo.309.1">Let’s show some error messages based on the form validation we have. </span><span class="koboSpan" id="kobo.309.2">Update the </span><code class="inlineCode"><span class="koboSpan" id="kobo.310.1">version-control.component.html</span></code><span class="koboSpan" id="kobo.311.1">, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.312.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.313.1">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.314.1"> #</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.315.1">versionForm</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.316.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.317.1">"ngForm"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.318.1"> (</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.319.1">ngSubmit</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.320.1">)=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.321.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.322.1">formSubmit(versionForm)"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.323.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.324.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.325.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.326.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.327.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.328.1">"form-group mb-4"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.329.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.330.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.331.1">label</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.332.1">for</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.333.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.334.1">"versionNumber"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.335.1">&gt;</span></span><span class="koboSpan" id="kobo.336.1">Version Number</span><span class="hljs-tag"><span class="koboSpan" id="kobo.337.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.338.1">label</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.339.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.340.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.341.1">input</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.342.1"> [(</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.343.1">ngModel</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.344.1">)]=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.345.1">"versionInput"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.346.1">pattern</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.347.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.348.1">"(</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.349.1">      [0-9]+)\.([0-9]+)\.([0-9]+)"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.350.1">required</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.351.1">name</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.352.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.353.1">"version"</span></span>
<span class="hljs-string"> </span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.354.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.355.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.356.1">"text"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.357.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.358.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.359.1">"form-control my-2 text-center"</span></span>
<span class="hljs-attr"> </span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.360.1">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.361.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.362.1">"versionNumber"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.363.1">aria-describedby</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.364.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.365.1">"versionHelp"</span></span>
<span class="hljs-attr"> </span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.366.1">placeholder</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.367.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.368.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.369.1">Enter version number"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.370.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.371.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.372.1">small</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.373.1">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.374.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.375.1">"versionHelp"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.376.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.377.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.378.1">"form-text text-muted</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.379.1">      block mt-6"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.380.1">&gt;</span></span><span class="koboSpan" id="kobo.381.1">Use semantic versioning (x.x.x)</span><span class="hljs-tag"><span class="koboSpan" id="kobo.382.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.383.1">small</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.384.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.385.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.386.1">small</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.387.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.388.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.389.1">"error block"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.390.1"> *</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.391.1">ngIf</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.392.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.393.1">"versionForm.submitted</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.394.1">      &amp;&amp; versionForm.controls['version'].errors?</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.395.1">      .['required']"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.396.1">&gt;</span></span><span class="koboSpan" id="kobo.397.1">
      Version number is required
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.398.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.399.1">small</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.400.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.401.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.402.1">small</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.403.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.404.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.405.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.406.1">error block"</span></span><span class="code-highlight"><strong class="hljs-tag-slc"> </strong></span><span class="hljs-tag"><span class="koboSpan" id="kobo.407.1">*</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.408.1">ngIf</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.409.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.410.1">"versionForm.submitted</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.411.1">      &amp;&amp; versionForm.controls['version']</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.412.1">      .errors?.['pattern']"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.413.1">&gt;</span></span><span class="koboSpan" id="kobo.414.1">
      Version number does not match the pattern (x.x.x)
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.415.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.416.1">small</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.417.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.418.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.419.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.420.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.421.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.422.1">button</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.423.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.424.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.425.1">"submit"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.426.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.427.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.428.1">"btn btn-</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.429.1">primary"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.430.1">&gt;</span></span><span class="koboSpan" id="kobo.431.1">Submit</span><span class="hljs-tag"><span class="koboSpan" id="kobo.432.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.433.1">button</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.434.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.435.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.436.1">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.437.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.438.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.439.1">app-vc-logs</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.440.1"> [</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.441.1">vName</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.442.1">]=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.443.1">"versionName"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.444.1">&gt;&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.445.1">app-vc-logs</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.446.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.447.1">If you now submit the </span><a id="_idIndexMarker512"/><span class="koboSpan" id="kobo.448.1">form without any input, you should see the following error:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.449.1"><img alt="" role="presentation" src="../Images/B18469_08_03.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.450.1">Figure 8.3: ng-tdf app with form validation</span></p>
<p class="normal"><span class="koboSpan" id="kobo.451.1">And if you try giving it the wrong value, you’ll see a different error.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.452.1">Great! </span><span class="koboSpan" id="kobo.452.2">Within a few minutes, we were able to create our first template-driven form in Angular with form validation. </span><span class="koboSpan" id="kobo.452.3">If you refresh the app now and add some versions, you should see the following:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.453.1"><img alt="" role="presentation" src="../Images/B18469_08_04.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.454.1">Figure 8.4: ng-tdf app final output</span></p></li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.455.1">Now that you know how </span><a id="_idIndexMarker513"/><span class="koboSpan" id="kobo.456.1">the template-driven forms are created, let’s see the next section to understand how it works.</span></p>
<h2 class="heading-2" id="_idParaDest-264"><span class="koboSpan" id="kobo.457.1">How it works…</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.458.1">The key to using template-driven forms in Angular resides in </span><code class="inlineCode"><span class="koboSpan" id="kobo.459.1">FormsModule</span></code><span class="koboSpan" id="kobo.460.1">, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.461.1">ngForm</span></code><span class="koboSpan" id="kobo.462.1"> directive, and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.463.1">ngModel</span></code><span class="koboSpan" id="kobo.464.1"> binding. </span><span class="koboSpan" id="kobo.464.2">This would almost always include template variables along with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.465.1">name</span></code><span class="koboSpan" id="kobo.466.1"> attributes for inputs in the template. </span><span class="koboSpan" id="kobo.466.2">We began by adding the </span><code class="inlineCode"><span class="koboSpan" id="kobo.467.1">FormsModule</span></code><span class="koboSpan" id="kobo.468.1"> in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.469.1">VersionControlComponent</span></code><span class="koboSpan" id="kobo.470.1"> class, which is necessary to use the</span><code class="inlineCode"><span class="koboSpan" id="kobo.471.1"> ngForm</span></code><span class="koboSpan" id="kobo.472.1"> directive and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.473.1">[(ngModel)]</span></code><span class="koboSpan" id="kobo.474.1"> two-way data binding. </span><span class="koboSpan" id="kobo.474.2">Then, we added the </span><code class="inlineCode"><span class="koboSpan" id="kobo.475.1">[(ngModel)]</span></code><span class="koboSpan" id="kobo.476.1"> to the version input. </span><span class="koboSpan" id="kobo.476.2">We also added the </span><code class="inlineCode"><span class="koboSpan" id="kobo.477.1">ngForm</span></code><span class="koboSpan" id="kobo.478.1"> attribute</span><strong class="keyWord"> </strong><span class="koboSpan" id="kobo.479.1">on the </span><code class="inlineCode"><span class="koboSpan" id="kobo.480.1">form</span></code><span class="koboSpan" id="kobo.481.1"> element, similarly creating a </span><code class="inlineCode"><span class="koboSpan" id="kobo.482.1">#versionForm</span></code><span class="koboSpan" id="kobo.483.1"> variable so that we can use it to see if the entire form is valid. </span><span class="koboSpan" id="kobo.483.2">Then, we added the </span><code class="inlineCode"><span class="koboSpan" id="kobo.484.1">ngSubmit</span></code><span class="koboSpan" id="kobo.485.1"> handler to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.486.1">form</span></code><span class="koboSpan" id="kobo.487.1"> element so that we could trigger a method when the form is submitted. </span><span class="koboSpan" id="kobo.487.2">We also added the respective method named </span><code class="inlineCode"><span class="koboSpan" id="kobo.488.1">formSubmit</span></code><span class="koboSpan" id="kobo.489.1"> in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.490.1">VersionControlComponent</span></code><span class="koboSpan" id="kobo.491.1"> class as well. </span><span class="koboSpan" id="kobo.491.2">Notice that we pass the </span><code class="inlineCode"><span class="koboSpan" id="kobo.492.1">versionForm</span></code><span class="koboSpan" id="kobo.493.1"> variable to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.494.1">formSubmit</span></code><span class="koboSpan" id="kobo.495.1"> method, which makes it easier to test the functionality for us. </span><span class="koboSpan" id="kobo.495.2">Upon submitting the form, we use the form in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.496.1">formSubmit</span></code><span class="koboSpan" id="kobo.497.1"> method to get the value of the input and to create a new </span><code class="inlineCode"><span class="koboSpan" id="kobo.498.1">version-log</span></code><span class="koboSpan" id="kobo.499.1"> item. </span><span class="koboSpan" id="kobo.499.2">Notice that we access the control/input by using </span><code class="inlineCode"><span class="koboSpan" id="kobo.500.1">form.controls['version']</span></code><span class="koboSpan" id="kobo.501.1">. </span><span class="koboSpan" id="kobo.501.2">The key version directly corresponds to the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.502.1">name</span></code><span class="koboSpan" id="kobo.503.1"> attribute on the input element in the template. </span><code class="inlineCode"><span class="koboSpan" id="kobo.504.1">ngForm</span></code><span class="koboSpan" id="kobo.505.1"> automatically creates a </span><code class="inlineCode"><span class="koboSpan" id="kobo.506.1">FormControl</span></code><span class="koboSpan" id="kobo.507.1"> instance for us, using the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.508.1">name</span></code><span class="koboSpan" id="kobo.509.1"> attribute of the input, and thus we can access it that way. </span><span class="koboSpan" id="kobo.509.2">Also, notice that if you provide an invalid version for the new release log, the app will show the respective</span><a id="_idIndexMarker514"/><span class="koboSpan" id="kobo.510.1"> errors based on either the empty input, or an invalid version format. </span><span class="koboSpan" id="kobo.510.2">This is because we have the </span><code class="inlineCode"><span class="koboSpan" id="kobo.511.1">required</span></code><strong class="keyWord"> </strong><span class="koboSpan" id="kobo.512.1">attribute set on the </span><code class="inlineCode"><span class="koboSpan" id="kobo.513.1">&lt;input /&gt;</span></code><span class="koboSpan" id="kobo.514.1"> element as well as the </span><code class="inlineCode"><span class="koboSpan" id="kobo.515.1">pattern</span></code><span class="koboSpan" id="kobo.516.1"> attribute.</span></p>
<h2 class="heading-2" id="_idParaDest-265"><span class="koboSpan" id="kobo.517.1">See also</span></h2>
<ul>
<li class="bulletList"><em class="italic"><span class="koboSpan" id="kobo.518.1">Building a template-driven form in Angular</span></em><span class="koboSpan" id="kobo.519.1">: </span><a href="https://angular.io/guide/forms#building-a-template-driven-form"><span class="url"><span class="koboSpan" id="kobo.520.1">https://angular.io/guide/forms#building-a-template-driven-form</span></span></a></li>
<li class="bulletList"><em class="italic"><span class="koboSpan" id="kobo.521.1">Show and hide</span></em><em class="italic"><a id="_idIndexMarker515"/></em><em class="italic"><span class="koboSpan" id="kobo.522.1"> validation error messages</span></em><span class="koboSpan" id="kobo.523.1"> (Angular docs): </span><a href="https://angular.io/guide/forms#show-and-hide-validation-error-messages "><span class="url"><span class="koboSpan" id="kobo.524.1">https://angular.io/guide/forms#show-and-hide-validation-error-messages</span></span></a></li>
</ul>
<h1 class="heading-1" id="_idParaDest-266"><span class="koboSpan" id="kobo.525.1">Creating your first reactive form with validation</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.526.1">You’ve learned about template-driven forms in the previous recipe and are now confident in building</span><a id="_idIndexMarker516"/><span class="koboSpan" id="kobo.527.1"> Angular apps with them. </span><span class="koboSpan" id="kobo.527.2">Now, guess what? </span><span class="koboSpan" id="kobo.527.3">reactive forms are even better. </span><span class="koboSpan" id="kobo.527.4">Many known engineers and businesses in the Angular community recommend using only reactive forms for Angular apps. </span><span class="koboSpan" id="kobo.527.5">The reason is that when it comes to complex forms, Reactive forms make it easy to manage, i.e., you can decouple your form’s logic from the template and add validators dynamically, etc. </span><span class="koboSpan" id="kobo.527.6">In this recipe, you’ll build your first Reactive form and will learn its basic usage.</span></p>
<h2 class="heading-2" id="_idParaDest-267"><span class="koboSpan" id="kobo.528.1">Getting ready</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.529.1">The app that we are going to work with resides in </span><code class="inlineCode"><span class="koboSpan" id="kobo.530.1">start/apps/chapter08/ng-reactive-forms</span></code><span class="koboSpan" id="kobo.531.1"> inside the cloned repository:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.532.1">Open the code repository in your code editor.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.533.1">Open the terminal, navigate to the code repository directory, and run the following command to serve the project:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.534.1">npm run serve ng-reactive-forms
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.535.1">This should open the app in a new browser tab, and you should see the following:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.536.1"><img alt="" role="presentation" src="../Images/B18469_08_05.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.537.1">Figure 8.5: ng-reactive-forms app running on http://localhost:4200</span></p></li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.538.1">Now that we have the </span><a id="_idIndexMarker517"/><span class="koboSpan" id="kobo.539.1">app running locally, let’s see the steps involved in this recipe in the next section.</span></p>
<h2 class="heading-2" id="_idParaDest-268"><span class="koboSpan" id="kobo.540.1">How to do it…</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.541.1">So far, we have an app that has a </span><code class="inlineCode"><span class="koboSpan" id="kobo.542.1">VcLogsComponent</span></code><span class="koboSpan" id="kobo.543.1">, which shows a bunch of version logs that we create. </span><span class="koboSpan" id="kobo.543.2">We also have a </span><code class="inlineCode"><span class="koboSpan" id="kobo.544.1">VersionControlComponent</span></code><span class="koboSpan" id="kobo.545.1">, which has a form with which the release logs will be created. </span><span class="koboSpan" id="kobo.545.2">We now have to make our current form a Reactive form, using the reactive forms API. </span><span class="koboSpan" id="kobo.545.3">Let’s get started:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.546.1">First of all, we need to import </span><code class="inlineCode"><span class="koboSpan" id="kobo.547.1">ReactiveFormsModule</span></code><span class="koboSpan" id="kobo.548.1"> into the imports of our </span><code class="inlineCode"><span class="koboSpan" id="kobo.549.1">AppModule</span></code><span class="koboSpan" id="kobo.550.1">. </span><span class="koboSpan" id="kobo.550.2">Let’s do it by modifying the </span><code class="inlineCode"><span class="koboSpan" id="kobo.551.1">app/components/version-control/version-control.component.ts</span></code><span class="koboSpan" id="kobo.552.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.553.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.554.1">import</span></span><span class="koboSpan" id="kobo.555.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.556.1">ReactiveFormsModule</span></span><span class="koboSpan" id="kobo.557.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.558.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.559.1">'@angular/forms'</span></span><span class="koboSpan" id="kobo.560.1">;
...
</span><span class="hljs-meta"><span class="koboSpan" id="kobo.561.1">@Component</span></span><span class="koboSpan" id="kobo.562.1">({
  ...,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.563.1">imports</span></span><span class="koboSpan" id="kobo.564.1">: [</span><span class="hljs-title"><span class="koboSpan" id="kobo.565.1">CommonModule</span></span><span class="koboSpan" id="kobo.566.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.567.1">VcLogsComponent</span></span><span class="koboSpan" id="kobo.568.1">,
</span><span class="hljs-attr"> </span> <span class="hljs-title"><span class="koboSpan" id="kobo.569.1">ReactiveFormsModule</span></span><span class="koboSpan" id="kobo.570.1">]
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.571.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.572.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.573.1">VersionControlComponent</span></span><span class="koboSpan" id="kobo.574.1">  {...}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.575.1">We’ll create the Reactive form shortly. </span><span class="koboSpan" id="kobo.575.2">First, import the required dependencies in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.576.1">version-control.component.ts</span></code><span class="koboSpan" id="kobo.577.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.578.1">import</span></span><span class="koboSpan" id="kobo.579.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.580.1">CommonModule</span></span><span class="koboSpan" id="kobo.581.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.582.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.583.1">'@angular/common'</span></span><span class="koboSpan" id="kobo.584.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.585.1">import</span></span><span class="koboSpan" id="kobo.586.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.587.1">Component</span></span><span class="koboSpan" id="kobo.588.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.589.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.590.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.591.1">;
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.592.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.593.1"> {</span></strong></span>
<span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.594.1">FormControl</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.595.1">,</span></strong></span>
<span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.596.1">FormGroup</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.597.1">,</span></strong></span>
<span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.598.1">ReactiveFormsModule</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.599.1">,</span></strong></span>
<span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.600.1">Validators</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.601.1">,</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.602.1">} </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.603.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.604.1">'@angular/forms'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.605.1">;</span></strong></span><span class="koboSpan" id="kobo.606.1">
...
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.607.1">Now, we’ll create a </span><code class="inlineCode"><span class="koboSpan" id="kobo.608.1">FormGroup</span></code><span class="koboSpan" id="kobo.609.1"> in our </span><code class="inlineCode"><span class="koboSpan" id="kobo.610.1">VersionControlComponent</span></code><span class="koboSpan" id="kobo.611.1"> class with a control named </span><code class="inlineCode"><span class="koboSpan" id="kobo.612.1">version</span></code><span class="koboSpan" id="kobo.613.1">. </span><span class="koboSpan" id="kobo.613.2">A </span><code class="inlineCode"><span class="koboSpan" id="kobo.614.1">FormGroup</span></code><span class="koboSpan" id="kobo.615.1"> allows us to group multiple controls together in a form. </span><span class="koboSpan" id="kobo.615.2">Modify</span><a id="_idIndexMarker518"/><span class="koboSpan" id="kobo.616.1"> the </span><code class="inlineCode"><span class="koboSpan" id="kobo.617.1">version-control.component.ts</span></code><span class="koboSpan" id="kobo.618.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-meta"><span class="koboSpan" id="kobo.619.1">@Component</span></span><span class="koboSpan" id="kobo.620.1">({...})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.621.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.622.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.623.1">VersionControlComponent</span></span><span class="koboSpan" id="kobo.624.1"> {
  versionInput = </span><span class="hljs-string"><span class="koboSpan" id="kobo.625.1">''</span></span><span class="koboSpan" id="kobo.626.1">;
  versionName = </span><span class="hljs-string"><span class="koboSpan" id="kobo.627.1">'0.0.0'</span></span><span class="koboSpan" id="kobo.628.1">;
  </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.629.1">versionPattern = </span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.630.1">'([0-9]+)\.([0-9]+)\.([0-9]+)'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.631.1">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.632.1">versionForm = </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.633.1">new</span></strong><strong class="hljs-title-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.634.1">FormGroup</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.635.1">({</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.636.1">version</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.637.1">: </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.638.1">new </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.639.1">FormControl</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.640.1">(</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.641.1">''</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.642.1">, [</span></strong></span>
<span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.643.1">Validators</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.644.1">.required,</span></strong></span>
<span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.645.1">Validators</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.646.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.647.1">pattern</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.648.1">(</span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.649.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.650.1">.</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.651.1">versionPattern),</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.652.1">]),</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.653.1">});</span></strong></span><span class="koboSpan" id="kobo.654.1">
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.655.1">Now that we have the Reactive form in place, let’s bind the </span><code class="inlineCode"><span class="koboSpan" id="kobo.656.1">versionForm</span></code><span class="koboSpan" id="kobo.657.1"> in the template to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.658.1">&lt;form&gt;</span></code><span class="koboSpan" id="kobo.659.1"> element. </span><span class="koboSpan" id="kobo.659.2">Update the </span><code class="inlineCode"><span class="koboSpan" id="kobo.660.1">version-control.component.html</span></code><span class="koboSpan" id="kobo.661.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.662.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.663.1">form</span></span><span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.664.1">[</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.665.1">formGroup</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.666.1">]=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.667.1">"versionForm"</span></strong></span><span class="hljs-tag"><span class="koboSpan" id="kobo.668.1">&gt;</span></span><span class="koboSpan" id="kobo.669.1">
  ...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.670.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.671.1">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.672.1">&gt;</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.673.1">Great! </span><span class="koboSpan" id="kobo.673.2">Now that we have the form group bound, we can also bind the </span><code class="inlineCode"><span class="koboSpan" id="kobo.674.1">version</span></code><span class="koboSpan" id="kobo.675.1"> form control. </span><span class="koboSpan" id="kobo.675.2">Modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.676.1">version-control.component.html</span></code><span class="koboSpan" id="kobo.677.1"> file further, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.678.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.679.1">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.680.1"> [</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.681.1">formGroup</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.682.1">]=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.683.1">"versionForm"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.684.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.685.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.686.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.687.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.688.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.689.1">"form-group mb-4"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.690.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.691.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.692.1">label</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.693.1">for</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.694.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.695.1">"versionNumber"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.696.1">&gt;</span></span><span class="koboSpan" id="kobo.697.1">Version Number</span><span class="hljs-tag"><span class="koboSpan" id="kobo.698.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.699.1">label</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.700.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.701.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.702.1">input</span></span><span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.703.1">formControlName</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.704.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.705.1">"version"</span></strong></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.706.1">name</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.707.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.708.1">"version"</span></span>
<span class="hljs-string"> </span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.709.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.710.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.711.1">"text"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.712.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.713.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.714.1">"form-control my-2 text-center"</span></span>
<span class="hljs-attr"> </span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.715.1">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.716.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.717.1">"versionNumber"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.718.1">aria-describedby</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.719.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.720.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.721.1">versionHelp"</span></span>
<span class="hljs-attr"> </span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.722.1">placeholder</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.723.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.724.1">"Enter version number"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.725.1">&gt;</span></span><span class="koboSpan" id="kobo.726.1">
    ...
  </span><span class="hljs-tag"><span class="koboSpan" id="kobo.727.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.728.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.729.1">&gt;</span></span><span class="koboSpan" id="kobo.730.1">
  ...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.731.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.732.1">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.733.1">&gt;</span></span><span class="koboSpan" id="kobo.734.1">
...
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.735.1">Let’s decide what will happen when we submit this form. </span><span class="koboSpan" id="kobo.735.2">We’ll call a method named </span><code class="inlineCode"><span class="koboSpan" id="kobo.736.1">formSubmit</span></code><span class="koboSpan" id="kobo.737.1"> in the template and pass </span><code class="inlineCode"><span class="koboSpan" id="kobo.738.1">versionForm</span></code><span class="koboSpan" id="kobo.739.1"> to it when the form is submitted. </span><span class="koboSpan" id="kobo.739.2">Modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.740.1">version-control.component.html</span></code><span class="koboSpan" id="kobo.741.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.742.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.743.1">form</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.744.1">  [</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.745.1">formGroup</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.746.1">]=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.747.1">"versionForm"</span></span>
<span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.748.1">(</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.749.1">ngSubmit</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.750.1">)=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.751.1">"formSubmit(versionForm)"</span></strong></span><span class="hljs-tag"><span class="koboSpan" id="kobo.752.1">&gt;</span></span><span class="koboSpan" id="kobo.753.1">
  ...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.754.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.755.1">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.756.1">&gt;</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.757.1">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.758.1">formSubmit</span></code><span class="koboSpan" id="kobo.759.1"> method </span><a id="_idIndexMarker519"/><span class="koboSpan" id="kobo.760.1">doesn’t yet exist. </span><span class="koboSpan" id="kobo.760.2">Let’s create it now in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.761.1">VersionControlComponent</span></code><span class="koboSpan" id="kobo.762.1"> class. </span><span class="koboSpan" id="kobo.762.2">Modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.763.1">version-control.component.ts</span></code><span class="koboSpan" id="kobo.764.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.765.1">...
</span><span class="hljs-meta"><span class="koboSpan" id="kobo.766.1">@Component</span></span><span class="koboSpan" id="kobo.767.1">({...})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.768.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.769.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.770.1">VersionControlComponent</span></span><span class="koboSpan" id="kobo.771.1"> {
  ...
  </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.772.1">formSubmit</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.773.1">(</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.774.1">form</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.775.1">: </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.776.1">FormGroup</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.777.1">) {</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.778.1">if</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.779.1"> (!form.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.780.1">valid</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.781.1">) {</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.782.1">return</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.783.1">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.784.1">}</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.785.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.786.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.787.1">versionName</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.788.1"> = form.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.789.1">controls</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.790.1">[</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.791.1">'version'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.792.1">].</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.793.1">value</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.794.1">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.795.1">}</span></strong></span><span class="koboSpan" id="kobo.796.1">
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.797.1">If you try submitting the form now with an invalid value, you’ll see that the version provided doesn’t get added to the logs, but if you provide a valid version like </span><code class="inlineCode"><span class="koboSpan" id="kobo.798.1">2.1.0</span></code><span class="koboSpan" id="kobo.799.1">, it will be added to the logs. </span><span class="koboSpan" id="kobo.799.2">However, this isn’t great in terms of UX, since it doesn’t tell us what’s wrong.</span></p> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="8"><span class="koboSpan" id="kobo.800.1">Let’s show some error </span><a id="_idIndexMarker520"/><span class="koboSpan" id="kobo.801.1">messages based on the form validation we have. </span><span class="koboSpan" id="kobo.801.2">Update the </span><code class="inlineCode"><span class="koboSpan" id="kobo.802.1">version-control.component.html</span></code><span class="koboSpan" id="kobo.803.1">, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.804.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.805.1">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.806.1"> [</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.807.1">formGroup</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.808.1">]=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.809.1">"versionForm"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.810.1"> (</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.811.1">ngSubmit</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.812.1">)=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.813.1">"formSubmit(versionForm)"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.814.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.815.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.816.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.817.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.818.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.819.1">"form-group mb-4"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.820.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.821.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.822.1">label</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.823.1">for</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.824.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.825.1">"versionNumber"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.826.1">&gt;</span></span><span class="koboSpan" id="kobo.827.1">Version Number</span><span class="hljs-tag"><span class="koboSpan" id="kobo.828.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.829.1">label</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.830.1">&gt;</span></span><span class="koboSpan" id="kobo.831.1">
    ...
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.832.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.833.1">small</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.834.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.835.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.836.1">"error block"</span></span><span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.837.1">*</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.838.1">ngIf</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.839.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.840.1">"versionForm.dirty &amp;&amp;</span></strong></span>
<span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.841.1">versionForm.controls.version.errors?.['required']"</span></strong></span><span class="hljs-tag"><span class="koboSpan" id="kobo.842.1">&gt;</span></span><span class="koboSpan" id="kobo.843.1">
      Version number is required
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.844.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.845.1">small</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.846.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.847.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.848.1">small</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.849.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.850.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.851.1">"error block"</span></span><span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.852.1">*</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.853.1">ngIf</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.854.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.855.1">"versionForm.dirty &amp;&amp;</span></strong></span>
<span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.856.1">versionForm.controls.version.errors?.['pattern']"</span></strong></span><span class="hljs-tag"><span class="koboSpan" id="kobo.857.1">&gt;</span></span><span class="koboSpan" id="kobo.858.1">
      Version number does not match the pattern (x.x.x)
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.859.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.860.1">small</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.861.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.862.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.863.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.864.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.865.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.866.1">button</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.867.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.868.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.869.1">"submit"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.870.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.871.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.872.1">"btn btn-</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.873.1">primary"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.874.1">&gt;</span></span><span class="koboSpan" id="kobo.875.1">Submit</span><span class="hljs-tag"><span class="koboSpan" id="kobo.876.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.877.1">button</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.878.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.879.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.880.1">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.881.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.882.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.883.1">app-vc-logs</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.884.1"> [</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.885.1">vName</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.886.1">]=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.887.1">"versionName"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.888.1">&gt;&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.889.1">app-vc-logs</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.890.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.891.1">If you now type something in the form and clear the input, you should see an error, as follows:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.892.1"><img alt="" role="presentation" src="../Images/B18469_08_06.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.893.1">Figure 8.6: ng-reactive-forms app with form validation</span></p>
<p class="normal"><span class="koboSpan" id="kobo.894.1">And if you try giving it the wrong value, you’ll see a different error.</span></p> </li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.895.1">Great! </span><span class="koboSpan" id="kobo.895.2">Within a few minutes, we were able to create our Reactive form in Angular with form validation. </span><span class="koboSpan" id="kobo.895.3">See the</span><a id="_idIndexMarker521"/><span class="koboSpan" id="kobo.896.1"> next section to understand how it works.</span></p>
<h2 class="heading-2" id="_idParaDest-269"><span class="koboSpan" id="kobo.897.1">How it works…</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.898.1">To work with reactive forms in Angular, we need to import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.899.1">ReactiveFormsModule</span></code><span class="koboSpan" id="kobo.900.1"> in the components in the case of standalone components, and in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.901.1">NgModule</span></code><span class="koboSpan" id="kobo.902.1"> if you’re using modules. </span><span class="koboSpan" id="kobo.902.2">In the recipe, we do exactly that, i.e., import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.903.1">ReactiveFormsModule</span></code><span class="koboSpan" id="kobo.904.1"> in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.905.1">VersionControlComponent</span></code><span class="koboSpan" id="kobo.906.1"> class’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.907.1">imports</span></code><span class="koboSpan" id="kobo.908.1"> array. </span><span class="koboSpan" id="kobo.908.2">After that, we create a </span><code class="inlineCode"><span class="koboSpan" id="kobo.909.1">FormGroup</span></code><span class="koboSpan" id="kobo.910.1">, which is a Reactive form, and it takes an object as an argument for the constructor function. </span><span class="koboSpan" id="kobo.910.2">The object passed to the constructor can have further </span><code class="inlineCode"><span class="koboSpan" id="kobo.911.1">FormControl</span></code><span class="koboSpan" id="kobo.912.1">, nested form groups, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.913.1">FormArray</span></code><span class="koboSpan" id="kobo.914.1">, etc. </span><span class="koboSpan" id="kobo.914.2">because they all inherit the </span><code class="inlineCode"><span class="koboSpan" id="kobo.915.1">AbstractControl</span></code><span class="koboSpan" id="kobo.916.1"> class, as shown in </span><em class="italic"><span class="koboSpan" id="kobo.917.1">Figure 8.6</span></em><span class="koboSpan" id="kobo.918.1">.</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.919.1"><img alt="" role="presentation" src="../Images/B18469_08_07.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.920.1">Figure 8.7: Base class AbstractControl being inherited</span></p>
<p class="normal"><span class="koboSpan" id="kobo.921.1">In our recipe, we provide a key named </span><code class="inlineCode"><span class="koboSpan" id="kobo.922.1">version</span></code><span class="koboSpan" id="kobo.923.1"> against a </span><code class="inlineCode"><span class="koboSpan" id="kobo.924.1">FormControl</span></code><span class="koboSpan" id="kobo.925.1">. </span><span class="koboSpan" id="kobo.925.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.926.1">FormControl</span></code><span class="koboSpan" id="kobo.927.1"> constructor method takes two arguments in our recipe; the first one is the default value, and the</span><a id="_idIndexMarker522"/><span class="koboSpan" id="kobo.928.1"> second is an array of </span><code class="inlineCode"><span class="koboSpan" id="kobo.929.1">Validators</span></code><span class="koboSpan" id="kobo.930.1">. </span><span class="koboSpan" id="kobo.930.2">Notice that we’re using the following validators:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.931.1">Validators</span></span><span class="koboSpan" id="kobo.932.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.933.1">required</span></span>
<span class="hljs-title"><span class="koboSpan" id="kobo.934.1">Validators</span></span><span class="koboSpan" id="kobo.935.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.936.1">pattern</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.937.1">Also, notice that the pattern we’re using to validate semantic versioning is </span><code class="inlineCode"><span class="koboSpan" id="kobo.938.1">([0-9]+)\.([0-9]+)\.([0-9]+)</span></code><span class="koboSpan" id="kobo.939.1">. </span><span class="koboSpan" id="kobo.939.2">We then use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.940.1">FormGroup</span></code><span class="koboSpan" id="kobo.941.1"> (i.e., the </span><code class="inlineCode"><span class="koboSpan" id="kobo.942.1">versionForm</span></code><span class="koboSpan" id="kobo.943.1"> variable) in the template on the </span><code class="inlineCode"><span class="koboSpan" id="kobo.944.1">&lt;form&gt;</span></code><span class="koboSpan" id="kobo.945.1"> element, using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.946.1">[formGroup]</span></code><span class="koboSpan" id="kobo.947.1"> binding. </span><span class="koboSpan" id="kobo.947.2">We then bind the </span><code class="inlineCode"><span class="koboSpan" id="kobo.948.1">version</span></code> <code class="inlineCode"><span class="koboSpan" id="kobo.949.1">FormControl</span></code><span class="koboSpan" id="kobo.950.1"> in the template using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.951.1">formControlName</span></code><span class="koboSpan" id="kobo.952.1"> attribute. </span><span class="koboSpan" id="kobo.952.2">We handle the form submission using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.953.1">(ngSubmit)</span></code><span class="koboSpan" id="kobo.954.1"> listener on the </span><code class="inlineCode"><span class="koboSpan" id="kobo.955.1">&lt;form&gt;</span></code><span class="koboSpan" id="kobo.956.1"> element. </span><span class="koboSpan" id="kobo.956.2">In the </span><code class="inlineCode"><span class="koboSpan" id="kobo.957.1">VersionControlComponent</span></code><span class="koboSpan" id="kobo.958.1"> class, we have the </span><code class="inlineCode"><span class="koboSpan" id="kobo.959.1">formSubmit</span></code><span class="koboSpan" id="kobo.960.1"> method to handle the form submission. </span><span class="koboSpan" id="kobo.960.2">This is also what we bind the event listener to in the template. </span><span class="koboSpan" id="kobo.960.3">When this method is called, we check if the form is valid.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.961.1">The validation on each </span><code class="inlineCode"><span class="koboSpan" id="kobo.962.1">FormGroup</span></code><span class="koboSpan" id="kobo.963.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.964.1">FormArray</span></code><span class="koboSpan" id="kobo.965.1">, or </span><code class="inlineCode"><span class="koboSpan" id="kobo.966.1">FormControl</span></code><span class="koboSpan" id="kobo.967.1"> happens on the </span><code class="inlineCode"><span class="koboSpan" id="kobo.968.1">change</span></code><span class="koboSpan" id="kobo.969.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.970.1">blur</span></code><span class="koboSpan" id="kobo.971.1">, or </span><code class="inlineCode"><span class="koboSpan" id="kobo.972.1">submit</span></code><span class="koboSpan" id="kobo.973.1"> event. </span><span class="koboSpan" id="kobo.973.2">And since they are inherited from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.974.1">AbstractControl</span></code><span class="koboSpan" id="kobo.975.1"> class, they can be configured via the </span><code class="inlineCode"><span class="koboSpan" id="kobo.976.1">updateOn</span></code><span class="koboSpan" id="kobo.977.1"> property on the </span><code class="inlineCode"><span class="koboSpan" id="kobo.978.1">AbstractControl</span></code><span class="koboSpan" id="kobo.979.1">. </span><span class="koboSpan" id="kobo.979.2">In our case, the validation happens on </span><code class="inlineCode"><span class="koboSpan" id="kobo.980.1">change</span></code><span class="koboSpan" id="kobo.981.1"> by default. </span><span class="koboSpan" id="kobo.981.2">If the form is not valid, we simply do not do anything. </span><span class="koboSpan" id="kobo.981.3">Otherwise, we set the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.982.1">versionName</span></code><span class="koboSpan" id="kobo.983.1"> property, which adds a new log to the logs list.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.984.1">Finally, we show the errors based on the form validation in the template, using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.985.1">errors</span></code><strong class="keyWord"> </strong><span class="koboSpan" id="kobo.986.1">property on the </span><code class="inlineCode"><span class="koboSpan" id="kobo.987.1">version</span></code><span class="koboSpan" id="kobo.988.1"> form control. </span><span class="koboSpan" id="kobo.988.2">When the form is empty after making any initial change to it, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.989.1">errors</span></code><span class="koboSpan" id="kobo.990.1"> object on the form control gets the </span><code class="inlineCode"><span class="koboSpan" id="kobo.991.1">required</span></code><span class="koboSpan" id="kobo.992.1"> property set to </span><code class="inlineCode"><span class="koboSpan" id="kobo.993.1">true</span></code><span class="koboSpan" id="kobo.994.1">. </span></p>
<p class="normal"><span class="koboSpan" id="kobo.995.1">When the user adds a value to the input, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.996.1">required</span></code><span class="koboSpan" id="kobo.997.1"> property is removed, and the validation of </span><code class="inlineCode"><span class="koboSpan" id="kobo.998.1">pattern</span></code><span class="koboSpan" id="kobo.999.1"> gets triggered, and if the pattern </span><code class="inlineCode"><span class="koboSpan" id="kobo.1000.1">([0-9]+)\.([0-9]+)\.([0-9]+)</span></code><span class="koboSpan" id="kobo.1001.1"> doesn’t match the value of the input, we get the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1002.1">pattern</span></code><span class="koboSpan" id="kobo.1003.1"> property added to the form </span><a id="_idIndexMarker523"/><span class="koboSpan" id="kobo.1004.1">control’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.1005.1">errors</span></code><span class="koboSpan" id="kobo.1006.1"> object. </span><span class="koboSpan" id="kobo.1006.2">Notice that in </span><em class="italic"><span class="koboSpan" id="kobo.1007.1">step 8</span></em><span class="koboSpan" id="kobo.1008.1">, we use these properties from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1009.1">errors</span></code><span class="koboSpan" id="kobo.1010.1"> object to show the relevant error.</span></p>
<h2 class="heading-2" id="_idParaDest-270"><span class="koboSpan" id="kobo.1011.1">See also</span></h2>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.1012.1">Angular’s guide to reactive forms: </span><a href="https://angular.io/guide/reactive-forms"><span class="url"><span class="koboSpan" id="kobo.1013.1">https://angular.io/guide/reactive-forms</span></span></a></li>
</ul>
<h1 class="heading-1" id="_idParaDest-271"><span class="koboSpan" id="kobo.1014.1">Testing forms in Angular</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.1015.1">To make sure we build robust and bug-free forms for end users, it is a really good idea to have tests relating to your forms. </span><span class="koboSpan" id="kobo.1015.2">It makes code more resilient and less prone to errors. </span><span class="koboSpan" id="kobo.1015.3">In this recipe, you’ll learn how to test your template-driven forms using unit tests.</span></p>
<h2 class="heading-2" id="_idParaDest-272"><span class="koboSpan" id="kobo.1016.1">Getting ready</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1017.1">The app that we are </span><a id="_idIndexMarker524"/><span class="koboSpan" id="kobo.1018.1">going to work with resides in </span><code class="inlineCode"><span class="koboSpan" id="kobo.1019.1">start/apps/chapter08/ng-testing-forms</span></code><span class="koboSpan" id="kobo.1020.1"> inside the cloned repository:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1021.1">Open the code repository</span><a id="_idIndexMarker525"/><span class="koboSpan" id="kobo.1022.1"> in your code editor.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1023.1">Open the terminal, navigate to the code repository directory, and run the following command to serve the project along with the backend server:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1024.1">npm run serve ng-testing-forms with-server
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1025.1">This should open the app in a new browser tab, and you should see the following:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1026.1"><img alt="" role="presentation" src="../Images/B18469_08_08.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1027.1">Figure 8.8: ng-testing-forms app running on http://localhost:4200</span></p></li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.1028.1">Now that we have the </span><a id="_idIndexMarker526"/><span class="koboSpan" id="kobo.1029.1">app running locally, let’s see the steps involved in this recipe in the next section.</span></p>
<h2 class="heading-2" id="_idParaDest-273"><span class="koboSpan" id="kobo.1030.1">How to do it…</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1031.1">We have an app that contains three different components. </span><span class="koboSpan" id="kobo.1031.2">The first one has a template-driven form, the second one has </span><a id="_idIndexMarker527"/><span class="koboSpan" id="kobo.1032.1">a reactive form with validations, and the third has a reactive form with both synchronous and asynchronous validations. </span><span class="koboSpan" id="kobo.1032.2">The implementation of all three of them is identical, except the third component’s validation kicks in as soon as the form is dirty instead of waiting to be submitted. </span><span class="koboSpan" id="kobo.1032.3">The form also has validations applied to the inputs. </span><span class="koboSpan" id="kobo.1032.4">Let us start looking into how we can test this form:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1033.1">First, run the following command to run the unit tests:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1034.1">npm run test ng-testing-forms
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1035.1">Once the command is run, you should see all the tests passing on the console as follows:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1036.1"><img alt="" role="presentation" src="../Images/B18469_08_09.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1037.1">Figure 8.9: Unit tests running with ng-testing-forms</span></p> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="2"><span class="koboSpan" id="kobo.1038.1">Let us write the tests</span><a id="_idIndexMarker528"/><span class="koboSpan" id="kobo.1039.1"> for the template-driven form. </span><span class="koboSpan" id="kobo.1039.2">This is </span><a id="_idIndexMarker529"/><span class="koboSpan" id="kobo.1040.1">easy. </span><span class="koboSpan" id="kobo.1040.2">We will update the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1041.1">version-control-tdf.component.spec.ts</span></code><span class="koboSpan" id="kobo.1042.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1043.1">...
</span><span class="hljs-title"><span class="koboSpan" id="kobo.1044.1">describe</span></span><span class="koboSpan" id="kobo.1045.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1046.1">'VersionControlTdfComponent'</span></span><span class="koboSpan" id="kobo.1047.1">, </span><span class="hljs-function"><span class="koboSpan" id="kobo.1048.1">() =&gt;</span></span><span class="koboSpan" id="kobo.1049.1"> {
  ...
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.1050.1">it</span></span><span class="koboSpan" id="kobo.1051.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1052.1">'should create'</span></span><span class="koboSpan" id="kobo.1053.1">, </span><span class="hljs-function"><span class="koboSpan" id="kobo.1054.1">() =&gt;</span></span><span class="koboSpan" id="kobo.1055.1"> {...});
  </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1056.1">it</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1057.1">(</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1058.1">'should submit the form with valid version'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1059.1">, </span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.1060.1">() =&gt;</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1061.1"> {</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1062.1">component.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1063.1">versionForm</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1064.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1065.1">controls</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1066.1">[</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1067.1">'version'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1068.1">]</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1069.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1070.1">setValue</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1071.1">(</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1072.1">'2.2.4'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1073.1">);</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1074.1">fixture.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1075.1">debugElement</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1076.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1077.1">nativeElement</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1078.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1079.1">querySelector</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1080.1">(</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1081.1">'button'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1082.1">).</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1083.1">click</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1084.1">();</span></strong></span>
<span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1085.1">expect</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1086.1">(component.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1087.1">versionName</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1088.1">).</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1089.1">toBe</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1090.1">(</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1091.1">'2.2.4'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1092.1">);</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1093.1">});</span></strong></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1094.1">If you look at the tests now, you should see all the tests passing as follows:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1095.1"><img alt="" role="presentation" src="../Images/B18469_08_10.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1096.1">Figure 8.10: First test for template-driven forms passing</span></p> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="3"><span class="koboSpan" id="kobo.1097.1">Let’s add another</span><a id="_idIndexMarker530"/><span class="koboSpan" id="kobo.1098.1"> test to the file. </span><span class="koboSpan" id="kobo.1098.2">This will test if we are able to see the error message of the required</span><a id="_idIndexMarker531"/><span class="koboSpan" id="kobo.1099.1"> input. </span><span class="koboSpan" id="kobo.1099.2">Let’s update the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1100.1">version-control-tdf.component.spec.ts</span></code><span class="koboSpan" id="kobo.1101.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.1102.1">it</span></span><span class="koboSpan" id="kobo.1103.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1104.1">'should show required error'</span></span><span class="koboSpan" id="kobo.1105.1">, </span><span class="hljs-function"><span class="koboSpan" id="kobo.1106.1">() =&gt;</span></span><span class="koboSpan" id="kobo.1107.1"> {
    component.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1108.1">versionForm</span></span><span class="koboSpan" id="kobo.1109.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1110.1">controls</span></span><span class="koboSpan" id="kobo.1111.1">[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1112.1">'version'</span></span><span class="koboSpan" id="kobo.1113.1">]
      .</span><span class="hljs-title"><span class="koboSpan" id="kobo.1114.1">setValue</span></span><span class="koboSpan" id="kobo.1115.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1116.1">'2.2.4'</span></span><span class="koboSpan" id="kobo.1117.1">);
    fixture.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1118.1">detectChanges</span></span><span class="koboSpan" id="kobo.1119.1">();
    component.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1120.1">versionForm</span></span><span class="koboSpan" id="kobo.1121.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1122.1">controls</span></span><span class="koboSpan" id="kobo.1123.1">[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1124.1">'version'</span></span><span class="koboSpan" id="kobo.1125.1">].</span><span class="hljs-title"><span class="koboSpan" id="kobo.1126.1">setValue</span></span><span class="koboSpan" id="kobo.1127.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1128.1">''</span></span><span class="koboSpan" id="kobo.1129.1">);
    fixture.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1130.1">detectChanges</span></span><span class="koboSpan" id="kobo.1131.1">();
    fixture.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1132.1">debugElement</span></span><span class="koboSpan" id="kobo.1133.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1134.1">nativeElement</span></span>
<span class="hljs-property"> </span><span class="koboSpan" id="kobo.1135.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1136.1">querySelector</span></span><span class="koboSpan" id="kobo.1137.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1138.1">'button'</span></span><span class="koboSpan" id="kobo.1139.1">).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1140.1">click</span></span><span class="koboSpan" id="kobo.1141.1">();
    fixture.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1142.1">detectChanges</span></span><span class="koboSpan" id="kobo.1143.1">();
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1144.1">expect</span></span><span class="koboSpan" id="kobo.1145.1">(component.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1146.1">versionName</span></span><span class="koboSpan" id="kobo.1147.1">).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1148.1">toBe</span></span><span class="koboSpan" id="kobo.1149.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1150.1">'0.0.0'</span></span><span class="koboSpan" id="kobo.1151.1">);
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1152.1">expect</span></span><span class="koboSpan" id="kobo.1153.1">(
      fixture.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1154.1">debugElement</span></span><span class="koboSpan" id="kobo.1155.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1156.1">nativeElement</span></span><span class="koboSpan" id="kobo.1157.1">
        .</span><span class="hljs-title"><span class="koboSpan" id="kobo.1158.1">querySelector</span></span><span class="koboSpan" id="kobo.1159.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1160.1">'</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1161.1">.error'</span></span><span class="koboSpan" id="kobo.1162.1">)
        .</span><span class="hljs-property"><span class="koboSpan" id="kobo.1163.1">textContent</span></span><span class="koboSpan" id="kobo.1164.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1165.1">trim</span></span><span class="koboSpan" id="kobo.1166.1">()
    ).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1167.1">toBe</span></span><span class="koboSpan" id="kobo.1168.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1169.1">'Version number is required'</span></span><span class="koboSpan" id="kobo.1170.1">);
  });
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1171.1">Let’s add one more test. </span><span class="koboSpan" id="kobo.1171.2">This will test if we are able to see the message for the pattern of the version being valid. </span><span class="koboSpan" id="kobo.1171.3">Add the following test to the same file:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.1172.1">it</span></span><span class="koboSpan" id="kobo.1173.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1174.1">'should show pattern error'</span></span><span class="koboSpan" id="kobo.1175.1">, </span><span class="hljs-function"><span class="koboSpan" id="kobo.1176.1">() =&gt;</span></span><span class="koboSpan" id="kobo.1177.1"> {
    component.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1178.1">versionForm</span></span><span class="koboSpan" id="kobo.1179.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1180.1">controls</span></span><span class="koboSpan" id="kobo.1181.1">[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1182.1">'version'</span></span><span class="koboSpan" id="kobo.1183.1">]
      .</span><span class="hljs-title"><span class="koboSpan" id="kobo.1184.1">setValue</span></span><span class="koboSpan" id="kobo.1185.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1186.1">'2.2.4'</span></span><span class="koboSpan" id="kobo.1187.1">);
    fixture.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1188.1">detectChanges</span></span><span class="koboSpan" id="kobo.1189.1">();
    component.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1190.1">versionForm</span></span><span class="koboSpan" id="kobo.1191.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1192.1">controls</span></span><span class="koboSpan" id="kobo.1193.1">[</span><span class="hljs-string"><span class="koboSpan" id="kobo.1194.1">'version'</span></span><span class="koboSpan" id="kobo.1195.1">]
      .</span><span class="hljs-title"><span class="koboSpan" id="kobo.1196.1">setValue</span></span><span class="koboSpan" id="kobo.1197.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1198.1">'invalid input'</span></span><span class="koboSpan" id="kobo.1199.1">);
    fixture.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1200.1">detectChanges</span></span><span class="koboSpan" id="kobo.1201.1">();
    fixture.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1202.1">debugElement</span></span><span class="koboSpan" id="kobo.1203.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1204.1">nativeElement</span></span>
<span class="hljs-property"> </span><span class="koboSpan" id="kobo.1205.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1206.1">querySelector</span></span><span class="koboSpan" id="kobo.1207.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1208.1">'button'</span></span><span class="koboSpan" id="kobo.1209.1">).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1210.1">click</span></span><span class="koboSpan" id="kobo.1211.1">();
    fixture.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1212.1">detectChanges</span></span><span class="koboSpan" id="kobo.1213.1">();
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1214.1">expect</span></span><span class="koboSpan" id="kobo.1215.1">(component.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1216.1">versionName</span></span><span class="koboSpan" id="kobo.1217.1">).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1218.1">toBe</span></span><span class="koboSpan" id="kobo.1219.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1220.1">'0.0.0'</span></span><span class="koboSpan" id="kobo.1221.1">);
    </span><span class="hljs-title"><span class="koboSpan" id="kobo.1222.1">expect</span></span><span class="koboSpan" id="kobo.1223.1">(
      fixture.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1224.1">debugElement</span></span><span class="koboSpan" id="kobo.1225.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1226.1">nativeElement</span></span><span class="koboSpan" id="kobo.1227.1">
        .</span><span class="hljs-title"><span class="koboSpan" id="kobo.1228.1">querySelector</span></span><span class="koboSpan" id="kobo.1229.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1230.1">'.error'</span></span><span class="koboSpan" id="kobo.1231.1">)
        .</span><span class="hljs-property"><span class="koboSpan" id="kobo.1232.1">textContent</span></span><span class="koboSpan" id="kobo.1233.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1234.1">trim</span></span><span class="koboSpan" id="kobo.1235.1">()
    ).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1236.1">toBe</span></span><span class="koboSpan" id="kobo.1237.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1238.1">'Version number does not match the pattern (x.x.x)'</span></span><span class="koboSpan" id="kobo.1239.1">);
  });
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1240.1">Great! </span><span class="koboSpan" id="kobo.1240.2">You should see all the tests still passing. </span><span class="koboSpan" id="kobo.1240.3">The fun fact is that the tests are identical for the Reactive form (with synchronous validators only) example as well.</span></p> </li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="5"><span class="koboSpan" id="kobo.1241.1">Copy all the three tests we added from </span><em class="italic"><span class="koboSpan" id="kobo.1242.1">step 2</span></em><span class="koboSpan" id="kobo.1243.1"> to </span><em class="italic"><span class="koboSpan" id="kobo.1244.1">step 4</span></em><span class="koboSpan" id="kobo.1245.1"> to the file </span><code class="inlineCode"><span class="koboSpan" id="kobo.1246.1">version-control-rf.component.spec.ts</span></code><span class="koboSpan" id="kobo.1247.1">.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1248.1">Now comes the tricky part, i.e., working with </span><code class="inlineCode"><span class="koboSpan" id="kobo.1249.1">async</span></code><span class="koboSpan" id="kobo.1250.1"> validators. </span><span class="koboSpan" id="kobo.1250.2">We cannot just copy and paste the</span><a id="_idIndexMarker532"/><span class="koboSpan" id="kobo.1251.1"> tests for this one and expect the tests to pass when we have an incorrect version provided in the form. </span><span class="koboSpan" id="kobo.1251.2">We need some additional work to do in this case. </span><span class="koboSpan" id="kobo.1251.3">First, copy </span><a id="_idIndexMarker533"/><span class="koboSpan" id="kobo.1252.1">the same tests from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1253.1">version-control-tdf.component.spec.ts</span></code><span class="koboSpan" id="kobo.1254.1"> file into the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1255.1">version-control-rf-async.component.spec.ts</span></code><span class="koboSpan" id="kobo.1256.1"> file.
    </span><p class="normal"><span class="koboSpan" id="kobo.1257.1">You will notice that we have two tests failing now, as follows:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1258.1"><img alt="" role="presentation" src="../Images/B18469_08_11.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1259.1">Figure 8.11: Tests failing for a form with asynchronous validators, using a service</span></p></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="7"><span class="koboSpan" id="kobo.1260.1">We are going to </span><a id="_idIndexMarker534"/><span class="koboSpan" id="kobo.1261.1">mock the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1262.1">FormValidationService</span></code><span class="koboSpan" id="kobo.1263.1"> for our</span><a id="_idIndexMarker535"/><span class="koboSpan" id="kobo.1264.1"> tests. </span><span class="koboSpan" id="kobo.1264.2">Update the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1265.1">version-control-rf-async.component.spec.ts</span></code><span class="koboSpan" id="kobo.1266.1">, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1267.1">import</span></span><span class="koboSpan" id="kobo.1268.1"> { provideHttpClient } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1269.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1270.1">'@angular/common/http'</span></span><span class="koboSpan" id="kobo.1271.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1272.1">import</span></span><span class="koboSpan" id="kobo.1273.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1274.1">ComponentFixture</span></span><span class="koboSpan" id="kobo.1275.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.1276.1">TestBed</span></span><span class="koboSpan" id="kobo.1277.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1278.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1279.1">'@angular/core/testing'</span></span><span class="koboSpan" id="kobo.1280.1">;
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1281.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1282.1"> { </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1283.1">of</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1284.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1285.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1286.1">'rxjs/internal/observable/of'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1287.1">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1288.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1289.1"> { </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1290.1">FormValidationService</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1291.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1292.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1293.1">'../../form-validation.service'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1294.1">;</span></strong></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1295.1">import</span></span><span class="koboSpan" id="kobo.1296.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1297.1">VersionControlRfAsyncComponent</span></span><span class="koboSpan" id="kobo.1298.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1299.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1300.1">'./version-control-rf-async.component'</span></span><span class="koboSpan" id="kobo.1301.1">;
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1302.1">const</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1303.1">FormValidationServiceMock</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1304.1"> = {</span></strong></span>
<span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1305.1">versionValidator</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1306.1">() {</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1307.1">return</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.1308.1">() =&gt;</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1309.1">of</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1310.1">(</span></strong><strong class="hljs-literal-slc"><span class="koboSpan" id="kobo.1311.1">null</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1312.1">);</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1313.1">},</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1314.1">};</span></strong></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1315.1">Let us provide our mock service to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1316.1">TestBed</span></code><span class="koboSpan" id="kobo.1317.1"> for the tests in the same file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1318.1">...
</span><span class="hljs-title"><span class="koboSpan" id="kobo.1319.1">describe</span></span><span class="koboSpan" id="kobo.1320.1">(</span><span class="hljs-string"><span class="koboSpan" id="kobo.1321.1">'VersionControlRfAsyncComponent'</span></span><span class="koboSpan" id="kobo.1322.1">, </span><span class="hljs-function"><span class="koboSpan" id="kobo.1323.1">() =&gt;</span></span><span class="koboSpan" id="kobo.1324.1"> {
 ...
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.1325.1">beforeEach</span></span><span class="koboSpan" id="kobo.1326.1">(</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1327.1">async</span></span><span class="koboSpan" id="kobo.1328.1"> () =&gt; {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1329.1">await</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1330.1">TestBed</span></span><span class="koboSpan" id="kobo.1331.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1332.1">configureTestingModule</span></span><span class="koboSpan" id="kobo.1333.1">({
      </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1334.1">imports</span></span><span class="koboSpan" id="kobo.1335.1">: [</span><span class="hljs-title"><span class="koboSpan" id="kobo.1336.1">VersionControlRfAsyncComponent</span></span><span class="koboSpan" id="kobo.1337.1">],
      </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1338.1">providers</span></span><span class="koboSpan" id="kobo.1339.1">: [
        </span><span class="hljs-title"><span class="koboSpan" id="kobo.1340.1">provideHttpClient</span></span><span class="koboSpan" id="kobo.1341.1">(),
        </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1342.1">{</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1343.1">provide</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1344.1">: </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1345.1">FormValidationService</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1346.1">,</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1347.1">useValue</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1348.1">: </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1349.1">FormValidationServiceMock</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1350.1">,</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1351.1">},</span></strong></span><span class="koboSpan" id="kobo.1352.1">
      ],
    }).</span><span class="hljs-title"><span class="koboSpan" id="kobo.1353.1">compileComponents</span></span><span class="koboSpan" id="kobo.1354.1">();
    ...
  </span><span class="koboSpan" id="kobo.1354.2">});
});
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1355.1">With the above change, the tests </span><code class="inlineCode"><span class="koboSpan" id="kobo.1356.1">'should submit the form with valid version'</span></code><span class="koboSpan" id="kobo.1357.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1358.1">'should show required error'</span></code><span class="koboSpan" id="kobo.1359.1"> should pass. </span><span class="koboSpan" id="kobo.1359.2">Yay! </span><span class="koboSpan" id="kobo.1359.3">However, the last test failed. </span><span class="koboSpan" id="kobo.1359.4">We will fix that.</span></p></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="9"><span class="koboSpan" id="kobo.1360.1">Let’s update the final</span><a id="_idIndexMarker536"/><span class="koboSpan" id="kobo.1361.1"> failing test. </span><span class="koboSpan" id="kobo.1361.2">We are going to</span><a id="_idIndexMarker537"/><span class="koboSpan" id="kobo.1362.1"> update our </span><code class="inlineCode"><span class="koboSpan" id="kobo.1363.1">FormValidationServiceMock</span></code><span class="koboSpan" id="kobo.1364.1"> object to return a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1365.1">pattern</span></code><span class="koboSpan" id="kobo.1366.1"> error if there is an invalid input. </span><span class="koboSpan" id="kobo.1366.2">Update the file as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1367.1">...
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1368.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1369.1"> { </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1370.1">AbstractControl</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1371.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1372.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1373.1">'@angular/forms'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1374.1">;</span></strong></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1375.1">import</span></span><span class="koboSpan" id="kobo.1376.1"> { </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1377.1">of</span></span><span class="koboSpan" id="kobo.1378.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1379.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1380.1">'rxjs/internal/observable/of'</span></span><span class="koboSpan" id="kobo.1381.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1382.1">import</span></span><span class="koboSpan" id="kobo.1383.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1384.1">FormValidationService</span></span><span class="koboSpan" id="kobo.1385.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1386.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1387.1">'../../form-validation.service'</span></span><span class="koboSpan" id="kobo.1388.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1389.1">import</span></span><span class="koboSpan" id="kobo.1390.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1391.1">VersionControlRfAsyncComponent</span></span><span class="koboSpan" id="kobo.1392.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1393.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1394.1">'./version-control-rf-async.component'</span></span><span class="koboSpan" id="kobo.1395.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1396.1">const</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1397.1">FormValidationServiceMock</span></span><span class="koboSpan" id="kobo.1398.1"> = {
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.1399.1">versionValidator</span></span><span class="koboSpan" id="kobo.1400.1">(</span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1401.1">control</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.1402.1">: </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1403.1">AbstractControl</span></strong></span><span class="koboSpan" id="kobo.1404.1">) {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1405.1">return</span></span> <span class="hljs-function"><span class="koboSpan" id="kobo.1406.1">() =&gt;</span></span><span class="koboSpan" id="kobo.1407.1"> {
      </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1408.1">if</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1409.1"> (control.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1410.1">value</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1411.1"> === </span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1412.1">'invalid input'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1413.1">) {</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1414.1">return</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1415.1">of</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1416.1">({ </span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1417.1">pattern</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1418.1">: </span></strong><strong class="hljs-literal-slc"><span class="koboSpan" id="kobo.1419.1">true</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1420.1"> });</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1421.1">}</span></strong></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.1422.1">return</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1423.1">of</span></span><span class="koboSpan" id="kobo.1424.1">(</span><span class="hljs-literal"><span class="koboSpan" id="kobo.1425.1">null</span></span><span class="koboSpan" id="kobo.1426.1">);
    };
  }};
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1427.1">And voila! </span><span class="koboSpan" id="kobo.1427.2">All of the tests should be passing now, as follows:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1428.1"><img alt="" role="presentation" src="../Images/B18469_08_12.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1429.1">Figure 8.12: All tests passing for the recipe</span></p></li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.1430.1">Awesome! </span><span class="koboSpan" id="kobo.1430.2">You now know a </span><a id="_idIndexMarker538"/><span class="koboSpan" id="kobo.1431.1">bunch of techniques to test your Angular forms. </span><span class="koboSpan" id="kobo.1431.2">However, some of these techniques might still require some explanation. </span><span class="koboSpan" id="kobo.1431.3">See the</span><a id="_idIndexMarker539"/><span class="koboSpan" id="kobo.1432.1"> next section to understand how it all works.</span></p>
<h2 class="heading-2" id="_idParaDest-274"><span class="koboSpan" id="kobo.1433.1">How it works…</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1434.1">Testing Angular forms can be a bit of a challenge, as it depends on how complex the form is, what use cases you want to test, and how complex those use cases are. </span><span class="koboSpan" id="kobo.1434.2">This is also true for cases where you have several dependencies to work with. </span><span class="koboSpan" id="kobo.1434.3">In our recipe, we started with the template-driven forms, and it was easy for us to test them, since the component has a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1435.1">ViewChild()</span></code><span class="koboSpan" id="kobo.1436.1"> of the type </span><code class="inlineCode"><span class="koboSpan" id="kobo.1437.1">NgForm</span></code><span class="koboSpan" id="kobo.1438.1">. </span><span class="koboSpan" id="kobo.1438.2">This makes it easier to write our first test that sets the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1439.1">version</span></code><span class="koboSpan" id="kobo.1440.1"> form control. </span><span class="koboSpan" id="kobo.1440.2">Then, we click the </span><strong class="screenText"><span class="koboSpan" id="kobo.1441.1">Submit</span></strong><span class="koboSpan" id="kobo.1442.1"> button and expect the component’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.1443.1">versionName</span></code><span class="koboSpan" id="kobo.1444.1"> property value to be the one we entered in the form. </span><span class="koboSpan" id="kobo.1444.2">Easy peasy!</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1445.1">For the second test, we first set the value of the form to </span><code class="inlineCode"><span class="koboSpan" id="kobo.1446.1">2.2.4</span></code><span class="koboSpan" id="kobo.1447.1">, and then we empty the form by setting the value to an empty string. </span><span class="koboSpan" id="kobo.1447.2">Then, we submit the form and expect the value of the component’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.1448.1">versionName</span></code><span class="koboSpan" id="kobo.1449.1"> property to remain unchanged and still be </span><code class="inlineCode"><span class="koboSpan" id="kobo.1450.1">0.0.0</span></code><span class="koboSpan" id="kobo.1451.1">. </span><span class="koboSpan" id="kobo.1451.2">However, what we also check is that, inside the form, we can see the error that says, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1452.1">'Version number is required'</span></code><span class="koboSpan" id="kobo.1453.1">. </span><span class="koboSpan" id="kobo.1453.2">Notice that we use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1454.1">fixture.debugElement.nativeElement.querySelector</span></code><span class="koboSpan" id="kobo.1455.1"> method to get the desired error element, and then we check its </span><code class="inlineCode"><span class="koboSpan" id="kobo.1456.1">textContent</span></code><span class="koboSpan" id="kobo.1457.1"> value.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1458.1">For the test to check the pattern, we do the same as for the second test, but instead of emptying the input, we provide </span><code class="inlineCode"><span class="koboSpan" id="kobo.1459.1">'</span></code><code class="inlineCode"><span class="koboSpan" id="kobo.1460.1">invalid input'</span></code><span class="koboSpan" id="kobo.1461.1"> as the new value to the form control. </span><span class="koboSpan" id="kobo.1461.2">The template-driven form picks it and shows the error </span><code class="inlineCode"><span class="koboSpan" id="kobo.1462.1">'Version number does not match the pattern (x.x.x)'</span></code><span class="koboSpan" id="kobo.1463.1">, which is what we expect in the test as well.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1464.1">The same three tests work exactly the same as the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1465.1">Reactive Forms</span></code><span class="koboSpan" id="kobo.1466.1"> example we have. </span><span class="koboSpan" id="kobo.1466.2">The difference this time is that the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1467.1">versionForm</span></code><span class="koboSpan" id="kobo.1468.1"> property in the component is not </span><code class="inlineCode"><span class="koboSpan" id="kobo.1469.1">NgForm</span></code><span class="koboSpan" id="kobo.1470.1"> but, rather, a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1471.1">FormGroup</span></code><span class="koboSpan" id="kobo.1472.1">. </span><span class="koboSpan" id="kobo.1472.2">It is amazing that Angular has the same API (i.e., the same methods) in both </span><code class="inlineCode"><span class="koboSpan" id="kobo.1473.1">NgForm</span></code><strong class="keyWord"> </strong><span class="koboSpan" id="kobo.1474.1">and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1475.1">FormGroup</span></code><strong class="keyWord"> </strong><span class="koboSpan" id="kobo.1476.1">to set and retrieve the values. </span><span class="koboSpan" id="kobo.1476.2">This is because it creates a top-level </span><code class="inlineCode"><span class="koboSpan" id="kobo.1477.1">FormGroup</span></code><span class="koboSpan" id="kobo.1478.1"> behind the scenes, thus making our tests the same.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1479.1">For the tests with </span><code class="inlineCode"><span class="koboSpan" id="kobo.1480.1">async</span></code><span class="koboSpan" id="kobo.1481.1"> validators, we did something special. </span><span class="koboSpan" id="kobo.1481.2">Apart from copying and pasting the tests from the</span><a id="_idIndexMarker540"/><span class="koboSpan" id="kobo.1482.1"> other examples, we had to mock the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1483.1">FormValidationService</span></code><span class="koboSpan" id="kobo.1484.1">. </span><span class="koboSpan" id="kobo.1484.2">This is because this example had an asynchronous validator function, which comes </span><a id="_idIndexMarker541"/><span class="koboSpan" id="kobo.1485.1">from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1486.1">FormValidationService</span></code><strong class="keyWord"> </strong><span class="koboSpan" id="kobo.1487.1">class, and it is a general best practice to mock all the dependencies of a unit so that we can purely test it.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1488.1">We start by creating a stub named </span><code class="inlineCode"><span class="koboSpan" id="kobo.1489.1">FormValidationServiceMock</span></code><span class="koboSpan" id="kobo.1490.1"> (we’ll learn more about stubs in </span><em class="chapterRef"><span class="koboSpan" id="kobo.1491.1">Chapter 10</span></em><span class="koboSpan" id="kobo.1492.1"> ,</span><em class="italic"><span class="koboSpan" id="kobo.1493.1">Writing Unit Tests in Angular with Jest</span></em><span class="koboSpan" id="kobo.1494.1">). </span><span class="koboSpan" id="kobo.1494.2">Then, we provide this stub in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1495.1">TestBed</span></code><span class="koboSpan" id="kobo.1496.1"> against the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1497.1">FormValidationService</span></code><span class="koboSpan" id="kobo.1498.1"> class. </span><span class="koboSpan" id="kobo.1498.2">Finally, we make sure that our </span><code class="inlineCode"><span class="koboSpan" id="kobo.1499.1">versionValidator</span></code><span class="koboSpan" id="kobo.1500.1"> method in the stub returns the correct error when the input is not valid. </span><span class="koboSpan" id="kobo.1500.2">And that’s it. </span><span class="koboSpan" id="kobo.1500.3">Without many changes in the tests themselves, we are able to test all three kinds of forms with minor adjustments. </span><span class="koboSpan" id="kobo.1500.4">I hope you learned quite a few techniques in this recipe.</span></p>
<h2 class="heading-2" id="_idParaDest-275"><span class="koboSpan" id="kobo.1501.1">See also</span></h2>
<ul>
<li class="bulletList"><em class="italic"><span class="koboSpan" id="kobo.1502.1">Testing</span></em><em class="italic"><a id="_idIndexMarker542"/></em> <em class="italic"><span class="koboSpan" id="kobo.1503.1">template-driven forms</span></em><span class="koboSpan" id="kobo.1504.1">: </span><a href="https://angular.io/guide/forms-overview#testing-template-driven-forms"><span class="url"><span class="koboSpan" id="kobo.1505.1">https://angular.io/guide/forms-overview#testing-template-driven-forms</span></span></a></li>
</ul>
<h1 class="heading-1" id="_idParaDest-276"><span class="koboSpan" id="kobo.1506.1">Server-side validation using asynchronous validator functions</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.1507.1">Form validations are straightforward in Angular, with the reason being the super-awesome validators that Angular provides out of the box. </span><span class="koboSpan" id="kobo.1507.2">These validators are synchronous, meaning that as soon as you change the input, the validators kick in and provide you with information about the validity </span><a id="_idIndexMarker543"/><span class="koboSpan" id="kobo.1508.1">of the values right away. </span><span class="koboSpan" id="kobo.1508.2">However, sometimes, you might rely on some validations from a backend API or </span><a id="_idIndexMarker544"/><span class="koboSpan" id="kobo.1509.1">have some asynchronous logic that you need to execute to validate the form value. </span><span class="koboSpan" id="kobo.1509.2">These situations would require something called asynchronous validators. </span><span class="koboSpan" id="kobo.1509.3">In this recipe, you’re</span><a id="_idIndexMarker545"/><span class="koboSpan" id="kobo.1510.1"> going to create your first asynchronous validator.</span></p>
<h2 class="heading-2" id="_idParaDest-277"><span class="koboSpan" id="kobo.1511.1">Getting ready</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1512.1">The app that we are going to work with resides in </span><code class="inlineCode"><span class="koboSpan" id="kobo.1513.1">start/apps/chapter08/ng-rf-async-validator</span></code><span class="koboSpan" id="kobo.1514.1"> inside the cloned repository:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1515.1">Open the code repository in your code editor.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1516.1">Open the terminal, navigate to the code repository directory, and run the following command to serve the project along with the backend server:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1517.1">npm run serve ng-rf-async-validator with-server
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1518.1">This should open the app in a new browser tab, and you should see the following:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1519.1"><img alt="" role="presentation" src="../Images/B18469_08_13.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1520.1">Figure 8.13: Asynchronous validators app running on http://localhost:4200</span></p></li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.1521.1">Now that we have</span><a id="_idIndexMarker546"/><span class="koboSpan" id="kobo.1522.1"> the app running, let’s see the steps involved in this recipe in the next section.</span></p>
<h2 class="heading-2" id="_idParaDest-278"><span class="koboSpan" id="kobo.1523.1">How to do it…</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1524.1">We already have the backend with an endpoint that can accept a version as a query parameter, returning a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1525.1">boolean</span></code><span class="koboSpan" id="kobo.1526.1"> for if the provided version is a valid version according to the pattern (</span><code class="inlineCode"><span class="koboSpan" id="kobo.1527.1">x.x.x</span></code><span class="koboSpan" id="kobo.1528.1">) and is a newer version than the previously provided one. </span><span class="koboSpan" id="kobo.1528.2">We’ll create an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1529.1">async</span></code><span class="koboSpan" id="kobo.1530.1"> validator to</span><a id="_idIndexMarker547"/><span class="koboSpan" id="kobo.1531.1"> make sure that the new releases have a valid version. </span><span class="koboSpan" id="kobo.1531.2">Let’s begin:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1532.1">First, we will modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1533.1">VersionService</span></code><span class="koboSpan" id="kobo.1534.1"> class in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1535.1">version.service.ts</span></code><span class="koboSpan" id="kobo.1536.1"> file, as follows, to add a method to validate the form input via the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1537.1">http://localhost:3333/api/version/validate</span></code><span class="koboSpan" id="kobo.1538.1"> endpoint:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1539.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1540.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1541.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1542.1">VersionService</span></span><span class="koboSpan" id="kobo.1543.1"> {
  ...
  </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1544.1">validateVersion</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1545.1">(</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1546.1">version</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1547.1">: </span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.1548.1">string</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1549.1">): </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1550.1">Observable</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1551.1">&lt;{ </span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1552.1">error</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1553.1">:</span></strong></span>
<span class="code-highlight"><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.1554.1">string</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1555.1"> }&gt; {</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1556.1">return</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1557.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1558.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1559.1">http</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1560.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1561.1">get</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1562.1">&lt;{ </span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1563.1">error</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1564.1">: </span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.1565.1">string</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1566.1"> }&gt;(</span></strong></span>
<span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1567.1">`</span></strong><strong class="hljs-subst-slc"><span class="koboSpan" id="kobo.1568.1">${</span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1569.1">this</span></strong><strong class="hljs-subst-slc"><span class="koboSpan" id="kobo.1570.1">.apiBaseUrl}</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1571.1">/validate?val=</span></strong><strong class="hljs-subst-slc"><span class="koboSpan" id="kobo.1572.1">${version}</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1573.1">`</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1574.1">);</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1575.1">}</span></strong></span>
<span class="hljs-title"><span class="koboSpan" id="kobo.1576.1">submitVersion</span></span><span class="koboSpan" id="kobo.1577.1">(</span><span class="hljs-attr"><span class="koboSpan" id="kobo.1578.1">version</span></span><span class="koboSpan" id="kobo.1579.1">: </span><span class="hljs-built_in"><span class="koboSpan" id="kobo.1580.1">string</span></span><span class="koboSpan" id="kobo.1581.1">): </span><span class="hljs-title"><span class="koboSpan" id="kobo.1582.1">Observable</span></span><span class="koboSpan" id="kobo.1583.1">&lt;{ </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1584.1">success</span></span><span class="koboSpan" id="kobo.1585.1">:
</span><span class="hljs-title"> </span> <span class="hljs-built_in"><span class="koboSpan" id="kobo.1586.1">boolean</span></span><span class="koboSpan" id="kobo.1587.1"> }&gt; {...);
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1588.1">We will now create an </span><strong class="keyWord"><span class="koboSpan" id="kobo.1589.1">Async Validator Function</span></strong><span class="koboSpan" id="kobo.1590.1"> (</span><code class="inlineCode"><span class="koboSpan" id="kobo.1591.1">AsyncValidatorFn</span></code><span class="koboSpan" id="kobo.1592.1">) inside the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1593.1">VersionService</span></code><span class="koboSpan" id="kobo.1594.1"> class. </span><span class="koboSpan" id="kobo.1594.2">This is</span><a id="_idIndexMarker548"/><span class="koboSpan" id="kobo.1595.1"> something </span><a id="_idIndexMarker549"/><span class="koboSpan" id="kobo.1596.1">we will bind later to the form in the app. </span><span class="koboSpan" id="kobo.1596.2">Let us update the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1597.1">version.service.ts</span></code><span class="koboSpan" id="kobo.1598.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1599.1">import</span></span><span class="koboSpan" id="kobo.1600.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1601.1">HttpClient</span></span><span class="koboSpan" id="kobo.1602.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1603.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1604.1">'@angular/common/http'</span></span><span class="koboSpan" id="kobo.1605.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1606.1">import</span></span><span class="koboSpan" id="kobo.1607.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1608.1">Injectable</span></span><span class="koboSpan" id="kobo.1609.1">, inject } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1610.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1611.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.1612.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1613.1">import</span></span><span class="koboSpan" id="kobo.1614.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1615.1">Observable</span></span><span class="koboSpan" id="kobo.1616.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1617.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1618.1">'rxjs/internal/Observable'</span></span><span class="koboSpan" id="kobo.1619.1">;
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1620.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1621.1"> { </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1622.1">AbstractControl</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1623.1">, </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1624.1">AsyncValidatorFn</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1625.1">, </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1626.1">ValidationErrors</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1627.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1628.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1629.1">'@angular/forms'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1630.1">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1631.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1632.1"> { timer, switchMap, map } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1633.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1634.1">'rxjs'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1635.1">;</span></strong></span><span class="koboSpan" id="kobo.1636.1">
...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1637.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1638.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1639.1">VersionService</span></span><span class="koboSpan" id="kobo.1640.1"> {
  ...
  
</span><span class="code-highlight"><strong class="hljs-slc"> </strong></span>
<span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1641.1">versionValidator</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1642.1">(): </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1643.1">AsyncValidatorFn</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1644.1"> {</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1645.1">return</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1646.1"> (</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1647.1">control</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1648.1">: </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1649.1">AbstractControl</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1650.1">): </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1651.1">Observable</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1652.1">&lt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1653.1">ValidationErrors</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1654.1"> | </span></strong><strong class="hljs-literal-slc"><span class="koboSpan" id="kobo.1655.1">null</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1656.1"> &gt; =&gt; {</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1657.1">return</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1658.1">timer</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1659.1">(</span></strong><strong class="hljs-number-slc"><span class="koboSpan" id="kobo.1660.1">500</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1661.1">).</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1662.1">pipe</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1663.1">(</span></strong></span>
<span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1664.1">switchMap</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1665.1">(</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.1666.1">() =&gt;</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1667.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1668.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1669.1">validateVersion</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1670.1">(</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1671.1">control.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1672.1">value</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1673.1">)),</span></strong></span>
<span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1674.1">map</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1675.1">(</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.1676.1">(</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.1677.1">{ error }</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.1678.1">) =&gt;</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1679.1"> {</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1680.1">const</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1681.1">errors</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1682.1">: </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1683.1">ValidationErrors</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1684.1"> = {};</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1685.1">if</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1686.1"> (error === </span></strong><strong class="hljs-literal-slc"><span class="koboSpan" id="kobo.1687.1">null</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1688.1">) {</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1689.1">return</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-literal-slc"><span class="koboSpan" id="kobo.1690.1">null</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1691.1">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1692.1">}</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1693.1">errors[error] = </span></strong><strong class="hljs-literal-slc"><span class="koboSpan" id="kobo.1694.1">true</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1695.1">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1696.1">return</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1697.1"> errors;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1698.1">})</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1699.1">);</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1700.1">};</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1701.1">}</span></strong></span><span class="koboSpan" id="kobo.1702.1">
  ...
</span><span class="koboSpan" id="kobo.1702.2">}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1703.1">We will use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1704.1">versionValidator</span></code><span class="koboSpan" id="kobo.1705.1"> method we just created inside the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1706.1">VersionControlComponent</span></code><span class="koboSpan" id="kobo.1707.1"> class </span><a id="_idIndexMarker550"/><span class="koboSpan" id="kobo.1708.1">with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1709.1">versionForm</span></code><span class="koboSpan" id="kobo.1710.1">. </span><span class="koboSpan" id="kobo.1710.2">To do that, let’s modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1711.1">version-control.component.ts</span></code><span class="koboSpan" id="kobo.1712.1"> file, as</span><a id="_idIndexMarker551"/><span class="koboSpan" id="kobo.1713.1"> follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.1714.1">import</span></span><span class="koboSpan" id="kobo.1715.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1716.1">Component</span></span><span class="koboSpan" id="kobo.1717.1">, </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1718.1">OnInit</span></strong></span><span class="koboSpan" id="kobo.1719.1">, </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1720.1">inject</span></strong></span><span class="koboSpan" id="kobo.1721.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1722.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1723.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.1724.1">;
...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1725.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1726.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1727.1">VersionControlComponent</span></span> <span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1728.1">implements</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1729.1">OnInit</span></strong></span><span class="koboSpan" id="kobo.1730.1"> {
  ...
  </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1731.1">ngOnInit</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1732.1">() {</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1733.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1734.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1735.1">versionForm</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1736.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1737.1">controls</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1738.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1739.1">version</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1740.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1741.1">setAsyncValidators</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1742.1">(</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1743.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1744.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1745.1">versionService</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1746.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1747.1">versionValidator</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1748.1">()</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1749.1">);</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1750.1">}</span></strong></span>
<span class="hljs-title"><span class="koboSpan" id="kobo.1751.1">formSubmit</span></span><span class="koboSpan" id="kobo.1752.1">(</span><span class="hljs-attr"><span class="koboSpan" id="kobo.1753.1">form</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.1754.1">: </span></span><span class="hljs-title"><span class="koboSpan" id="kobo.1755.1">FormGroup</span></span><span class="koboSpan" id="kobo.1756.1">) {...}
} 
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1757.1">If you now try submitting a version equal to or lower than the last submitted one, you will receive an error, as follows:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1758.1"><img alt="" role="presentation" src="../Images/B18469_08_14.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1759.1">Figure 8.14: Error being shown when a lower or equal version number is provided</span></p> </li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.1760.1">Cool! </span><span class="koboSpan" id="kobo.1760.2">So, you now know </span><a id="_idIndexMarker552"/><span class="koboSpan" id="kobo.1761.1">how to create an asynchronous validator function in Angular for form validation within reactive forms. </span><span class="koboSpan" id="kobo.1761.2">Since </span><a id="_idIndexMarker553"/><span class="koboSpan" id="kobo.1762.1">you’ve finished the recipe, refer to the next section to see how this works.</span></p>
<h2 class="heading-2" id="_idParaDest-279"><span class="koboSpan" id="kobo.1763.1">How it works...</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1764.1">Angular provides an effortless way to create </span><code class="inlineCode"><span class="koboSpan" id="kobo.1765.1">async</span></code><span class="koboSpan" id="kobo.1766.1"> validator functions, and they’re handy too. </span><span class="koboSpan" id="kobo.1766.2">We use an </span><code class="inlineCode"><span class="koboSpan" id="kobo.1767.1">async</span></code><span class="koboSpan" id="kobo.1768.1"> validator function when there needs to be a validation that can be time-consuming and we don’t want to block the main thread, or when we rely on a backend service for validation. </span><span class="koboSpan" id="kobo.1768.2">For example, in this recipe, we started by creating the validator method named </span><code class="inlineCode"><span class="koboSpan" id="kobo.1769.1">versionValidator</span></code><span class="koboSpan" id="kobo.1770.1"> inside a new service, called </span><code class="inlineCode"><span class="koboSpan" id="kobo.1771.1">VersionService</span></code><span class="koboSpan" id="kobo.1772.1">. </span><span class="koboSpan" id="kobo.1772.2">Notice that we are using a couple of RxJS operators in the method, including </span><code class="inlineCode"><span class="koboSpan" id="kobo.1773.1">timer</span></code><span class="koboSpan" id="kobo.1774.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.1775.1">switchMap</span></code><span class="koboSpan" id="kobo.1776.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1777.1">map</span></code><span class="koboSpan" id="kobo.1778.1">. </span><span class="koboSpan" id="kobo.1778.2">We use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1779.1">timer</span></code><span class="koboSpan" id="kobo.1780.1"> operator to debounce and wait for the user to stop typing for </span><strong class="keyWord"><span class="koboSpan" id="kobo.1781.1">500</span></strong><span class="koboSpan" id="kobo.1782.1"> milliseconds. </span><span class="koboSpan" id="kobo.1782.2">We then use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1783.1">switchMap</span></code><span class="koboSpan" id="kobo.1784.1"> operator combined with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1785.1">validateVersion</span></code><span class="koboSpan" id="kobo.1786.1"> method to make an HTTP call to the backend, validating the version. </span><span class="koboSpan" id="kobo.1786.2">The benefit of </span><code class="inlineCode"><span class="koboSpan" id="kobo.1787.1">switchMap</span></code><span class="koboSpan" id="kobo.1788.1"> here is that it cancels out existing HTTP calls, if any. </span><span class="koboSpan" id="kobo.1788.2">Then, we use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1789.1">map</span></code><span class="koboSpan" id="kobo.1790.1"> operator to remove the error from the HTTP call. </span><span class="koboSpan" id="kobo.1790.2">If there’s no error, we return an empty object from the map function’s callback. </span><span class="koboSpan" id="kobo.1790.3">If we have an error, we set the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1791.1">[error]</span></code><span class="koboSpan" id="kobo.1792.1"> as </span><code class="inlineCode"><span class="koboSpan" id="kobo.1793.1">true</span></code><span class="koboSpan" id="kobo.1794.1"> in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1795.1">errors</span></code><span class="koboSpan" id="kobo.1796.1"> object, as shown in </span><em class="italic"><span class="koboSpan" id="kobo.1797.1">step 4</span></em><span class="koboSpan" id="kobo.1798.1">.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.1799.1">After creating the validator function, we attached it to the form control for the version name by using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1800.1">FormControl.setAsyncValidators</span></code><span class="koboSpan" id="kobo.1801.1"> method in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1802.1">VersionControlComponent</span></code><span class="koboSpan" id="kobo.1803.1"> class. </span><span class="koboSpan" id="kobo.1803.2">We then used the validation errors, named </span><code class="inlineCode"><span class="koboSpan" id="kobo.1804.1">pattern</span></code><span class="koboSpan" id="kobo.1805.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.1806.1">oldVersion</span></code><span class="koboSpan" id="kobo.1807.1">, in the</span><a id="_idIndexMarker554"/><span class="koboSpan" id="kobo.1808.1"> template to show the relevant </span><a id="_idIndexMarker555"/><span class="koboSpan" id="kobo.1809.1">error message on the UI.</span></p>
<h2 class="heading-2" id="_idParaDest-280"><span class="koboSpan" id="kobo.1810.1">See also</span></h2>
<ul>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.1811.1">AsyncValidator</span></code><span class="koboSpan" id="kobo.1812.1"> Angular docs: </span><a href="https://angular.io/api/forms/AsyncValidator#provide-a-custom-async-validator-directive"><span class="url"><span class="koboSpan" id="kobo.1813.1">https://angular.io/api/forms/AsyncValidator#provide-a-custom-async-validator-directive</span></span></a></li>
</ul>
<h1 class="heading-1" id="_idParaDest-281"><span class="koboSpan" id="kobo.1814.1">Implementing complex forms with reactive FormArray</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.1815.1">This is definitely one of the most requested recipes from the readers of the first edition of </span><em class="italic"><span class="koboSpan" id="kobo.1816.1">Angular Cookbook</span></em><span class="koboSpan" id="kobo.1817.1">. </span><span class="koboSpan" id="kobo.1817.2">In this recipe, we’ll work with reactive Forms and specifically, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1818.1">FormArray</span></code><span class="koboSpan" id="kobo.1819.1"> class from reactive forms. </span><span class="koboSpan" id="kobo.1819.2">We’re going to implement a complex form, which has a list of projects that can be</span><a id="_idIndexMarker556"/><span class="koboSpan" id="kobo.1820.1"> submitted with reactive forms. </span><span class="koboSpan" id="kobo.1820.2">The user will be able to add as many projects as they want and will be </span><a id="_idIndexMarker557"/><span class="koboSpan" id="kobo.1821.1">able to remove the ones they don’t want.</span></p>
<h2 class="heading-2" id="_idParaDest-282"><span class="koboSpan" id="kobo.1822.1">Getting ready</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1823.1">The app that we are going to work with resides in </span><code class="inlineCode"><span class="koboSpan" id="kobo.1824.1">start/apps/chapter08/ng-form-arrays</span></code><span class="koboSpan" id="kobo.1825.1"> inside the cloned repository:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1826.1">Open the code repository in your code editor.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.1827.1">Open the terminal, navigate to the code repository directory, and run the following command to serve the project:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.1828.1">npm run serve ng-form-arrays
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.1829.1">This should open the app in a new browser tab, and you should see the following:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.1830.1"><img alt="" role="presentation" src="../Images/B18469_08_15.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.1831.1">Figure 8.15: reactive FormArray app running on http://localhost:4200</span></p></li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.1832.1">Now that we have the app</span><a id="_idIndexMarker558"/><span class="koboSpan" id="kobo.1833.1"> running locally, let’s see the steps involved in this recipe in the next section.</span></p>
<h2 class="heading-2" id="_idParaDest-283"><span class="koboSpan" id="kobo.1834.1">How to do it…</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.1835.1">We have an app that already implements a Reactive form. </span><span class="koboSpan" id="kobo.1835.2">However, we can only add one project so far. </span><span class="koboSpan" id="kobo.1835.3">We will use reactive </span><code class="inlineCode"><span class="koboSpan" id="kobo.1836.1">FormArray</span></code><span class="koboSpan" id="kobo.1837.1"> to let the user submit multiple projects, and we will use the Reactive </span><code class="inlineCode"><span class="koboSpan" id="kobo.1838.1">FormBuilder</span></code><span class="koboSpan" id="kobo.1839.1">, which is a nice little API from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1840.1">@angular/forms</span></code><span class="koboSpan" id="kobo.1841.1"> package that </span><a id="_idIndexMarker559"/><span class="koboSpan" id="kobo.1842.1">makes it easy to create and maintain reactive forms in Angular. </span><span class="koboSpan" id="kobo.1842.2">Let us begin:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.1843.1">First of all, let’s use the Reactive </span><code class="inlineCode"><span class="koboSpan" id="kobo.1844.1">FormBuilder</span></code><span class="koboSpan" id="kobo.1845.1"> to add a </span><code class="inlineCode"><span class="koboSpan" id="kobo.1846.1">FormArray</span></code><span class="koboSpan" id="kobo.1847.1"> to the existing Reactive form in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1848.1">portfolio-form.component.ts</span></code><span class="koboSpan" id="kobo.1849.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.1850.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1851.1">import</span></span><span class="koboSpan" id="kobo.1852.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.1853.1">FormBuilder</span></span><span class="koboSpan" id="kobo.1854.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.1855.1">ReactiveFormsModule</span></span><span class="koboSpan" id="kobo.1856.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.1857.1">Validators</span></span><span class="koboSpan" id="kobo.1858.1">, </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1859.1">FormGroup</span></strong></span><span class="koboSpan" id="kobo.1860.1">, </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1861.1">FormControl</span></strong></span><span class="koboSpan" id="kobo.1862.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1863.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.1864.1">'@angular/forms'</span></span><span class="koboSpan" id="kobo.1865.1">;
...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.1866.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.1867.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.1868.1">PortfolioFormComponent</span></span><span class="koboSpan" id="kobo.1869.1"> {
  fb = </span><span class="hljs-title"><span class="koboSpan" id="kobo.1870.1">inject</span></span><span class="koboSpan" id="kobo.1871.1">(</span><span class="hljs-title"><span class="koboSpan" id="kobo.1872.1">FormBuilder</span></span><span class="koboSpan" id="kobo.1873.1">);
  portfolioForm = </span><span class="hljs-variable"><span class="koboSpan" id="kobo.1874.1">this</span></span><span class="koboSpan" id="kobo.1875.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1876.1">fb</span></span><span class="koboSpan" id="kobo.1877.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.1878.1">group</span></span><span class="koboSpan" id="kobo.1879.1">({
    </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1880.1">name</span></span><span class="koboSpan" id="kobo.1881.1">: [</span><span class="hljs-string"><span class="koboSpan" id="kobo.1882.1">''</span></span><span class="koboSpan" id="kobo.1883.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.1884.1">Validators</span></span><span class="koboSpan" id="kobo.1885.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.1886.1">required</span></span><span class="koboSpan" id="kobo.1887.1">],
    </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1888.1">bio</span></span><span class="koboSpan" id="kobo.1889.1">: [</span><span class="hljs-string"><span class="koboSpan" id="kobo.1890.1">''</span></span><span class="koboSpan" id="kobo.1891.1">],
    </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1892.1">projects</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1893.1">: </span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1894.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1895.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1896.1">fb</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1897.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1898.1">array</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1899.1">&lt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1900.1">FormGroup</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1901.1">&lt;{</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1902.1">label</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1903.1">: </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1904.1">FormControl</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1905.1">&lt;</span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.1906.1">string</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1907.1"> | </span></strong><strong class="hljs-literal-slc"><span class="koboSpan" id="kobo.1908.1">null</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1909.1">&gt;;</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1910.1">url</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1911.1">: </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1912.1">FormControl</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1913.1">&lt;</span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.1914.1">string</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1915.1"> | </span></strong><strong class="hljs-literal-slc"><span class="koboSpan" id="kobo.1916.1">null</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1917.1">&gt;;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1918.1">}&gt;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1919.1">&gt;([]),</span></strong></span><span class="koboSpan" id="kobo.1920.1">
  })
  </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1921.1">get</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.1922.1">projectsFormArr</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1923.1">() {</span></strong></span>
<span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.1924.1">return</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.1925.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1926.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1927.1">portfolioForm</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1928.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1929.1">controls</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1930.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.1931.1">projects</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.1932.1">;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.1933.1">}</span></strong></span><span class="koboSpan" id="kobo.1934.1">
  ...
</span><span class="koboSpan" id="kobo.1934.2">}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.1935.1">Now that we have the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1936.1">projects</span></code> <code class="inlineCode"><span class="koboSpan" id="kobo.1937.1">FormArray</span></code><span class="koboSpan" id="kobo.1938.1">, let’s use that in the template so that we can show the </span><a id="_idIndexMarker560"/><span class="koboSpan" id="kobo.1939.1">form inputs for the projects, according</span><a id="_idIndexMarker561"/><span class="koboSpan" id="kobo.1940.1"> to the form array. </span><span class="koboSpan" id="kobo.1940.2">Let’s modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.1941.1">portfolio-form.component.html</span></code><span class="koboSpan" id="kobo.1942.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.1943.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1944.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1945.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1946.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1947.1">"flex gap-4 items-center flex-col md:flex-row"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1948.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1949.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1950.1">form</span></span><span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1951.1">[</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1952.1">formGroup</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1953.1">]=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1954.1">"portfolioForm"</span></strong></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1955.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1956.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1957.1">"flex-1 w-full</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.1958.1">    md:w-auto"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1959.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1960.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1961.1">section</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1962.1">&gt;</span></span><span class="koboSpan" id="kobo.1963.1">...</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1964.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1965.1">section</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1966.1">&gt;</span></span><span class="koboSpan" id="kobo.1967.1">
    ...
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.1968.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1969.1">section</span></span><span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1970.1">formArrayName</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1971.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1972.1">"projects"</span></strong></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1973.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1974.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1975.1">label</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1976.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1977.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1978.1">"text-sm"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1979.1">&gt;</span></span><span class="koboSpan" id="kobo.1980.1">Projects</span><span class="hljs-tag"><span class="koboSpan" id="kobo.1981.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1982.1">label</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1983.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1984.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.1985.1">fieldset</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.1986.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.1987.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.1988.1">"flex gap-4 mb-4 justify-between"</span></span><span class="hljs-tag"> </span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1989.1">        *</span></span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1990.1">ngFor</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1991.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1992.1">"let projectControl of</span></strong></span>
<span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1993.1">projectsFormArr.controls; trackBy: trackByFn"</span></strong></span>
<span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1994.1">[</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.1995.1">formGroup</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1996.1">]=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.1997.1">"projectControl"</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.1998.1">&gt;</span></strong></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.1999.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2000.1">input</span></span><span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2001.1">formControlName</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2002.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2003.1">"label"</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2004.1"> type="text"</span></strong></span>
<span class="hljs-string"> </span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2005.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2006.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2007.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2008.1">form-control"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2009.1">placeholder</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2010.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2011.1">"Enter label"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2012.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2013.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2014.1">input</span></span><span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2015.1">formControlName</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2016.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2017.1">"ur</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2018.1">l" type="url</span></strong></span><span class="hljs-string"><span class="koboSpan" id="kobo.2019.1">"</span></span>
<span class="hljs-string"> </span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2020.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2021.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2022.1">"form-control"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2023.1">placeholder</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2024.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2025.1">"Enter URL"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2026.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2027.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2028.1">fieldset</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2029.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2030.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2031.1">section</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2032.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2033.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2034.1">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2035.1">&gt;</span></span><span class="koboSpan" id="kobo.2036.1">
  ...
</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2037.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2038.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2039.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2040.1">You’ll notice that the object on the right in the app has a </span><code class="inlineCode"><span class="koboSpan" id="kobo.2041.1">projects</span></code><span class="koboSpan" id="kobo.2042.1"> array now. </span><span class="koboSpan" id="kobo.2042.2">However, we can see no inputs for the projects at the moment. </span><span class="koboSpan" id="kobo.2042.3">That’s because the form array is empty, as shown in the following figure:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2043.1"><img alt="" role="presentation" src="../Images/B18469_08_16.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2044.1">Figure 8.16: reactive FormArray app running on http://localhost:4200</span></p></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="3"><span class="koboSpan" id="kobo.2045.1">We’ll add one form</span><a id="_idIndexMarker562"/><span class="koboSpan" id="kobo.2046.1"> group to the form array </span><a id="_idIndexMarker563"/><span class="koboSpan" id="kobo.2047.1">by default when the app starts. </span><span class="koboSpan" id="kobo.2047.2">To do this, modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2048.1">portfolio-form.component.ts</span></code><span class="koboSpan" id="kobo.2049.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.2050.1">import</span></span><span class="koboSpan" id="kobo.2051.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.2052.1">Component</span></span><span class="koboSpan" id="kobo.2053.1">, </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2054.1">OnInit</span></strong></span><span class="koboSpan" id="kobo.2055.1">, inject } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2056.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2057.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.2058.1">;
...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2059.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2060.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2061.1">PortfolioFormComponent</span></span><span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.2062.1">implements</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2063.1">OnInit</span></strong></span><span class="koboSpan" id="kobo.2064.1"> {
  ...
  </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2065.1">ngOnInit</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2066.1">(): </span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.2067.1">void</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2068.1"> {</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.2069.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2070.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2071.1">addNewProject</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2072.1">();</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2073.1">}</span></strong></span>
<span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2074.1">addNewProject</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2075.1">() {</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.2076.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2077.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.2078.1">projectsFormArr</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2079.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2080.1">push</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2081.1">(</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.2082.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2083.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.2084.1">fb</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2085.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2086.1">group</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2087.1">({</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2088.1">label</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2089.1">: [</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2090.1">''</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2091.1">, </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2092.1">Validators</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2093.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.2094.1">required</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2095.1">],</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2096.1">url</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2097.1">: [</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2098.1">''</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2099.1">, </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2100.1">Validators</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2101.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.2102.1">required</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2103.1">]</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2104.1">})</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2105.1">)</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2106.1">}</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2107.1">...</span></strong></span><span class="koboSpan" id="kobo.2108.1">
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2109.1">If you look at the app now, you should see one set of inputs for the projects, as shown in the following figure:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2110.1"><img alt="" role="presentation" src="../Images/B18469_08_17.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2111.1">Figure 8.17: One set of inputs for projects by default</span></p></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="4"><span class="koboSpan" id="kobo.2112.1">Let’s add a button </span><a id="_idIndexMarker564"/><span class="koboSpan" id="kobo.2113.1">for the user to be able</span><a id="_idIndexMarker565"/><span class="koboSpan" id="kobo.2114.1"> to add more projects. </span><span class="koboSpan" id="kobo.2114.2">We’ll modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2115.1">portfolio-form.component.html</span></code><span class="koboSpan" id="kobo.2116.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.2117.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2118.1">section</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2119.1">formArrayName</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2120.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2121.1">"projects"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2122.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2123.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2124.1">label</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2125.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2126.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2127.1">"text-sm"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2128.1">&gt;</span></span><span class="koboSpan" id="kobo.2129.1">Projects</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2130.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2131.1">label</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2132.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2133.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2134.1">fieldset</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2135.1"> [</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2136.1">formGroup</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2137.1">]=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2138.1">"projectControl"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2139.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2140.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2141.1">"flex</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2142.1">        gap-4 mb-4 justify-between"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2143.1"> *</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2144.1">ngFor</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2145.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2146.1">"let</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2147.1">        projectControl of projectsFormArr.controls;</span></span>
<span class="hljs-string"> </span><span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2148.1">let isLast = last;</span></strong></span><span class="hljs-string"><span class="koboSpan" id="kobo.2149.1"> trackBy: trackByFn"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2150.1">&gt;</span></span><span class="koboSpan" id="kobo.2151.1">
        ...
        </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2152.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2153.1">input</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2154.1">formControlName</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2155.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2156.1">"url"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2157.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2158.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2159.1">"url"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2160.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2161.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2162.1">"form-</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2163.1">          control"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2164.1">placeholder</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2165.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2166.1">"Enter URL"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2167.1">&gt;</span></span>
<span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2168.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2169.1">button</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2170.1">type</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2171.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2172.1">"button"</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2173.1"> [</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2174.1">style.visibility</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2175.1">]=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2176.1">"isLast</span></strong></span>
<span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2177.1">? </span><span class="koboSpan" id="kobo.2177.2">'visible' : 'hidden'"</span></strong></span>
<span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2178.1">(</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2179.1">click</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2180.1">)=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2181.1">"addNewProject()"</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2182.1">&gt;</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2183.1">+</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2184.1">&lt;/</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2185.1">button</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2186.1">&gt;</span></strong></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2187.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2188.1">fieldset</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2189.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2190.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2191.1">section</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2192.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2193.1">With the code above, you should see new project inputs appearing with the click of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2194.1">+</span></code><span class="koboSpan" id="kobo.2195.1"> button.</span></p></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="5"><span class="koboSpan" id="kobo.2196.1">Let’s add our final feature for this recipe, which is showing buttons to remove the project’s input row. </span><span class="koboSpan" id="kobo.2196.2">We’ll first </span><a id="_idIndexMarker566"/><span class="koboSpan" id="kobo.2197.1">add a method in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2198.1">portfolio-form.component.ts</span></code><span class="koboSpan" id="kobo.2199.1"> file</span><a id="_idIndexMarker567"/><span class="koboSpan" id="kobo.2200.1"> that receives the index of the row to be removed as an argument:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2201.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2202.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2203.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2204.1">PortfolioFormComponent</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2205.1">implements</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2206.1">OnInit</span></span><span class="koboSpan" id="kobo.2207.1"> {
  ...
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.2208.1">addNewProject</span></span><span class="koboSpan" id="kobo.2209.1">() {...}
  </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2210.1">removeProject</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2211.1">(</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2212.1">index</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.2213.1">: </span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.2214.1">number</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2215.1">) {</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.2216.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2217.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.2218.1">projectsFormArr</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2219.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2220.1">removeAt</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2221.1">(index);</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2222.1">}</span></strong></span><span class="koboSpan" id="kobo.2223.1">
  ...
</span><span class="koboSpan" id="kobo.2223.2">}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2224.1">Now, we’ll update the template to add the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2225.1">Remove</span></code><span class="koboSpan" id="kobo.2226.1"> button. </span><span class="koboSpan" id="kobo.2226.2">Update the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2227.1">portfolio-form.component.html</span></code><span class="koboSpan" id="kobo.2228.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.2229.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2230.1">section</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2231.1">formArrayName</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2232.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2233.1">"projects"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2234.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2235.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2236.1">label</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2237.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2238.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2239.1">"text-sm"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2240.1">&gt;</span></span><span class="koboSpan" id="kobo.2241.1">Projects</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2242.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2243.1">label</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2244.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2245.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2246.1">fieldset</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2247.1"> [</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2248.1">formGroup</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2249.1">]=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2250.1">"projectControl"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2251.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2252.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2253.1">"flex</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2254.1">        gap-4 mb-4 justify-between"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2255.1"> *</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2256.1">ngFor</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2257.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2258.1">"let</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2259.1">        projectControl of projectsFormArr.controls; let</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2260.1">        isLast = last; </span></span><span class="code-highlight"><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2261.1">let i = index;</span></strong></span><span class="hljs-string"><span class="koboSpan" id="kobo.2262.1"> trackBy: trackByFn"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2263.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2264.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2265.1">input</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2266.1">formControlName</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2267.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2268.1">"label"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2269.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2270.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2271.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2272.1">text"</span></span>
<span class="hljs-string"> </span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2273.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2274.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2275.1">"form-control"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2276.1">placeholder</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2277.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2278.1">"Enter label"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2279.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2280.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2281.1">input</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2282.1">formControlName</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2283.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2284.1">"url"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2285.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2286.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2287.1">"</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2288.1">url"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2289.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2290.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2291.1">"form-</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2292.1">          control"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2293.1">placeholder</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2294.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2295.1">"Enter URL"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2296.1">&gt;</span></span>
<span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2297.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2298.1">button</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2299.1">type</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2300.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2301.1">"button"</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2302.1"> [</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2303.1">hidden</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2304.1">]=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2305.1">"</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2306.1">isLast"</span></strong></span>
<span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2307.1">(</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2308.1">click</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2309.1">)=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2310.1">"removeProject(i)"</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2311.1">&gt;</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2312.1">-</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2313.1">&lt;/</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2314.1">button</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2315.1">&gt;</span></strong></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2316.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2317.1">button</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2318.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2319.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2320.1">"button"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2321.1"> [</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2322.1">style.visibility</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2323.1">]=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2324.1">"isLast ?</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2325.1">          'visible' : 'hidden'"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2326.1"> [</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2327.1">hidden</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2328.1">]=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2329.1">"!isLast"</span></span>
<span class="hljs-string"> </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2330.1"> (</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2331.1">click</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2332.1">)=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2333.1">"addNewProject()"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2334.1">&gt;</span></span><span class="koboSpan" id="kobo.2335.1">+</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2336.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2337.1">button</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2338.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2339.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2340.1">fieldset</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2341.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2342.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2343.1">section</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2344.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2345.1">If you now look at the app, you should be able to add or remove projects to the form as you like, as shown in the following figure:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2346.1"><img alt="" role="presentation" src="../Images/B18469_08_18.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2347.1">Figure 8.18: Final result with form arrays</span></p> </li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.2348.1">Great! </span><span class="koboSpan" id="kobo.2348.2">You now know how to </span><a id="_idIndexMarker568"/><span class="koboSpan" id="kobo.2349.1">work with reactive </span><code class="inlineCode"><span class="koboSpan" id="kobo.2350.1">FormArray</span></code><span class="koboSpan" id="kobo.2351.1">. </span><span class="koboSpan" id="kobo.2351.2">Refer to the next section to understand how it all works.</span></p>
<h2 class="heading-2" id="_idParaDest-284"><span class="koboSpan" id="kobo.2352.1">How it works…</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2353.1">Angular’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.2354.1">FormArray</span></code><span class="koboSpan" id="kobo.2355.1"> is an amazing tool </span><a id="_idIndexMarker569"/><span class="koboSpan" id="kobo.2356.1">built into the reactive Forms in Angular. </span><span class="koboSpan" id="kobo.2356.2">It aggregates all values of each child </span><code class="inlineCode"><span class="koboSpan" id="kobo.2357.1">FormControl</span></code><span class="koboSpan" id="kobo.2358.1"> or </span><code class="inlineCode"><span class="koboSpan" id="kobo.2359.1">FormGroup</span></code><span class="koboSpan" id="kobo.2360.1"> into an array. </span><span class="koboSpan" id="kobo.2360.2">The beauty of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2361.1">FormArray</span></code><span class="koboSpan" id="kobo.2362.1"> is that if any one of the child </span><code class="inlineCode"><span class="koboSpan" id="kobo.2363.1">FormControls</span></code><span class="koboSpan" id="kobo.2364.1"> is invalid, the whole array becomes invalid. </span><span class="koboSpan" id="kobo.2364.2">In this recipe, we start by using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2365.1">FormBuilder</span></code><span class="koboSpan" id="kobo.2366.1"> from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2367.1">ReactiveFormsModule</span></code><span class="koboSpan" id="kobo.2368.1"> in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2369.1">PortfolioFormComponent</span></code><span class="koboSpan" id="kobo.2370.1"> class. </span><span class="koboSpan" id="kobo.2370.2">We initialize it with an empty </span><code class="inlineCode"><span class="koboSpan" id="kobo.2371.1">FormArray</span></code><span class="koboSpan" id="kobo.2372.1"> and then push one </span><code class="inlineCode"><span class="koboSpan" id="kobo.2373.1">FormGroup</span></code><span class="koboSpan" id="kobo.2374.1"> to it when the component mounts (using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2375.1">ngOnInit</span></code><strong class="keyWord"> </strong><span class="koboSpan" id="kobo.2376.1">method). </span><span class="koboSpan" id="kobo.2376.2">This is so we can see one set of form inputs for the projects. </span><span class="koboSpan" id="kobo.2376.3">Note that we use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2377.1">addNewProject</span></code><span class="koboSpan" id="kobo.2378.1"> method for this. </span><span class="koboSpan" id="kobo.2378.2">Also note that we use a </span><code class="inlineCode"><span class="koboSpan" id="kobo.2379.1">getter</span></code><span class="koboSpan" id="kobo.2380.1"> function, named </span><code class="inlineCode"><span class="koboSpan" id="kobo.2381.1">projectsFormArr</span></code><span class="koboSpan" id="kobo.2382.1">, so that we can easily access the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2383.1">FormArray</span></code><span class="koboSpan" id="kobo.2384.1"> to be able to loop over it, add Form Groups to it, and remove the desired </span><code class="inlineCode"><span class="koboSpan" id="kobo.2385.1">FormGroups</span></code><span class="koboSpan" id="kobo.2386.1"> from it when needed. </span><span class="koboSpan" id="kobo.2386.2">We then loop over the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2387.1">projectsFormArr.controls</span></code><span class="koboSpan" id="kobo.2388.1"> array so that we can display the inputs via the HTML template, using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2389.1">*ngFor</span></code><span class="koboSpan" id="kobo.2390.1"> directive.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2391.1">Then, we modify the template to add the + button so that we can add more projects to the form array. </span><span class="koboSpan" id="kobo.2391.2">Note the statement in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2392.1">*ngFor</span></code><span class="koboSpan" id="kobo.2393.1"> has </span><code class="inlineCode"><span class="koboSpan" id="kobo.2394.1">let isLast = last</span></code><span class="koboSpan" id="kobo.2395.1">. </span><span class="koboSpan" id="kobo.2395.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.2396.1">*ngFor</span></code><span class="koboSpan" id="kobo.2397.1"> directive provides us with the first and last variables automatically, so we can use them in our template. </span><span class="koboSpan" id="kobo.2397.2">This statement creates a variable named </span><code class="inlineCode"><span class="koboSpan" id="kobo.2398.1">isLast</span></code><span class="koboSpan" id="kobo.2399.1"> for us, and it assigns the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2400.1">last</span></code><span class="koboSpan" id="kobo.2401.1"> variable provided by the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2402.1">*ngFor</span></code><span class="koboSpan" id="kobo.2403.1"> directive (which is a Boolean) to it. </span><span class="koboSpan" id="kobo.2403.2">This is so we can show the + button only on the last row instead of on every row.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2404.1">Finally, we add the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2405.1">remove</span></code><span class="koboSpan" id="kobo.2406.1"> button to each row except for the last one so we can remove the respective </span><code class="inlineCode"><span class="koboSpan" id="kobo.2407.1">FormGroup</span></code><span class="koboSpan" id="kobo.2408.1"> from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2409.1">FormArray</span></code><span class="koboSpan" id="kobo.2410.1">. </span><span class="koboSpan" id="kobo.2410.2">Note that here we also add </span><code class="inlineCode"><span class="koboSpan" id="kobo.2411.1">let i = index</span></code><span class="koboSpan" id="kobo.2412.1"> to the template in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2413.1">*ngFor</span></code><span class="koboSpan" id="kobo.2414.1"> directive. </span><span class="koboSpan" id="kobo.2414.2">This is because our </span><code class="inlineCode"><span class="koboSpan" id="kobo.2415.1">removeProject</span></code><span class="koboSpan" id="kobo.2416.1"> method in the TypeScript file expects the index of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2417.1">FormGroup</span></code><span class="koboSpan" id="kobo.2418.1"> in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2419.1">FormArray</span></code><span class="koboSpan" id="kobo.2420.1"> to be passed in it when it is called. </span><span class="koboSpan" id="kobo.2420.2">Hence, we’re able to get the index for each </span><code class="inlineCode"><span class="koboSpan" id="kobo.2421.1">FormGroup</span></code><span class="koboSpan" id="kobo.2422.1"> from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2423.1">*ngFor</span></code><span class="koboSpan" id="kobo.2424.1"> directive and can pass the index to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2425.1">removeProject</span></code><span class="koboSpan" id="kobo.2426.1"> method. </span><span class="koboSpan" id="kobo.2426.2">We use </span><code class="inlineCode"><span class="koboSpan" id="kobo.2427.1">[hidden]="isLast"</span></code><span class="koboSpan" id="kobo.2428.1"> on each </span><code class="inlineCode"><span class="koboSpan" id="kobo.2429.1">remove</span></code> <a id="_idIndexMarker570"/><span class="koboSpan" id="kobo.2430.1">button so that it is hidden onthe last row only. </span><span class="koboSpan" id="kobo.2430.2">This is because we show the + button </span><a id="_idIndexMarker571"/><span class="koboSpan" id="kobo.2431.1">on the last row and we need to have at least one empty row for the projects.</span></p>
<h2 class="heading-2" id="_idParaDest-285"><span class="koboSpan" id="kobo.2432.1">See also</span></h2>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.2433.1">Angular </span><a id="_idIndexMarker572"/><code class="inlineCode"><span class="koboSpan" id="kobo.2434.1">FormArray</span></code><span class="koboSpan" id="kobo.2435.1">: </span><a href="https://angular.io/api/forms/FormArray"><span class="url"><span class="koboSpan" id="kobo.2436.1">https://angular.io/api/forms/FormArray</span></span></a></li>
</ul>
<h1 class="heading-1" id="_idParaDest-286"><span class="koboSpan" id="kobo.2437.1">Writing your own custom form control using ControlValueAccessor</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.2438.1">Angular forms are great. </span><span class="koboSpan" id="kobo.2438.2">While </span><a id="_idIndexMarker573"/><span class="koboSpan" id="kobo.2439.1">they support the default HTML tags like </span><code class="inlineCode"><span class="koboSpan" id="kobo.2440.1">input</span></code><span class="koboSpan" id="kobo.2441.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.2442.1">textarea</span></code><span class="koboSpan" id="kobo.2443.1">, etc., sometimes, you might want to define your own components that take a value from the user. </span><span class="koboSpan" id="kobo.2443.2">What if your components could work</span><a id="_idIndexMarker574"/><span class="koboSpan" id="kobo.2444.1"> seamlessly with Angular forms, i.e., using f</span><code class="inlineCode"><span class="koboSpan" id="kobo.2445.1">ormControlName</span></code><span class="koboSpan" id="kobo.2446.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.2447.1">ngModel</span></code><span class="koboSpan" id="kobo.2448.1">, and so on? </span><span class="koboSpan" id="kobo.2448.2">That would be cool, right?</span></p>
<p class="normal"><span class="koboSpan" id="kobo.2449.1">In this recipe, you’ll learn how to create a component with your own custom form control using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2450.1">ControlValueAccessor</span></code><span class="koboSpan" id="kobo.2451.1"> API, allowing you to use your component with both template-driven forms and reactive forms.</span></p>
<h2 class="heading-2" id="_idParaDest-287"><span class="koboSpan" id="kobo.2452.1">Getting ready</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2453.1">The app that we are going to work with resides in </span><code class="inlineCode"><span class="koboSpan" id="kobo.2454.1">start/apps/chapter08/ng-form-cva</span></code><span class="koboSpan" id="kobo.2455.1"> inside the cloned repository:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.2456.1">Open the code repository in your code editor.</span></li>
<li class="numberedList"><span class="koboSpan" id="kobo.2457.1">Open the terminal, navigate to the code repository directory, and run the following command to serve the project:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2458.1">npm run serve ng-form-cva
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2459.1">This should open the app in a new browser tab, and you should see the following:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2460.1"><img alt="" role="presentation" src="../Images/B18469_08_19.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2461.1">Figure 8.19: Custom form control app running on http://localhost:4200</span></p></li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.2462.1">Now that we have the </span><a id="_idIndexMarker575"/><span class="koboSpan" id="kobo.2463.1">app running locally, let’s see the steps involved in this recipe in the next section.</span></p>
<h2 class="heading-2" id="_idParaDest-288"><span class="koboSpan" id="kobo.2464.1">How to do it…</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.2465.1">We have a simple Angular app. </span><span class="koboSpan" id="kobo.2465.2">It has</span><a id="_idIndexMarker576"/><span class="koboSpan" id="kobo.2466.1"> two inputs and a </span><strong class="screenText"><span class="koboSpan" id="kobo.2467.1">Submit</span></strong><span class="koboSpan" id="kobo.2468.1"> button. </span><span class="koboSpan" id="kobo.2468.2">The inputs are for a review, and they ask the user to provide a value for the rating of this imaginary item and any comments the user wants to provide. </span><span class="koboSpan" id="kobo.2468.3">We’ll convert the rating input into a custom </span><code class="inlineCode"><span class="koboSpan" id="kobo.2469.1">FormControl</span></code><span class="koboSpan" id="kobo.2470.1"> using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2471.1">ControlValueAccessor</span></code><span class="koboSpan" id="kobo.2472.1"> API. </span><span class="koboSpan" id="kobo.2472.2">Let’s get started:</span></p>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="1"><span class="koboSpan" id="kobo.2473.1">Let’s create a component for our custom </span><code class="inlineCode"><span class="koboSpan" id="kobo.2474.1">FormControl</span></code><span class="koboSpan" id="kobo.2475.1"> Open the terminal in the project root and run the following command and select the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2476.1">@nx/angular:component schematics</span></code><span class="koboSpan" id="kobo.2477.1"> and “As provided” when asked:
        </span><pre class="programlisting con"><code class="hljs-con"><span class="koboSpan" id="kobo.2478.1">cd start &amp;&amp; nx g c rating --directory apps/chapter08/ng-form-cva/src/app/components/rating
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2479.1">We’ll now create the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2480.1">star</span></code><span class="koboSpan" id="kobo.2481.1"> UI for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2482.1">rating</span></code><span class="koboSpan" id="kobo.2483.1"> component. </span><span class="koboSpan" id="kobo.2483.2">Modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2484.1">rating.component.html</span></code><span class="koboSpan" id="kobo.2485.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.2486.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2487.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2488.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2489.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2490.1">"rating"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2491.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2492.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2493.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2494.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2495.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2496.1">"rating__star"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2497.1"> [</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2498.1">ngClass</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2499.1">]=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2500.1">"{</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2501.1">      'rating__star--active':</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2502.1">        (!isMouseOver &amp;&amp; value &gt;= star) ||</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2503.1">        (isMouseOver &amp;&amp; hoveredRating &gt;= star),</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2504.1">        '!cursor-default': disabled</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2505.1">    }"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2506.1"> (</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2507.1">mouseenter</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2508.1">)=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2509.1">"onRatingMouseEnter(star)"</span></span>
<span class="hljs-string"> </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2510.1"> (</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2511.1">mouseleave</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2512.1">)=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2513.1">"onRatingMouseLeave()"</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2514.1">         (</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2515.1">click</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2516.1">)=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2517.1">"selectRating(star)"</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2518.1">    *</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2519.1">ngFor</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2520.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2521.1">"let star of [1, 2, 3, 4, 5]; let i = index"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2522.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2523.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2524.1">span</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2525.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2526.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2527.1">"material-symbols-outlined"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2528.1">&gt;</span></span><span class="koboSpan" id="kobo.2529.1">
      star
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2530.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2531.1">span</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2532.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2533.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2534.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2535.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2536.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2537.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2538.1">&gt;</span></span>
</code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2539.1">Add the styles for </span><a id="_idIndexMarker577"/><span class="koboSpan" id="kobo.2540.1">the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2541.1">rating</span></code><span class="koboSpan" id="kobo.2542.1"> component to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2543.1">rating.component.scss</span></code><span class="koboSpan" id="kobo.2544.1"> file as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-selector-class"><span class="koboSpan" id="kobo.2545.1">.rating</span></span><span class="koboSpan" id="kobo.2546.1"> {
  </span><span class="hljs-attribute"><span class="koboSpan" id="kobo.2547.1">display</span></span><span class="koboSpan" id="kobo.2548.1">: flex;
  </span><span class="hljs-attribute"><span class="koboSpan" id="kobo.2549.1">margin-bottom</span></span><span class="koboSpan" id="kobo.2550.1">: </span><span class="hljs-number"><span class="koboSpan" id="kobo.2551.1">10px</span></span><span class="koboSpan" id="kobo.2552.1">;
  &amp;__star {
    </span><span class="hljs-attribute"><span class="koboSpan" id="kobo.2553.1">cursor</span></span><span class="koboSpan" id="kobo.2554.1">: pointer;
    </span><span class="hljs-attribute"><span class="koboSpan" id="kobo.2555.1">color</span></span><span class="koboSpan" id="kobo.2556.1">: grey;
    </span><span class="hljs-attribute"><span class="koboSpan" id="kobo.2557.1">padding</span></span><span class="koboSpan" id="kobo.2558.1">: </span><span class="hljs-number"><span class="koboSpan" id="kobo.2559.1">0</span></span> <span class="hljs-number"><span class="koboSpan" id="kobo.2560.1">6px</span></span><span class="koboSpan" id="kobo.2561.1">;
    &amp;</span><span class="hljs-selector-pseudo"><span class="koboSpan" id="kobo.2562.1">:first-child</span></span><span class="koboSpan" id="kobo.2563.1"> {
      </span><span class="hljs-attribute"><span class="koboSpan" id="kobo.2564.1">padding-left</span></span><span class="koboSpan" id="kobo.2565.1">: </span><span class="hljs-number"><span class="koboSpan" id="kobo.2566.1">0</span></span><span class="koboSpan" id="kobo.2567.1">;
    }
    &amp;</span><span class="hljs-selector-pseudo"><span class="koboSpan" id="kobo.2568.1">:last-child</span></span><span class="koboSpan" id="kobo.2569.1"> {
      </span><span class="hljs-attribute"><span class="koboSpan" id="kobo.2570.1">padding-right</span></span><span class="koboSpan" id="kobo.2571.1">: </span><span class="hljs-number"><span class="koboSpan" id="kobo.2572.1">0</span></span><span class="koboSpan" id="kobo.2573.1">;
    }
    &amp;</span><span class="hljs-attr"><span class="koboSpan" id="kobo.2574.1">--active</span></span><span class="koboSpan" id="kobo.2575.1"> {
      </span><span class="hljs-attribute"><span class="koboSpan" id="kobo.2576.1">color</span></span><span class="koboSpan" id="kobo.2577.1">: orange;
    }
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2578.1">We also need to modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2579.1">RatingComponent</span></code><span class="koboSpan" id="kobo.2580.1"> class to</span><a id="_idIndexMarker578"/><span class="koboSpan" id="kobo.2581.1"> introduce the necessary methods and properties. </span><span class="koboSpan" id="kobo.2581.2">Let’s modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2582.1">rating.component.ts</span></code><span class="koboSpan" id="kobo.2583.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-comment"><span class="koboSpan" id="kobo.2584.1">/* eslint-disable @typescript-eslint/no-empty-function */</span></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.2585.1">import</span></span><span class="koboSpan" id="kobo.2586.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.2587.1">CommonModule</span></span><span class="koboSpan" id="kobo.2588.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2589.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2590.1">'@angular/common'</span></span><span class="koboSpan" id="kobo.2591.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2592.1">import</span></span><span class="koboSpan" id="kobo.2593.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.2594.1">Component</span></span><span class="koboSpan" id="kobo.2595.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2596.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2597.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.2598.1">;
</span><span class="hljs-meta"><span class="koboSpan" id="kobo.2599.1">@Component</span></span><span class="koboSpan" id="kobo.2600.1">({
  ...
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2601.1">standalone</span></span><span class="koboSpan" id="kobo.2602.1">: </span><span class="hljs-literal"><span class="koboSpan" id="kobo.2603.1">true</span></span><span class="koboSpan" id="kobo.2604.1">,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2605.1">imports</span></span><span class="koboSpan" id="kobo.2606.1">: [</span><span class="hljs-title"><span class="koboSpan" id="kobo.2607.1">CommonModule</span></span><span class="koboSpan" id="kobo.2608.1">]
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2609.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2610.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2611.1">RatingComponent</span></span><span class="koboSpan" id="kobo.2612.1"> {
  value = </span><span class="hljs-number"><span class="koboSpan" id="kobo.2613.1">2</span></span><span class="koboSpan" id="kobo.2614.1">;
  hoveredRating = </span><span class="hljs-number"><span class="koboSpan" id="kobo.2615.1">2</span></span><span class="koboSpan" id="kobo.2616.1">;
  isMouseOver = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.2617.1">false</span></span><span class="koboSpan" id="kobo.2618.1">;
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.2619.1">onRatingMouseEnter</span></span><span class="koboSpan" id="kobo.2620.1">(</span><span class="hljs-attr"><span class="koboSpan" id="kobo.2621.1">rating</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2622.1">: </span></span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2623.1">number</span></span><span class="koboSpan" id="kobo.2624.1">) {
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.2625.1">this</span></span><span class="koboSpan" id="kobo.2626.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.2627.1">hoveredRating</span></span><span class="koboSpan" id="kobo.2628.1"> = rating;
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.2629.1">this</span></span><span class="koboSpan" id="kobo.2630.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.2631.1">isMouseOver</span></span><span class="koboSpan" id="kobo.2632.1"> = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.2633.1">true</span></span><span class="koboSpan" id="kobo.2634.1">;
  }
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.2635.1">onRatingMouseLeave</span></span><span class="koboSpan" id="kobo.2636.1">() {
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.2637.1">this</span></span><span class="koboSpan" id="kobo.2638.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.2639.1">hoveredRating</span></span><span class="koboSpan" id="kobo.2640.1"> = </span><span class="hljs-number"><span class="koboSpan" id="kobo.2641.1">0</span></span><span class="koboSpan" id="kobo.2642.1">;
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.2643.1">this</span></span><span class="koboSpan" id="kobo.2644.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.2645.1">isMouseOver</span></span><span class="koboSpan" id="kobo.2646.1"> = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.2647.1">false</span></span><span class="koboSpan" id="kobo.2648.1">;
  }
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.2649.1">selectRating</span></span><span class="koboSpan" id="kobo.2650.1">(</span><span class="hljs-attr"><span class="koboSpan" id="kobo.2651.1">rating</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2652.1">: </span></span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2653.1">number</span></span><span class="koboSpan" id="kobo.2654.1">) {
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.2655.1">this</span></span><span class="koboSpan" id="kobo.2656.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.2657.1">value</span></span><span class="koboSpan" id="kobo.2658.1"> = rating;
  }
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2659.1">Let’s import the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2660.1">RatingComponent</span></code><span class="koboSpan" id="kobo.2661.1"> class in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2662.1">HomeComponent</span></code><span class="koboSpan" id="kobo.2663.1"> class </span><a id="_idIndexMarker579"/><span class="koboSpan" id="kobo.2664.1">because </span><code class="inlineCode"><span class="koboSpan" id="kobo.2665.1">RatingComponent</span></code><span class="koboSpan" id="kobo.2666.1"> is a </span><code class="inlineCode"><span class="koboSpan" id="kobo.2667.1">standalone</span></code><span class="koboSpan" id="kobo.2668.1"> component. </span><span class="koboSpan" id="kobo.2668.2">Update</span><a id="_idIndexMarker580"/><span class="koboSpan" id="kobo.2669.1"> the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2670.1">home.component.ts</span></code><span class="koboSpan" id="kobo.2671.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2672.1">...
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.2673.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2674.1"> { </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2675.1">RatingComponent</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2676.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.2677.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2678.1">'../components/rating/rating.component'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2679.1">;</span></strong></span>
<span class="hljs-meta"><span class="koboSpan" id="kobo.2680.1">@Component</span></span><span class="koboSpan" id="kobo.2681.1">({
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2682.1">selector</span></span><span class="koboSpan" id="kobo.2683.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.2684.1">'app-home'</span></span><span class="koboSpan" id="kobo.2685.1">,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2686.1">templateUrl</span></span><span class="koboSpan" id="kobo.2687.1">: </span><span class="hljs-string"><span class="koboSpan" id="kobo.2688.1">'./home.component.html'</span></span><span class="koboSpan" id="kobo.2689.1">,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2690.1">styleUrls</span></span><span class="koboSpan" id="kobo.2691.1">: [</span><span class="hljs-string"><span class="koboSpan" id="kobo.2692.1">'./home.component.scss'</span></span><span class="koboSpan" id="kobo.2693.1">],
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2694.1">standalone</span></span><span class="koboSpan" id="kobo.2695.1">: </span><span class="hljs-literal"><span class="koboSpan" id="kobo.2696.1">true</span></span><span class="koboSpan" id="kobo.2697.1">,
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2698.1">imports</span></span><span class="koboSpan" id="kobo.2699.1">: [</span><span class="hljs-title"><span class="koboSpan" id="kobo.2700.1">CommonModule</span></span><span class="koboSpan" id="kobo.2701.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.2702.1">ReactiveFormsModule</span></span><span class="koboSpan" id="kobo.2703.1">,
</span><span class="hljs-attr"> </span> <span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2704.1">RatingComponent</span></strong></span><span class="koboSpan" id="kobo.2705.1">]
})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2706.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2707.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2708.1">HomeComponent</span></span><span class="koboSpan" id="kobo.2709.1"> {
  ...
</span><span class="koboSpan" id="kobo.2709.2">}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2710.1">Now, we need to use </span><a id="_idIndexMarker581"/><span class="koboSpan" id="kobo.2711.1">this </span><code class="inlineCode"><span class="koboSpan" id="kobo.2712.1">rating</span></code><span class="koboSpan" id="kobo.2713.1"> component instead of the input that we already have in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2714.1">home.component.html</span></code><span class="koboSpan" id="kobo.2715.1"> file. </span><span class="koboSpan" id="kobo.2715.2">Modify the file as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.2716.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2717.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2718.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2719.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2720.1">"home"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2721.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2722.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2723.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2724.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2725.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2726.1">"review-container"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2727.1">&gt;</span></span><span class="koboSpan" id="kobo.2728.1">
    ...
    </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2729.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2730.1">form</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2731.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2732.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2733.1">"input-container"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2734.1"> [</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2735.1">formGroup</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2736.1">]=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2737.1">"reviewForm"</span></span>
<span class="hljs-string"> </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2738.1"> (</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2739.1">ngSubmit</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2740.1">)=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2741.1">"submitReview(reviewForm)"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2742.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2743.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2744.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2745.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2746.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2747.1">"mb-3"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2748.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2749.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2750.1">label</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2751.1">for</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2752.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2753.1">"ratingInput"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2754.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2755.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2756.1">"form-</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2757.1">          label"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2758.1">&gt;</span></span><span class="koboSpan" id="kobo.2759.1">Rating</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2760.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2761.1">label</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2762.1">&gt;</span></span>
<span class="code-highlight"><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2763.1">&lt;</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2764.1">app-rating</span></strong><strong class="hljs-tag-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2765.1">formControlName</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2766.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2767.1">"rating"</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2768.1">&gt;&lt;/</span></strong><strong class="hljs-name-slc"><span class="koboSpan" id="kobo.2769.1">app-rating</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.2770.1">&gt;</span></strong></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2771.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2772.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2773.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2774.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2775.1">div</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2776.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2777.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2778.1">"mb-3"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2779.1">&gt;</span></span><span class="koboSpan" id="kobo.2780.1">
        ...
      </span><span class="hljs-tag"><span class="koboSpan" id="kobo.2781.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2782.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2783.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2784.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2785.1">button</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2786.1">id</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2787.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2788.1">"submitBtn"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2789.1"> [</span></span><span class="hljs-attr"><span class="koboSpan" id="kobo.2790.1">disabled</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2791.1">]=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2792.1">"reviewForm.</span></span>
<span class="hljs-string"><span class="koboSpan" id="kobo.2793.1">        invalid"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2794.1">class</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2795.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2796.1">"btn btn-dark"</span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="koboSpan" id="kobo.2797.1">type</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2798.1">=</span></span><span class="hljs-string"><span class="koboSpan" id="kobo.2799.1">"submit"</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2800.1">&gt;</span></span>
<span class="hljs-tag"> </span><span class="koboSpan" id="kobo.2801.1">      Submit</span><span class="hljs-tag"><span class="koboSpan" id="kobo.2802.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2803.1">button</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2804.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2805.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2806.1">form</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2807.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2808.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2809.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2810.1">&gt;</span></span>
<span class="hljs-tag"><span class="koboSpan" id="kobo.2811.1">&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.2812.1">div</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.2813.1">&gt;</span></span>
</code></pre>
<p class="normal"><span class="koboSpan" id="kobo.2814.1">If you refresh the app</span><a id="_idIndexMarker582"/><span class="koboSpan" id="kobo.2815.1"> now and hover over the stars, you can see the color change. </span><span class="koboSpan" id="kobo.2815.2">The selected rating is also highlighted as follows:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.2816.1"><img alt="" role="presentation" src="../Images/B18469_08_20.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.2817.1">Figure 8.20: Rating component with hovered stars</span></p></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="7"><span class="koboSpan" id="kobo.2818.1">Let’s now implement </span><a id="_idIndexMarker583"/><span class="koboSpan" id="kobo.2819.1">the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2820.1">ControlValueAccessor</span></code><span class="koboSpan" id="kobo.2821.1"> interface for our </span><code class="inlineCode"><span class="koboSpan" id="kobo.2822.1">rating</span></code><span class="koboSpan" id="kobo.2823.1"> component. </span><span class="koboSpan" id="kobo.2823.2">It requires a couple of methods </span><a id="_idIndexMarker584"/><span class="koboSpan" id="kobo.2824.1">to be implemented. </span><span class="koboSpan" id="kobo.2824.2">Modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2825.1">rating.component.ts</span></code><span class="koboSpan" id="kobo.2826.1"> file, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="code-highlight"><strong class="hljs-comment-slc"><span class="koboSpan" id="kobo.2827.1">/* eslint-disable @typescript-eslint/no-empty-function */</span></strong></span>
<span class="hljs-keyword"><span class="koboSpan" id="kobo.2828.1">import</span></span><span class="koboSpan" id="kobo.2829.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.2830.1">CommonModule</span></span><span class="koboSpan" id="kobo.2831.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2832.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2833.1">'@angular/common'</span></span><span class="koboSpan" id="kobo.2834.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2835.1">import</span></span><span class="koboSpan" id="kobo.2836.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.2837.1">Component</span></span><span class="koboSpan" id="kobo.2838.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2839.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2840.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.2841.1">;
</span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.2842.1">import</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2843.1"> { </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2844.1">ControlValueAccessor</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2845.1"> } </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.2846.1">from</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.2847.1">'@angular/forms'</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2848.1">;</span></strong></span>
<span class="hljs-meta"><span class="koboSpan" id="kobo.2849.1">@Component</span></span><span class="koboSpan" id="kobo.2850.1">({...})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2851.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2852.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2853.1">RatingComponent</span></span><span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.2854.1">implements</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2855.1">ControlValueAccessor</span></strong></span><span class="koboSpan" id="kobo.2856.1"> {
  ...
  </span><span class="koboSpan" id="kobo.2856.2">isMouseOver = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.2857.1">false</span></span><span class="koboSpan" id="kobo.2858.1">;
  </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2859.1">onChange</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2860.1">: </span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.2861.1">any</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2862.1"> = </span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.2863.1">() =&gt;</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2864.1"> { };</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2865.1">onTouched</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2866.1">: </span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.2867.1">any</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2868.1"> = </span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.2869.1">() =&gt;</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2870.1"> { };</span></strong></span><span class="koboSpan" id="kobo.2871.1">
  ...
  </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2872.1">registerOnChange</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2873.1">(</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2874.1">fn</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.2875.1">: </span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.2876.1">any</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2877.1">){</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.2878.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2879.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.2880.1">onChange</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2881.1"> = fn;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2882.1">}</span></strong></span>
<span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2883.1">registerOnTouched</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2884.1">(</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2885.1">fn</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.2886.1">: </span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.2887.1">any</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2888.1">) {</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.2889.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2890.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.2891.1">onTouched</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2892.1"> = fn;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2893.1">}</span></strong></span><span class="koboSpan" id="kobo.2894.1">
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2895.1">We’ll now add the required methods to disable the input when required and to set the value of the form control – in other words, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2896.1">setDisabledState</span></code><span class="koboSpan" id="kobo.2897.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.2898.1">writeValue</span></code><span class="koboSpan" id="kobo.2899.1"> methods. </span><span class="koboSpan" id="kobo.2899.2">We’ll also add the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2900.1">disabled</span></code><span class="koboSpan" id="kobo.2901.1"> property to our </span><code class="inlineCode"><span class="koboSpan" id="kobo.2902.1">RatingComponent</span></code><span class="koboSpan" id="kobo.2903.1"> class, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2904.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2905.1">import</span></span><span class="koboSpan" id="kobo.2906.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.2907.1">Component</span></span><span class="koboSpan" id="kobo.2908.1">, </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2909.1">Input</span></strong></span><span class="koboSpan" id="kobo.2910.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2911.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.2912.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.2913.1">;
...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2914.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2915.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2916.1">RatingComponent</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2917.1">implements</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2918.1">ControlValueAccessor</span></span><span class="koboSpan" id="kobo.2919.1"> {
  ...
  </span><span class="koboSpan" id="kobo.2919.2">isMouseOver = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.2920.1">false</span></span><span class="koboSpan" id="kobo.2921.1">;
  </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2922.1">disabled = </span></strong><strong class="hljs-literal-slc"><span class="koboSpan" id="kobo.2923.1">false</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2924.1">;</span></strong></span><span class="koboSpan" id="kobo.2925.1">
  ...
  </span><span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2926.1">setDisabledState</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2927.1">(</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2928.1">isDisabled</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2929.1">: </span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.2930.1">boolean</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2931.1">): </span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.2932.1">void</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2933.1"> {</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.2934.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2935.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.2936.1">disabled</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2937.1"> = isDisabled;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2938.1">}</span></strong></span>
<span class="code-highlight"><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.2939.1">writeValue</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2940.1">(</span></strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.2941.1">value</span></strong><strong class="hljs-params-slc"><span class="koboSpan" id="kobo.2942.1">: </span></strong><strong class="hljs-built_in-slc"><span class="koboSpan" id="kobo.2943.1">number</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2944.1">) {</span></strong></span>
<span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.2945.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2946.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.2947.1">value</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2948.1"> = value;</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.2949.1">}</span></strong></span><span class="koboSpan" id="kobo.2950.1">
}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.2951.1">We need to use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2952.1">disabled</span></code><span class="koboSpan" id="kobo.2953.1"> property to </span><a id="_idIndexMarker585"/><span class="koboSpan" id="kobo.2954.1">prevent any UI changes when it is </span><code class="inlineCode"><span class="koboSpan" id="kobo.2955.1">true</span></code><span class="koboSpan" id="kobo.2956.1">. </span><span class="koboSpan" id="kobo.2956.2">The value </span><a id="_idIndexMarker586"/><span class="koboSpan" id="kobo.2957.1">of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2958.1">value</span></code><span class="koboSpan" id="kobo.2959.1"> variable should not be updated either. </span><span class="koboSpan" id="kobo.2959.2">Modify the </span><code class="inlineCode"><span class="koboSpan" id="kobo.2960.1">rating.component.ts</span></code><span class="koboSpan" id="kobo.2961.1"> file to do so, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.2962.1">...
</span><span class="hljs-meta"><span class="koboSpan" id="kobo.2963.1">@Component</span></span><span class="koboSpan" id="kobo.2964.1">({...})
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.2965.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2966.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2967.1">RatingComponent</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.2968.1">implements</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.2969.1">OnInit</span></span><span class="koboSpan" id="kobo.2970.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.2971.1">ControlValueAccessor</span></span><span class="koboSpan" id="kobo.2972.1"> {
  ...
  </span><span class="koboSpan" id="kobo.2972.2">isMouseOver = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.2973.1">false</span></span><span class="koboSpan" id="kobo.2974.1">;
  disabled = </span><span class="code-highlight"><strong class="hljs-literal-slc"><span class="koboSpan" id="kobo.2975.1">true</span></strong></span><span class="koboSpan" id="kobo.2976.1">;
  ...
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.2977.1">onRatingMouseEnter</span></span><span class="koboSpan" id="kobo.2978.1">(</span><span class="hljs-attr"><span class="koboSpan" id="kobo.2979.1">rating</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.2980.1">: </span></span><span class="hljs-built_in"><span class="koboSpan" id="kobo.2981.1">number</span></span><span class="koboSpan" id="kobo.2982.1">) {
    </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.2983.1">if</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2984.1"> (</span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.2985.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2986.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.2987.1">disabled</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2988.1">) </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.2989.1">return</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.2990.1">;</span></strong></span>
<span class="hljs-variable"><span class="koboSpan" id="kobo.2991.1">this</span></span><span class="koboSpan" id="kobo.2992.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.2993.1">hoveredRating</span></span><span class="koboSpan" id="kobo.2994.1"> = rating;
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.2995.1">this</span></span><span class="koboSpan" id="kobo.2996.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.2997.1">isMouseOver</span></span><span class="koboSpan" id="kobo.2998.1"> = </span><span class="hljs-literal"><span class="koboSpan" id="kobo.2999.1">true</span></span><span class="koboSpan" id="kobo.3000.1">;
  }
  ...
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.3001.1">selectRating</span></span><span class="koboSpan" id="kobo.3002.1">(</span><span class="hljs-attr"><span class="koboSpan" id="kobo.3003.1">rating</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.3004.1">: </span></span><span class="hljs-built_in"><span class="koboSpan" id="kobo.3005.1">number</span></span><span class="koboSpan" id="kobo.3006.1">) {
    </span><span class="code-highlight"><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.3007.1">if</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3008.1"> (</span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.3009.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3010.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.3011.1">disabled</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3012.1">) </span></strong><strong class="hljs-keyword-slc"><span class="koboSpan" id="kobo.3013.1">return</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3014.1">;</span></strong></span>
<span class="hljs-variable"><span class="koboSpan" id="kobo.3015.1">this</span></span><span class="koboSpan" id="kobo.3016.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.3017.1">value</span></span><span class="koboSpan" id="kobo.3018.1"> = rating;
  }
  ...
</span><span class="koboSpan" id="kobo.3018.2">}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.3019.1">With the above change, you’ll notice that hovering over the stars doesn’t do anything now because </span><a id="_idIndexMarker587"/><span class="koboSpan" id="kobo.3020.1">of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3021.1">disabled</span></code><span class="koboSpan" id="kobo.3022.1"> property being set to </span><code class="inlineCode"><span class="koboSpan" id="kobo.3023.1">true</span></code><span class="koboSpan" id="kobo.3024.1">.</span></p></li>
</ol>
<ol class="numberedList" style="list-style-type: decimal;">
<li class="numberedList" value="10"><span class="koboSpan" id="kobo.3025.1">Let’s make sure that we</span><a id="_idIndexMarker588"/><span class="koboSpan" id="kobo.3026.1"> send the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3027.1">value</span></code><span class="koboSpan" id="kobo.3028.1"> variable to </span><code class="inlineCode"><span class="koboSpan" id="kobo.3029.1">ControlValueAccessor</span></code><span class="koboSpan" id="kobo.3030.1"> because that’s what we want to access later. </span><span class="koboSpan" id="kobo.3030.2">Also, let’s set the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3031.1">disabled</span></code><span class="koboSpan" id="kobo.3032.1"> property back to </span><code class="inlineCode"><span class="koboSpan" id="kobo.3033.1">false</span></code><span class="koboSpan" id="kobo.3034.1">. </span><span class="koboSpan" id="kobo.3034.2">Update the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3035.1">selectRating</span></code><span class="koboSpan" id="kobo.3036.1"> method in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3037.1">RatingComponent</span></code><span class="koboSpan" id="kobo.3038.1"> class, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.3039.1">...
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3040.1">export</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.3041.1">class</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.3042.1">RatingComponent</span></span> <span class="hljs-keyword"><span class="koboSpan" id="kobo.3043.1">implements</span></span> <span class="hljs-title"><span class="koboSpan" id="kobo.3044.1">ControlValueAccessor</span></span><span class="koboSpan" id="kobo.3045.1"> {
  ...
  </span><span class="hljs-meta"><span class="koboSpan" id="kobo.3046.1">@Input</span></span><span class="koboSpan" id="kobo.3047.1">() disabled = </span><span class="code-highlight"><strong class="hljs-literal-slc"><span class="koboSpan" id="kobo.3048.1">false</span></strong></span><span class="koboSpan" id="kobo.3049.1">;
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.3050.1">constructor</span></span><span class="koboSpan" id="kobo.3051.1">() { }
  ...
  </span><span class="hljs-title"><span class="koboSpan" id="kobo.3052.1">selectRating</span></span><span class="koboSpan" id="kobo.3053.1">(</span><span class="hljs-attr"><span class="koboSpan" id="kobo.3054.1">rating</span></span><span class="hljs-params"><span class="koboSpan" id="kobo.3055.1">: </span></span><span class="hljs-built_in"><span class="koboSpan" id="kobo.3056.1">number</span></span><span class="koboSpan" id="kobo.3057.1">) {
    </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3058.1">if</span></span><span class="koboSpan" id="kobo.3059.1"> (</span><span class="hljs-variable"><span class="koboSpan" id="kobo.3060.1">this</span></span><span class="koboSpan" id="kobo.3061.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.3062.1">disabled</span></span><span class="koboSpan" id="kobo.3063.1">) </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3064.1">return</span></span><span class="koboSpan" id="kobo.3065.1">;
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.3066.1">this</span></span><span class="koboSpan" id="kobo.3067.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.3068.1">value</span></span><span class="koboSpan" id="kobo.3069.1"> = rating;
    </span><span class="hljs-variable"><span class="koboSpan" id="kobo.3070.1">this</span></span><span class="koboSpan" id="kobo.3071.1">.</span><span class="hljs-title"><span class="koboSpan" id="kobo.3072.1">onTouched</span></span><span class="koboSpan" id="kobo.3073.1">();
    </span><span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.3074.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3075.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.3076.1">onChange</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3077.1">(rating);</span></strong></span><span class="koboSpan" id="kobo.3078.1">
  }
  ...
</span><span class="koboSpan" id="kobo.3078.2">}
</span></code></pre>
</li>
<li class="numberedList"><span class="koboSpan" id="kobo.3079.1">We need to tell Angular that our </span><code class="inlineCode"><span class="koboSpan" id="kobo.3080.1">RatingComponent</span></code><span class="koboSpan" id="kobo.3081.1"> class has a </span><code class="inlineCode"><span class="koboSpan" id="kobo.3082.1">value</span></code><span class="koboSpan" id="kobo.3083.1"> accessor; otherwise, using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3084.1">formControlName</span></code><span class="koboSpan" id="kobo.3085.1"> attribute on the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3086.1">&lt;app-rating&gt;</span></code><span class="koboSpan" id="kobo.3087.1"> element will throw errors. </span><span class="koboSpan" id="kobo.3087.2">Let’s add an </span><code class="inlineCode"><span class="koboSpan" id="kobo.3088.1">NG_VALUE_ACCESSOR</span></code><span class="koboSpan" id="kobo.3089.1"> provider to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3090.1">RatingComponent</span></code><span class="koboSpan" id="kobo.3091.1"> class’s decorator, as follows:
        </span><pre class="programlisting code"><code class="hljs-code"><span class="hljs-keyword"><span class="koboSpan" id="kobo.3092.1">import</span></span><span class="koboSpan" id="kobo.3093.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.3094.1">Component</span></span><span class="koboSpan" id="kobo.3095.1">, </span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.3096.1">forwardRef</span></strong></span><span class="koboSpan" id="kobo.3097.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.3098.1">Input</span></span><span class="koboSpan" id="kobo.3099.1">, </span><span class="hljs-title"><span class="koboSpan" id="kobo.3100.1">OnInit</span></span><span class="koboSpan" id="kobo.3101.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3102.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.3103.1">'@angular/core'</span></span><span class="koboSpan" id="kobo.3104.1">;
</span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3105.1">import</span></span><span class="koboSpan" id="kobo.3106.1"> { </span><span class="hljs-title"><span class="koboSpan" id="kobo.3107.1">ControlValueAccessor</span></span><span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.3108.1">, </span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.3109.1">NG_VALUE_ACCESSOR</span></strong></span><span class="koboSpan" id="kobo.3110.1"> } </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3111.1">from</span></span> <span class="hljs-string"><span class="koboSpan" id="kobo.3112.1">'@angular/forms'</span></span><span class="koboSpan" id="kobo.3113.1">;
</span><span class="hljs-meta"><span class="koboSpan" id="kobo.3114.1">@Component</span></span><span class="koboSpan" id="kobo.3115.1">({
  ...
  </span><span class="hljs-attr"><span class="koboSpan" id="kobo.3116.1">imports</span></span><span class="koboSpan" id="kobo.3117.1">: [</span><span class="hljs-title"><span class="koboSpan" id="kobo.3118.1">CommonModule</span></span><span class="koboSpan" id="kobo.3119.1">],
  </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.3120.1">providers</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3121.1">: [{</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.3122.1">provide</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3123.1">: </span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.3124.1">NG_VALUE_ACCESSOR</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3125.1">,</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.3126.1">useExisting</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3127.1">: </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.3128.1">forwardRef</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3129.1">(</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.3130.1">() =&gt;</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.3131.1">RatingComponent</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3132.1">),</span></strong></span>
<span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.3133.1">multi</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3134.1">: </span></strong><strong class="hljs-literal-slc"><span class="koboSpan" id="kobo.3135.1">true</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.3136.1">}]</span></strong></span><span class="koboSpan" id="kobo.3137.1">
})
...
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.3138.1">If you refresh the app now, select a rating, and hit the </span><strong class="screenText"><span class="koboSpan" id="kobo.3139.1">Submit</span></strong><span class="koboSpan" id="kobo.3140.1"> button, you should see the values being logged, as follows:</span></p>
<figure class="mediaobject"><span class="koboSpan" id="kobo.3141.1"><img alt="" role="presentation" src="../Images/B18469_08_21.png"/></span></figure>
<p class="packt_figref"><span class="koboSpan" id="kobo.3142.1">Figure 8.21: Form value logged using the custom form control</span></p></li>
</ol>
<p class="normal"><span class="koboSpan" id="kobo.3143.1">Voilà! </span><span class="koboSpan" id="kobo.3143.2">You just learned</span><a id="_idIndexMarker589"/><span class="koboSpan" id="kobo.3144.1"> how to create a custom form contro</span><a id="_idIndexMarker590"/><span class="koboSpan" id="kobo.3145.1">l using </span><code class="inlineCode"><span class="koboSpan" id="kobo.3146.1">ControlValueAccessor</span></code><span class="koboSpan" id="kobo.3147.1">. </span><span class="koboSpan" id="kobo.3147.2">Refer to the next section to understand how it works.</span></p>
<h2 class="heading-2" id="_idParaDest-289"><span class="koboSpan" id="kobo.3148.1">How it works…</span></h2>
<p class="normal"><span class="koboSpan" id="kobo.3149.1">We started the recipe by creating a component we can use to provide a rating for the review we submit. </span><span class="koboSpan" id="kobo.3149.2">We started by adding the template and the styles for the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3150.1">rating</span></code><span class="koboSpan" id="kobo.3151.1"> component. </span><span class="koboSpan" id="kobo.3151.2">Note that we are using an </span><code class="inlineCode"><span class="koboSpan" id="kobo.3152.1">[ngClass]</span></code><span class="koboSpan" id="kobo.3153.1"> directive on each of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3154.1">star</span></code><span class="koboSpan" id="kobo.3155.1"> elements to add the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3156.1">rating__star--active</span></code><span class="koboSpan" id="kobo.3157.1"> class conditionally. </span><span class="koboSpan" id="kobo.3157.2">Let’s discuss each condition now:</span></p>
<ul>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.3158.1">(isMouseOver &amp;&amp; hoveredRating &gt;= star)</span></code><span class="koboSpan" id="kobo.3159.1">: This condition relies on the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3160.1">isMouseOver</span></code><span class="koboSpan" id="kobo.3161.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.3162.1">hoveredRating</span></code><span class="koboSpan" id="kobo.3163.1"> variables. </span><span class="koboSpan" id="kobo.3163.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.3164.1">isMouseOver</span></code><span class="koboSpan" id="kobo.3165.1"> variable becomes </span><code class="inlineCode"><span class="koboSpan" id="kobo.3166.1">true</span></code><span class="koboSpan" id="kobo.3167.1"> as soon as we mouse over any star and is turned back to </span><code class="inlineCode"><span class="koboSpan" id="kobo.3168.1">false</span></code><span class="koboSpan" id="kobo.3169.1"> when we move away from the star. </span><span class="koboSpan" id="kobo.3169.2">This means that it is only </span><code class="inlineCode"><span class="koboSpan" id="kobo.3170.1">true</span></code><span class="koboSpan" id="kobo.3171.1"> when we’re hovering over a star. </span><code class="inlineCode"><span class="koboSpan" id="kobo.3172.1">hoveredRating</span></code><span class="koboSpan" id="kobo.3173.1"> tells us which star we’re hovering over at any moment and is assigned the star’s value – in other words, a value from </span><code class="inlineCode"><span class="koboSpan" id="kobo.3174.1">1</span></code><span class="koboSpan" id="kobo.3175.1"> to </span><code class="inlineCode"><span class="koboSpan" id="kobo.3176.1">5</span></code><span class="koboSpan" id="kobo.3177.1">. </span><span class="koboSpan" id="kobo.3177.2">So, this condition is only </span><code class="inlineCode"><span class="koboSpan" id="kobo.3178.1">true</span></code><span class="koboSpan" id="kobo.3179.1"> when we’re doing a mouseover, and the hovered star’s rating is greater than the value of the current star. </span><span class="koboSpan" id="kobo.3179.2">So, if we’re hovering over the fourth star, all the stars from value </span><code class="inlineCode"><span class="koboSpan" id="kobo.3180.1">1</span></code><span class="koboSpan" id="kobo.3181.1"> to </span><code class="inlineCode"><span class="koboSpan" id="kobo.3182.1">4</span></code><span class="koboSpan" id="kobo.3183.1"> will be highlighted, as they’ll have the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3184.1">rating__star--active</span></code><span class="koboSpan" id="kobo.3185.1"> class conditionally assigned to them.</span></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.3186.1">(!isMouseOver &amp;&amp; value &gt;= star)</span></code><span class="koboSpan" id="kobo.3187.1">: This condition relies on the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3188.1">isMouseOver</span></code><span class="koboSpan" id="kobo.3189.1"> variable that we discussed previously and the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3190.1">value</span></code><span class="koboSpan" id="kobo.3191.1"> variable. </span><span class="koboSpan" id="kobo.3191.2">The </span><code class="inlineCode"><span class="koboSpan" id="kobo.3192.1">value</span></code><span class="koboSpan" id="kobo.3193.1"> variable holds the value of the selected rating, which is updated when we click on a star. </span><span class="koboSpan" id="kobo.3193.2">So, this condition is applied when we’re not doing a mouseover, and we have the value of the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3194.1">value</span></code><span class="koboSpan" id="kobo.3195.1"> variable greater than the current star. </span><span class="koboSpan" id="kobo.3195.2">This is especially beneficial when you have a greater value assigned to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3196.1">value</span></code><span class="koboSpan" id="kobo.3197.1"> variable and try to hover over a star with a lesser value, in which case, all </span><a id="_idIndexMarker591"/><span class="koboSpan" id="kobo.3198.1">the stars with values greater than the hovered star will not be highlighted.</span></li>
</ul>
<p class="normal"><span class="koboSpan" id="kobo.3199.1">Then, we used three events </span><a id="_idIndexMarker592"/><span class="koboSpan" id="kobo.3200.1">on each star, </span><code class="inlineCode"><span class="koboSpan" id="kobo.3201.1">mouseenter</span></code><span class="koboSpan" id="kobo.3202.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.3203.1">mouseleave</span></code><span class="koboSpan" id="kobo.3204.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.3205.1">click</span></code><span class="koboSpan" id="kobo.3206.1">, and then used our </span><code class="inlineCode"><span class="koboSpan" id="kobo.3207.1">onRatingMouseEnter</span></code><span class="koboSpan" id="kobo.3208.1">, </span><code class="inlineCode"><span class="koboSpan" id="kobo.3209.1">onRatingMouseLeave</span></code><span class="koboSpan" id="kobo.3210.1">, and </span><code class="inlineCode"><span class="koboSpan" id="kobo.3211.1">selectRating</span></code><span class="koboSpan" id="kobo.3212.1"> methods, respectively, for these events. </span><span class="koboSpan" id="kobo.3212.2">All of this was designed to ensure that the entire UI is fluent and provides a good user experience. </span><span class="koboSpan" id="kobo.3212.3">We then implemented the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3213.1">ControlValueAccessor</span></code><span class="koboSpan" id="kobo.3214.1"> interface for our </span><code class="inlineCode"><span class="koboSpan" id="kobo.3215.1">rating</span></code><span class="koboSpan" id="kobo.3216.1"> component. </span><span class="koboSpan" id="kobo.3216.2">When we do that, we need to define the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3217.1">onChange</span></code><span class="koboSpan" id="kobo.3218.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.3219.1">onTouched</span></code><span class="koboSpan" id="kobo.3220.1"> methods as empty methods, which we did as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-attr"><span class="koboSpan" id="kobo.3221.1">onChange</span></span><span class="koboSpan" id="kobo.3222.1">: any = </span><span class="hljs-function"><span class="koboSpan" id="kobo.3223.1">() =&gt;</span></span><span class="koboSpan" id="kobo.3224.1"> { };
</span><span class="hljs-attr"><span class="koboSpan" id="kobo.3225.1">onTouched</span></span><span class="koboSpan" id="kobo.3226.1">: any = </span><span class="hljs-function"><span class="koboSpan" id="kobo.3227.1">() =&gt;</span></span><span class="koboSpan" id="kobo.3228.1"> { };
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.3229.1">Then, we used the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3230.1">registerOnChange</span></code><span class="koboSpan" id="kobo.3231.1"> and </span><code class="inlineCode"><span class="koboSpan" id="kobo.3232.1">registerOnTouched</span></code><span class="koboSpan" id="kobo.3233.1"> methods from </span><code class="inlineCode"><span class="koboSpan" id="kobo.3234.1">ControlValueAccessor</span></code><span class="koboSpan" id="kobo.3235.1"> to assign our methods, as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.3236.1">registerOnChange</span></span><span class="koboSpan" id="kobo.3237.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.3238.1">fn: any</span></span><span class="koboSpan" id="kobo.3239.1">){
  </span><span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.3240.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3241.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.3242.1">onChange</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3243.1"> = fn;</span></strong></span><span class="koboSpan" id="kobo.3244.1">
}
</span><span class="hljs-title"><span class="koboSpan" id="kobo.3245.1">registerOnTouched</span></span><span class="koboSpan" id="kobo.3246.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.3247.1">fn: any</span></span><span class="koboSpan" id="kobo.3248.1">) {
  </span><span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.3249.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3250.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.3251.1">onTouched</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3252.1"> = fn;</span></strong></span><span class="koboSpan" id="kobo.3253.1">
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.3254.1">We registered these methods because whenever we make a change in our component and want to let </span><code class="inlineCode"><span class="koboSpan" id="kobo.3255.1">ControlValueAccessor</span></code><span class="koboSpan" id="kobo.3256.1"> know that the value has changed, we need to call the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3257.1">onChange</span></code><span class="koboSpan" id="kobo.3258.1"> method ourselves. </span><span class="koboSpan" id="kobo.3258.2">We do that in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3259.1">selectRating</span></code><span class="koboSpan" id="kobo.3260.1"> method as follows, which makes sure that when we select a rating, we set the form control’s value to the value of the selected rating:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.3261.1">selectRating</span></span><span class="koboSpan" id="kobo.3262.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.3263.1">rating: number</span></span><span class="koboSpan" id="kobo.3264.1">) {
  </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3265.1">if</span></span><span class="koboSpan" id="kobo.3266.1"> (</span><span class="hljs-variable"><span class="koboSpan" id="kobo.3267.1">this</span></span><span class="koboSpan" id="kobo.3268.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.3269.1">disabled</span></span><span class="koboSpan" id="kobo.3270.1">) </span><span class="hljs-keyword"><span class="koboSpan" id="kobo.3271.1">return</span></span><span class="koboSpan" id="kobo.3272.1">;
  </span><span class="hljs-variable"><span class="koboSpan" id="kobo.3273.1">this</span></span><span class="koboSpan" id="kobo.3274.1">.</span><span class="hljs-property"><span class="koboSpan" id="kobo.3275.1">value</span></span><span class="koboSpan" id="kobo.3276.1"> = rating;
  </span><span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.3277.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3278.1">.</span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.3279.1">onChange</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3280.1">(rating);</span></strong></span><span class="koboSpan" id="kobo.3281.1">
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.3282.1">The other way around is when we need to know when the form control’s value is changed from outside the component. </span><span class="koboSpan" id="kobo.3282.2">In this case, we need to assign the updated value to the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3283.1">value</span></code><span class="koboSpan" id="kobo.3284.1"> variable. </span><span class="koboSpan" id="kobo.3284.2">We do that in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3285.1">writeValue</span></code><span class="koboSpan" id="kobo.3286.1"> method from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3287.1">ControlValueAccessor</span></code><span class="koboSpan" id="kobo.3288.1"> interface, as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-title"><span class="koboSpan" id="kobo.3289.1">writeValue</span></span><span class="koboSpan" id="kobo.3290.1">(</span><span class="hljs-params"><span class="koboSpan" id="kobo.3291.1">value: number</span></span><span class="koboSpan" id="kobo.3292.1">) {
  </span><span class="code-highlight"><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.3293.1">this</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3294.1">.</span></strong><strong class="hljs-property-slc"><span class="koboSpan" id="kobo.3295.1">value</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3296.1"> = value;</span></strong></span><span class="koboSpan" id="kobo.3297.1">
}
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.3298.1">What if we don’t want the</span><a id="_idIndexMarker593"/><span class="koboSpan" id="kobo.3299.1"> user to provide a value for the rating? </span><span class="koboSpan" id="kobo.3299.2">In other </span><a id="_idIndexMarker594"/><span class="koboSpan" id="kobo.3300.1">words, we want the rating form control to be disabled. </span><span class="koboSpan" id="kobo.3300.2">For this, we use the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3301.1">setDisabledState</span></code><span class="koboSpan" id="kobo.3302.1"> method from the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3303.1">ControlValueAccessor</span></code><span class="koboSpan" id="kobo.3304.1"> interface, so whenever the form control’s </span><code class="inlineCode"><span class="koboSpan" id="kobo.3305.1">disabled</span></code><span class="koboSpan" id="kobo.3306.1"> state is changed, we set the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3307.1">disabled</span></code><span class="koboSpan" id="kobo.3308.1"> property to reflect the changes.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.3309.1">Finally, we wanted Angular to know that this </span><code class="inlineCode"><span class="koboSpan" id="kobo.3310.1">RatingComponent</span></code><span class="koboSpan" id="kobo.3311.1"> class has a value accessor. </span><span class="koboSpan" id="kobo.3311.2">This is so that we can use the reactive forms API – specifically, the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3312.1">formControlName</span></code><span class="koboSpan" id="kobo.3313.1"> attribute with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3314.1">&lt;app-rating&gt;</span></code><span class="koboSpan" id="kobo.3315.1"> selector – and use it as a form control. </span><span class="koboSpan" id="kobo.3315.2">To do that, we provide our </span><code class="inlineCode"><span class="koboSpan" id="kobo.3316.1">RatingComponent</span></code><span class="koboSpan" id="kobo.3317.1"> class as a provider to its </span><code class="inlineCode"><span class="koboSpan" id="kobo.3318.1">@Component</span></code><span class="koboSpan" id="kobo.3319.1"> definition decorator, using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3320.1">NG_VALUE_ACCESSOR</span></code><span class="koboSpan" id="kobo.3321.1"> injection token, as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="koboSpan" id="kobo.3322.1">@</span><span class="hljs-title"><span class="koboSpan" id="kobo.3323.1">Component</span></span><span class="koboSpan" id="kobo.3324.1">({
  ...
  </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.3325.1">providers</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3326.1">: [{</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.3327.1">provide</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3328.1">: </span></strong><strong class="hljs-variable-slc"><span class="koboSpan" id="kobo.3329.1">NG_VALUE_ACCESSOR</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3330.1">,</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.3331.1">useExisting</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3332.1">: </span></strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.3333.1">forwardRef</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3334.1">(</span></strong><strong class="hljs-function-slc"><span class="koboSpan" id="kobo.3335.1">() =&gt;</span></strong><strong class="hljs-slc"> </strong><strong class="hljs-title-slc"><span class="koboSpan" id="kobo.3336.1">RatingComponent</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3337.1">),</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"> </strong><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.3338.1">multi</span></strong><strong class="hljs-slc"><span class="koboSpan" id="kobo.3339.1">: </span></strong><strong class="hljs-literal-slc"><span class="koboSpan" id="kobo.3340.1">true</span></strong></span>
<span class="code-highlight"><strong class="hljs-slc"><span class="koboSpan" id="kobo.3341.1">  }]</span></strong></span><span class="koboSpan" id="kobo.3342.1">
})
</span></code></pre>
<p class="normal"><span class="koboSpan" id="kobo.3343.1">Note that we’re using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3344.1">useExisting</span></code><span class="koboSpan" id="kobo.3345.1"> property with the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3346.1">forwardRef</span></code><span class="koboSpan" id="kobo.3347.1"> method providing our </span><code class="inlineCode"><span class="koboSpan" id="kobo.3348.1">RatingComponent</span></code><span class="koboSpan" id="kobo.3349.1"> class in it. </span><span class="koboSpan" id="kobo.3349.2">We </span><a id="_idIndexMarker595"/><span class="koboSpan" id="kobo.3350.1">need to provide </span><code class="inlineCode"><span class="koboSpan" id="kobo.3351.1">multi: true</span></code><span class="koboSpan" id="kobo.3352.1"> because Angular</span><a id="_idIndexMarker596"/><span class="koboSpan" id="kobo.3353.1"> itself registers some value accessors using the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3354.1">NG_VALUE_ACCESSOR</span></code><span class="koboSpan" id="kobo.3355.1"> injection token, and there may also be third-party form controls.</span></p>
<p class="normal"><span class="koboSpan" id="kobo.3356.1">Once we’ve set everything up, we use </span><code class="inlineCode"><span class="koboSpan" id="kobo.3357.1">formControlName</span></code><span class="koboSpan" id="kobo.3358.1"> on our </span><code class="inlineCode"><span class="koboSpan" id="kobo.3359.1">rating</span></code><span class="koboSpan" id="kobo.3360.1"> component in the </span><code class="inlineCode"><span class="koboSpan" id="kobo.3361.1">home.component.html</span></code><span class="koboSpan" id="kobo.3362.1"> file, as follows:</span></p>
<pre class="programlisting code"><code class="hljs-code"><span class="hljs-tag"><span class="koboSpan" id="kobo.3363.1">&lt;</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.3364.1">app-rating</span></span><span class="hljs-tag"> </span><span class="code-highlight"><strong class="hljs-attr-slc"><span class="koboSpan" id="kobo.3365.1">formControlName</span></strong><strong class="hljs-tag-slc"><span class="koboSpan" id="kobo.3366.1">=</span></strong><strong class="hljs-string-slc"><span class="koboSpan" id="kobo.3367.1">"rating"</span></strong></span><span class="hljs-tag"><span class="koboSpan" id="kobo.3368.1">&gt;&lt;/</span></span><span class="hljs-name"><span class="koboSpan" id="kobo.3369.1">app-rating</span></span><span class="hljs-tag"><span class="koboSpan" id="kobo.3370.1">&gt;</span></span>
</code></pre>
<h2 class="heading-2" id="_idParaDest-290"><span class="koboSpan" id="kobo.3371.1">See also</span></h2>
<ul>
<li class="bulletList"><span class="koboSpan" id="kobo.3372.1">Custom form control in Angular by </span><code class="inlineCode"><span class="koboSpan" id="kobo.3373.1">thoughtram</span></code><span class="koboSpan" id="kobo.3374.1">: </span><a href="https://blog.thoughtram.io/angular/2016/07/27/custom-form-controls-in-angular-2.html"><span class="url"><span class="koboSpan" id="kobo.3375.1">https://blog.thoughtram.io/angular/2016/07/27/custom-form-controls-in-angular-2.html</span></span></a></li>
<li class="bulletList"><code class="inlineCode"><span class="koboSpan" id="kobo.3376.1">ControlValueAccessor</span></code><span class="koboSpan" id="kobo.3377.1"> docs: </span><a href="https://angular.io/api/forms/ControlValueAccessor"><span class="url"><span class="koboSpan" id="kobo.3378.1">https://angular.io/api/forms/ControlValueAccessor</span></span></a></li>
</ul>
<h1 class="heading-1"><span class="koboSpan" id="kobo.3379.1">Learn more on Discord</span></h1>
<p class="normal"><span class="koboSpan" id="kobo.3380.1">To join the Discord community for this book – where you can share feedback, ask questions to the author, and learn about new releases – follow the QR code below:</span></p>
<p class="normal"><a href="Chapter_8.xhtml"><span class="url"><span class="koboSpan" id="kobo.3381.1">https://packt.link/AngularCookbook2e</span></span></a></p>
<p class="normal"><span class="koboSpan" id="kobo.3382.1"><img alt="" role="presentation" src="../Images/QR_Code1388317275422265.png"/></span></p>
</div>
</body></html>
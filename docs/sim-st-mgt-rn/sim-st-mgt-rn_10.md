

# 附录

好吧，我亲爱的读者，我们已经到达了这本书的最后一部分：总结。我真诚地希望你喜欢阅读我关于 React Native 中状态管理库的讨论，并且我想感谢你一路走来。现在，让我带你回顾一下这本书中我们讨论的所有内容。如果你在之后对我的想法和沉思不太感到疲倦，你将找到关于**状态管理**的招聘面试问题相关的附加部分。

在这本书的前几章中，我们广泛地探讨了网络开发的历史。我们看到了互联网景观的演变，这导致了**ReactJS**的创建。然后，我们讨论了**React**本身的演变，这导致了 React Native 的创建。了解 React Native 与 ReactJS 的紧密联系在开发 React Native 应用时非常有帮助。ReactJS 社区比其移动优先的表亲更大、更成熟。许多 React Native 开发者面临的问题都可以用 ReactJS 知识来解决。有一个叫做**React 心态**的概念，这对于编写健壮、可扩展和无 bug 的应用至关重要。关于这个主题有很多优秀的文章，例如官方 React 文档中发布的*Thinking in React*文章。一旦我们学会了如何采用这种心态，我们就开始构建我们自己的应用：Funbook。

毫不奇怪，我们创建的应用程序是一个社交媒体克隆应用。社交媒体应用是示例代码的一个有趣话题，因为我们都非常熟悉它们应该如何工作。同时，它们比大多数 ReactJS 教程中出现的传统待办事项应用要复杂得多。设置任何移动应用本身就是一项任务。对于所有那些网络开发者来说，在移动应用领域工作是一个全新的领域，拥有自己的工具和流程。幸运的是，我们可以利用**Expo**，几分钟内就能拥有一个功能齐全且可测试的应用。一旦我们对基本的应用设置感到舒适，我们就开始编写真正的 Funbook 应用。我们添加了一些界面：动态、对话、喜欢的图片和相机。然后我们开始用 React 思考！我们规划和编写了所有界面的底层组件。我们使用了许多现代 React 特性，例如 hooks 和 context。到**第四章**（B18396_04.xhtml#_idTextAnchor048）结束时，我们拥有了一个美丽、功能齐全的移动应用，我们可以在真实设备上或在我们电脑屏幕上的手机模拟器上对其进行测试。这看起来可能像是一项大量的工作，但让我向你保证：在 React Native 及其一些 JavaScript 前辈出现之前，创建在**Android**和**iOS**上工作的移动应用要复杂得多！

*第五章*，*在我们的 Funbook 应用中实现 Redux*，是第一个讨论 React Native 应用中状态管理外部解决方案的章节。我们讨论的具体解决方案是**Redux**和**Redux Toolkit**。截至本书写作时，Redux 是 React 社区中最古老、最广为人知且使用最广泛的状态管理库。如果使用得当，它是一个伟大的工具。它需要相当多的样板代码，而且其创造者对其实现方式有所怀疑。然而，Redux Toolkit 背后的团队在保持该库对开发者友好和更新方面取得了巨大进步。我们在 Funbook 应用中配置了 Redux 和 Redux Toolkit，并了解了如何使用它们来管理喜欢的图片列表。

在下一章中，我们讨论了被认为是 React 社区中第二受欢迎的库：**MobX**。到那时，我们已经掌握了 ReactJS、React Native 的扎实知识，并对如何仅使用 React 或与 Redux 一起管理全局状态有一些思考。MobX 邀请我们重新思考一些先入为主的观念，并以不同的方式看待全局状态管理。MobX 不是通过复杂的组件网络传递 props 或 actions，而是为我们提供了将全局状态数据作为任何其他 prop 使用的工具，同时只通知组件它们正在被观察。后来我们了解到这种全局状态管理有时被称为**基于代理的**。状态管理库位于用户和代码之间，以一种类似网络代理的方式在无形层中管理状态。MobX 有时与**Valtio**，另一个基于代理的状态管理库相提并论。

在了解了 MobX 的可观察性、动作以及它们推导状态值的方法（应尽可能多地进行）之后，我们准备开始使用它。我们实现了与 Redux 相同的功能——管理喜欢的图片列表。一旦在 MobX 中实现了这个功能，我们就转向下一个状态管理库：**XState**。

Xstate 不如 Redux 和 MobX 受欢迎，但它提供了另一种看待全局状态管理的方式。而且，它还提供了一种专门的工具来做这件事！**Xstate 可视化器**是一个令人难以置信的工具，可以用于任何应用中的任何全局状态。在创建新应用时，能够看到不同状态片段如何相互关联可能会很有帮助。Xstate 不仅提供了这个伟大的工具，而且其创造者还邀请我们采取更数学的方法来管理状态。多亏了他，我们可以学习什么是状态机，以及应用中的每个全局状态部分都应该始终处于定义状态。

在尝试了 Xstate 并当然地使用它实现了喜欢的图片列表之后，我们准备继续前进。我们接下来查看的库是**Jotai**。

当我开始写这本书时，Jotai 被视为新晋的佼佼者。那已经是很多个月以前的事情了！在撰写这个总结的时候，有几款新的状态管理库出现。我担心它们还不够成熟，无法与 Redux 和 MobX 这样的巨头一起分析。然而，Jotai 在过去几个月里一直保持着强劲势头，并越来越受到社区的重视。Jotai 受 `useState` 钩子的启发很大。最大的不同在于，Jotai 的原子将在整个应用中自由可用，无需不愉快的属性钻取或大量的样板代码。对我来说，使用 Jotai 来处理喜欢的图片列表感觉有点神奇：最少的配置，我们就可以在任何我们想要的地方访问状态片段！

一旦我们在 Funbook 应用中使用了 Jotai，我们就准备放弃它并继续前进。接下来的事情与它的前辈们非常不同——**React Query**，以及我们可能根本不需要任何状态管理库的观念。React Query 不是一个状态管理库；它是一个为更好地管理应用和服务器之间的数据同步而创建的库。它的目标是减少网络调用同时保持数据的相关性。在开发者体验方面，它也是一个令人难以置信的解决方案。文档详尽无遗，并配有专门的博客。成百上千的常见开发者问题都在库内部得到了解决。我们使用了 React Query，或者 **TanStack Query**，来获取喜欢的图片列表。不幸的是，由于 Funbook 应用的后端相当简单，我们无法使用它提供的其他功能，例如数据突变。

React Query 的创造者提出了一个非常好的问题：你真的需要为你的应用使用状态管理库吗？让我们也来问自己同样的问题。我们能够仅使用 React 就创建了 Funbook 应用。我们也曾尝试将 React Query 与本地状态混合使用。这意味着所有专门的状态管理库都应该和这本书一起从地球上抹去吗？当然不是。

选择一个状态管理库，当从经过实战检验的解决方案中进行选择时，这主要取决于开发者的经验。你的应用程序的最终用户不会知道你是否在使用 Jotai 或 Redux，但你的同行开发者可能会对此提出很多意见。一些开发者对 Redux 如痴如醉，而另一些则宁愿不接触基于 Redux 的项目。在社区中有一个无声的全球共识，即状态管理库不应该用于在应用程序中获取和持久化数据。这项任务应该留给更适合的库，例如 React Query。所以，也许你下一个创建的应用程序将使用 MobX 进行本地状态管理，React Query 进行数据获取？或者也许使用 Xstate 进行本地状态管理，**Axios** 进行数据获取，以及 **Async Storage** 进行状态持久化？或者也许是其他完全不同的东西。我相信每个状态管理库都有其优点和缺点。我也相信讨论哪个更好是一个无意义的问题，因为它们在客观上都不是更好的。我希望通过这本书，你能够“浅尝辄止”地了解几种不同的解决方案，并且更加了解你个人的偏好。一旦你找到了你喜欢的，那就享受与之一起工作的乐趣吧！

## 奖励内容

谈到工作：你可能会发现自己，亲爱的读者，正在参加面试，面试官会问你关于 React、React Native 和状态管理解决方案的问题。我遇到过一些问题，我认为这些问题要么非常常见，要么非常有趣。我整理了一份这些问题列表，希望它能帮助你顺利通过下一次招聘。关于 React 和 Redux 的问题在大多数与 React 和 React Native 软件开发相关的职位面试中都会出现。如果你指定你熟悉给定的库，可能会被问到关于其他状态管理库的问题。说实话，80% 的工作机会都会列出 React 和 Redux。我希望能在这几个月和几年内有所改变，因为其他状态管理库提供了很好的解决方案。以下是一些常见或有趣的问题：

1.  在 React 中，`props` 和 `state` 之间的区别是什么？

1.  在 React Native 应用程序中，使用外部状态管理库是必要的吗？

1.  在 Redux 中，什么是 reducer 和 action？

1.  在 Redux 中，使用 selectors 的优势是什么？

1.  在 Redux 中，你能否直接更改状态值？

1.  在 MobX 中，什么是模型？

1.  在 MobX 中，你如何使组件感知全局状态值？

1.  在 Xstate 中，什么是状态机？

1.  在 Xstate 中，你如何通过状态机传递额外的数据？

1.  在 Jotai 中，最基本的州状态叫什么名字？

1.  你能否只用 React Query 就替换所有的状态管理？

我只给你这些问题，因为给你答案可能会太简单了，你不这么认为吗？如果你必须回到书中去研究答案，或者也许简单地谷歌一下，那么信息更有可能留在你脑海中。

我衷心希望您阅读这本书的乐趣和我写作这本书的乐趣一样！感谢您一直陪伴在这里，并且随时可以通过 Twitter（如果这本书出版时它仍然存在）联系我！晚安，祝您好运！

- en: '*Chapter 6*: Using Angular Components'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the previous chapter, we introduced the Angular Academy application and briefly
    scratched its surface by demonstrating how we can use CSS Custom Properties to
    control theme properties and CSS Grid layouts. In this chapter, we will dig into
    the details of how to implement the application using the new Angular components
    that we introduced in [*Chapter 4*](B16295_04_ePub_RK.xhtml#_idTextAnchor055),
    *Exploring Angular Components Features*.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
- en: Note that we will be covering a lot of ground in this chapter, so I recommend
    that you revisit *Chapter 4*, *Exploring Angular Components Features*, if you
    want to learn about Angular components or if you need a refresher. This chapter
    will be about using the new official Angular components and how to wire them together
    in our Angular Academy example application.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
- en: 'More specifically, we will be covering the following topics in this chapter:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
- en: Understanding the Angular Academy application
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Showing course videos using the Angular YouTube Player
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Using the new Clipboard service
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Finding your school using the Angular Google Maps components
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If you are like us, then you are probably eager to dive into the details on
    how to use the new official Angular components, but let's step back and reflect
    on the Angular Academy application so that we can understand what we are going
    to build.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
- en: By starting from the ground up in this way, we hope that you get a more concrete
    understanding of how to use the new components by seeing how to wire them together
    using services and navigation.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
- en: Understanding the Angular Academy application
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The first thing you should think about when using components is **what** you
    want the user to be able to accomplish by using the component, as well as what
    data that use case requires, before digging into the details about the component
    you are going to use.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
- en: Our primary use case for the Angular Academy application. is to allow tailor-made
    lists of video courses, which will provide the user with a custom list of videos
    and location information for the video's content. To accomplish this, we will
    use the Angular YouTube Player to display videos and select schools via Angular
    Google Maps (for the **how**). It will be the school that creates the course,
    and the course will contain one or more videos that the user will watch.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
- en: With the use case in place, we can now give some thought to **what** data we
    will be using, before describing **how** we are going to display or use the data.
    This will make it easier to separate data retrieval and storage from the actual
    usage of the different components. So, let's establish a data model before we
    use the new Angular components.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
- en: Establishing a data model
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
- en: We have many ways to describe data models, but for the sake of brevity, we will
    limit ourselves to simple TypeScript interfaces to describe the models and use
    Angular services to communicate with the backend.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
- en: 'The models that we will be using to support our use case are as follows:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
- en: School
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Course
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Video
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The list of videos you saw in the previous chapter is related to a Course that
    has been produced by a School. We’ll start by giving a Course a title, an optional
    description, and a list of videos for the user to watch:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-21
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The basic information we need for each video is where to access it on YouTube,
    the date it was uploaded, the author who produced it, and an optional description
    of what it is about:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  id: totrans-23
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'We will attach a name and the latitude and longitude for each school so that
    we can find them on a map:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Additionally, we will describe the courses being offered by the school in the
    `courses` array. Note that the description in the `courses` array will be using
    the Course model as part of the School model. The shared use of the Course interface
    will allow logic to be reused between the Schools and Course components.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
- en: Dividing the application into components
  id: totrans-27
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Now, we will divide the app into the following three main modules. These will
    be displayed separately on the screen:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
- en: Course
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Theme
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Schools
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The Course component will use the layout grid that we introduced in [*Chapter
    5*](B16295_05_ePub_RK.xhtml#_idTextAnchor075), *Using CSS Custom Properties,*
    as well as a Video component that will display YouTube videos via the Angular
    YouTube Player module.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
- en: The theme component should also seem familiar to you from [*Chapter 5*](B16295_05_ePub_RK.xhtml#_idTextAnchor075),
    *Using CSS Custom Properties,* where we used it to control the theme settings
    using CSS properties. The theme settings should influence the graphical display
    of the Schools and Course components.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
- en: The Schools component will let you find your school via the Angular Google Maps
    component and let you select a course to follow from the chosen school (and redirect
    you to the Course component).
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
- en: 'Each of the components will be mapped for navigation in `app.module.ts`, like
    this:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Note that the Course component will require a parameter for which course to
    display. For simplicity, we will just assume that the user is already logged in,
    has chosen to follow the course with an ID of `1`, and then display this as the
    default route. A later implementation could add a login page and a user model,
    which could redirect the user to the chosen course upon startup (the chosen course
    could, for example, be stored on the user model). We will revisit this in [*Chapter
    8*](B16295_08_ePub_RK.xhtml#_idTextAnchor094), *Additional Provider Scopes*.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
- en: Now that we have divided the application into components, it is time to start
    thinking about how to include dependencies for these modules.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
- en: Including dependencies using modules
  id: totrans-39
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'We will start by specifying the application as a module that imports the Course,
    Schools, and Theme modules:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'The Course module will include the Video module:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'The Video module will include the `YouTubePlayerModule` and `ClipboardModule`
    dependencies:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Finally, the Schools module will include `GoogleMapsModule`:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: Did you notice that we only included the specific dependencies where they are
    needed? This way of structuring applications can help you have a clearer overview
    of the dependencies in the application.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
- en: Retrieving data using services
  id: totrans-49
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Now that we have specified the example data model and divided the application
    into modules, it is time to specify how we will access data from the components.
    We will use the following Angular services for this:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
- en: '`CourseService`'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`SchoolsService`'
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Each of the services will be set up to fetch data asynchronously. The main difference
    here will be that `CourseService` will retrieve one Course at a time, while `SchoolsService`
    will retrieve several Schools at a time.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
- en: 'The `CourseService` will have a `getCourse` call available to retrieve a single
    course:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: The Course model will contain the list of videos for the course to display.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
- en: Important Note
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
- en: We are using mock data here, but this approach should illustrate how you can
    implement asynchronous data retrieval from the server via the `Course` component.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
- en: 'Similarly, we will introduce `SchoolsService`, which will retrieve the list
    of schools providing courses:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Here, we will return several schools via the `getSchools` call. The idea is
    that each of the returned schools should provide links to one or several courses
    that can be retrieved via `CourseService`. We will illustrate this by providing
    a link to the courses that the school is offering in the Schools component.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
- en: Wiring up navigation
  id: totrans-62
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: For simplicity, we will assume that the user has signed up for a school so that
    we can direct the user to a course in the chosen school. Here, the default link
    will display videos from the course in the chosen school via the default route
    on startup.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
- en: 'We will start by setting up the links for the Material Side Navigation container
    in the Navigation component on the left side of the screen, as follows:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Here, you can see that the default route, `/`, will have a title of **Watch
    courses** This will be mapped to the Courses component in the route description.
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
- en: Having established the navigation and the data model and having split the app
    into modules, we can start describing how to use the Angular components in the
    Angular Academy app. We will start by describing how to use the Angular YouTube
    Player to show the course videos.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
- en: Showing course videos using the Angular YouTube Player
  id: totrans-68
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this section, we''ll create a separate video component to display videos
    that are attached to a course. For simplicity, we''ll accept the information as
    `@Input` inside the Video component, like so:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'This code should be familiar to you from the introduction in [*Chapter 4*](B16295_04_ePub_RK.xhtml#_idTextAnchor055),
    *Exploring Angular Components Features,* where we introduced how to use it. We
    can now write the template for the Video component to display the YouTube videos,
    like this:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Do you remember how we used the custom `videoSize` CSS property in the previous
    chapter to tweak the grid column's size? This effort is paying off – we just need
    to refer to the `video` class here (with no direct reference to dynamic sizing
    at all). The reference to the `tile` class lets us manipulate the tile color settings
    using the theme component.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
- en: Did you also notice how we introduced the `cdkCopyToClipboard` feature here?
    This feature can be handy in desktop applications when you want to extract data
    from the running application to the clipboard.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
- en: 'Having established the Video component, we can now use it from the Course component,
    like this:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Note the usage of the `async` pipe operator on `course$`. Here, we are waiting
    for the data to be retrieved so that we can start rendering the video using the
    Video component.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
- en: Now that we have covered how to display course videos using the Angular YouTube
    Player, we will learn how to find a school using the Angular Google Maps component
    and show how the navigation from the School component to the Course component
    works.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
- en: Finding your school using the Angular Google Maps component
  id: totrans-79
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The Schools component will allow you to find a school via Google Maps by clicking
    a marker where the school has been placed. This will open the **MapInfo** window,
    where you can click on the course that you can watch from school. Clicking on
    this course will lead you to the course overview you saw in the previous chapter.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
- en: You can find the Schools component in the Angular Academy application by clicking
    the **Find school** menu entry. This should render the Schools component, where
    you will see the example **Angular Advanced** school.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
- en: 'When you open the Schools component in the Angular Academy application, it
    should open with a red default Google Maps marker. If you click it, then your
    display should look like this:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 6.1 – Opening the red Google Maps marker'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_6.1_B16295.jpg)'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
- en: Figure 6.1 – Opening the red Google Maps marker
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
- en: If you click the **Angular Advanced** link in the map information window, you
    will be transferred to the course component with the ID for the **Angular Advanced**
    course as a parameter.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
- en: 'We expect the incoming course data on the map info window of the Schools component
    to come from the Schools service as an asynchronous call, as illustrated here:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Here, you can see how we opened `MapInfoWindow` when clicking on the map anchor
    point in the `openInfo` call.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
- en: 'We will register the `openInfo` call on the `mapClick` function of the Angular
    Google Maps component, and make it open a **MapInfo** window that displays a link
    to the courses being offered by the school:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Note the usage of the async pipe on the `schools$` observable. This will make
    the school data available in the `schools` variable. Combined with `NgIf` on `<ng-container>`,
    you can stop data from being rendered until data is available.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
- en: If you have not tried it yet, I recommend that you try clicking your way through
    **Find your school** and clicking the **Angular Advanced** course to find your
    way back to the Course listing.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您还没有尝试过，我建议您尝试通过点击**查找您的学校**并点击**Angular高级**课程来找到课程列表。
- en: Did you notice how the Course listing was opened using the course ID that was
    retrieved from the course array in the School data model? In our example application,
    we have registered the `course/:id` route to open the course component with the
    `id` parameter. For now, we will just assume that the user only has a single course
    available and that this course is chosen upon startup. This simple example has
    helped illustrate how the basic flow of the Angular Academy is intended to be.
    In a more realistic scenario, we would allow for the user to log in and have chosen
    courses stored in a session. We will revisit this in [*Chapter 8*](B16295_08_ePub_RK.xhtml#_idTextAnchor094),
    *Additional Provider Scopes*, where we will introduce user login.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 您是否注意到课程列表是通过从学校数据模型中检索到的课程ID来打开的？在我们的示例应用程序中，我们已经注册了`course/:id`路由来通过`id`参数打开课程组件。目前，我们假设用户只有一个课程可用，并且该课程在启动时被选中。这个简单的例子有助于说明Angular
    Academy的基本流程是如何设计的。在更现实的场景中，我们会允许用户登录，并将选中的课程存储在会话中。我们将在[*第8章*](B16295_08_ePub_RK.xhtml#_idTextAnchor094)，*附加提供者作用域*中重新讨论这个问题，我们将介绍用户登录。
- en: Summary
  id: totrans-95
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: In this chapter, we gave you a basic overview of how to use the new Angular
    components by giving you a concrete example with the Angular Academy application.
    The example included a description of how to retrieve data using services and
    how to structure the inclusion of dependencies via Angular modules. In the next
    chapter, we will describe how to use a test-as-a-user approach using Angular Component
    Harnesses.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们通过提供一个具体的Angular Academy应用程序的例子，向您介绍了如何使用新的Angular组件。该例子包括如何使用服务检索数据以及如何通过Angular模块结构化依赖项的包含。在下一章中，我们将描述如何使用Angular组件
    Harnesses的测试作为用户的方法。

<html><head></head><body><div class="chapter" title="Chapter&#xA0;2.&#xA0;JSX in Depth"><div class="titlepage"><div><div><h1 class="title"><a id="ch02"/>Chapter 2. JSX in Depth</h1></div></div></div><p>In the first chapter, we built our first component using React. We saw how using JSX makes the development easy. In this chapter, we will dive deep into JSX.</p><p>
<span class="strong"><strong>JavaScript XML</strong></span> (<span class="strong"><strong>JSX</strong></span>) is an XML syntax that constructs the markup in React components. React works without JSX, but using JSX makes it easy to read and write the React components as well as structure them just like any other HTML element.</p><p>In this chapter, we will cover following points:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Why JSX?</li><li class="listitem" style="list-style-type: disc">Transforming JSX into JavaScript</li><li class="listitem" style="list-style-type: disc">Specifying HTML tags and React components</li><li class="listitem" style="list-style-type: disc">Multiple components</li><li class="listitem" style="list-style-type: disc">Different types of JSX tags</li><li class="listitem" style="list-style-type: disc">Using JavaScript expressions inside JSX</li><li class="listitem" style="list-style-type: disc">Namespaced components</li><li class="listitem" style="list-style-type: disc">Spread attributes</li><li class="listitem" style="list-style-type: disc">CSS styles and JSX</li><li class="listitem" style="list-style-type: disc">JSX Gotchas</li></ul></div><p>At the end of the chapter, we will get familiar with the JSX syntax, how it should be used with React, and best practices of using it. We will also study some of the corner cases that one can run into while using JSX.</p><div class="section" title="Why JSX?"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec15"/>Why JSX?</h1></div></div></div><p>Shawn had a great <a id="id31" class="indexterm"/>first day and he was just getting started with the next one at Adequate Consulting. With a mug of coffee, he startled Mike.</p><p>"Hey Mike, I saw that we used JSX for building our first component. Why should we use JSX when React has <code class="literal">React.createElement</code>?"</p><p>"You can use React without using JSX. But JSX makes it easy to build React components. It reduces the amount of code required to write. It looks like HTML markup. Its syntax is <a id="id32" class="indexterm"/>simple and concise and it's very easy to visualize the components that are getting built."</p><p>"Take an example of the render function of a component without using JSX."</p><div class="informalexample"><pre class="programlisting">// render without JSX
render: function(){
    return(React.createElement("div", 
                               null, 
                               "Hello React World!"));
}</pre></div><p>"With JSX, it looks much better."</p><div class="informalexample"><pre class="programlisting">// render with JSX
render: function(){
    return &lt;div&gt;
      Hello React World
    &lt;/div&gt;;
  }</pre></div><p>"Compared to the previous non-JSX example, the JSX code is much more readable, easy to understand, and close to the actual HTML markup."</p><p>"The similarity between JSX and HTML markup means that non-developers such as UI and UX designers in the team can contribute to a project using JSX. Having XML-like tag syntax also makes reading large component trees easier compared to the function calls or object literals in JavaScript." explained Mike.</p><p>"Yeah. The syntax does look familiar. We will be using JSX all the way in our projects right?"</p><p>"Yes, we will", remarked Mike.</p></div></div>
<div class="section" title="Transforming JSX into JavaScript"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec16"/>Transforming JSX into JavaScript</h1></div></div></div><p>"Shawn, as I <a id="id33" class="indexterm"/>mentioned, the JSX is transformed to the <a id="id34" class="indexterm"/>native JavaScript syntax."</p><div class="informalexample"><pre class="programlisting">// Input (JSX):
var app = &lt;App name="Mike" /&gt;;</pre></div><p>"This will eventually get transformed to"</p><div class="informalexample"><pre class="programlisting">// Output (JS):
var app = React.createElement(App, {name:"Mike"});</pre></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="tip02"/>Tip</h3><p>
<span class="strong"><strong>Downloading the example code</strong></span>
</p><p>You can download the example code files for this book from your account at <a class="ulink" href="http://www.packtpub.com">http://www.packtpub.com</a>. If you purchased this book elsewhere, you can visit <a class="ulink" href="http://www.packtpub.com/support">http://www.packtpub.com/support</a> and register to have the files e-mailed directly to you.</p><p>You can download the code files by following these steps:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">Log in or register to our website using your e-mail address and password.</li><li class="listitem" style="list-style-type: disc">Hover the mouse pointer on the <span class="strong"><strong>SUPPORT</strong></span> tab at the top.</li><li class="listitem" style="list-style-type: disc">Click on <span class="strong"><strong>Code Downloads &amp; Errata</strong></span>.</li><li class="listitem" style="list-style-type: disc">Enter the name of the book in the <span class="strong"><strong>Search</strong></span> box.</li><li class="listitem" style="list-style-type: disc">Select the book for which you're looking to download the code files.</li><li class="listitem" style="list-style-type: disc">Choose from the drop-down menu where you purchased this book from.</li><li class="listitem" style="list-style-type: disc">Click on <span class="strong"><strong>Code Download</strong></span>.</li></ul></div><p>Once the file is downloaded, please make sure that you unzip or extract the folder using the latest version of:</p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">WinRAR / 7-Zip for Windows</li><li class="listitem" style="list-style-type: disc">Zipeg / iZip / UnRarX for Mac</li><li class="listitem" style="list-style-type: disc">7-Zip / PeaZip for Linux</li></ul></div></div></div><p>"If you would like to see this live in action, try this example at <a class="ulink" href="https://babeljs.io/repl/">https://babeljs.io/repl/</a>. It's a live REPL that can transform a JSX code to the native JavaScript code."</p><p>"There is another editor available for converting HTML to JSX. You can check it out at <a class="ulink" href="http://facebook.github.io/react/html-jsx.html">http://facebook.github.io/react/html-jsx.html</a>. This allows you to paste an arbitrary <a id="id35" class="indexterm"/>HTML code that gets converted to JSX with extraction of styles, classes, and other information and then create a component on top of it." said Mike.</p><p>"Pretty handy. However, this is just for ease of development, right? What happens when we deploy our code?" asked Shawn.</p><p>"JSX is not meant to <a id="id36" class="indexterm"/>be compiled at runtime. Though there is a JSX <a id="id37" class="indexterm"/>transformer that converts JSX to JavaScript in a browser. Using it to compile JSX at runtime in the browser would slow down our application. We will use tools such as Babel, which is a JavaScript transpiler to convert our JSX code to the native JavaScript code before deploying the application."</p></div>
<div class="section" title="HTML tags vs React components"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec17"/>HTML tags vs React components</h1></div></div></div><p>"Mike, I am <a id="id38" class="indexterm"/>intrigued by one more thing. In JSX, we are <a id="id39" class="indexterm"/>mixing the React components as if they are simple HTML tags. We did this in our first component."</p><div class="informalexample"><pre class="programlisting">ReactDOM.render(&lt;App headings = {['When', 'Who', 'Description']} 
                     data = {data} /&gt;, 
             document.getElementById('container'));</pre></div><p>"The <code class="literal">App</code> tag is not a valid HTML tag here. But this still works."</p><p>"Yes. That's because we can specify both HTML tags and React components in JSX. There is a subtle difference though. HTML tags start with a lowercase letter and React components start with an uppercase letter." Mike explained.</p><div class="informalexample"><pre class="programlisting">// Specifying HTML tags
render: function(){
    return(&lt;table className = 'table'&gt;
           .....
           &lt;/table&gt;);
}

// Specifying React components
var App = React.createClass({..});
ReactDOM.render(&lt;App headings = {['When', 'Who', 'Description']}  
                     data = {data} /&gt;, 
                document.getElementById('container'));</pre></div><p>"That's the <a id="id40" class="indexterm"/>primary difference. JSX uses this convention <a id="id41" class="indexterm"/>to differentiate between the local component classes and HTML tags."</p></div>
<div class="section" title="Self closing tag"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec18"/>Self closing tag</h1></div></div></div><p>"Another thing <a id="id42" class="indexterm"/>that you must have noticed is how the component tag is closed in <code class="literal">ReactDOM.render</code>" added Mike.</p><div class="informalexample"><pre class="programlisting">ReactDOM.render(&lt;App .../&gt;, document.getElementById('container'));</pre></div><p>"As JSX is based on XML, it allows adding a self-closing tag. All the component tags must be closed either with self-closing format or with a closing tag."</p><p>"Thanks Mike! Things make much more sense now."</p></div>
<div class="section" title="Multiple components"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec19"/>Multiple components</h1></div></div></div><p>"Shawn, let's get <a id="id43" class="indexterm"/>back to our application. We are using almost the same code from last time but you can set up a new JSBin. We have included the latest React library and bootstrap library in the HTML tab. We have also added a container element, which we will render our React app."</p><div class="informalexample"><pre class="programlisting">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;script src="https://code.jquery.com/jquery.min.js"&gt;&lt;/script&gt;
    &lt;link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet" type="text/css" /&gt;
    &lt;script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"&gt;&lt;/script&gt;
    &lt;script src="//fb.me/react-with-addons-0.14.3.js"&gt;&lt;/script&gt;
    &lt;script src="//fb.me/react-dom-0.14.3.js"&gt;&lt;/script&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;meta name="viewport" content="width=device-width"&gt;
    &lt;title&gt;JSX in Detail&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;div id="container"&gt;
    &lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre></div><p>"Right now, we are only using a single component to display the data from the recent changes API."</p><div class="informalexample"><pre class="programlisting">var App = React.createClass({
  render: function(){
    var headings = this.props.headings.map(function(heading) {
      return(&lt;th&gt;
        {heading}
      &lt;/th&gt;);
    });

    var rows = this.props.data.map(function(row){
      return  &lt;tr&gt;
        &lt;td&gt;{row.when}&lt;/td&gt;
        &lt;td&gt;{row.who}&lt;/td&gt;
        &lt;td&gt;{row.description}&lt;/td&gt;
      &lt;/tr&gt;

    })
      return &lt;div&gt;&lt;h1&gt;{this.props.title}&lt;/h1&gt;&lt;table&gt;
        &lt;thead&gt;
          {headings}
        &lt;/thead&gt;
        {rows}
      &lt;/table&gt;&lt;/div&gt;
  }
});</pre></div><p>"Let's split this single <a id="id44" class="indexterm"/>component into small composable components. These simple modular components will use other modular components with well-defined self-contained interfaces."</p><p>"Got it" said Shawn.</p><p>"Ok. The first step is trying to identify the different components that are present in our single component."</p><p>"Currently, our render method lists <code class="literal">tableHeadings</code> and <code class="literal">tableRows</code> as the children of table element."</p><div class="informalexample"><pre class="programlisting">return(&lt;table&gt;
             {tableHeadings}
             {tableRows}
       &lt;/table&gt;);</pre></div><p>"I guess we will make the components for the headings and rows?" Shawn asked.</p><p>"Yes. But we can go one step further. Both headings and rows are lists of still smaller units, a <code class="literal">Heading</code> and a <code class="literal">Row</code> tag, respectively. It can be visualized as follows:"</p><div class="informalexample"><pre class="programlisting">&lt;table&gt;
  &lt;Headings&gt;
    &lt;Heading/&gt;
    &lt;Heading/&gt;
  &lt;/Headings&gt;
  &lt;Rows &gt;
    &lt;Row/&gt;
    &lt;Row/&gt;
  &lt;/Rows&gt;
&lt;/table&gt;</pre></div><p>"Makes sense, Mike. Let me try to create <code class="literal">Heading</code> now."</p><p>"Sure, go ahead."</p><div class="informalexample"><pre class="programlisting">var Heading = React.createClass({
  render: function() {
    return(&lt;th&gt;{heading}&lt;/th&gt;);
  }
});</pre></div><p>"Mike, I think this <a id="id45" class="indexterm"/>will work, except the heading. I am not sure how to render the actual heading in the <code class="literal">&lt;th&gt;</code> tag."</p><p>"Don't worry about it. Let's just assume that it will be passed as props to the <code class="literal">Heading</code> component."</p><p>"Sure. Here is the <code class="literal">Heading</code> component then:"</p><div class="informalexample"><pre class="programlisting">var Heading = React.createClass({
  render: function() {
    return(&lt;th&gt;{this.props.heading}&lt;/th&gt;);
  }
}); </pre></div><p>"Perfect! The <code class="literal">Row</code> component will also be similar to <code class="literal">Heading</code>. It will get the <code class="literal">changeSet</code> object in its props"</p><div class="informalexample"><pre class="programlisting">var Row = React.createClass({
  render: function() {
    return(&lt;tr&gt;
             &lt;td&gt;{this.props.changeSet.when}&lt;/td&gt;
             &lt;td&gt;{this.props.changeSet.who}&lt;/td&gt;
             &lt;td&gt;{this.props.changeSet.description}&lt;/td&gt;
          &lt;/tr&gt;);
  }
});</pre></div><p>"Shawn, we are done with lowest-level components. Now, it's time to move up a level. Let's build <code class="literal">Headings</code> first."</p><p>"Similar to how a <code class="literal">Heading</code> component will get its title in props, <code class="literal">Headings</code> will get a list of titles passed to it."</p><div class="informalexample"><pre class="programlisting">var Headings = React.createClass({
  render: function() {
    var headings = this.props.headings.map(function(heading) {
      return(&lt;Heading heading = {heading}/&gt;);
    });

   return (&lt;thead&gt;&lt;tr&gt;{headings}&lt;/tr&gt;&lt;thead&gt;);
  }
});</pre></div><p>"We are iterating over the list of titles and converting them into a list of the <code class="literal">Heading</code> components. The <code class="literal">Headings</code> component is controlling how the props are passed to the individual <code class="literal">Heading</code> <a id="id46" class="indexterm"/>components. In a sense, individual <code class="literal">Heading</code> components are owned by <code class="literal">Headings</code>." explained Mike.</p><p>"In React, an owner is the component that sets props of other components. We can also say that if the X component is present in the <code class="literal">render()</code> method of the Y component, then Y owns X." Mike further added.</p><p>"Shawn, go ahead and build the Rows component similar to <code class="literal">Headings</code>."</p><p>"Here you go:"</p><div class="informalexample"><pre class="programlisting">var Rows = React.createClass({
  render: function() {
    var rows = this.props.changeSets.map(function(changeSet) {
      return(&lt;Row changeSet = {changeSet}/&gt;);
    });
    return ({rows});
  }
});</pre></div><p>"There is just one issue. You can't render the rows as it's a collection of components. Remember that the <code class="literal">render()</code> function can only render one tag" Mike said.</p><p>"I guess I should wrap the rows in a <code class="literal">&lt;tbody&gt;</code> tag.", Shawn."</p><div class="informalexample"><pre class="programlisting">var Rows = React.createClass({
  render: function() {
    var rows = this.props.changeSets.map(function(changeSet) {
      return(&lt;Row changeSet = {changeSet}/&gt;);
    });

    return (&lt;tobdy&gt;{rows}&lt;/tbody&gt;);
  }
});</pre></div><p>"Perfect. We have almost everything now. Let's finish it by adding the top-level <code class="literal">App</code> component."</p><div class="informalexample"><pre class="programlisting">var App = React.createClass({
  render: function(){
    return &lt;table className = 'table'&gt;
             &lt;Headings headings = {this.props.headings} /&gt;
             &lt;Rows changeSets = {this.props.changeSets} /&gt;
           &lt;/table&gt;;
    }
});</pre></div><p>"Here's how <a id="id47" class="indexterm"/>our complete code looks now:"</p><div class="informalexample"><pre class="programlisting">var Heading = React.createClass({
  render: function() {
    return &lt;th&gt;{this.props.heading}&lt;/th&gt;;
  }
});

var Headings = React.createClass({
  render: function() {
    var headings = this.props.headings.map(function(name) {
      return &lt;Heading heading = {name}/&gt;;
    });
   return &lt;thead&gt;&lt;tr&gt;{headings}&lt;/tr&gt;&lt;/thead&gt;;
  }
});

var Row = React.createClass({
  render: function() {
    return &lt;tr&gt;
             &lt;td&gt;{this.props.changeSet.when}&lt;/td&gt;
             &lt;td&gt;{this.props.changeSet.who}&lt;/td&gt;
             &lt;td&gt;{this.props.changeSet.description}&lt;/td&gt;
           &lt;/tr&gt;;
  }
});

var Rows = React.createClass({
  render: function() {
    var rows = this.props.changeSets.map(function(changeSet) {
      return(&lt;Row changeSet = {changeSet}/&gt;);
    });
    return &lt;tbody&gt;{rows}&lt;/tbody&gt;;
  }
});


var App = React.createClass({
  render: function() {
    return &lt;table className = 'table'&gt;
             &lt;Headings headings = {this.props.headings} /&gt;
             &lt;Rows changeSets = {this.props.changeSets} /&gt;
           &lt;/table&gt;;
    }
});

var data = [{ "when": "2 minutes ago",
              "who": "Jill Dupre",
              "description": "Created new account"
            },
            {      
              "when": "1 hour ago",
              "who": "Lose White",
              "description": "Added fist chapter"
           }];
var headings = ['When', 'Who', 'Description'];

ReactDOM.render(&lt;App headings = {headings} 
                     changeSets = {data} /&gt;, 
                                      document.getElementById('container')); </pre></div><p>"Shawn, I think you have understood the power of composability of components now. It makes our UI easy <a id="id48" class="indexterm"/>to reason with and easy to reuse and compose. We will be using this philosophy throughout with React."</p><p>"I agree. Every component does one thing right and in the end, all of them get composed together so that the whole application is built. Different parts of the code get separated in such a way that they don't interfere with each other."</p></div>
<div class="section" title="JavaScript expressions"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec20"/>JavaScript expressions</h1></div></div></div><p>"Shawn, let's <a id="id49" class="indexterm"/>discuss a bit about how we have rendered the <code class="literal">Rows</code> and <code class="literal">Headings</code> tag."</p><div class="informalexample"><pre class="programlisting">render: function() {
    var headings = this.props.headings.map(function(name) {
      return(&lt;Heading heading = {name}/&gt;);
    });

   return &lt;tr&gt;{headings}&lt;/tr&gt;;
  }</pre></div><p>"We are rendering <code class="literal">{headings}</code>, which is a list of React components, directly by adding them in curly braces as children of the <code class="literal">&lt;tr&gt;</code> tag. These expressions that are used to specify the child components are called child expressions."</p><p>"There is another <a id="id50" class="indexterm"/>category of expressions called as JavaScript expressions. These are simple expressions used for passing props or evaluating some JavaScript code that can be used as an attribute value."</p><div class="informalexample"><pre class="programlisting">// Passing props as expressions
ReactDOM.render(&lt;App headings = {['When', 'Who', 'Description']} 
                  data = {data} /&gt;, 
                document.getElementById('container'));

// Evaluating expressions
ReactDOM.render(&lt;App headings = {['When', 'Who', 'Description']} 
                  data = {data.length &gt; 0 ? data : ''} /&gt;, 
                document.getElementById('container'));</pre></div><p>"Anything that is present in curly braces is evaluated by JSX. It works for both children expressions as well as JavaScript expressions," added Mike.</p><p>"Thanks for the detailed explanation. I have a query though. Is there any way to write comments in the JSX code? I mean, we may not need it all the time, but knowing how to add comments might be handy," Shawn asked.</p><p>"Remember the curly braces rule. Comments are simply just JavaScript expressions. When we are in a child element, just wrap the comments in the curly braces."</p><div class="informalexample"><pre class="programlisting">render: function() {
    return(&lt;th&gt; 
             {/* This is a comment */}
             {this.props.heading}
           &lt;/th&gt;);
  }</pre></div><p>"You can also add comments in a JSX tag. There is no need to wrap them in curly braces in this case," Mike added.</p><div class="informalexample"><pre class="programlisting">ReactDOM.render(&lt;App 
                  /* Multi
                     Line 
                     Comment
                  */
                  headings = {headings} 
                  changeSets = {data} /&gt;, 
                document.getElementById('container'));</pre></div></div>
<div class="section" title="Namespaced components"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec21"/>Namespaced components</h1></div></div></div><p>"Shawn, you must <a id="id51" class="indexterm"/>have used modules and packages in languages such as Ruby and Java. The idea behind these concepts is to create a namespace hierarchy of code such that the code from one module or package doesn't interfere with another."</p><p>"Yes. Is something like this available with React?" Shawn asked.</p><p>"Yes. React allows creating components that are namespaced under a parent component so that they don't interfere with other components or global functions."</p><p>"We are using very generic names such as Rows and Headings that can be used later in other parts of the app too. So it makes sense to namespace them now, rather than later." explained Mike.</p><p>"Agreed. Let's do it right away," Shawn.</p><p>"We need to represent the top-level component as custom component rather than using the <code class="literal">&lt;table&gt;</code> element."</p><div class="informalexample"><pre class="programlisting">var RecentChangesTable = React.createClass({
  render: function() {
    return &lt;table&gt;
             {this.props.children}
           &lt;/table&gt;;
  } 
});</pre></div><p>"Now, we can replace the <code class="literal">App</code> component to use <code class="literal">RecentChangesTable</code> instead of <code class="literal">&lt;table&gt;.</code>"</p><div class="informalexample"><pre class="programlisting">var App = React.createClass({
  render: function(){
    return(&lt;RecentChangesTable&gt;
                &lt;Headings headings = {this.props.headings} /&gt;
                &lt;Rows changeSets = {this.props.changeSets} /&gt;
           &lt;/RecentChangesTable&gt;);
    }
});</pre></div><p>"Hang on, Mike. We just replaced <code class="literal">&lt;table&gt;</code> with a custom component. All it does is just render <code class="literal">this.props.children</code>. How does it get all the headings and rows?" Shawn asked.</p><p>"Ah! Nice observation. React, by default, captures all the child nodes between open and close tags of a component in an array and adds it to the props of that component as <code class="literal">this.props.children</code>. So we can render it using <code class="literal">{this.props.children}</code>. We will get all Headings and Rows as <code class="literal">this.props.children</code> in the <code class="literal">RecentChangesTable</code> component. The output is the same as before, when we used the <code class="literal">&lt;table&gt;</code> tag directly."</p><p>"Awesome!" exclaimed Shawn.</p><p>"Cool. Let's move <a id="id52" class="indexterm"/>on next step by namespacing all other components under <code class="literal">RecentChangesTable</code>."</p><div class="informalexample"><pre class="programlisting">RecentChangesTable.Headings = React.createClass({
  render: function() {
    var headings = this.props.headings.map(function(name) {
      return(&lt;RecentChangesTable.Heading heading = {name}/&gt;);
    });

   return (&lt;thead&gt;&lt;tr&gt;{headings}&lt;/tr&gt;&lt;/thead&gt;);
  }
});

RecentChangesTable.Heading = React.createClass({
  render: function() {
    return(&lt;th&gt;
             {this.props.heading}
           &lt;/th&gt;);
  }
});


RecentChangesTable.Row = React.createClass({
  render: function() {
    return(&lt;tr&gt;
             &lt;td&gt;{this.props.changeSet.when}&lt;/td&gt;
             &lt;td&gt;{this.props.changeSet.who}&lt;/td&gt;
             &lt;td&gt;{this.props.changeSet.description}&lt;/td&gt;
          &lt;/tr&gt;);
  }
});

RecentChangesTable.Rows = React.createClass({
  render: function() {
    var rows = this.props.changeSets.map(function(changeSet) {
      return(&lt;RecentChangesTable.Row changeSet = {changeSet}/&gt;);
    });

    return (&lt;tbody&gt;{rows}&lt;/tbody&gt;);
  }
});</pre></div><p>"We will also need to update the <code class="literal">App</code> component to use namespaced components now."</p><div class="informalexample"><pre class="programlisting">var App = React.createClass({
  render: function(){
    return(&lt;RecentChangesTable&gt;
                 &lt;RecentChangesTable.Headings headings = {this.props.headings} /&gt;
                 &lt;RecentChangesTable.Rows changeSets = {this.props.changeSets} /&gt;
               &lt;/RecentChangesTable&gt;);
    }
});</pre></div><p>"We are now <a id="id53" class="indexterm"/>done. Everything is namespaced under <code class="literal">RecentChangesTable</code> now", said Mike.</p></div>
<div class="section" title="Spread attributes"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec22"/>Spread attributes</h1></div></div></div><p>Shawn learned a <a id="id54" class="indexterm"/>lot of things about JSX but when he was reflecting on the previous steps, he came up with another question.</p><p>"Mike, as of now we are just passing two props to the <code class="literal">App</code> component: <code class="literal">headings</code> and <code class="literal">changesets</code>. However, tomorrow these props can increase to any number. Passing them one by one would be cumbersome. Especially, when we have to pass some data from the recent changes API directly. It will be hard to a keep track of the structure of the incoming data and pass it accordingly in the props. Is there a better way?"</p><p>"Another excellent question, Shawn. True, it might be cumbersome passing a large number of attributes to the component one by one. But we can solve this using the <code class="literal">spread</code> attributes."</p><div class="informalexample"><pre class="programlisting">var props = { headings: headings, changeSets: data, timestamps: timestamps };
ReactDOM.render(&lt;App {...props } /&gt;, 
                     document.getElementById('container'));</pre></div><p>"In this case, all the properties of object are passed as props to the <code class="literal">App</code> component. We can pass any object that can contain any number of key value pairs and all of them will be passed as props to the component" explained Mike.</p><p>"Very cool. Is the <code class="literal">(…)</code> operator present only in JSX?"</p><p>"Nope. It is actually based on the spread attribute feature in ES2015, which is the next JavaScript standard. ES2015, or ES6 as it is called, introduces some new features in JavaScript language and React is taking advantage of these developing standards in order to provide a cleaner syntax in JSX" added Mike.</p><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note03"/>Note</h3><p>ES2015 already <a id="id55" class="indexterm"/>supports spread operator for arrays at <a class="ulink" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_operator">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_operator</a>. There is <a id="id56" class="indexterm"/>also a proposal <a id="id57" class="indexterm"/>for objects at <a class="ulink" href="https://github.com/sebmarkbage/ecmascript-rest-spread">https://github.com/sebmarkbage/ecmascript-rest-spread</a>.</p></div></div><p>"Not only this, spread attributes can be used multiple times or it can be combined with other attributes. The <a id="id58" class="indexterm"/>order of the attributes is important though. Newer attributes override previous ones."</p><div class="informalexample"><pre class="programlisting">var data = [{ "when": "2 minutes ago",
              "who": "Jill Dupre",
              "description": "Created new account"
            },
            {
              "when": "1 hour ago",
              "who": "Lose White",
              "description": "Added fist chapter"
            }];
var headings = ['When', 'Who', 'Description'];

var props = { headings: headings, changeSets: data };

ReactDOM.render(&lt;App {...props} headings = {['Updated at ', 'Author', 'Change']} /&gt;, document.getElementById('container'));</pre></div><p>"Instead of showing <span class="strong"><strong>When</strong></span>, <span class="strong"><strong>Who</strong></span>, and <span class="strong"><strong>Description</strong></span>, <span class="strong"><strong>Updated at</strong></span>, <span class="strong"><strong>Author</strong></span>, and <span class="strong"><strong>Change</strong></span> will be shown as the headings in this case" Mike explained.</p><div class="mediaobject"><img src="graphics/4730_02_01.jpg" alt="Spread attributes"/></div><div class="note" title="Note" style=""><div class="inner"><h3 class="title"><a id="note04"/>Note</h3><p>ES2015 or ES6 is the latest version JavaScript standard. It has a lot of features, which are used by React, similar to the spread attributes. We will be using lot more ES2015 or ES6 code in the upcoming chapters.</p></div></div></div>
<div class="section" title="Styles in JSX"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec23"/>Styles in JSX</h1></div></div></div><p>"Mike, all of the <a id="id59" class="indexterm"/>things that we did today are very cool. When do we start adding styles? How can I make this page look pretty? Right now it's a bit dull." Shawn asked.</p><p>"Ah, right. Let's do that. React allows us to pass styles to the components the same way props can be passed. For example, we want our headings to be of the floral white color and maybe we want to change the font size. We will represent it in a typical CSS way as follows:"</p><div class="informalexample"><pre class="programlisting">background-color: 'FloralWhite',
font-size: '19px';</pre></div><p>"We can represent this as a JavaScript object in the CamelCase fashion."</p><div class="informalexample"><pre class="programlisting">    var headingStyle = { backgroundColor: 'FloralWhite',
                         fontSize: '19px' 
                       };</pre></div><p>Then, we can use it in each Heading component as a JavaScript object."</p><div class="informalexample"><pre class="programlisting">RecentChangesTable.Heading = React.createClass({
  render: function() {
    var headingStyle = { backgroundColor: 'FloralWhite',
                         fontSize: '19px' };
    return(&lt;th style={headingStyle}&gt;{this.props.heading}&lt;/th&gt;);
  }
});</pre></div><p>"Similarly, let's change the rows to have their own styles."</p><div class="informalexample"><pre class="programlisting">  RecentChangesTable.Row = React.createClass({
  render: function() {
  var trStyle = { backgroundColor: 'aliceblue' };
    return &lt;tr style={trStyle}&gt;
                &lt;td&gt;{this.props.changeSet.when}&lt;/td&gt;
                &lt;td&gt;{this.props.changeSet.who}&lt;/td&gt;
                &lt;td&gt;{this.props.changeSet.description}&lt;/td&gt;
            &lt;/tr&gt;;
  }
});</pre></div><p>"We now have some shiny new headings and rows sprinkled by CSS styling" Mike added.</p><div class="mediaobject"><img src="graphics/4730_02_02.jpg" alt="Styles in JSX"/></div><p>"Nice. The name of the attribute to pass these styles must be 'style', right?" Shawn asked.</p><p>"Yes. Also the keys of this style object need to be CamelCased, for example, <code class="literal">backgroundColor</code>, <code class="literal">backgroundImage</code>, <code class="literal">fontSize</code>, and so on."</p><p>"Mike, I understood the inline styling, however, how to add the CSS classes?"</p><p>"Ah right. We can <a id="id60" class="indexterm"/>pass the class name as an attribute to the DOM tags. Let's extract the styling to a new <code class="literal">recentChangesTable</code> CSS class."</p><div class="informalexample"><pre class="programlisting">// css
recentChangesTable {
  background-color: 'FloralWhite',
  font-size: '19px'
}</pre></div><p>"Now, to apply this class to our component, all we need to do is pass it to the component using the expalined <code class="literal">className</code> prop."</p><div class="informalexample"><pre class="programlisting">render: function(){
    return &lt;table className = 'recentChangesTable'&gt;
             &lt;Headings headings = {this.props.headings} /&gt;
             &lt;Rows changeSets = {this.props.changeSets} /&gt;
           &lt;/table&gt;;
    }
});</pre></div><p>"As we have seen previously, React makes use of the CamelCase attributes. Here, the <code class="literal">className</code> prop will be converted to a normal class attribute when React renders the actual HTML."</p><div class="informalexample"><pre class="programlisting">&lt;table class = 'recentChangesTable'&gt; 
…
&lt;/table&gt;</pre></div><p>"We can also pass multiple classes to the <code class="literal">className</code> prop."</p><div class="informalexample"><pre class="programlisting">&lt;table className = 'recentChangesTable userHeadings'&gt;</pre></div><p>"That's it! We can simply start using the styles freely in our components. This makes it trivial to integrate React with existing CSS styles."</p></div>
<div class="section" title="JSX Gotchas"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec24"/>JSX Gotchas</h1></div></div></div><p>The day was heading to <a id="id61" class="indexterm"/>an end. Mike and Shawn were still discussing about this shiny new thing—JSX. Mike decided that it was time to tell Shawn about the issues with using JSX.</p><p>"Shawn, so how do you feel about using JSX?"</p><p>"I liked it so far. It's very similar to the HTML markup. I can pass attributes, styles, and even classes. I can also use all the DOM elements" explained Shawn.</p><p>"Yes. But JSX is not HTML. We have to always remember this. Otherwise, we will run into trouble."</p><p>"For example, if you want to pass some custom attribute that does not exist in the HTML specification, then React will simply ignore it."</p><div class="informalexample"><pre class="programlisting">// custom-attribute won't be rendered
&lt;table custom-attribute = 'super_awesome_table'&gt;
&lt;/table&gt;</pre></div><p>"It must be passed as a data attribute so that React will render it."</p><div class="informalexample"><pre class="programlisting">// data-custom-attribute will be rendered
&lt;table data-custom-attribute = 'super_awesome_table'&gt;
&lt;/table&gt;</pre></div><p>"We may also run into some issues while rendering the HTML content dynamically. In the JSX tags, we can add a valid HTML entity directly."</p><div class="informalexample"><pre class="programlisting">// Using HTML entity inside JSX tags.
&lt;div&gt; Mike &amp;amp; Shawn &lt;/div&gt;
// will produce
 React.createElement("div", null, " Mike &amp; Shawn ")</pre></div><p>"But if we render it in a dynamic expression, it will then escape the ampersand."</p><div class="informalexample"><pre class="programlisting">// Using HTML entity inside dynamic expression
var first = 'Mike';
var second = 'Shawn';
&lt;div&gt; { first + '&amp;amp;' + second } &lt;/div&gt;

var first = 'Mike';
var second = 'Shawn';
React.createElement("div", null, " ", first + '&amp;amp;' + second, " ")</pre></div><p>"It happens as React escapes all the strings in order to prevent XSS attacks by default. To overcome it, we can directly pass the Unicode character of <code class="literal">&amp;amp;</code> or we can use arrays of strings and JSX elements." Mike explained.</p><div class="informalexample"><pre class="programlisting">// Using mixed arrays of JSX elements and normal variables
&lt;div&gt; {[first, &lt;span&gt;&amp;amp;&lt;/span&gt;, second]} &lt;/div&gt;

React.createElement("div", null, " ", [first, 
                                   React.createElement("span", null, "&amp;"), second], " ")</pre></div><p>"Wow. It can get pretty messed up" expressed Shawn.</p><p>"Well, yes, but if we remember the rules, then it's pretty simple. Also, as a last resort, React also allows to render raw HTML using a special <code class="literal">dangerouslySetInnerHTML</code> prop."</p><div class="informalexample"><pre class="programlisting">// Rendering raw HTML directly
&lt;div dangerouslySetInnerHTML={{__html: 'Mike &amp;amp; Shawn'}} /&gt;</pre></div><p>"Although this option <a id="id62" class="indexterm"/>should be used after consideration about what is getting rendered to prevent XSS attacks" Mike explained.</p></div>
<div class="section" title="Conditionals in JSX"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec25"/>Conditionals in JSX</h1></div></div></div><p>"React embraces the idea of tying markup and logic that generates the markup together. This means that we <a id="id63" class="indexterm"/>can use the power of JavaScript for loops and conditionals."</p><p>"But if/else logic is a bit hard to express in markup. Therefore, in JSX, we can't use conditional statements such as if/else."</p><div class="informalexample"><pre class="programlisting">// Using if/else directly doesn't work
&lt;div className={if(success) { 'green' } else { 'red' }}/&gt;
Error: Parse Error: Line 1: Unexpected token if</pre></div><p>"Instead, we can use a ternary operator for specifying the if/else logic."</p><div class="informalexample"><pre class="programlisting">// Using ternary operator
&lt;div className={ success ? 'green' : 'red' }/&gt;
React.createElement("div", {className:  success ? 'green' : 'red'})</pre></div><p>"But ternary operator gets cumbersome with large expressions when we want to use the React component as a child. In this case, it's better to offload the logic to a block or maybe a function" Mike added.</p><div class="informalexample"><pre class="programlisting">// Moving if/else logic to a function
var showResult = function() {
  if(this.props.success === true)
    return &lt;SuccessComponent /&gt;
  else
    return &lt;ErrorComponent /&gt;
};</pre></div></div>
<div class="section" title="Non-DOM attributes"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec26"/>Non-DOM attributes</h1></div></div></div><p>"Alright Shawn, it's <a id="id64" class="indexterm"/>time to take a detailed look at our application again. If you closely see the console output, you will see a few warnings related to Keys."</p><div class="informalexample"><pre class="programlisting">"Each child in an array should have a unique \"key\" prop. Check the render method of Rows. See http://fb.me/react-warning-keys for more information."</pre></div><p>"In the <code class="literal">render()</code> method of <code class="literal">Rows</code>, we are rendering collection of the <code class="literal">Row</code> components."</p><div class="informalexample"><pre class="programlisting">RecentChangesTable.Rows = React.createClass({
  render: function() {
    var rows = this.props.changeSets.map(function(changeSet) {
      return(&lt;Row changeSet = {changeSet}/&gt;);
    });

    return &lt;tbody&gt;{rows}&lt;/tbody&gt;;
  }
});</pre></div><p>"During the rendering of list items, a component may move up or down in the DOM tree based on the user interaction. For example, in case of search or sorting, the items in the list can change their position. New items can also get added to the front of the list in case new data gets fetched. In such cases, React may remove and recreate components based on the diff algorithm. But if we provide a unique identifier for each element in the list, then React will intelligently decide whether to destroy it or not. This will improve the rendering performance. This can be achieved by passing a unique <code class="literal">key</code> prop to every item in the list."</p><p>In our case, the number of rows is currently fixed. But later on, we want to show the updates page as the new data is being fetched from the API. The situation gets complicated when children are added or removed dynamically as the state and identity of each component must be maintained in every render pass. The <code class="literal">key</code> prop will help React to uniquely identify the component in such cases. Go ahead and use the index of the <code class="literal">Row</code> component for this purpose as it will be unique as of now" Mike further explained.</p><p>"Cool. So let me try adding the <code class="literal">key</code> prop to <code class="literal">Rows</code>. I noticed same issue with the <code class="literal">Headings</code> component too, therefore, I will add a key for <code class="literal">Headings</code> as well." said Shawn.</p><div class="informalexample"><pre class="programlisting">RecentChangesTable.Rows = React.createClass({
  render: function() {
    var rows = this.props.changeSets.map(function(changeSet, index) {
      return(&lt;Row key={index} changeSet = {changeSet}/&gt;);
    });

    return (&lt;div&gt;{rows}&lt;/div&gt;);
  }
});
RecentChangesTable.Headings = React.createClass({
  render: function() {
    var headings = this.props.headings.map(function(name, index) {
      return(&lt;RecentChangesTable.Heading key={index} heading = {name}/&gt;);
    });

    return (&lt;thead&gt;&lt;tr&gt;{headings}&lt;/tr&gt;&lt;/thead&gt;);
  }
});</pre></div><p>"Perfect. Note that the value of keys for a given list should be unique. We will get to know more about the keys when we start updating the DOM based on dynamic data. But this is good enough for now" said Mike.</p><p>"Makes sense. Are there any more such keywords/identifiers available for us?"</p><p>"Yes. Along with key, there is also refs or references. It allows the parent component to keep a reference of a child <a id="id65" class="indexterm"/>component. Right now, we can't access the child components outside the <code class="literal">render()</code> method of the component. But having <code class="literal">ref</code> allows us to use the child component anywhere in the component, not just the <code class="literal">render()</code> method."</p><div class="informalexample"><pre class="programlisting">&lt;input ref="myInput" /&gt;</pre></div><p>"Now, we can access these references outside the render method too."</p><div class="informalexample"><pre class="programlisting">    this.refs.myInput</pre></div><p>"It's pretty useful when we want to inform a component to change something at runtime. We will discuss and use <code class="literal">refs</code> in more detail later when we deal with event handlers" Mike added.</p></div>
<div class="section" title="Summary"><div class="titlepage"><div><div><h1 class="title"><a id="ch02lvl1sec27"/>Summary</h1></div></div></div><p>In this chapter, we dived deep into JSX. We discussed why using JSX makes development with React easy and how JSX gets transformed into the plain native JavaScript. We split big the single React component into small, focused components and understood the advantages of reusable, modular components. We saw different JSX tags, JavaScript expressions, and how React is taking advantages of ES6 features such as spread attributes. In the end, we discussed advanced topics such as namespaced components and some gotchas that we should keep in mind while using JSX.</p><p>In the next chapter, we will focus on data flow and models to access data and component life cycle and their use.</p></div></body></html>